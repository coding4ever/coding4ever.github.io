
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Manganalisa Source Code Mesin Penjawab Otomatis Y!M Versi 8, 9 & 10 - Coding4ever&#8217;s Blog</title>
  <meta name="author" content="Admin">

  
  <meta name="description" content="Kalo pada artikel sebelumnya kita sudah mengetahui bagaimana cara menganalisa bagian-bagian penting program Y!M untuk mendapatkan informasi yang kita &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://coding4ever.net/blog/2010/02/22/manganalisa-source-code-mesin-penjawab-otomatis-ym-versi-8-9-10">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/atom.xml" rel="alternate" title="Coding4ever's Blog" type="application/atom+xml">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="./javascripts/libs/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="//fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="//fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-50866618-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">Coding4ever&#8217;s Blog</a></h1>
  
    <h2>Just coding&#8230; coding&#8230; and coding&#8230; because coding should be fun :)</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="https://www.google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:coding4ever.net" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Home</a></li>
  <li><a href="/blog/archives">Archives</a></li>
  <li><a href="/gudang-software">Gudang Software</a></li>
  <li><a href="/source-code">Source Code</a></li>  
  <li><a href="/aplikasi-gratis">Aplikasi Gratis</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div>
<article class="hentry" role="article">
  
  <header>
    
      <h1 class="entry-title">Manganalisa Source Code Mesin Penjawab Otomatis Y!M Versi 8, 9 & 10</h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2010-02-22T07:01:48+07:00'><span class='date'><span class='date-month'>Feb</span> <span class='date-day'>22</span><span class='date-suffix'>nd</span>, <span class='date-year'>2010</span></span> <span class='time'>7:01 am</span></time>
        
           | <a href="#disqus_thread"
             data-disqus-identifier="http://coding4ever.net">Comments</a>
        
      </p>
    
  </header>


<div class="entry-content"><p>Kalo pada artikel <a href="http://coding4ever.net/blog/2010/01/01/menganalisa-dan-membuat-mesin-penjawab-otomatis-ym/">sebelumnya</a> kita sudah mengetahui bagaimana cara menganalisa bagian-bagian penting program Y!M untuk mendapatkan informasi yang kita butuhkan guna membuat program mesin penjawab otomatis Y!M ini maka pada artikel kali ini kita akan membahas full semua source code penting untuk membuat aplikasi ini.</p>

<p>Sebenarnya saya sudah lama ingin mengupload source code ini tapi berhubung waktu itu baru support untuk Y!M 8 saya jadi males nguploadnya, tapi setelah melakukan sedikit penyesuaian untuk mendukung Y!M 9 dan 10 akhirnya saya bisa dengan tenang mengupload source code ini :D.</p>

<p>Seperti pada artikel <a href="http://coding4ever.net/blog/2010/01/01/menganalisa-dan-membuat-mesin-penjawab-otomatis-ym/">sebelumnya</a> untuk melanjutkan pembahasan ini kita harus mengetahui urutan windows parent->anak baik untuk membaca pesan yang masuk atau membalasnya.</p>

<!-- more -->


<p>Berikut adalah urutannya :</p>

<ol>
<li><p>Y!M 8</p></li>
<li><p>YSearchMenuWndClass ->  IMClass -> YHTMLContainer -> Internet Explorer_Server (membaca pesan yang masuk)</p></li>
<li><p>YSearchMenuWndClass ->  IMClass -> YIMInputWindow (membalas pesan)</p></li>
<li><p>Y!M 9</p></li>
<li><p>ATL:007C07F0 -> YHTMLContainer -> Internet Explorer_Server (membaca pesan yang masuk)</p></li>
<li><p>ATL:007C07F0 -> YIMInputWindow (membalas pesan)</p></li>
<li><p>Y!M 10</p></li>
<li><p>CConvWndBase -> YHTMLContainer -> Internet Explorer_Server (membaca pesan yang masuk)</p></li>
<li><p>CConvWndBase -> YIMInputWindow (membalas pesan)</p></li>
</ol>


<p>Telihat ada sedikit perbedaan nama class/window untuk Y!M 8, 9 dan 10 dan jika Anda lupa bagaimana cara untuk mendapatkan informasi tersebut silahkan mampir ke<a href="http://coding4ever.net/blog/2010/01/01/menganalisa-dan-membuat-mesin-penjawab-otomatis-ym/">sini</a> dulu.</p>

<p>Karena aplikasi kita kali ini akan mendukung 3 versi Y!M otomatis kita harus mempunyai sebuah fungsi untuk mengecek versi Y!M yang terinstall di komputer, salah satu cara termudah untuk mendapatkan informasi tersebut adalah via registry windows dan setelah melakukan sedikit investigasi saya mendapatkan lokasi berikut di registry windows :</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>;Y!M 8 dan 9
</span><span class='line'>Key : HKEY_LOCAL_MACHINE\SOFTWARE\Yahoo\pager
</span><span class='line'>Name : ProductVersion
</span><span class='line'>
</span><span class='line'>;Y!M 10
</span><span class='line'>Key : HKEY_CURRENT_USER\Software\yahoo\pager
</span><span class='line'>Name : Version</span></code></pre></td></tr></table></div></figure>


<p>Fungsinya akan terlihat seperti berikut :</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>Private Function getYMVersion() As String
</span><span class='line'>    Dim ymVersion       As String
</span><span class='line'>    Dim arrYMVersion()  As String
</span><span class='line'>
</span><span class='line'>    'cek key Y!M 8 dan 9
</span><span class='line'>    ymVersion = getFromWindowsRegistry(HKEY_LOCAL_MACHINE, "SOFTWARE\Yahoo\pager", "ProductVersion")
</span><span class='line'>
</span><span class='line'>    'Y!M 10
</span><span class='line'>    'jika pengecekan key Y!M versi 8 dan 9 masih kosong coba cek key Y!M 10
</span><span class='line'>    If Not (Len(ymVersion) > 0) Then ymVersion = getFromWindowsRegistry(HKEY_CURRENT_USER, "Software\yahoo\pager", "Version")
</span><span class='line'>
</span><span class='line'>    If Len(ymVersion) > 0 Then
</span><span class='line'>        arrYMVersion = Split(ymVersion, ".") ' ex : 10.0.0.1102, kita ambil mayor versionnya aja = 10
</span><span class='line'>    Else
</span><span class='line'>        ReDim arrYMVersion(0)
</span><span class='line'>    End If
</span><span class='line'>
</span><span class='line'>    getYMVersion = arrYMVersion(0)
</span><span class='line'>End Function</span></code></pre></td></tr></table></div></figure>


<p>Cara yang kedua dengan memanfaatkan registry berikut :</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>HKEY_CLASSES_ROOT\ymsgr\shell\open\command</span></code></pre></td></tr></table></div></figure>


<p>dan jika kita lihat nilai dari key tersebut lebih kurang seperti berikut :</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>"C:\Program Files\Yahoo!\Messenger\YahooMessenger.exe" %1</span></code></pre></td></tr></table></div></figure>


<p>Loh mana informasi versi Y!Mnya ? Versi Y!Mnya bisa langsung kita dapatkan dari file <strong>YahooMessenger.exe</strong> jadi dengan cara kedua ini kita membutuhkan referensi Microsoft Scripting Runtime untuk membuat fungsi getYMVersion.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>Private Function getYMVersion() As String
</span><span class='line'>    Dim fso             As Scripting.FileSystemObject
</span><span class='line'>    Dim YMExe           As String
</span><span class='line'>    Dim arrYMVersion()  As String
</span><span class='line'>
</span><span class='line'>    YMExe = getFromWindowsRegistry(HKEY_CLASSES_ROOT, "ymsgr\shell\open\command", "") 'output -> "C:\Program Files\Yahoo!\Messenger\YahooMessenger.exe" %1
</span><span class='line'>    YMExe = Replace(YMExe, " %1", "") 'hapus karakter spasi+%1
</span><span class='line'>    YMExe = Replace(YMExe, Chr(34), "") 'hapus karakter petik "
</span><span class='line'>
</span><span class='line'>    If Len(YMExe) > 0 Then
</span><span class='line'>        Set fso = New Scripting.FileSystemObject
</span><span class='line'>        arrYMVersion = Split(fso.GetFileVersion(YMExe), ".") ' ex : 10.0.0.1102, kita ambil mayor versionnya aja = 10
</span><span class='line'>        Set fso = Nothing
</span><span class='line'>
</span><span class='line'>    Else
</span><span class='line'>        ReDim arrYMVersion(0)
</span><span class='line'>    End If
</span><span class='line'>
</span><span class='line'>    getYMVersion = arrYMVersion(0)
</span><span class='line'>End Function</span></code></pre></td></tr></table></div></figure>


<p>Dari 2 fungsi getYMVersion tersebut terserah Anda mau menggunakan yang mana, yang jelas hasilnya sama. Selanjutnya kita tinggal panggil fungsi tersebut seperti berikut :</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>Public Sub Main()
</span><span class='line'>    Dim ymVersion   As String
</span><span class='line'>
</span><span class='line'>    ymVersion = getYMVersion
</span><span class='line'>    If Not (Len(ymVersion) > 0) Then
</span><span class='line'>        MsgBox "Y!M belum terinstall, aplikasi tidak bisa dilanjutkan", vbExclamation, "Peringatan"
</span><span class='line'>        End
</span><span class='line'>    End If
</span><span class='line'>
</span><span class='line'>    'TODO : tampilkan form utama disini
</span><span class='line'>End Sub</span></code></pre></td></tr></table></div></figure>


<p>Oke sampai disini kita sudah punya fungsi pengecekan versi Y!M langkah berikutnya adalah mendapatkan ymID yang sedang chat dengan kita.</p>

<p>Informasi ymID ini nanti digunakan untuk memudahkan kita memparsing pesan yang masuk.</p>

<p>Satu-satunya cara yang saat ini saya ketahui untuk mendapatkan informasi ymID adalah dengan membaca informasi Title Bar Y!M, tetapi informasi Title Bar ini tidak fix tergantung kondisi berikut :</p>

<ol>
<li><p> Versi Y!M</p></li>
<li><p> Lawan chat sudah terdaftar Messenger List/belum</p></li>
</ol>


<p>berikut cuplikannya</p>

<p><a href="http://coding4ever.files.wordpress.com/2010/02/22022010-1.jpg"><img src="http://coding4ever.files.wordpress.com/2010/02/22022010-1.jpg?w=300" alt="" /></a></p>

<p>Berdasarkan gambar diatas kita bisa dengan mudah membuat fungsi untuk mendapatkan ymID.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>Private Function getYMID(ByVal hwndYMMainClass As Long) As String
</span><span class='line'>    Dim titleBar        As String
</span><span class='line'>    Dim ymID            As String
</span><span class='line'>    Dim arrTitleBar()   As String
</span><span class='line'>    Dim pos             As Long
</span><span class='line'>
</span><span class='line'>    titleBar = String$(100, Chr$(0))
</span><span class='line'>    GetWindowText hwndYMMainClass, titleBar, 100
</span><span class='line'>    titleBar = Left$(titleBar, InStr(titleBar, Chr$(0)) - 1)
</span><span class='line'>
</span><span class='line'>    If InStr(1, titleBar, " (") > 0 Then 'lawan chat terdaftar di Messenger List
</span><span class='line'>        'ex YM8    : KoKom Armag3d0n (k4m4r82) - Instant Message
</span><span class='line'>        '   YM9/10 : KoKom Armag3d0n (k4m4r82)
</span><span class='line'>
</span><span class='line'>        arrTitleBar = Split(titleBar, " (")
</span><span class='line'>        ymID = arrTitleBar(0)
</span><span class='line'>
</span><span class='line'>    Else
</span><span class='line'>        Select Case ymVersion
</span><span class='line'>            Case "8" 'ex : KoKom Armag3d0n - Instant Message
</span><span class='line'>                arrTitleBar = Split(titleBar, " - ")
</span><span class='line'>                ymID = arrTitleBar(0)
</span><span class='line'>
</span><span class='line'>            Case "9", "10" 'ex : KoKom Armag3d0n
</span><span class='line'>                ymID = titleBar
</span><span class='line'>        End Select
</span><span class='line'>    End If
</span><span class='line'>
</span><span class='line'>    getYMID = ymID
</span><span class='line'>End Function</span></code></pre></td></tr></table></div></figure>


<p>Contoh penggunaan fungsi getYMID</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>Private Sub cmdGetYMID_Click()
</span><span class='line'>    Dim hwndYMMainClass     As Long
</span><span class='line'>    Dim ymID                As String
</span><span class='line'>
</span><span class='line'>    Select Case ymVersion
</span><span class='line'>        Case "8": hwndYMMainClass = FindWindow("YSearchMenuWndClass", vbNullString)
</span><span class='line'>        Case "9": hwndYMMainClass = FindWindow("ATL:007C07F0", vbNullString)
</span><span class='line'>        Case "10": hwndYMMainClass = FindWindow("CConvWndBase", vbNullString)
</span><span class='line'>    End Select
</span><span class='line'>
</span><span class='line'>    ymID = getYMID(hwndYMMainClass)
</span><span class='line'>    MsgBox "YM ID : " & ymID
</span><span class='line'>End Sub</span></code></pre></td></tr></table></div></figure>


<p>Fungsi berikutnya yang akan kita buat adalah fungsi untuk membaca pesan yang masuk, kondisinya juga sama seperti Title Bar informasinya tidak fix tergantung :</p>

<ol>
<li><p> Versi Y!M</p></li>
<li><p> Lawan chat sudah terdaftar Messenger List/belum</p></li>
</ol>


<p>Kalo penasaran lihat gambar berikut :</p>

<p><a href="http://coding4ever.files.wordpress.com/2010/02/22022010-2.jpg"><img src="http://coding4ever.files.wordpress.com/2010/02/22022010-2.jpg?w=300" alt="" /></a></p>

<p><a href="http://coding4ever.files.wordpress.com/2010/02/22022010-3.jpg"><img src="http://coding4ever.files.wordpress.com/2010/02/22022010-3.jpg?w=300" alt="" /></a></p>

<p>Contoh beberapa variasi pesan yang masuk setelah dibaca di program</p>

<p><a href="http://coding4ever.files.wordpress.com/2010/02/22022010-4.jpg"><img src="http://coding4ever.files.wordpress.com/2010/02/22022010-4.jpg?w=267" alt="" /></a></p>

<p><a href="http://coding4ever.files.wordpress.com/2010/02/22022010-5.jpg"><img src="http://coding4ever.files.wordpress.com/2010/02/22022010-5.jpg?w=266" alt="" /></a></p>

<p>Terlihat dengan jelas perbedaan antara Y!M 8 dan Y!M 9/10 pada saat pembacaan pesan yang masuk, dimana untuk Y!M 9 dan 10 menambahkan informasi <strong>tanggal</strong> dan <strong>jam</strong> pesan masuk.</p>

<p>Berikut adalah fungsi untuk menghandle semua variasi tersebut.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
<span class='line-number'>56</span>
<span class='line-number'>57</span>
<span class='line-number'>58</span>
<span class='line-number'>59</span>
<span class='line-number'>60</span>
<span class='line-number'>61</span>
<span class='line-number'>62</span>
<span class='line-number'>63</span>
<span class='line-number'>64</span>
<span class='line-number'>65</span>
<span class='line-number'>66</span>
<span class='line-number'>67</span>
<span class='line-number'>68</span>
<span class='line-number'>69</span>
<span class='line-number'>70</span>
<span class='line-number'>71</span>
<span class='line-number'>72</span>
<span class='line-number'>73</span>
<span class='line-number'>74</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>Private Function getYMMessage(ByVal hwndYMMainClass As Long) As String
</span><span class='line'>    Dim hwndIMClass         As Long
</span><span class='line'>    Dim hwndYHTMLContainer  As Long
</span><span class='line'>    Dim hwndIEServer        As Long
</span><span class='line'>
</span><span class='line'>    Dim ymID                As String
</span><span class='line'>    Dim msg                 As String
</span><span class='line'>
</span><span class='line'>    Dim arrMsg()            As String
</span><span class='line'>    Dim arrValidMsg()       As String
</span><span class='line'>    Dim validMsg            As String
</span><span class='line'>    Dim i                   As Long
</span><span class='line'>
</span><span class='line'>    Select Case ymVersion
</span><span class='line'>        Case "8"
</span><span class='line'>            'urutkan kelas yg harus dilalui untuk membaca pesan yang masuk
</span><span class='line'>            'YSearchMenuWndClass ->  IMClass -> YHTMLContainer -> Internet Explorer_Server
</span><span class='line'>
</span><span class='line'>            If hwndYMMainClass &lt;> 0 Then
</span><span class='line'>                ymID = getYMID(hwndYMMainClass)
</span><span class='line'>
</span><span class='line'>                hwndIMClass = FindWindowEx(hwndYMMainClass, 0&, "IMClass", vbNullString)
</span><span class='line'>                hwndYHTMLContainer = FindWindowEx(hwndIMClass, 0&, "YHTMLContainer", vbNullString)
</span><span class='line'>                hwndIEServer = FindWindowEx(hwndYHTMLContainer, 0&, "Internet Explorer_Server", vbNullString)
</span><span class='line'>
</span><span class='line'>                msg = getIEText(hwndIEServer)
</span><span class='line'>
</span><span class='line'>                arrMsg = Split(msg, Chr(10))
</span><span class='line'>                For i = LBound(arrMsg) To UBound(arrMsg)
</span><span class='line'>                    If Len(arrMsg(i)) > 0 Then
</span><span class='line'>                        If Left(arrMsg(i), Len(ymID) + 2) = ymID & ": " Then
</span><span class='line'>                            arrValidMsg = Split(arrMsg(i), ": ")
</span><span class='line'>                            validMsg = arrValidMsg(UBound(arrValidMsg))
</span><span class='line'>                            Exit For
</span><span class='line'>                        End If
</span><span class='line'>                    End If
</span><span class='line'>                Next i
</span><span class='line'>
</span><span class='line'>                validMsg = Replace(validMsg, Chr(13), "")
</span><span class='line'>                getYMMessage = validMsg
</span><span class='line'>            End If
</span><span class='line'>
</span><span class='line'>        Case "9", "10"
</span><span class='line'>            'urutkan kelas yg harus dilalui untuk membaca pesan yang masuk
</span><span class='line'>            'Y!M 9  : ATL:007C07F0 -> YHTMLContainer -> Internet Explorer_Server
</span><span class='line'>            'Y!M 10 : CConvWndBase -> YHTMLContainer -> Internet Explorer_Server
</span><span class='line'>
</span><span class='line'>            If hwndYMMainClass &lt;> 0 Then
</span><span class='line'>                ymID = getYMID(hwndYMMainClass)
</span><span class='line'>
</span><span class='line'>                hwndYHTMLContainer = FindWindowEx(hwndYMMainClass, 0&, "YHTMLContainer", vbNullString)
</span><span class='line'>                hwndIEServer = FindWindowEx(hwndYHTMLContainer, 0&, "Internet Explorer_Server", vbNullString)
</span><span class='line'>
</span><span class='line'>                msg = getIEText(hwndIEServer)
</span><span class='line'>
</span><span class='line'>                arrMsg = Split(msg, Chr(10))
</span><span class='line'>                For i = LBound(arrMsg) To UBound(arrMsg)
</span><span class='line'>                    If Len(arrMsg(i)) > 0 Then
</span><span class='line'>                        If Left(arrMsg(i), Len(ymID) + 2) = ymID & " (" Then
</span><span class='line'>                            arrValidMsg = Split(arrMsg(i), "): ")
</span><span class='line'>                            validMsg = arrValidMsg(UBound(arrValidMsg))
</span><span class='line'>                            Exit For
</span><span class='line'>                        End If
</span><span class='line'>                    End If
</span><span class='line'>                Next i
</span><span class='line'>
</span><span class='line'>                validMsg = Replace(validMsg, Chr(13), "")
</span><span class='line'>                getYMMessage = validMsg
</span><span class='line'>            End If
</span><span class='line'>
</span><span class='line'>        Case Else
</span><span class='line'>            'silahkan coba sendiri versi ym yg lain
</span><span class='line'>    End Select
</span><span class='line'>End Function</span></code></pre></td></tr></table></div></figure>


<p>Contoh penggunaan fungsi getYMMessage</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>Private Sub cmdGetYMMessage_Click()
</span><span class='line'>    Dim hwndYMMainClass     As Long
</span><span class='line'>    Dim ymMessage           As String
</span><span class='line'>
</span><span class='line'>    Select Case ymVersion
</span><span class='line'>        Case "8": hwndYMMainClass = FindWindow("YSearchMenuWndClass", vbNullString)
</span><span class='line'>        Case "9": hwndYMMainClass = FindWindow("ATL:007C07F0", vbNullString)
</span><span class='line'>        Case "10": hwndYMMainClass = FindWindow("CConvWndBase", vbNullString)
</span><span class='line'>    End Select
</span><span class='line'>
</span><span class='line'>    ymMessage = getYMMessage(hwndYMMainClass)
</span><span class='line'>    MsgBox "Pesan masuk : " & ymMessage
</span><span class='line'>End Sub</span></code></pre></td></tr></table></div></figure>


<p>Fungsi terakhir adalah fungsi untuk mengirim pesan ke lawat chat</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>Private Sub YMChatSend(ByVal hwndYMMainClass As Long, ByVal msgToSend As String)
</span><span class='line'>    Dim hwndIMClass         As Long
</span><span class='line'>    Dim hwndYIMInputWindow  As Long
</span><span class='line'>
</span><span class='line'>    Select Case ymVersion
</span><span class='line'>        Case "8"
</span><span class='line'>            'urutkan kelas yg harus dilalui untuk membalas pesan yang masuk
</span><span class='line'>            'YSearchMenuWndClass ->  IMClass -> YIMInputWindow
</span><span class='line'>
</span><span class='line'>            If hwndYMMainClass &lt;> 0 Then
</span><span class='line'>                hwndIMClass = FindWindowEx(hwndYMMainClass, 0&, "IMClass", vbNullString)
</span><span class='line'>                hwndYIMInputWindow = FindWindowEx(hwndIMClass, 0&, "YIMInputWindow", vbNullString)
</span><span class='line'>            End If
</span><span class='line'>
</span><span class='line'>        Case "9", "10"
</span><span class='line'>            'urutkan kelas yg harus dilalui untuk membalas pesan yang masuk
</span><span class='line'>            'Y!M 9  : ATL:007C07F0 -> YIMInputWindow
</span><span class='line'>            'Y!M 10 : CConvWndBase -> YIMInputWindow
</span><span class='line'>            If hwndYMMainClass &lt;> 0 Then hwndYIMInputWindow = FindWindowEx(hwndYMMainClass, 0&, "YIMInputWindow", vbNullString)
</span><span class='line'>    End Select
</span><span class='line'>
</span><span class='line'>    If hwndYIMInputWindow &lt;> 0 Then
</span><span class='line'>        Call SendMessageByString(hwndYIMInputWindow, WM_SETTEXT, 0&, msgToSend)
</span><span class='line'>        Call SendMessage(hwndYIMInputWindow, WM_KEYDOWN, VK_RETURN, 0&) 'otomatis menekan tombol Send
</span><span class='line'>    End If
</span><span class='line'>End Sub</span></code></pre></td></tr></table></div></figure>


<p>Contoh penggunaan fungsi ymChatSend</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>Private Sub cmdSendMessage_Click()
</span><span class='line'>    Dim hwndYMMainClass     As Long
</span><span class='line'>    Dim msg                 As String
</span><span class='line'>
</span><span class='line'>    Select Case ymVersion
</span><span class='line'>        Case "8": hwndYMMainClass = FindWindow("YSearchMenuWndClass", vbNullString)
</span><span class='line'>        Case "9": hwndYMMainClass = FindWindow("ATL:007C07F0", vbNullString)
</span><span class='line'>        Case "10": hwndYMMainClass = FindWindow("CConvWndBase", vbNullString)
</span><span class='line'>    End Select
</span><span class='line'>
</span><span class='line'>    msg = "Hallo bro gue udah selesai nih nGebuatin mesin penjawab otomatis Y!Mnya" & vbCrLf & _
</span><span class='line'>          "Tinggal maem-maemnya ya !!!"
</span><span class='line'>    Call ymChatSend(hwndYMMainClass, msg)
</span><span class='line'>End Sub</span></code></pre></td></tr></table></div></figure>


<p>Akhirnya selesai juga :) dan potongan kode diatas sudah saya susun menjadi program sederhana dengan kasus &ldquo;Tes Bahasa Inggris&rdquo; yang bisa didownload di<a href="http://www.4shared.com/file/jxBWeMZD/YMAnsweringMachine.html">sini</a>.</p>

<p>Kalo males <a href="https://github.com/k4m4r82/YMAnsweringMachine">download</a> kita lihat  aja trailernya :)</p>

<p><a href="http://coding4ever.files.wordpress.com/2010/02/22022010-6.jpg"><img src="http://coding4ever.files.wordpress.com/2010/02/22022010-6.jpg?w=300" alt="" /></a></p>

<p><a href="http://coding4ever.files.wordpress.com/2010/02/22022010-7.jpg"><img src="http://coding4ever.files.wordpress.com/2010/02/22022010-7.jpg?w=300" alt="" /></a></p>

<p><a href="http://coding4ever.files.wordpress.com/2010/02/22022010-8.jpg"><img src="http://coding4ever.files.wordpress.com/2010/02/22022010-8.jpg?w=300" alt="" /></a></p>

<p><a href="http://coding4ever.files.wordpress.com/2010/02/22022010-9.jpg"><img src="http://coding4ever.files.wordpress.com/2010/02/22022010-9.jpg?w=300" alt="" /></a></p>

<p><a href="http://coding4ever.files.wordpress.com/2010/02/22022010-10.jpg"><img src="http://coding4ever.files.wordpress.com/2010/02/22022010-10.jpg?w=300" alt="" /></a></p>

<p>Selamat mencoba :)</p>
</div>


  <footer>
    <p class="meta">
      
  

<span class="byline author vcard">Posted by <span class="fn">Admin</span></span>

      




<time class='entry-date' datetime='2010-02-22T07:01:48+07:00'><span class='date'><span class='date-month'>Feb</span> <span class='date-day'>22</span><span class='date-suffix'>nd</span>, <span class='date-year'>2010</span></span> <span class='time'>7:01 am</span></time>
      

<span class="categories">
  
    <a class='category' href='/blog/categories/visual-basic/'>visual basic</a>
  
</span>


    </p>
    
      <div class="sharing">
  
  
  
    <div class="fb-like" data-send="true" data-width="450" data-show-faces="false"></div>
  
</div>

    
    <p class="meta">
      
        <a class="basic-alignment left" href="/blog/2010/02/18/cara-mudah-dan-gampang-membuat-aplikasi-service-dengan-vb6/" title="Previous Post: Cara mudah dan gampang membuat aplikasi service dengan VB6">&laquo; Cara mudah dan gampang membuat aplikasi service dengan VB6</a>
      
      
        <a class="basic-alignment right" href="/blog/2010/02/25/menambahkan-icon-pada-menu-standar-vb/" title="Next Post: Menambahkan icon pada menu standar VB">Menambahkan icon pada menu standar VB &raquo;</a>
      
    </p>
  </footer>
</article>

  <section>
    <h1>Comments</h1>
    <div id="disqus_thread" aria-live="polite"><noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>
  </section>

</div>

<aside class="sidebar">
  
    <section>
  <h1>Admin</h1>
  
  <a href="http://www.facebook.com/abu.anas.1232" title="Admin" target="_blank"><img src="https://coding4ever.files.wordpress.com/2015/04/avatar-blog.png" border="0" alt="Admin" /></a><br/>
  
  <p>Software developer yang berasal dari Riau, tepatnya di <a href="http://id.wikipedia.org/wiki/Kabupaten_Indragiri_Hilir" title="Negeri Seribu Parit" target="_blank">Negeri Seribu Parit</a> dan saat ini berdomisili di Yogyakarta.</p>
  
  <p>Pernah mengajar di salah satu perguruan tinggi swasta (PTS) di Yogyakarta.<br>
     Saat ini bekerja sebagai staf IT di PTS yang sama sebagai senior software developer.</p>
  
  <p>Fokus mengembangkan aplikasi di atas platform .NET dan Android. Diwaktu luang insya Alloh akan terus berbagi pengalaman di blog <a href="http://coding4ever.net/" target="_blank">ini</a>.</p>    
</section><section>
  <h1>Contacts</h1>
    <ul>		
		<li>			
			<a href="mailto:coding4ever.net@gmail.com" title="GMail" target="_blank"><img src="http://coding4ever.files.wordpress.com/2014/05/gmail-small2.png" border="0" alt="GMail" /></a>
		</li>		
		<li>			
			<a href="https://github.com/k4m4r82?tab=repositories" title="GitHub" target="_blank"><img src="http://coding4ever.files.wordpress.com/2014/05/github-small2.png" border="0" alt="GitHub" /></a>
		</li>
		<li>
			<a href="http://www.facebook.com/abu.anas.1232" title="Facebook" target="_blank"><img src="http://coding4ever.files.wordpress.com/2014/05/fb-small2.png" border="0" alt="Facebook" /></a>
		</li>				
	</ul>
</section><section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2015/04/14/paket-nuget-yang-wajib-dicoba-bagian-number-1-crashreporter-dot-net/">Paket NuGet Yang Wajib Dicoba Bagian #1 - CrashReporter.NET</a>
      </li>
    
      <li class="post">
        <a href="/blog/2015/04/13/comment-as-a-guest/">Comment as a Guest</a>
      </li>
    
      <li class="post">
        <a href="/blog/2015/04/12/membuat-laporan-crystal-reports-net-dengan-model-data-push/">Membuat Laporan Crystal Reports .NET Dengan Model Data-Push</a>
      </li>
    
      <li class="post">
        <a href="/blog/2015/04/11/blog-lama-coding4ever-aktif-kembali/">Blog Lama Coding4ever Aktif Kembali</a>
      </li>
    
      <li class="post">
        <a href="/blog/2014/11/06/kr-pulsa-elektrik/">KR Pulsa Elektrik</a>
      </li>
    
      <li class="post">
        <a href="/blog/2014/06/08/entity-framework-part-8/">Entity Framework Part 8</a>
      </li>
    
      <li class="post">
        <a href="/blog/2014/06/02/manajemen-proyek-menggunakan-redmine-bagian-1/">Manajemen Proyek Menggunakan Redmine Bagian 1</a>
      </li>
    
      <li class="post">
        <a href="/blog/2014/05/21/manajemen-password-menggunakan-keepass/">Manajemen Password Menggunakan KeePass</a>
      </li>
    
      <li class="post">
        <a href="/blog/2014/05/10/sms-gateway-edisi-net-part-1/">SMS Gateway Edisi .NET Part 1</a>
      </li>
    
      <li class="post">
        <a href="/blog/2014/04/11/entity-framework-part-7/">Entity Framework Part 7</a>
      </li>
    
  </ul>
</section>
<section>
  <h1>Categories</h1>
    <ul id="category-list"><li><a href='/blog/categories/dot-net-remoting/'>.net remoting (9)</a></li><li><a href='/blog/categories/active-report/'>active report (4)</a></li><li><a href='/blog/categories/android/'>android (1)</a></li><li><a href='/blog/categories/aplikasi/'>aplikasi (4)</a></li><li><a href='/blog/categories/crashreporter-dot-net/'>crashreporter.net (1)</a></li><li><a href='/blog/categories/crystal-reports-net/'>crystal reports .net (1)</a></li><li><a href='/blog/categories/dapper-net/'>dapper .net (3)</a></li><li><a href='/blog/categories/entity-framework/'>entity framework (8)</a></li><li><a href='/blog/categories/firebird/'>firebird (11)</a></li><li><a href='/blog/categories/freeware/'>freeware (7)</a></li><li><a href='/blog/categories/inno-setup/'>inno setup (6)</a></li><li><a href='/blog/categories/jaringan/'>jaringan (1)</a></li><li><a href='/blog/categories/mysql/'>mysql (3)</a></li><li><a href='/blog/categories/nsis/'>nsis (2)</a></li><li><a href='/blog/categories/nuget/'>nuget (4)</a></li><li><a href='/blog/categories/sql-server-2000/'>sql server 2000 (1)</a></li><li><a href='/blog/categories/sqlite/'>sqlite (3)</a></li><li><a href='/blog/categories/tools-installer/'>tools installer (8)</a></li><li><a href='/blog/categories/uncategorized/'>uncategorized (8)</a></li><li><a href='/blog/categories/visual-basic/'>visual basic (73)</a></li><li><a href='/blog/categories/visual-basic-net/'>visual basic .net (11)</a></li><li><a href='/blog/categories/visual-c-number/'>visual c# (34)</a></li><li><a href='/blog/categories/winsock/'>winsock (6)</a></li></ul>
</section>
<section>
  <h1>Tag Cloud</h1>
    <span id="tag-cloud"><a href='/blog/categories/dot-net-remoting' style='font-size: 107.3972602739726%'>.net remoting(9)</a> <a href='/blog/categories/active-report' style='font-size: 103.28767123287672%'>active report(4)</a> <a href='/blog/categories/android' style='font-size: 100.82191780821918%'>android(1)</a> <a href='/blog/categories/aplikasi' style='font-size: 103.28767123287672%'>aplikasi(4)</a> <a href='/blog/categories/crashreporter-dot-net' style='font-size: 100.82191780821918%'>crashreporter.net(1)</a> <a href='/blog/categories/crystal-reports-net' style='font-size: 100.82191780821918%'>crystal reports .net(1)</a> <a href='/blog/categories/dapper-net' style='font-size: 102.46575342465754%'>dapper .net(3)</a> <a href='/blog/categories/entity-framework' style='font-size: 106.57534246575342%'>entity framework(8)</a> <a href='/blog/categories/firebird' style='font-size: 109.04109589041096%'>firebird(11)</a> <a href='/blog/categories/freeware' style='font-size: 105.75342465753425%'>freeware(7)</a> <a href='/blog/categories/inno-setup' style='font-size: 104.93150684931507%'>inno setup(6)</a> <a href='/blog/categories/jaringan' style='font-size: 100.82191780821918%'>jaringan(1)</a> <a href='/blog/categories/mysql' style='font-size: 102.46575342465754%'>mysql(3)</a> <a href='/blog/categories/nsis' style='font-size: 101.64383561643835%'>nsis(2)</a> <a href='/blog/categories/nuget' style='font-size: 103.28767123287672%'>nuget(4)</a> <a href='/blog/categories/sql-server-2000' style='font-size: 100.82191780821918%'>sql server 2000(1)</a> <a href='/blog/categories/sqlite' style='font-size: 102.46575342465754%'>sqlite(3)</a> <a href='/blog/categories/tools-installer' style='font-size: 106.57534246575342%'>tools installer(8)</a> <a href='/blog/categories/uncategorized' style='font-size: 106.57534246575342%'>uncategorized(8)</a> <a href='/blog/categories/visual-basic' style='font-size: 160.0%'>visual basic(73)</a> <a href='/blog/categories/visual-basic-net' style='font-size: 109.04109589041096%'>visual basic .net(11)</a> <a href='/blog/categories/visual-c-number' style='font-size: 127.94520547945206%'>visual c#(34)</a> <a href='/blog/categories/winsock' style='font-size: 104.93150684931507%'>winsock(6)</a> </span>
</section>

<section>
  <h1>GitHub Repos</h1>
  <ul id="gh_repos">
    <li class="loading">Status updating&#8230;</li>
  </ul>
  
  <script type="text/javascript">
    $(document).ready(function(){
        if (!window.jXHR){
            var jxhr = document.createElement('script');
            jxhr.type = 'text/javascript';
            jxhr.src = '/javascripts/libs/jXHR.js';
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(jxhr, s);
        }

        github.showRepos({
            user: 'k4m4r82',
            count: 0,
            skip_forks: true,
            target: '#gh_repos'
        });
    });
  </script>
  <script src="/javascripts/github.js" type="text/javascript"> </script>
</section>


  
</aside>


    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2009 - 2015 - Admin -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  

<script type="text/javascript">
      var disqus_shortname = 'coding4ever';
      
        
        // var disqus_developer = 1;
        var disqus_identifier = 'http://coding4ever.net/blog/2010/02/22/manganalisa-source-code-mesin-penjawab-otomatis-ym-versi-8-9-10/';
        var disqus_url = 'http://coding4ever.net/blog/2010/02/22/manganalisa-source-code-mesin-penjawab-otomatis-ym-versi-8-9-10/';
        var disqus_script = 'embed.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = '//' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>



<div id="fb-root"></div>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) {return;}
  js = d.createElement(s); js.id = id; js.async = true;
  js.src = "//connect.facebook.net/en_US/all.js#appId=212934732101925&xfbml=1";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>









</body>
</html>
