<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Category: Nsis | Coding4ever's Blog]]></title>
  <link href="http://coding4ever.net/blog/categories/nsis/atom.xml" rel="self"/>
  <link href="http://coding4ever.net/"/>
  <updated>2014-11-13T19:37:47+07:00</updated>
  <id>http://coding4ever.net/</id>
  <author>
    <name><![CDATA[Admin]]></name>
    
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[Membuat Paket Instalasi Vb + Mysql Dengan NSIS]]></title>
    <link href="http://coding4ever.net/blog/2010/01/16/membuat-paket-instalasi-vb-mysql-dengan-nsis/"/>
    <updated>2010-01-16T09:43:35+07:00</updated>
    <id>http://coding4ever.net/blog/2010/01/16/membuat-paket-instalasi-vb-mysql-dengan-nsis</id>
    <content type="html"><![CDATA[<p>Melengkapi tulisan saya <a href="{{%20site.url%20}}/blog/2009/12/31/membuat-paket-instalasi-vb-mysql-dengan-inno-setup/">Membuat paket instalasi vb + mysql dengan inno setup</a> kali ini kita akan membuatnya menggunakan <a href="http://nsis.sourceforge.net">NSIS</a>. <a href="http://nsis.sourceforge.net"></a></p>

<p><a href="http://nsis.sourceforge.net">NSIS</a> adalah salah satu tool gratis dan open source untuk membuat paket instalasi. Oke sebelum kita melangkah lebih jauh, berikut adalah hal-hal yang perlu kita persiapkan :</p>

<ol>
<li><p> <a href="http://nsis.sourceforge.net">NSIS</a></p></li>
<li><p> <a href="http://dev.mysql.com/downloads/mysql/">MySQL versi noninstall</a> disesuaikan dengan versi MySQL yang terinstall di komputer Anda</p></li>
<li><p> <a href="http://dev.mysql.com/downloads/connector/odbc/">Connector ODBC</a> yang sudah terinstall biasanya ada di C:\Program Files\MySQL\Connector ODBC 5.1</p></li>
<li><p> Database yang sudah di backup/dump</p></li>
<li><p> Untuk editor, bagi Anda yang buta warna cukup pake notepad :D, saya sendiri menggunakan <a href="http://notepad-plus.sourceforge.net/uk/site.htm">notepad++</a> atau kalo pengen lebih nyaman bisa menggunakan <a href="http://www.eclipse.org/downloads/">eclipse</a> kemudian download <a href="http://nsis.sourceforge.net/EclipseNSIS_-_NSIS_plugin_for_Eclipse">plug-in NSIS</a></p></li>
</ol>


<!-- more -->


<p>Memang kalo dilihat dari segi skrip,  <a href="http://jrsoftware.org/">Inno Setup</a> lebih simple dibandingkan <a href="http://nsis.sourceforge.net/">NSIS</a> tetapi setelah saya bandingkan hasil paket instalasi NSIS lebih kecil dibandingkan Inno Setup.</p>

<p>Skrip Inno Setup dan NSIS sama-sama dikelompokkan dalam section-section bedanya kalo Inno Setup untuk nama sectionnya sudah fix (misal Setup, Tasks, Files de el el) sedangkan NSIS untuk nama sectionnya bebas dan tentunya dalam penamaan section di NSIS disesuaikan dengan isinya (misal Install MySQL 5).</p>

<p>Salah satu bagian penting dari skrip NSIS yang kita bahas disini adalah skrip yang digunakan untuk membuat <strong><em>service MySQL, mendaftarkan driver MySQL Connector ODBC dan melakukan proses undump skrip databse (.sql)</em></strong>.</p>

<p>Saya ambil contoh untuk membuat service MySQL tentunya dilihat dari versi windows yang terinstall kalo keluarga Win9x jelas tidak bisa karena belum mendukung pembuatan service, oleh karena itu sebelum menjalankan perintah membuat service akan dilakukan pengecekan versi windows terlebih dulu.</p>

<p>Nah disini akan terlihat jelas perbedaan skrip Inno Setup dan NSIS dimana untuk melakukan ini inno setup cukup menambahkan flag MinVersion, misal :</p>

<p>{% codeblock %}
[Run]
;mysqld &ndash;install MySQL
Filename: &ldquo;{app}\mysql\bin\mysqld.exe&rdquo;; Parameters: &ldquo;install &rdquo;&ldquo;MySQL&rdquo;&ldquo;&rdquo;; StatusMsg: &ldquo;Sedang menginstall service MySQL &hellip;&rdquo;; Flags: runhidden; MinVersion: 0,5.01.2600sp2; Tasks: installmysql
{% endcodeblock %}</p>

<p>Sedangkan untuk NSIS kita perlu mendownload <a href="http://nsis.sourceforge.net/mediawiki/images/4/4e/NSIS_version_plugin_02.zip">Version plug-in</a> terlebih dulu dan mengekstraknya kemudiakan mengcopykan file version.dll ke folder instalasi NSIS\Plugins, walaupun sebenarnya kita bisa membuat fungsi sendiri di NSIS untuk mengecek versi windows yang terinstall.</p>

<p>Contoh skrip NSIS untuk mengecek versi windows dan menginstall service MySQL :</p>

<p>{% codeblock %}
Section &ldquo;Install MySQL 5&rdquo;
    Version::IsWindowsXP</p>

<pre><code>Pop $0 ;nilai var $0 akan bersisi 1 jika windows XP selain itu 0
StrCmp $0 "1" ItIsWindowsXP ItIsNotWindowsXP ;StrCmp sama seperti fungsi IIF di VB

ItIsWindowsXP:
Goto installservice

ItIsNotWindowsXP:
Goto done

installservice:
    DetailPrint "Sedang menginstall service MySQL ..."
    ExecWait '"$MYSQL_DIR\bin\mysqld.exe" install "MySQL"'

done:
    ;do nothing
</code></pre>

<p>SectionEnd
{% endcodeblock %}</p>

<p>Gimana lumayan beda kan? :)</p>

<p>Khusus untuk file-file Runtime VB memerlukan penanganan khusus dan untuk memudahkan Anda mencoba sample skrip ini download terlebih dahulu file Runtime VB di<a href="http://nsis.sourceforge.net/vb6runtime.zip">sini</a> dan jangan lupa diekstrak.</p>

<p>Persiapan terakhir untuk struktur folder saya buat seperti berikut :</p>

<p><a href="http://coding4ever.files.wordpress.com/2010/01/16012010-5.jpg"><img src="http://coding4ever.files.wordpress.com/2010/01/16012010-5.jpg?w=300" alt="" /></a></p>

<p>Dan saya tidak akan menjelaskan fungsi-fungsi/perintah yang digunakan dalam skrip NSIS karena sudah saya sisipkan komentar di sample skrip instalasi NSIS.</p>

<p>Jika masih kesulitan Anda bisa langsung membaca manual NSIS yang penjelasannya sudah sangat lengkap.</p>

<p>Berikut contoh skrip instalasi lengkap menggunakan NSIS :</p>

<p>{% codeblock %}
;Skrip instalasi by k4m4r82
;<a href="http://coding4ever.wordpress.com">http://coding4ever.wordpress.com</a></p>

<p>!include VB6RunTime.nsh</p>

<p>;deklarasi konstanta
;format pemanggilan ${NAMA_KONSTANTA}
!define APP_NAME &ldquo;Sistem Pembelian Bahan Baku PT. ALBASI&rdquo;
!define APP_PUBLISHER &ldquo;K4m4r82&rsquo;s Laboratory&rdquo;
!define APP_VERSION &ldquo;2.0.50&rdquo;</p>

<p>BrandingText /TRIMCENTER &ldquo;&ndash; ${APP_PUBLISHER} &ndash;&rdquo;
Name &ldquo;${APP_NAME} ${APP_VERSION}&rdquo;
Caption &ldquo;${APP_NAME} ${APP_VERSION}&rdquo;</p>

<p>CompletedText &ldquo;Instalasi sudah selesai&rdquo;</p>

<p>Icon &ldquo;setup.ico&rdquo;
LoadLanguageFile &ldquo;${NSISDIR}\Contrib\Language files\Indonesian.nlf&rdquo;
OutFile &ldquo;output\DemoSetupNSIS.exe&rdquo;
ShowInstDetails show
ShowUninstDetails show
WindowIcon on
XPStyle on</p>

<p>;informasi default folder instalasi
InstallDir &ldquo;$PROGRAMFILES\SPBB&rdquo;</p>

<p>;informasi folder instalasi disimpan disini
;informasi ini akan memudahkan kita untuk membuat program update
InstallDirRegKey HKCU &ldquo;Software\PT ALBASI\SPBB&rdquo; &ldquo;InstallDir&rdquo;</p>

<p>VIAddVersionKey /LANG=${LANG_INDONESIAN} &ldquo;ProductName&rdquo; &ldquo;${APP_NAME}&rdquo;
VIAddVersionKey /LANG=${LANG_INDONESIAN} &ldquo;Comments&rdquo; &ldquo;&rdquo;
VIAddVersionKey /LANG=${LANG_INDONESIAN} &ldquo;CompanyName&rdquo; &ldquo;${APP_PUBLISHER}&rdquo;
VIAddVersionKey /LANG=${LANG_INDONESIAN} &ldquo;LegalTrademarks&rdquo; &ldquo;${APP_NAME} is a trademark of ${APP_PUBLISHER}&rdquo;
VIAddVersionKey /LANG=${LANG_INDONESIAN} &ldquo;LegalCopyright&rdquo; &ldquo;Copyright © 2009. ${APP_PUBLISHER}&rdquo;
VIAddVersionKey /LANG=${LANG_INDONESIAN} &ldquo;FileDescription&rdquo; &ldquo;${APP_NAME}&rdquo;
VIAddVersionKey /LANG=${LANG_INDONESIAN} &ldquo;FileVersion&rdquo; &ldquo;2.0.0.50&rdquo;
VIProductVersion &ldquo;2.0.0.50&rdquo;</p>

<p>RequestExecutionLevel admin</p>

<p>AddBrandingImage left 150|234
Page custom BrandingImage
Page components
Page directory
Page instfiles</p>

<p>UninstPage custom un.BrandingImage
UninstPage uninstConfirm
UninstPage instfiles</p>

<p>;deklarsi variabel
;format pemanggilan $NAMA_VARIABEL ingat ada sedikit perbedaan dg konstanta
Var MainDir
Var MySQLDir
Var AlreadyInstalled</p>

<p>;section yang diawali karakter -, pilihannya tidak ditampilkan
Section &ldquo;-Inisialisasi Variabel&rdquo;
    StrCpy $MainDir $INSTDIR
    StrCpy $MySQLDir $MainDir\mysql
SectionEnd</p>

<p>Section &ldquo;-Visual Basic Runtime&rdquo;
    ;download file Visual Basic Runtime di: <a href="http://nsis.sourceforge.net/vb6runtime.zip">http://nsis.sourceforge.net/vb6runtime.zip</a>
    IfFileExists &ldquo;$MainDir\Albasi.exe&rdquo; 0 new_installation
        StrCpy $AlreadyInstalled 1</p>

<pre><code>new_installation:
    !insertmacro VB6RunTimeInstall "dll&amp;ocx\vb6runtime" $AlreadyInstalled
</code></pre>

<p>SectionEnd</p>

<p>Section &ldquo;-My Application Runtime&rdquo;
    SetOutPath $MainDir
        File &ldquo;main\Albasi.exe.manifest&rdquo;
    File &ldquo;main\Albasi.exe&rdquo;</p>

<pre><code>SetOutPath $SYSDIR

File "dll&amp;ocx\LVbuttons.OCX"
RegDLL "$SYSDIR\LVbuttons.ocx"

File "dll&amp;ocx\MSMASK32.OCX"
RegDLL "$SYSDIR\MSMASK32.ocx"

File "dll&amp;ocx\cTreeOpt6.ocx"
RegDLL "$SYSDIR\cTreeOpt6.ocx"

File "dll&amp;ocx\Comdlg32.ocx"
RegDLL "$SYSDIR\Comdlg32.ocx"

File "dll&amp;ocx\vbalDTab6.ocx"
RegDLL "$SYSDIR\vbalDTab6.ocx"

File "dll&amp;ocx\vbalExpBar6.ocx"
RegDLL "$SYSDIR\vbalExpBar6.ocx"

File "dll&amp;ocx\MSCOMCTL.OCX"
RegDLL "$SYSDIR\MSCOMCTL.ocx"

File "dll&amp;ocx\vbalIml6.ocx"
RegDLL "$SYSDIR\vbalIml6.ocx"

File "dll&amp;ocx\cPopMenu6.ocx"
RegDLL "$SYSDIR\cPopMenu6.ocx"

File "dll&amp;ocx\cNewMenu6.dll"
RegDLL "$SYSDIR\cNewMenu6.DLL"

File "dll&amp;ocx\scrrun.dll"
RegDLL "$SYSDIR\scrrun.DLL"

File "dll&amp;ocx\vbalMDITabs6.dll"
RegDLL "$SYSDIR\vbalMDITabs6.DLL"

File "dll&amp;ocx\SSubTmr6.dll"
RegDLL "$SYSDIR\SSubTmr6.DLL"

File "dll&amp;ocx\msado21.tlb"
RegDLL "$SYSDIR\msado21.tlb"
</code></pre>

<p>SectionEnd</p>

<p>; param /e -> expand
SectionGroup /e &ldquo;Komponen Server&rdquo;
    Section &ldquo;Install MySQL 5&rdquo;
        ; param /r -> recursive
        SetOutPath $MySQLDir\bin
        File /r &ldquo;mysql-5.1.36-win32\bin*.*&rdquo;</p>

<pre><code>    SetOutPath $MySQLDir\Docs
    File /r "mysql-5.1.36-win32\Docs\*.*"

    SetOutPath $MySQLDir\lib
    File /r "mysql-5.1.36-win32\lib\*.*"

    SetOutPath $MySQLDir\share
    File /r "mysql-5.1.36-win32\share\*.*"

    SetOutPath $MySQLDir\data
    File /r "mysql-5.1.36-win32\data\*.*"

    SetOutPath $MySQLDir
    File "mysql-5.1.36-win32\*.*"

    ;informasi lokasi instalasi mysql
    WriteINIStr $MySQLDir\my.ini "mysqld" "basedir" $MySQLDir
    WriteINIStr $MySQLDir\my.ini "mysqld" "datadir" $MySQLDir\data

    ;proses membuat dan menjalankan service mysql, cek versi windows terlebih dulu
    ;untuk contoh disini baru di tes untuk windows xp sp2
    Version::IsWindowsXP

    Pop $0 ;nilai var $0 akan bersisi 1 jika windows XP selain itu 0
    StrCmp $0 "1" ItIsWindowsXP ItIsNotWindowsXP ;StrCmp sama seperti fungsi IIF di VB

    ItIsWindowsXP:
    Goto installservice

    ItIsNotWindowsXP:
    Goto done

    installservice:
        DetailPrint "Sedang menginstall service MySQL ..."
        ExecWait '"$MySQLDir\bin\mysqld.exe" install "MySQL"'

        ;jalankan service MySQL
        DetailPrint "Sedang menjalankan service MySQL ..."
        ExecWait '"$SYSDIR\net.exe" start "MySQL"'

        ;mendaftarkan port default mysql (3306) ke firewall
        DetailPrint "Sedang mendaftarkan port MySQL ..."
        ExecWait '"$SYSDIR\netsh.exe" firewall add portopening TCP 3306 "Port MySQL"'

        ;mengganti password default root (blank). ex : masterkey
        DetailPrint "Mengganti password root"
        ExecWait '"$MySQLDir\bin\mysqladmin.exe" -uroot password masterkey'

        ;menghapus user default1 (user=blank, password=blank)
        ExecWait '"$MySQLDir\bin\mysql.exe" -uroot -pmasterkey -e "DELETE FROM mysql.user WHERE Host=$\'localhost$\' AND User=$\'$\'"'
        ExecWait '"$MySQLDir\bin\mysql.exe" -uroot -pmasterkey -e "FLUSH PRIVILEGES"'

        ;menghapus user default2 (user=root, password=blank)
        ExecWait '"$MySQLDir\bin\mysql.exe" -uroot -pmasterkey -e "DELETE FROM mysql.user WHERE Host=$\'127.0.0.1$\' AND User=$\'root$\'"'
        ExecWait '"$MySQLDir\bin\mysql.exe" -uroot -pmasterkey -e "FLUSH PRIVILEGES"'

        ;set agar user root bisa login dari mesin lain (kalo diperlukan)
        ExecWait '"$MySQLDir\bin\mysql.exe" -uroot -pmasterkey -e "GRANT ALL PRIVILEGES ON *.* TO root@$\'%$\' IDENTIFIED BY $\'masterkey$\'"'
        ExecWait '"$MySQLDir\bin\mysql.exe" -uroot -pmasterkey -e "FLUSH PRIVILEGES"'

    done:
        ;do nothing
SectionEnd

Section "Install MySQL Connector ODBC"
    SetOutPath $SYSDIR

    ;dll mysql odbc tidak perlu diregistrasikan
    ;jadi otomatis tidak perlu memanggil fungsi RegDLL
    File "C:\Program Files\MySQL\Connector ODBC 5.1\myodbc5.dll"
    File "C:\Program Files\MySQL\Connector ODBC 5.1\myodbc5S.dll"
    File "C:\Program Files\MySQL\Connector ODBC 5.1\myodbc5.lib"
    File "C:\Program Files\MySQL\Connector ODBC 5.1\myodbc5S.lib"
    File "C:\Program Files\MySQL\Connector ODBC 5.1\myodbc-installer.exe"

    Version::IsWindowsXP

    Pop $0
    StrCmp $0 "1" ItIsWindowsXP ItIsNotWindowsXP

    ItIsWindowsXP:
    Goto installdriverodbc

    ItIsNotWindowsXP:
    Goto done

    installdriverodbc:
        ;install driver myodbc
        DetailPrint "Tunggu sedang mendaftarkan driver MySQL Connector ODBC 5.1.5"
        ExecWait '"$SYSDIR\myodbc-installer.exe" -d -a -n "MySQL ODBC 5.1 Driver" -t "DRIVER=myodbc5.dll;SETUP=myodbc5S.dll"'

    done:
        ;do nothing
SectionEnd

Section "Install Database"
    SetOutPath $MySQLDir\bin

    File "main\albasi.sql"
    File "main\exec.cmd"

    Version::IsWindowsXP

    Pop $0
    StrCmp $0 "1" ItIsWindowsXP ItIsNotWindowsXP

    ItIsWindowsXP:
    Goto installdatabase

    ItIsNotWindowsXP:
    Goto done

    installdatabase:
        ;membuat database kosong
        ExecWait '"$MySQLDir\bin\mysql.exe" -uroot -pmasterkey -e "CREATE DATABASE albasi"'

        ;menjalankan file batch exec.cmd untuk melakukan proses undump
        ExecWait '"$MySQLDir\bin\exec.cmd"'

    done:
        ;do nothing
SectionEnd
</code></pre>

<p>SectionGroupEnd</p>

<p>SectionGroup /e &ldquo;Buat Shortcut&rdquo;
    Section &ldquo;Start Programs&rdquo;
        SectionIn RO ;RO -> Read Only</p>

<pre><code>    CreateDirectory "$SMPROGRAMS\PT. ALBASI"
    CreateShortCut "$SMPROGRAMS\PT. ALBASI\${APP_NAME}.lnk" "$MainDir\Albasi.exe" "" "$MainDir\Albasi.exe" 0
SectionEnd

Section "Desktop"
    ;CreateDirectory "$DESKTOP\SPBB"
    CreateShortCut "$DESKTOP\${APP_NAME}.lnk" "$MainDir\Albasi.exe" "" "$MainDir\Albasi.exe" 0
SectionEnd

Section "Quick Launch"
    ;CreateDirectory "$QUICKLAUNCH\SPBB"
    CreateShortCut "$QUICKLAUNCH\${APP_NAME}.lnk" "$MainDir\Albasi.exe" "" "$MainDir\Albasi.exe" 0
SectionEnd
</code></pre>

<p>SectionGroupEnd</p>

<p>Section &ldquo;-Registry Windows&rdquo;
    ;informasi uninstall
    WriteRegStr HKLM &ldquo;Software\Microsoft\Windows\CurrentVersion\Uninstall\SPBB&rdquo; &ldquo;DisplayName&rdquo; &ldquo;${APP_NAME}&rdquo;
    WriteRegStr HKLM &ldquo;Software\Microsoft\Windows\CurrentVersion\Uninstall\SPBB&rdquo; &ldquo;UninstallString&rdquo; &lsquo;&ldquo;$MainDir\uninstaller.exe&rdquo;&rsquo;
    WriteRegStr HKLM &ldquo;Software\Microsoft\Windows\CurrentVersion\Uninstall\SPBB&rdquo; &ldquo;DisplayIcon&rdquo; &lsquo;&ldquo;$MainDir\uninstaller.exe&rdquo;&rsquo;</p>

<pre><code>WriteRegDWORD HKLM "Software\Microsoft\Windows\CurrentVersion\Uninstall\SPBB" "NoModify" 1
WriteRegDWORD HKLM "Software\Microsoft\Windows\CurrentVersion\Uninstall\SPBB" "NoRepair" 1

WriteUninstaller $MainDir\uninstaller.exe
</code></pre>

<p>SectionEnd</p>

<p>Section &ldquo;-File Konfigurasi Program&rdquo;
    WriteINIStr $MainDir\infoprogram.ini &ldquo;Sistem&rdquo; &ldquo;serverName&rdquo; &ldquo;127.0.0.1&rdquo;
    WriteINIStr $MainDir\infoprogram.ini &ldquo;Sistem&rdquo; &ldquo;dbName&rdquo; &ldquo;albasi&rdquo;
SectionEnd</p>

<p>Section &ldquo;Uninstall&rdquo;
    ;stop service MySQL
    DetailPrint &ldquo;Menghentikan Service MySQL &hellip;&rdquo;
    ExecWait &lsquo;&ldquo;$SYSDIR\net.exe&rdquo; stop &ldquo;MySQL&rdquo;&rsquo;</p>

<pre><code>;hapus service MySQL
DetailPrint "Sedang menghapus service MySQL ..."
ExecWait '"$MySQLDir\bin\mysqld.exe" remove "MySQL"'

;driver MySQL Connector ODBC 5.1
DetailPrint "Tunggu sedang menghapus driver MySQL Connector ODBC 5.1"
ExecWait '"$SYSDIR\myodbc-installer.exe" -d -r -n "MySQL ODBC 5.1 Driver"'

; Remove registry keys
DeleteRegKey HKLM "Software\Microsoft\Windows\CurrentVersion\Uninstall\SPBB"

; Remove files and uninstaller
Delete $MainDir\*.*
RMDir $MainDir

; Remove shortcuts
Delete "$SMPROGRAMS\PT. ALBASI\*.*"
RMDir "$SMPROGRAMS\PT. ALBASI"

Delete "$DESKTOP\${APP_NAME}.lnk"
Delete "$QUICKLAUNCH\${APP_NAME}.lnk"
</code></pre>

<p>SectionEnd</p>

<p>;fungsi untuk menampilkan gambar/banner pada saat instalasi
;untuk contoh disini posisi gambar di sebelah kiri
Function BrandingImage
    SetOutPath &ldquo;$TEMP&rdquo;</p>

<pre><code>SetFileAttributes SetupModern21.bmp temporary
File SetupModern21.bmp
SetBrandingImage "$TEMP\SetupModern21.bmp" /resizetofit
</code></pre>

<p>FunctionEnd</p>

<p>;fungsi untuk menampilkan gambar/banner pada saat uninstall
Function un.BrandingImage
    SetBrandingImage &ldquo;$TEMP\SetupModern21.bmp&rdquo; /resizetofit
FunctionEnd
{% endcodeblock %}</p>

<p>Di dalam skrip instalasi ada file exec.cmd, isinya adalah :</p>

<p>{% codeblock %}
mysql -uroot -pmasterkey albasi &lt; albasi.sql
{% endcodeblock %}</p>

<p>Isi file exec.cmd sebenarnya untuk proses undump dan ternyata Inno Setup dan NSIS gagal menjalankan perintah tersebut, padahal perintah-perintah yang lainnya sukses.</p>

<p>Contoh hasil instalasi :</p>

<p><a href="http://coding4ever.files.wordpress.com/2010/01/16012010-1.jpg"><img src="http://coding4ever.files.wordpress.com/2010/01/16012010-1.jpg?w=299" alt="" /></a></p>

<p>Gambar 1</p>

<p><a href="http://coding4ever.files.wordpress.com/2010/01/16012010-22.jpg"><img src="http://coding4ever.files.wordpress.com/2010/01/16012010-22.jpg?w=299" alt="" /></a></p>

<p>Gambar 2</p>

<p><a href="http://coding4ever.files.wordpress.com/2010/01/16012010-3.jpg"><img src="http://coding4ever.files.wordpress.com/2010/01/16012010-3.jpg?w=299" alt="" /></a></p>

<p>Gambar 3</p>

<p><a href="http://coding4ever.files.wordpress.com/2010/01/16012010-4.jpg"><img src="http://coding4ever.files.wordpress.com/2010/01/16012010-4.jpg?w=299" alt="" /></a></p>

<p>Gambar 4</p>

<p>Selamat mencoba :)</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Membuat Paket Instalasi Update Program Menggunakan NSIS]]></title>
    <link href="http://coding4ever.net/blog/2009/12/29/membuat-paket-instalasi-update-program-menggunakan-nsis/"/>
    <updated>2009-12-29T13:26:52+07:00</updated>
    <id>http://coding4ever.net/blog/2009/12/29/membuat-paket-instalasi-update-program-menggunakan-nsis</id>
    <content type="html"><![CDATA[<p>Masalah update program adalah masalah klasik untuk para programmer aplikasi desktop, bagaimana tidak biasanya kita selalu disibukan dengan masalah yang satu ini. Update&hellip; update&hellip; dan update &hellip; :D apalagi dengan jumlah klien yang banyak wahhhh cape deh.</p>

<p>Sebenarnya proses update sendiri pada dasarnya adalah masalah sederhana <strong>&ldquo;tinggal copy program yang baru untuk menimpa program yang lama&rdquo;</strong>. Permasalahan biasanya muncul jika yang harus melakukan update adalah klien kita yang benar<sup>5</sup> END USER :D. Ya mungking cuma bisa ngetik di word atau mantan operator dos yang baru pindah ke windows de el el.</p>

<p>Sehingga dengan adanya program update yang baik <strong>&ldquo;User nyaman kita pun tenang&rdquo;</strong> :D.</p>

<!-- more -->


<p><a href="http://nsis.sourceforge.net/">NSIS</a> (Nullsoft Scriptable Install System) merupakan tool untuk membuat paket instalasi dengan lisensi open source.</p>

<p>Ada satu hal penting sebelum kita bisa membuat paket instalasi update program yaitu mengetahui informasi dimana program kita diinstall.</p>

<p>Ada banyak cara untuk melakukan hal ini :
<strong> 1. Mencatat lokasi program pada saat instalasi</strong></p>

<p>{% codeblock %}
InstallDirRegKey HKCU &ldquo;Software\PT ALBASI\SPBB&rdquo; &ldquo;installDir&rdquo;
{% endcodeblock %}</p>

<p><strong>2. Mencatat lokasi program pada saat start up</strong>
contoh menggunakan vb</p>

<p>{% codeblock %}
Public Sub Main()
   Call saveString(HKEY_CURRENT_USER, &ldquo;Software\PT ALBASI\SPBB&rdquo;, &ldquo;installDir&rdquo;, App.Path)
End Sub
{% endcodeblock %}</p>

<p>Contoh skrip sederhana untuk membuat paket instalasi update :</p>

<p>{% codeblock %}
!define APP_NAME &ldquo;SPBB PT ALBASI&rdquo;</p>

<p>Name &ldquo;${APP_NAME}&rdquo;
OutFile &ldquo;output\updateAlbasi.exe&rdquo;
Icon &ldquo;setup.ico&rdquo;
ShowInstDetails nevershow
XPStyle on
RequestExecutionLevel admin</p>

<p>Var INSTALL_DIR</p>

<p>Function .onInit
    MessageBox MB_YESNO|MB_ICONQUESTION &ldquo;Apakah proses update ${APP_NAME} ingin dilanjutkan ?&rdquo; /SD IDYES IDYES yes IDNO no</p>

<pre><code>yes:
SetSilent silent
Goto done

no:
Abort

done:
;ambil informasi lokasi instalasi
ReadRegStr $INSTALL_DIR HKCU "Software\PT ALBASI\SPBB" "installDir"

IfFileExists $INSTALL_DIR\Albasi.exe lanjut batal
batal:
    MessageBox MB_ICONSTOP|MB_OK "Lokasi instalasi ${APP_NAME} tidak ditemukan. Proses update batal"
    Abort

lanjut:

FindWindow $0 "" "${APP_NAME}"
StrCmp $0 0 lanjut2
    MessageBox MB_ICONSTOP|MB_OK "Program SPBB Albasi sedang dijalankan.$\nSilakan tutup aplikasi tersebut terlebih dahulu."
    Abort

lanjut2:
SetOutPath "$INSTALL_DIR"
File "core\exe\Albasi.exe" ;file program utama

MessageBox MB_ICONINFORMATION|MB_OK "Proses update ${APP_NAME} selesai"
</code></pre>

<p>FunctionEnd</p>

<p>Section &ldquo;&rdquo;
SectionEnd
{% endcodeblock %}</p>

<p>Untuk memperkecil ukuran file update Anda bisa menggunakan plugin <a href="http://www.tibed.net/vpatch">VPatch</a> (sudah include pada saat instalasi NSIS) dengan menggunakan VPatch yang dicatat hanya perbedaan versi sebelumnya dengan yang terakhir sehingga bisa memperkecil ukuran file update.</p>

<p>Artikel berikutnya masih dengan judul yang sama tetapi menggunakan inno setup.</p>

<p>Selamat mencoba :)</p>
]]></content>
  </entry>
  
</feed>
