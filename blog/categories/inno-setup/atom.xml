<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Category: Inno Setup | Coding4ever's Blog]]></title>
  <link href="http://coding4ever.net/blog/categories/inno-setup/atom.xml" rel="self"/>
  <link href="http://coding4ever.net/"/>
  <updated>2015-04-20T10:43:05+07:00</updated>
  <id>http://coding4ever.net/</id>
  <author>
    <name><![CDATA[Admin]]></name>
    
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[Menambahkan Form Input Pada Saat Instalasi (Inno Setup)]]></title>
    <link href="http://coding4ever.net/blog/2010/12/12/menambahkan-form-input-pada-saat-instalasi-inno-setup/"/>
    <updated>2010-12-12T00:01:03+07:00</updated>
    <id>http://coding4ever.net/blog/2010/12/12/menambahkan-form-input-pada-saat-instalasi-inno-setup</id>
    <content type="html"><![CDATA[<p>Adakalanya kita ingin menyederhanan proses konfigurasi aplikasi, sehingga sebagian konfigurasi kita pindah pada saat instalasi.</p>

<p>Misal kita akan menambahkan input profil klien seperti nama, telepon, alamat dan kota.</p>

<p><a href="http://coding4ever.files.wordpress.com/2010/12/12122010-3.jpg"><img src="http://coding4ever.files.wordpress.com/2010/12/12122010-3.jpg?w=300" alt="" /></a></p>

<p>Jadi dengan menggunakan <a href="http://jrsoftware.org/">Inno Setup</a> kita bisa dengan mudah melakukan hal ini, dan untuk lokasi penyimpanannya sendiri ada 2 pilihan yaitu disimpan dalam format file <a href="{{%20site.url%20}}/blog/2010/04/23/contoh-sederhana-memanipulasi-ini-file-untuk-menyimpan-informasi/">INI</a> atau langsung ke registry windows.</p>

<!-- more -->


<p>Kita akan bahas satu-satu kodenya dan pada artikel ini saya tidak membahas skrip lengkap <a href="http://jrsoftware.org/">Inno Setup</a>nya karna sudah saya bahas pada artikel yang <a href="http://coding4ever.wordpress.com/category/tools-installer/">lain</a>nya, jadi fokus kita kali ini hanya di section <strong>[Code]</strong>.</p>

<p>Berikut kodenya untuk menambahkan form input dan menyimpannya ke file dengan format <a href="{{%20site.url%20}}/blog/2010/04/23/contoh-sederhana-memanipulasi-ini-file-untuk-menyimpan-informasi/">INI</a>.</p>

<p>{% codeblock %}
[Code]
var
   INIInputPage: TInputQueryWizardPage;</p>

<p>procedure InitializeWizard();
begin
  // Form Input
  INIInputPage := CreateInputQueryPage(wpInfoAfter, &lsquo;Konfigurasi&rsquo;, &lsquo;Konfigurasi Program.&rsquo;,
                                       &lsquo;Isikan konfigurasi program ke dalam form di bawah ini.&rsquo;);</p>

<p>  INIInputPage.Add(&lsquo;Nama&rsquo;, False);
  INIInputPage.Add(&lsquo;Telepon&rsquo;, False);
  INIInputPage.Add(&lsquo;Alamat&rsquo;, False);
  INIInputPage.Add(&lsquo;Kota&rsquo;, False);</p>

<p>  INIInputPage.Values[0] := GetPreviousData(&lsquo;Nama&rsquo;, &lsquo;&rsquo;);
  INIInputPage.Values[1] := GetPreviousData(&lsquo;Telepon&rsquo;, &lsquo;&rsquo;);
  INIInputPage.Values[2] := GetPreviousData(&lsquo;Alamat&rsquo;, &lsquo;&rsquo;);
  INIInputPage.Values[3] := GetPreviousData(&lsquo;Kota&rsquo;, &lsquo;&rsquo;);
end;</p>

<p>// prosedur ketika user mengklik tombol kembali, setelah pengisian form
procedure RegisterPreviousData(PreviousDataKey: Integer);
begin
  // tampilkan nilai sebelumnya yang sudah diinputkan user
  SetPreviousData(PreviousDataKey, &lsquo;Nama&rsquo;, INIInputPage.Values[0]);
  SetPreviousData(PreviousDataKey, &lsquo;Telepon&rsquo;, INIInputPage.Values[1]);
  SetPreviousData(PreviousDataKey, &lsquo;Alamat&rsquo;, INIInputPage.Values[2]);
  SetPreviousData(PreviousDataKey, &lsquo;Kota&rsquo;, INIInputPage.Values[3]);
end;</p>

<p>// prosedur ketika user mengklik tombol lanjut, setelah pengisian form
function NextButtonClick(CurPageID: Integer): Boolean;
begin
  Result := True;
  if CurPageID = INIInputPage.ID then begin
    // validasi input, untuk contoh disini saya validasi semua inputan harus diisi
    if (Trim(INIInputPage.Values[0]) = &lsquo;&rsquo;) or (Trim(INIInputPage.Values[1]) = &lsquo;&rsquo;) or
       (Trim(INIInputPage.Values[2]) = &lsquo;&rsquo;) or (Trim(INIInputPage.Values[3]) = &lsquo;&rsquo;) then begin
       MsgBox(&lsquo;Anda harus mengisikan data secara lengkap!&rsquo;, mbError, MB_OK);
       Result := False;</p>

<pre><code>end else begin
  // jika semua input form oke, tulis ke file dengan format INI
  // otomatis akan disimpan di folder instalasi dengan nama konfig.ini
  SetIniString('Konfigurasi', 'Nama', INIInputPage.Values[0], ExpandConstant('{app}') + '\konfig.ini');
  SetIniString('Konfigurasi', 'Telepon', INIInputPage.Values[1], ExpandConstant('{app}') + '\konfig.ini');
  SetIniString('Konfigurasi', 'Alamat', INIInputPage.Values[2], ExpandConstant('{app}') + '\konfig.ini');
  SetIniString('Konfigurasi', 'kota', INIInputPage.Values[3], ExpandConstant('{app}') + '\konfig.ini');
end;
</code></pre>

<p>  end;
end;
{% endcodeblock %}</p>

<p>Berikut contoh file <a href="{{%20site.url%20}}/blog/2010/04/23/contoh-sederhana-memanipulasi-ini-file-untuk-menyimpan-informasi/">INI</a> yang dihasilkan dari kode diatas</p>

<p><a href="http://coding4ever.files.wordpress.com/2010/12/12122010-1.jpg"><img src="http://coding4ever.files.wordpress.com/2010/12/12122010-1.jpg?w=300" alt="" /></a></p>

<p>Sedangkan untuk menyimpan langsung ke registry windows menggunakan perintah <strong>RegWriteStringValue</strong></p>

<p>{% codeblock %}
// jika semua input form oke, simpan ke registry windows
RegWriteStringValue(HKEY_CURRENT_USER, &lsquo;Software\K4m4r82<code>s Laboratory\Sistem Informasi Sekolah', 'Nama', INIInputPage.Values[0]);
RegWriteStringValue(HKEY_CURRENT_USER, 'Software\K4m4r82</code>s Laboratory\Sistem Informasi Sekolah&rsquo;, &lsquo;Telepon&rsquo;, INIInputPage.Values[1]);
RegWriteStringValue(HKEY_CURRENT_USER, &lsquo;Software\K4m4r82<code>s Laboratory\Sistem Informasi Sekolah', 'Alamat', INIInputPage.Values[2]);
RegWriteStringValue(HKEY_CURRENT_USER, 'Software\K4m4r82</code>s Laboratory\Sistem Informasi Sekolah&rsquo;, &lsquo;Kota&rsquo;, INIInputPage.Values[3]);
{% endcodeblock %}</p>

<p>Jika kita lihat di registry windows, hasilnya lebih kurang seperti berikut :</p>

<p><a href="http://coding4ever.files.wordpress.com/2010/12/12122010-2.jpg"><img src="http://coding4ever.files.wordpress.com/2010/12/12122010-2.jpg?w=300" alt="" /></a></p>

<p>Selamat mencoba :)</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Menambahkan Serial Number Pada Paket Instalasi (Inno Setup)]]></title>
    <link href="http://coding4ever.net/blog/2010/04/05/menambahkan-serial-number-pada-paket-instalasi-inno-setup/"/>
    <updated>2010-04-05T00:01:04+07:00</updated>
    <id>http://coding4ever.net/blog/2010/04/05/menambahkan-serial-number-pada-paket-instalasi-inno-setup</id>
    <content type="html"><![CDATA[<p>Melengkapi koleksi artikel saya tentang pembuatan <a href="http://coding4ever.wordpress.com/category/tools-installer/">paket instalasi</a>, kali ini kita akan menambahkan serial number pada <a href="http://coding4ever.wordpress.com/category/tools-installer/">paket instalasi</a> yang kita buat menggunakan <a href="http://jrsoftware.org/">Inno Setup</a>.</p>

<p><a href="http://www.mjfreelancing.com/IKG.htm">IKG</a> (Inno Key Generator) adalah <a href="http://en.wikipedia.org/wiki/Third_party">Third-Party</a> files yang akan kita gunakan pada artikel ini dan <a href="http://jrsoftware.org/">Inno Setup</a> yang saya gunakan adalah versi 5.0.8.</p>

<p>Silahkan Anda download <a href="http://www.mjfreelancing.com/IKG.htm">IKG</a> dari situs resminya atau bisa juga download di<a href="http://dc196.4shared.com/download/257069716/702b80a7">sini</a> tetapi saya lebih menyarankan Anda untuk  mendownload dari link ke <a href="http://dc196.4shared.com/download/257069716/702b80a7">dua</a> saja :D karena sudah saya seleksi file-file apa saja yang dibutuhkan.</p>

<!-- more -->


<p>Jika sudah selesai downloadnya silahkan Anda ekstrak file IKG.rarnya, berikut adalah penjelasan singkat tentang file-file yang ada di dalam file IKG.rar</p>

<ol>
<li><p> <strong>ISID.dll</strong>, file ini dibutuhkan untuk melakukan validasi serial number/unlock code yang diinputkan pada saat proses instalasi, otomatis harus kita sertakan pada saat pembuatan paket instalasi.</p></li>
<li><p> <strong>IKG.exe</strong> adalah tool untuk mengenerate file Inno Key yang berisi informasi user + serial number valid yang sudah terenkripsi,<del> jadi setiap paket instalasi yang kita buat membutuhkan file inno key yang unik (huhhhh report juga ya) namanya juga mau aman (walaupun tidak 100%) report sedikitkan engga pa2 kan</del> (ralat 1 public key inno bisa untuk beberapa user name yg berbeda).</p></li>
<li><p> <strong>IKGHelp.pdf</strong>, klo yang ini kayaxnya enggak perlu saya jelasin.</p></li>
</ol>


<p>Oke langsung saja Anda jalankan file IKG.exe, setelah itu akan tampil form berikut :</p>

<p><a href="http://coding4ever.files.wordpress.com/2010/04/05042010-1.jpg"><img src="http://coding4ever.files.wordpress.com/2010/04/05042010-1.jpg?w=300" alt="" /></a></p>

<p>Langkah pertama yang harus kita lakukan adalah mengeset password IKG, agar tidak semua orang bisa menggunakan tool ini.</p>

<p>Klik menu File -> Change Bank Password</p>

<p><a href="http://coding4ever.files.wordpress.com/2010/04/05042010-2.jpg"><img src="http://coding4ever.files.wordpress.com/2010/04/05042010-2.jpg?w=300" alt="" /></a></p>

<p>Selanjutnya kita tinggal masukkan passwordnya</p>

<p><a href="http://coding4ever.files.wordpress.com/2010/04/05042010-3.jpg"><img src="http://coding4ever.files.wordpress.com/2010/04/05042010-3.jpg" alt="" /></a></p>

<p>Untuk menyederhanakan pembahasan, informasi yang akan kita tambahkan pada saat instalasi kita batasi sebagai berikut :</p>

<ol>
<li><p> Registered Name</p></li>
<li><p> Registered Company</p></li>
<li><p> Registration Code</p></li>
<li><p> Private Key</p></li>
</ol>


<p>Maka konfigurasi yang harus kita set pada tool IKG adalah sebagai berikut :</p>

<p><a href="http://coding4ever.files.wordpress.com/2010/04/05042010-4.jpg"><img src="http://coding4ever.files.wordpress.com/2010/04/05042010-4.jpg?w=300" alt="" /></a></p>

<p>Kita tinggal menginputkan informasi Registered Name dan Organisation, untuk informasi Registration Code dan Private Key sudah otomatis terisi.</p>

<p>Jika sudah kita langsung saja simpan file Inno Keynya, file ini berisi informasi Registered Name, Registered Company, Registration Code dan Private Key (sesuai setting diatas) yang sudah dienkripsi.</p>

<p><a href="http://coding4ever.files.wordpress.com/2010/04/05042010-5.jpg"><img src="http://coding4ever.files.wordpress.com/2010/04/05042010-5.jpg?w=300" alt="" /></a></p>

<p><a href="http://coding4ever.files.wordpress.com/2010/04/05042010-6.jpg"><img src="http://coding4ever.files.wordpress.com/2010/04/05042010-6.jpg?w=300" alt="" /></a></p>

<p>Jadi jika kita akan membuat file setup berikutnya, kita harus mengetik ulang informasi Registered Name dan Registered Company yang lain (unik) dan menyimpan ulang file Inno Key (sebaiknya dengan nama yang berbeda).</p>

<p>Sampai disini kita akan memasuki bagian yang paling menyenangkan yaitu coding :D. Kita akan menambahkan beberapa baris kode pada bagian <strong>[Files]</strong> dan <strong>[Code]</strong>.</p>

<p>{% codeblock %}
[Files]
;file klien-1.iky dihasilkan oleh tool IKG
Source: klien-1.iky; DestDir: {tmp}; Flags: ignoreversion
Source: ISID.dll; DestDir: {sys}; Flags: ignoreversion</p>

<p>[Code]
function ValidateSerialNumber(InnoKeyFile, User, Orgn, ProdCode, HDD, MAC, PrivateKey, Serial: String): Boolean;
external &lsquo;ValidateSerialNumber@files:ISID.dll stdcall&rsquo;;</p>

<p>const
    INNO_KEY = &lsquo;klien-1.iky&rsquo;;</p>

<p>var
    UserPage   : TInputQueryWizardPage;
    UserValues : TArrayOfString;</p>

<p>procedure InitializeWizard();
begin
    { create the custom page }
    UserPage := CreateInputQueryPage(wpInfoBefore, &lsquo;Informasi Registrasi&rsquo;, &lsquo;Anda memerlukan user yang valid agar bisa melanjutkan proses instalasi&rsquo;,
        &lsquo;Masukkan informasi registrasi (case sensitive), kemudian klik tombol Lanjut >.&rsquo;);</p>

<pre><code>UserPage.Add('Registered Name:', False);
UserPage.Add('Registered Company:', False);
UserPage.Add('Registration Code:', False);
UserPage.Add('Private Key:', False);

{ Set default values }
SetArrayLength(UserValues, 4);
RegQueryStringValue(HKLM, 'Software\Microsoft\Windows\CurrentVersion', 'RegisteredOwner', UserValues[0]);
RegQueryStringValue(HKLM, 'Software\Microsoft\Windows\CurrentVersion', 'RegisteredOrganization', UserValues[1]);
if (UserValues[0] = '') and (UserValues[1] = '') then begin
    RegQueryStringValue(HKCU, 'Software\Microsoft\MS Setup (ACME)\User Info', 'DefName', UserValues[0]);
    RegQueryStringValue(HKCU, 'Software\Microsoft\MS Setup (ACME)\User Info', 'DefCompany', UserValues[1]);
end;

{ Try to find the settings that were stored last time (also see below). }
UserPage.Values[0] := GetPreviousData('Name', UserValues[0]);
UserPage.Values[1] := GetPreviousData('Company', UserValues[1]);
UserPage.Values[2] := GetPreviousData('Unlock', UserValues[2]);
UserPage.Values[3] := GetPreviousData('Private', UserValues[3]);
</code></pre>

<p>end;</p>

<p>procedure RegisterPreviousData(PreviousDataKey: Integer);
begin
  { Store the settings so we can restore them next time }
  SetPreviousData(PreviousDataKey, &lsquo;Name&rsquo;, UserPage.Values[0]);
  SetPreviousData(PreviousDataKey, &lsquo;Company&rsquo;, UserPage.Values[1]);
  SetPreviousData(PreviousDataKey, &lsquo;Unlock&rsquo;, UserPage.Values[2]);
  SetPreviousData(PreviousDataKey, &lsquo;Private&rsquo;, UserPage.Values[3]);
end;</p>

<p>function ScriptDlgPages(CurPage: Integer; BackClicked: Boolean): Boolean;
var
    ExpPath: String;</p>

<p>begin
    Result := True;</p>

<pre><code>if (CurPage = UserPage.ID) then
begin
    ExtractTemporaryFile(INNO_KEY);     { the public key file }

    ExpPath := ExpandConstant('{tmp}\' + INNO_KEY);

    Result := False;

    UserValues[0] := UserPage.Values[0];
    UserValues[1] := UserPage.Values[1];
    UserValues[2] := UserPage.Values[2];
    UserValues[3] := UserPage.Values[3];

    if (UserValues[0] = '') or (UserValues[1] = '') or (UserValues[2] = '') or (UserValues[3] = '') then
        MsgBox('No fields can be blank !', mbError, MB_OK)
    else
    begin
        Result := ValidateSerialNumber(ExpPath, UserValues[0], UserValues[1], '', '', '', UserValues[3], UserValues[2]);

        if (not Result) then
            MsgBox('Invalid Entry !', mbError, MB_OK);

    end
end
</code></pre>

<p>end;</p>

<p>function NextButtonClick(CurPage: Integer): Boolean;
begin
  Result := ScriptDlgPages(CurPage, False);
end;</p>

<p>function BackButtonClick(CurPage: Integer): Boolean;
begin
  Result := True;//ScriptDlgPages(CurPage, True);
end;</p>

<p>function HasHtmlHelp(): Boolean;
begin
    { HHCTRL.OCX GUID }
    Result := RegValueExists(HKCR, &lsquo;CLSID{4662DAB0-D393-11D0-9A56-00C04FB68B66}\InprocServer32&rsquo;, &lsquo;&rsquo;);
end;</p>

<p>function HasNoHtmlHelp(): Boolean;
begin
    Result := not HasHtmlHelp;
end;
{% endcodeblock %}</p>

<p>Jika sudah selesai silahkan compile (CTRL+F9) skrip inno setup Anda, dan ingat skrip diatas hanya potongan skrip inno setup. Contoh skrip yang lengkap bisa Anda lihat di<a href="{{%20site.url%20}}/blog/2009/12/31/membuat-paket-instalasi-vb-mysql-dengan-inno-setup/">sini</a> dan <a href="{{%20site.url%20}}/blog/2010/01/05/membuat-paket-instalasi-vb-firebird-dengan-inno-setup/">sini</a>.</p>

<p><a href="http://coding4ever.files.wordpress.com/2010/04/05042010-7.jpg"><img src="http://coding4ever.files.wordpress.com/2010/04/05042010-7.jpg?w=300" alt="" /></a>
<a href="http://coding4ever.files.wordpress.com/2010/04/05042010-8.jpg"><img src="http://coding4ever.files.wordpress.com/2010/04/05042010-8.jpg?w=300" alt="" /></a>
Jika kita mencoba memasukkan informasi registrasi yang salah, maka akan tampil pesan berikut :</p>

<p><a href="http://coding4ever.files.wordpress.com/2010/04/05042010-9.jpg"><img src="http://coding4ever.files.wordpress.com/2010/04/05042010-9.jpg" alt="" /></a></p>

<p>Selamat mencoba :)</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Menambahkan Skin Pada Paket Instalasi (Inno Setup)]]></title>
    <link href="http://coding4ever.net/blog/2010/03/31/menambahkan-skin-pada-paket-instalasi-inno-setup/"/>
    <updated>2010-03-31T02:59:21+07:00</updated>
    <id>http://coding4ever.net/blog/2010/03/31/menambahkan-skin-pada-paket-instalasi-inno-setup</id>
    <content type="html"><![CDATA[<p>Inilah krennya <a href="http://jrsoftware.org/">inno setup</a> selain gratis dan open source juga banyak tersedia Third-Party Files, salah satunya ISSkin dari <a href="http://isskin.codejock.com/">codejock</a>.</p>

<p>Sebelum kita menambahkan skin, kita lihat dulu tampilan standar paket instalasi yang dibuat menggunakan inno setup.</p>

<p><a href="http://coding4ever.files.wordpress.com/2010/03/31032010-1.jpg"><img src="http://coding4ever.files.wordpress.com/2010/03/31032010-1.jpg?w=300" alt="" /></a></p>

<p>Dan kita lihat setelah menambahkan skin</p>

<!-- more -->


<p><a href="http://coding4ever.files.wordpress.com/2010/03/31032010-2.jpg"><img src="http://coding4ever.files.wordpress.com/2010/03/31032010-2.jpg?w=300" alt="" /></a></p>

<p>Gimana ? Menarik bukan ? :)</p>

<p>Oke langsung saja download sample ISSkin di<a href="http://isskin.codejock.com/downloads/ISSkinExample.zip">sini</a>, ekstrak file ISSkinExample.zip dan terakhir jalankan file ISSkin.exe</p>

<p>Apakah cukup seperti itu saja ? Tentu tidak, kita harus menambahkan beberapa baris kode pada skrip inno setup di bagian [Files] dan [Code].</p>

<p>{% codeblock %}
[Files]
; Add the ISSkin DLL used for skinning Inno Setup installations.
Source: ISSkin.dll; DestDir: {app}; Flags: dontcopy</p>

<p>; Add the Visual Style resource contains resources used for skinning,
; you can also use Microsoft Visual Styles (*.msstyles) resources.
Source: Styles\Office2007.cjstyles; DestDir: {tmp}; Flags: dontcopy</p>

<p>; The following code block is used to load the ISS, pass in
; NormalAqua.ini as the second parameter to LoadSkin to use
; the Aqua color scheme instead of the default Blue color
; scheme.
[Code]
// Importing LoadSkin API from ISSkin.DLL
procedure LoadSkin(lpszPath: String; lpszIniFileName: String);
external &lsquo;LoadSkin@files:isskin.dll stdcall&rsquo;;</p>

<p>// Importing UnloadSkin API from ISSkin.DLL
procedure UnloadSkin();
external &lsquo;UnloadSkin@files:isskin.dll stdcall&rsquo;;</p>

<p>// Importing ShowWindow Windows API from User32.DLL
function ShowWindow(hWnd: Integer; uType: Integer): Integer;
external &lsquo;<a href="&#109;&#97;&#105;&#x6c;&#x74;&#111;&#58;&#83;&#104;&#111;&#x77;&#87;&#x69;&#110;&#x64;&#x6f;&#x77;&#64;&#x75;&#x73;&#x65;&#114;&#51;&#50;&#46;&#100;&#108;&#x6c;">&#x53;&#x68;&#x6f;&#119;&#87;&#x69;&#110;&#100;&#111;&#x77;&#64;&#117;&#x73;&#101;&#x72;&#x33;&#50;&#46;&#x64;&#108;&#x6c;</a> stdcall&rsquo;;</p>

<p>function InitializeSetup(): Boolean;
begin
    ExtractTemporaryFile(&lsquo;Office2007.cjstyles&rsquo;);
    LoadSkin(ExpandConstant(&lsquo;{tmp}\Office2007.cjstyles&rsquo;), &lsquo;NormalAqua.ini&rsquo;);
    Result := True;
end;</p>

<p>procedure DeinitializeSetup();
begin
    // Hide Window before unloading skin so user does not get
    // a glimse of an unskinned window before it is closed.
    ShowWindow(StrToInt(ExpandConstant(&lsquo;{wizardhwnd}&rsquo;)), 0);
    UnloadSkin();
end;
{% endcodeblock %}</p>

<p>Berikut adalah beberapa variasi skin hasil dari ngoprek kode berikut :</p>

<p>{% codeblock %}
LoadSkin(ExpandConstant(&lsquo;{tmp}\Office2007.cjstyles&rsquo;), &lsquo;NormalAqua.ini&rsquo;);
{% endcodeblock %}</p>

<p><a href="http://coding4ever.files.wordpress.com/2010/03/31032010-3.jpg"><img src="http://coding4ever.files.wordpress.com/2010/03/31032010-3.jpg?w=300" alt="" /></a></p>

<p>{% codeblock %}
LoadSkin(ExpandConstant(&lsquo;{tmp}\Office2007.cjstyles&rsquo;), &lsquo;NormalBlack.ini&rsquo;);
{% endcodeblock %}</p>

<p><a href="http://coding4ever.files.wordpress.com/2010/03/31032010-4.jpg"><img src="http://coding4ever.files.wordpress.com/2010/03/31032010-4.jpg?w=300" alt="" /></a></p>

<p>{% codeblock %}
LoadSkin(ExpandConstant(&lsquo;{tmp}\Vista.cjstyles&rsquo;), &lsquo;NormalSilver.ini&rsquo;);
{% endcodeblock %}</p>

<p><a href="http://coding4ever.files.wordpress.com/2010/03/31032010-5.jpg"><img src="http://coding4ever.files.wordpress.com/2010/03/31032010-5.jpg?w=300" alt="" /></a></p>

<p>{% codeblock %}
LoadSkin(ExpandConstant(&lsquo;{tmp}\Vista.cjstyles&rsquo;), &lsquo;&rsquo;);
{% endcodeblock %}</p>

<p>Selamat mencoba :)</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Membuat Paket Instalasi Vb + Firebird Dengan Inno Setup]]></title>
    <link href="http://coding4ever.net/blog/2010/01/05/membuat-paket-instalasi-vb-firebird-dengan-inno-setup/"/>
    <updated>2010-01-05T13:16:54+07:00</updated>
    <id>http://coding4ever.net/blog/2010/01/05/membuat-paket-instalasi-vb-firebird-dengan-inno-setup</id>
    <content type="html"><![CDATA[<p>Menyambung postingan saya sebelumnya <a href="{{%20site.url%20}}/blog/2009/12/31/membuat-paket-instalasi-vb-mysql-dengan-inno-setup/">Membuat paket instalasi vb + mysql dengan inno setup</a> kali ini database yang kita paketkan adalah <a href="http://firebirdsql.org/">Firebird</a>. Adapun hal-hal yang perlu dipersiapkan :</p>

<ol>
<li><p> File <a href="http://sourceforge.net/projects/firebird/files/firebird-win32/2.1.3-Release/Firebird-2.1.3.18185_0_Win32.exe/download?use_mirror=autoselect">Setup Firebird</a> (saat postingan ini dibuat versi Firebird-2.1.3.18185_0_Win32)</p></li>
<li><p> File OdbcFb32.dll hasil dari instalasi <a href="http://firebirdsql.org/download/prerelease/odbc/Firebird_ODBC_2.0.0.148_win32.exe">Firebird ODBC</a> yang ada di c:\windows\system32</p></li>
<li><p> <a href="http://jrsoftware.org/">Inno Setup</a></p></li>
</ol>


<!-- more -->


<p>Karena semua persiapan sudah oke, berikut skrip instalasinya :</p>

<p>{% codeblock %}
;Skrip instalasi by k4m4r82
;<a href="http://coding4ever.wordpress.com">http://coding4ever.wordpress.com</a></p>

<p>[Setup]
AppName=Retail Manager Pro
AppVerName=Retail Manager Pro Versi 1.0.0.50
AppPublisher=K4m4r82&rsquo;s Laboratory
AllowCancelDuringInstall = yes
DefaultDirName={pf}\RetailManagerPro
DefaultGroupName=Retail Manager Pro
Compression = lzma
SolidCompression = yes
OutputBaseFilename=SetupRetailManagerPro
AllowNoIcons = yes
AlwaysRestart = no
AlwaysShowComponentsList = no
DisableProgramGroupPage = yes
AppendDefaultDirName = yes
CreateUninstallRegKey = yes
DisableStartupPrompt = yes
LanguageDetectionMethod=none
ShowLanguageDialog=no
Uninstallable = yes
UninstallFilesDir={app}\uninst
UninstallDisplayIcon={app}\RetailManager.exe,0
UninstallDisplayName=Retail Manager Pro
WindowVisible = no
AppCopyright=Copyright © 2009 K4m4r82&rsquo;s Laboratory
FlatComponentsList = yes
PrivilegesRequired = admin
VersionInfoVersion=1.0.0.50
SetupIconFile=Setup.ico
WizardImageFile=SetupModern21.bmp
WizardSmallImageFile=SetupModernSmall21.bmp</p>

<p>[Languages]
Name: ina; MessagesFile: compiler:Indonesia.isl
Name: en; MessagesFile: compiler:Default.isl</p>

<p>[Tasks]
Name: desktopicon; Description: {cm:CreateDesktopIcon}; GroupDescription: {cm:AdditionalIcons}; Flags: unchecked
Name: quicklaunchicon; Description: {cm:CreateQuickLaunchIcon}; GroupDescription: {cm:AdditionalIcons}; Flags: unchecked</p>

<p>[Files]
;Visual Basic Runtime
Source: dll&amp;ocx\VB6STKIT.DLL; DestDir: {sys}; Flags: uninsneveruninstall onlyifdoesntexist
Source: dll&amp;ocx\COMCAT.DLL; DestDir: {sys}; Flags: uninsneveruninstall sharedfile regserver onlyifdoesntexist
Source: dll&amp;ocx\stdole2.tlb; DestDir: {sys}; Flags: uninsneveruninstall sharedfile regtypelib
Source: dll&amp;ocx\asycfilt.dll; DestDir: {sys}; Flags: uninsneveruninstall onlyifdoesntexist
Source: dll&amp;ocx\olepro32.dll; DestDir: {sys}; Flags: uninsneveruninstall sharedfile regserver onlyifdoesntexist
Source: dll&amp;ocx\oleaut32.dll; DestDir: {sys}; Flags: uninsneveruninstall sharedfile regserver onlyifdoesntexist
Source: dll&amp;ocx\msvbvm60.dll; DestDir: {sys}; Flags: uninsneveruninstall sharedfile regserver onlyifdoesntexist</p>

<p>;file hasil instalasi firebird odbc
Source: C:\WINDOWS\system32\OdbcFb32.dll; DestDir: {sys}; Flags: restartreplace sharedfile regserver onlyifdoesntexist</p>

<p>;file installer database firebird sesuaikan dengan versi yang Anda download
Source: main\Firebird-2.1.3.18185_0_Win32.exe; DestDir: &ldquo;{tmp}&rdquo;; Flags: deleteafterinstall</p>

<p>;My Application Runtime
Source: main\RetailManager.exe; DestDir: {app}; Flags: ignoreversion
Source: main\RetailManager.pdf; DestDir: {app}; Flags: ignoreversion
Source: main\RETAIL_MANAGER.FDB; DestDir: {app}\Db; Flags: onlyifdoesntexist
Source: main\RetailManager.exe.manifest; DestDir: {app}; Flags: ignoreversion</p>

<p>Source: dll&amp;ocx\cTreeOpt6.ocx; DestDir: {sys}; Flags: uninsneveruninstall sharedfile regserver onlyifdoesntexist
Source: dll&amp;ocx\vbalDTab6.ocx; DestDir: {sys}; Flags: uninsneveruninstall sharedfile regserver onlyifdoesntexist
Source: dll&amp;ocx\vbalExpBar6.ocx; DestDir: {sys}; Flags: uninsneveruninstall sharedfile regserver onlyifdoesntexist
Source: dll&amp;ocx\mscomctl.ocx; DestDir: {sys}; Flags: uninsneveruninstall sharedfile regserver onlyifdoesntexist
Source: dll&amp;ocx\vbalIml6.ocx; DestDir: {sys}; Flags: uninsneveruninstall sharedfile regserver onlyifdoesntexist
Source: dll&amp;ocx\cPopMenu6.ocx; DestDir: {sys}; Flags: uninsneveruninstall sharedfile regserver onlyifdoesntexist
Source: dll&amp;ocx\LVbuttons.ocx; DestDir: {sys}; Flags: uninsneveruninstall sharedfile regserver onlyifdoesntexist
Source: dll&amp;ocx\MyTextBox.ocx; DestDir: {sys}; Flags: uninsneveruninstall sharedfile regserver onlyifdoesntexist
Source: dll&amp;ocx\MSCOMCT2.OCX; DestDir: {sys}; Flags: uninsneveruninstall sharedfile regserver onlyifdoesntexist
Source: dll&amp;ocx\vbalMDITabs6.dll; DestDir: {sys}; Flags: uninsneveruninstall sharedfile regserver onlyifdoesntexist
Source: dll&amp;ocx\SSubTmr6.dll; DestDir: {sys}; Flags: uninsneveruninstall sharedfile regserver onlyifdoesntexist
Source: dll&amp;ocx\scrrun.dll; DestDir: {sys}; Flags: uninsneveruninstall sharedfile regserver onlyifdoesntexist
Source: dll&amp;ocx\cNewMenu6.dll; DestDir: {sys}; Flags: uninsneveruninstall sharedfile regserver onlyifdoesntexist
Source: dll&amp;ocx\msado21.tlb; DestDir: {sys}; Flags: uninsneveruninstall sharedfile regtypelib</p>

<p>[Icons]
Name: {group}\Retail Manager Pro; Filename: {app}\RetailManager.exe; WorkingDir: {app}
Name: {group}\Retail Manager Pro User Manual; Filename: {app}\RetailManager.pdf; WorkingDir: {app}</p>

<p>Name: {userdesktop}\Retail Manager Pro; Filename: {app}\RetailManager.exe; WorkingDir: {app}; Tasks: desktopicon
Name: {userappdata}\Microsoft\Internet Explorer\Quick Launch\Retail Manager Pro; Filename: {app}\RetailManager.exe; WorkingDir: {app}; Tasks: quicklaunchicon</p>

<p>[Registry]
;mencatat lokasi instalasi program, ini dibutuhkan jika kita ingin membuat paket instalasi update
Root: HKCU; Subkey: &ldquo;Software\K4m4r82`s Laboratory\RetailManager&rdquo;; ValueName: &ldquo;installDir&rdquo;; ValueType: String; ValueData: {app}; Flags: uninsdeletevalue</p>

<p>[INI]
Filename: &ldquo;{app}\infoProgram.ini&rdquo;; Section: &ldquo;Sistem&rdquo;; Key: &ldquo;serverName&rdquo;; String: &ldquo;127.0.0.1&rdquo;
Filename: &ldquo;{app}\infoProgram.ini&rdquo;; Section: &ldquo;Sistem&rdquo;; Key: &ldquo;dbPath&rdquo;; String: &ldquo;{app}\Db&rdquo;</p>

<p>[Run]
;install firebird
Filename: &ldquo;{tmp}\Firebird-2.1.3.18185_0_Win32.exe&rdquo;; Parameters: &ldquo;/SP- /NORESTART /NOCPL /NOICONS /SILENT /FORCE /COMPONENTS=&rdquo;&ldquo;servercomponent\superservercomponent, SuperServerComponent, ServerComponent, ClientComponent, DevAdminComponent&rdquo;&ldquo;&rdquo;; StatusMsg: &ldquo;Instalasi Firebird 2.0 Server&hellip;&rdquo;</p>

<p>;daftarkan port firebird (3050) ke windows firewall
Filename: &ldquo;{sys}\netsh.exe&rdquo;; Parameters: &ldquo;firewall add portopening TCP 3050 &rdquo;&ldquo;Service Firebird Server&rdquo;&ldquo;&rdquo;; StatusMsg: &ldquo;Mendaftarkan port Service Firebird &hellip;&rdquo;; Flags: runhidden; MinVersion: 0,5.01.2600sp2
Filename: &ldquo;{sys}\netsh.exe&rdquo;; Parameters: &ldquo;firewall add allowedprogram &rdquo;&ldquo;{pf}\Firebird\Firebird_2_0\bin\fbserver.exe&rdquo;&ldquo; &rdquo;&ldquo;Firebird Server&rdquo;&ldquo; ENABLE ALL&rdquo;; StatusMsg: &ldquo;Mendaftarkan Firebird Server &hellip;&rdquo;; Flags: runhidden; MinVersion: 0,5.01.2600sp2</p>

<p>;menjalankan service firebird
Filename: &ldquo;{pf}\Firebird\Firebird_2_0\bin\fbserver.exe&rdquo;; Parameters: &ldquo;-a&rdquo;; StatusMsg: &ldquo;Menjalankan service firebird&rdquo;; Flags: waituntilidle</p>

<p>[UninstallRun]
Filename: &ldquo;{sys}\netsh.exe&rdquo;; Parameters: &ldquo;firewall delete portopening protocol = TCP port = 3050&rdquo;; Flags: runhidden; MinVersion: 0,5.01.2600sp2
Filename: &ldquo;{sys}\netsh.exe&rdquo;; Parameters: &ldquo;firewall delete allowedprogram &rdquo;&ldquo;{pf}\Firebird\Firebird_2_0\bin\fbserver.exe&rdquo;&ldquo;&rdquo;; Flags: runhidden; MinVersion: 0,5.01.2600sp2
{% endcodeblock %}</p>

<p>Selamat mencoba :)</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Membuat Paket Instalasi Vb + Mysql Dengan Inno Setup]]></title>
    <link href="http://coding4ever.net/blog/2009/12/31/membuat-paket-instalasi-vb-mysql-dengan-inno-setup/"/>
    <updated>2009-12-31T07:54:25+07:00</updated>
    <id>http://coding4ever.net/blog/2009/12/31/membuat-paket-instalasi-vb-mysql-dengan-inno-setup</id>
    <content type="html"><![CDATA[<p>Membuat paket instalasi yang mudah untuk aplikasi yang akan kita distribusikan memang gampang-gampang susah, gampang bagi kita untuk membuatnya hanya dengan menggunakan Package &amp; Deployment Wizard.</p>

<p>Package &amp; Deployment Wizard merupakan tool installer bawaan yang sudah disediakan oleh visual basic, tetapi apakah hasilnya akan cukup memudahkan bagi klien apalagi jika aplikasi yang kita buat menggunakan database yang membutuhkan konfigurasi atau setting-setting yang lumayan banyak pada saat instalasi, seperti MySQL atau Firebird (Maaf ya Ms Access enggak termasuk :D).</p>

<!-- more -->


<p>Atau kita mencukupkan untuk membuat panduan instalasi yang dibagi menjadi beberapa bagian :</p>

<ol>
<li><p> Instalasi Program</p></li>
<li><p> Instalasi Database Server (ex. MySQL/Firebird)  + Konfigurasi</p></li>
<li><p> Install Driver ODBC</p></li>
<li><p> Mengcopy database/undump script sql</p></li>
</ol>


<p>Atau kita ingin sedikit memaksakan diri dengan membuat paket instalasi yang mudah yang hanya dengan 6 kali klik bisa menyelesaikan semua masalah diatas. Jika iya kita langsung saja mempersiapkan tool-tool yang dibutuhkan :</p>

<ol>
<li><p> <a href="http://jrsoftware.org/">Inno Setup</a></p></li>
<li><p> <a href="http://dev.mysql.com/downloads/mysql/">MySQL versi noninstall</a> disesuaikan dengan versi MySQL yang terinstall di komputer Anda</p></li>
<li><p> <a href="http://dev.mysql.com/downloads/connector/odbc/">Connector ODBC</a> yang sudah terinstall biasanya ada di C:\Program Files\MySQL\Connector ODBC 5.1</p></li>
<li><p> Database yang sudah di backup/dump</p></li>
</ol>


<p>Adapun versi yang terinstall di komputer saya :</p>

<ol>
<li><p> Inno Setup 5.0.8</p></li>
<li><p> MySQL Server: 5.1.36-community</p></li>
<li><p> Connector ODBC 5.1</p></li>
</ol>


<p>Lakukan backup/dump database dengan cara :</p>

<ol>
<li><p> Aktifkan dos console</p></li>
<li><p> Masuk ke folder instalasi MySQL misal C:\Program Files\MySQL\MySQL Server 5.1\bin</p></li>
<li><p> kemudian ketikkan perintah: mysqldump -u<strong>nama_user</strong> -p<strong>password_user</strong> &ndash;routines nama_database > c:\nama_database.sql</p></li>
</ol>


<p>Parameter <strong>&ndash;routines</strong> wajib Anda ketikkan jika database Anda mempunyai prosedur/fungsi. Persiapan terakhir untuk struktur folder saya buat seperti berikut :</p>

<p>{% img center <a href="http://coding4ever.files.wordpress.com/2009/12/struktur_folder.jpg">http://coding4ever.files.wordpress.com/2009/12/struktur_folder.jpg</a> %}</p>

<p>Untuk keterangan lebih lanjut skrip inno setup silahkan baca manualnya. Contoh skrip instalasi lengkap :</p>

<p>{% codeblock %}
;Skrip instalasi by k4m4r82
;<a href="http://coding4ever.wordpress.com/">http://coding4ever.wordpress.com/</a>
[Setup]
AppName=Sistem Pembelian Bahan Baku PT. ALBASI
AppVerName=Sistem Pembelian Bahan Baku PT. ALBASI Versi 1.0.0.50
AppPublisher=K4m4r82&rsquo;s Laboratory
AllowCancelDuringInstall = yes
DefaultDirName={pf}\PT ALBASI
DefaultGroupName=PT ALBASI
Compression = lzma
SolidCompression = yes
OutputBaseFilename=SetupAlbasiServer
AllowNoIcons = yes
AlwaysRestart = no
AlwaysShowComponentsList = no
DisableProgramGroupPage = yes
AppendDefaultDirName = yes
CreateUninstallRegKey = yes
DisableStartupPrompt = yes
LanguageDetectionMethod=none
ShowLanguageDialog=no
Uninstallable = yes
UninstallFilesDir={app}\uninst
UninstallDisplayIcon={app}\Albasi.exe,0
UninstallDisplayName=Sistem Pembelian Bahan Baku PT. ALBASI
WindowVisible = no
AppCopyright=Copyright © 2009. K4m4r82&rsquo;s Laboratory
FlatComponentsList = yes
PrivilegesRequired = admin
VersionInfoVersion=1.0.0.50
SetupIconFile=Setup.ico
WizardImageFile=SetupModern21.bmp
WizardSmallImageFile=SetupModernSmall21.bmp</p>

<p>[Languages]
Name: ina; MessagesFile: compiler:Indonesia.isl
Name: en; MessagesFile: compiler:Default.isl</p>

<p>[Tasks]
Name: desktopicon; Description: {cm:CreateDesktopIcon}; GroupDescription: {cm:AdditionalIcons}; Flags: unchecked
Name: quicklaunchicon; Description: {cm:CreateQuickLaunchIcon}; GroupDescription: {cm:AdditionalIcons}; Flags: unchecked
Name: installmysql; Description: &ldquo;Install MySQL&rdquo;; GroupDescription: &ldquo;Proses tambahan:&rdquo;; Flags: checkedonce</p>

<p>[Files]
;Visual Basic Runtime
Source: dll&amp;ocx\VB6STKIT.DLL; DestDir: {sys}; Flags: uninsneveruninstall onlyifdoesntexist
Source: dll&amp;ocx\COMCAT.DLL; DestDir: {sys}; Flags: uninsneveruninstall sharedfile regserver onlyifdoesntexist
Source: dll&amp;ocx\stdole2.tlb; DestDir: {sys}; Flags: uninsneveruninstall sharedfile regtypelib
Source: dll&amp;ocx\asycfilt.dll; DestDir: {sys}; Flags: uninsneveruninstall onlyifdoesntexist
Source: dll&amp;ocx\olepro32.dll; DestDir: {sys}; Flags: uninsneveruninstall sharedfile regserver onlyifdoesntexist
Source: dll&amp;ocx\oleaut32.dll; DestDir: {sys}; Flags: uninsneveruninstall sharedfile regserver onlyifdoesntexist
Source: dll&amp;ocx\msvbvm60.dll; DestDir: {sys}; Flags: uninsneveruninstall sharedfile regserver onlyifdoesntexist</p>

<p>;daftar file MySQL
Source: mysql-5.1.36-win32\bin*; DestDir: {app}\mysql\bin; Flags: ignoreversion; Tasks: installmysql
Source: mysql-5.1.36-win32\Docs*; DestDir: {app}\mysql\Docs; Flags: ignoreversion; Tasks: installmysql
Source: mysql-5.1.36-win32\lib*; DestDir: {app}\mysql\lib; Flags: ignoreversion recursesubdirs; Tasks: installmysql
Source: mysql-5.1.36-win32\share*; DestDir: {app}\mysql\share; Flags: ignoreversion recursesubdirs; Tasks: installmysql
Source: mysql-5.1.36-win32\data*; DestDir: {app}\mysql\data; Flags: ignoreversion recursesubdirs uninsneveruninstall; Tasks: installmysql
Source: mysql-5.1.36-win32*; DestDir: {app}\mysql; Flags: ignoreversion; Tasks: installmysql</p>

<p>;daftar file MySQL ODBC 5.1
Source: &ldquo;C:\Program Files\MySQL\Connector ODBC 5.1\myodbc5.dll&rdquo;; DestDir: {sys}; Flags: onlyifdoesntexist
Source: &ldquo;C:\Program Files\MySQL\Connector ODBC 5.1\myodbc5S.dll&rdquo;; DestDir: {sys}; Flags: onlyifdoesntexist
Source: &ldquo;C:\Program Files\MySQL\Connector ODBC 5.1\myodbc5.lib&rdquo;; DestDir: {sys}; Flags: onlyifdoesntexist
Source: &ldquo;C:\Program Files\MySQL\Connector ODBC 5.1\myodbc5S.lib&rdquo;; DestDir: {sys}; Flags: onlyifdoesntexist
Source: &ldquo;C:\Program Files\MySQL\Connector ODBC 5.1\myodbc-installer.exe&rdquo;; DestDir: {sys}; Flags: onlyifdoesntexist</p>

<p>;My Application Runtime
Source: main\Albasi.exe.manifest; DestDir: {app}; Flags: ignoreversion
Source: main\Albasi.exe; DestDir: {app}; Flags: ignoreversion
Source: main\albasi.sql; DestDir: {app}\mysql\bin; Flags: ignoreversion
Source: main\exec.cmd; DestDir: {app}\mysql\bin; Flags: ignoreversion</p>

<p>Source: dll&amp;ocx\MSMASK32.OCX; DestDir: {sys}; Flags: uninsneveruninstall sharedfile regserver onlyifdoesntexist
Source: dll&amp;ocx\cTreeOpt6.ocx; DestDir: {sys}; Flags: uninsneveruninstall sharedfile regserver onlyifdoesntexist
Source: dll&amp;ocx\Comdlg32.ocx; DestDir: {sys}; Flags: uninsneveruninstall sharedfile regserver onlyifdoesntexist
Source: dll&amp;ocx\vbalDTab6.ocx; DestDir: {sys}; Flags: uninsneveruninstall sharedfile regserver onlyifdoesntexist
Source: dll&amp;ocx\MSCOMCT2.OCX; DestDir: {sys}; Flags: uninsneveruninstall sharedfile regserver onlyifdoesntexist
Source: dll&amp;ocx\MyTextBox.ocx; DestDir: {sys}; Flags: uninsneveruninstall sharedfile regserver onlyifdoesntexist
Source: dll&amp;ocx\LVbuttons.ocx; DestDir: {sys}; Flags: uninsneveruninstall sharedfile regserver onlyifdoesntexist
Source: dll&amp;ocx\vbalExpBar6.ocx; DestDir: {sys}; Flags: uninsneveruninstall sharedfile regserver onlyifdoesntexist
Source: dll&amp;ocx\MSCOMCTL.OCX; DestDir: {sys}; Flags: uninsneveruninstall sharedfile regserver onlyifdoesntexist
Source: dll&amp;ocx\vbalIml6.ocx; DestDir: {sys}; Flags: uninsneveruninstall sharedfile regserver onlyifdoesntexist
Source: dll&amp;ocx\cPopMenu6.ocx; DestDir: {sys}; Flags: uninsneveruninstall sharedfile regserver onlyifdoesntexist
Source: dll&amp;ocx\cNewMenu6.dll; DestDir: {sys}; Flags: uninsneveruninstall sharedfile regserver onlyifdoesntexist
Source: dll&amp;ocx\scrrun.dll; DestDir: {sys}; Flags: uninsneveruninstall sharedfile regserver onlyifdoesntexist
Source: dll&amp;ocx\vbalMDITabs6.dll; DestDir: {sys}; Flags: uninsneveruninstall sharedfile regserver onlyifdoesntexist
Source: dll&amp;ocx\SSubTmr6.dll; DestDir: {sys}; Flags: uninsneveruninstall sharedfile regserver onlyifdoesntexist</p>

<p>Source: dll&amp;ocx\msado21.tlb; DestDir: {sys}; Flags: uninsneveruninstall sharedfile regtypelib</p>

<p>[Icons]
Name: {group}\Sistem Pembelian Bahan Baku PT. ALBASI; Filename: {app}\Albasi.exe; WorkingDir: {app}
Name: {userdesktop}\Sistem Pembelian Bahan Baku PT. ALBASI; Filename: {app}\Albasi.exe; WorkingDir: {app}; Tasks: desktopicon
Name: {userappdata}\Microsoft\Internet Explorer\Quick Launch\Sistem Pembelian Bahan Baku PT. ALBASI; Filename: {app}\Albasi.exe; WorkingDir: {app}; Tasks: quicklaunchicon</p>

<p>[INI]
Filename: {app}\mysql\my.ini; Section: mysqld; Key: basedir; String: {app}\mysql; Tasks: installmysql
Filename: {app}\mysql\my.ini; Section: mysqld; Key: datadir; String: {app}\mysql\data; Tasks: installmysql</p>

<p>Filename: {app}\infoProgram.ini; Section: Sistem; Key: serverName; String: &ldquo;127.0.0.1&rdquo;
Filename: {app}\infoProgram.ini; Section: Sistem; Key: dbName; String: &ldquo;albasi&rdquo;</p>

<p>[Run]
;install service MySQL
Filename: &ldquo;{app}\mysql\bin\mysqld.exe&rdquo;; Parameters: &ldquo;install &rdquo;&ldquo;MySQL&rdquo;&ldquo;&rdquo;; StatusMsg: &ldquo;Sedang menginstall service MySQL &hellip;&rdquo;; Flags: runhidden; MinVersion: 0,5.01.2600sp2; Tasks: installmysql</p>

<p>;jalankan service MySQL
Filename: {sys}\net.exe; Parameters: &ldquo;start &rdquo;&ldquo;MySQL&rdquo;&ldquo;&rdquo;; StatusMsg: &ldquo;Sedang menjalankan service MySQL &hellip;&rdquo;; Flags: runhidden; MinVersion: 0.0,4.0.1381; Tasks: installmysql</p>

<p>;mendaftarkan port default mysql (3306) ke firewall
Filename: &ldquo;{sys}\netsh.exe&rdquo;; Parameters: &ldquo;firewall add portopening TCP 3306 &rdquo;&ldquo;Port MySQL&rdquo;&ldquo;&rdquo;; StatusMsg: &ldquo;Sedang mendaftarkan port MySQL &hellip;&rdquo;; Flags: runhidden; MinVersion: 0,5.01.2600sp2
Filename: &ldquo;{sys}\netsh.exe&rdquo;; Parameters: &ldquo;firewall set service type = fileandprint mode = enable&rdquo;; StatusMsg: &ldquo;Mengaktifkan File and Printer Sharing &hellip;&rdquo;; Flags: runhidden; MinVersion: 0,5.01.2600sp2</p>

<p>;mengganti password default root (blank). ex : masterkey
Filename: &ldquo;{app}\mysql\bin\mysqladmin.exe&rdquo;; Parameters: &ldquo;-uroot password masterkey&rdquo;; StatusMsg: &ldquo;Mengganti password root&rdquo;; Flags: runhidden; MinVersion: 0,5.01.2600sp2</p>

<p>;menghapus user default1 (user=blank, password=blank)
Filename: &ldquo;{app}\mysql\bin\mysql.exe&rdquo;; Parameters: &ldquo;-uroot -pmasterkey -e &rdquo;&ldquo;DELETE FROM mysql.user WHERE Host=&lsquo;localhost&rsquo; AND User=&lsquo;&rsquo;&rdquo;&ldquo;&rdquo;; Flags: runhidden; MinVersion: 0,5.01.2600sp2
Filename: &ldquo;{app}\mysql\bin\mysql.exe&rdquo;; Parameters: &ldquo;-uroot -pmasterkey -e &rdquo;&ldquo;FLUSH PRIVILEGES&rdquo;&ldquo;&rdquo;; Flags: runhidden; MinVersion: 0,5.01.2600sp2</p>

<p>;menghapus user default2 (user=root, password=blank)
Filename: &ldquo;{app}\mysql\bin\mysql.exe&rdquo;; Parameters: &ldquo;-uroot -pmasterkey -e &rdquo;&ldquo;DELETE FROM mysql.user WHERE Host=&lsquo;127.0.0.1&rsquo; AND User=&lsquo;root&rsquo;&rdquo;&ldquo;&rdquo;; Flags: runhidden; MinVersion: 0,5.01.2600sp2
Filename: &ldquo;{app}\mysql\bin\mysql.exe&rdquo;; Parameters: &ldquo;-uroot -pmasterkey -e &rdquo;&ldquo;FLUSH PRIVILEGES&rdquo;&ldquo;&rdquo;; Flags: runhidden; MinVersion: 0,5.01.2600sp2</p>

<p>;set agar user root bisa login dari mesin lain (kalo diperlukan)
Filename: &ldquo;{app}\mysql\bin\mysql.exe&rdquo;; Parameters: &ldquo;-uroot -pmasterkey -e &rdquo;&ldquo;GRANT ALL PRIVILEGES ON <em>.</em> TO root@&lsquo;%&rsquo; IDENTIFIED BY &lsquo;masterkey&rsquo;&rdquo;&ldquo;&rdquo;; Flags: runhidden; MinVersion: 0,5.01.2600sp2
Filename: &ldquo;{app}\mysql\bin\mysql.exe&rdquo;; Parameters: &ldquo;-uroot -pmasterkey -e &rdquo;&ldquo;FLUSH PRIVILEGES&rdquo;&ldquo;&rdquo;; Flags: runhidden; MinVersion: 0,5.01.2600sp2</p>

<p>;membuat database kosong
Filename: &ldquo;{app}\mysql\bin\mysql.exe&rdquo;; Parameters: &ldquo;-uroot -pmasterkey -e &rdquo;&ldquo;CREATE DATABASE albasi&rdquo;&ldquo;&rdquo;; Flags: runhidden; MinVersion: 0,5.01.2600sp2</p>

<p>;menjalankan file batch exec.cmd untuk melakukan proses undump
Filename: &ldquo;{app}\mysql\bin\exec.cmd&rdquo;; Flags: runhidden; MinVersion: 0,5.01.2600sp2</p>

<p>;install driver myodbc
Filename: &ldquo;{sys}\myodbc-installer.exe&rdquo;; Parameters: &ldquo;-d -a -n &rdquo;&ldquo;MySQL ODBC 5.1 Driver&rdquo;&ldquo; -t &rdquo;&ldquo;DRIVER=myodbc5.dll;SETUP=myodbc5S.dll&rdquo;&ldquo;&rdquo;; StatusMsg: &ldquo;Tunggu sedang mendaftarkan driver MySQL Connector ODBC 5.1.5&rdquo;; Flags: runhidden</p>

<p>[UninstallRun]
Filename: {sys}\net.exe; Parameters: &ldquo;stop &rdquo;&ldquo;MySQL&rdquo;&ldquo;&rdquo;; StatusMsg: &ldquo;Menghentikan Service MySQL &hellip;&rdquo;; Flags: runhidden; MinVersion: 0.0,4.0.1381
Filename: &ldquo;{app}\mysql\bin\mysqld.exe&rdquo;; Parameters: &ldquo;remove &rdquo;&ldquo;MySQL&rdquo;&ldquo;&rdquo;; StatusMsg: &ldquo;Sedang menghapus service MySQL &hellip;&rdquo;; Flags: runhidden; MinVersion: 0,5.01.2600sp2</p>

<p>Filename: &ldquo;{sys}\myodbc-installer.exe&rdquo;; Parameters: &ldquo;-d -r -n &rdquo;&ldquo;MySQL ODBC 5.1 Driver&rdquo;&ldquo;&rdquo;; StatusMsg: &ldquo;Tunggu sedang menghapus driver MySQL Connector ODBC 5.1.5&rdquo;; Flags: runhidden</p>

<p>[UninstallDelete]
Type: files; Name: {app}\mysql\bin*.<em>
Type: files; Name: {app}\mysql\Docs*.</em>
Type: files; Name: {app}\mysql\lib*.<em>
Type: files; Name: {app}\mysql\share*.</em></p>

<p>Type: files; Name: {sys}\myodbc5S.dll
Type: files; Name: {sys}\myodbc5S.lib
Type: files; Name: {sys}\myodbc5.dll
Type: files; Name: {sys}\myodbc5.lib
Type: files; Name: {sys}\myodbc-installer.exe</p>

<p>[Registry]
;mencatat lokasi instalasi program, ini dibutuhkan jika kita ingin membuat paket instalasi update
Root: HKCU; Subkey: &ldquo;Software\PT ALBASI\SPBB&rdquo;; ValueName: &ldquo;installDir&rdquo;; ValueType: String; ValueData: {app}; Flags: uninsdeletevalue
{% endcodeblock %}</p>

<p>Di dalam skrip instalasi ada file exec.cmd, isinya adalah :</p>

<p>{% codeblock %}
mysql -uroot -pmasterkey albasi &lt; albasi.sql
{% endcodeblock %}</p>

<p>Isi file exec.cmd sebenarnya untuk proses undump, tapi saya masih belum tau kenapa inno setup gagal menjalankannya padahal perintah-perintah yang lainnya sukses.</p>

<p>Contoh hasil instalasi :</p>

<p>{% img center <a href="http://coding4ever.files.wordpress.com/2009/12/install-1.jpg">http://coding4ever.files.wordpress.com/2009/12/install-1.jpg</a> %}</p>

<p>{% img center <a href="http://coding4ever.files.wordpress.com/2009/12/install-2.jpg">http://coding4ever.files.wordpress.com/2009/12/install-2.jpg</a> %}</p>

<p>{% img center <a href="http://coding4ever.files.wordpress.com/2009/12/install-3.jpg">http://coding4ever.files.wordpress.com/2009/12/install-3.jpg</a> %}</p>

<p>{% img center <a href="http://coding4ever.files.wordpress.com/2009/12/install-4.jpg">http://coding4ever.files.wordpress.com/2009/12/install-4.jpg</a> %}</p>

<p>{% img center <a href="http://coding4ever.files.wordpress.com/2009/12/install-5.jpg">http://coding4ever.files.wordpress.com/2009/12/install-5.jpg</a> %}</p>

<p>{% img center <a href="http://coding4ever.files.wordpress.com/2009/12/install-6.jpg">http://coding4ever.files.wordpress.com/2009/12/install-6.jpg</a> %}</p>

<p>Yuph mungkin itu saja, selamat mencoba :)</p>
]]></content>
  </entry>
  
</feed>
