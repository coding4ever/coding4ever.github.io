<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Category: Firebird | Coding4ever's Blog]]></title>
  <link href="http://coding4ever.net/blog/categories/firebird/atom.xml" rel="self"/>
  <link href="http://coding4ever.net/"/>
  <updated>2015-04-11T16:50:35+07:00</updated>
  <id>http://coding4ever.net/</id>
  <author>
    <name><![CDATA[Admin]]></name>
    
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[Menembus Pertahanan Database Firebird Yang Diproteksi Bagian 2]]></title>
    <link href="http://coding4ever.net/blog/2013/06/25/menembus-pertahanan-database-firebird-yang-diproteksi-bagian-2/"/>
    <updated>2013-06-25T11:04:17+07:00</updated>
    <id>http://coding4ever.net/blog/2013/06/25/menembus-pertahanan-database-firebird-yang-diproteksi-bagian-2</id>
    <content type="html"><![CDATA[<p>Postingan saya kali ini merupakan jawaban untuk om guys yang sudah berhasil <a href="https://coding4ever.wordpress.com/2011/01/03/menembus-pertahanan-database-firebird-yang-diproteksi/">Menembus pertahanan database Firebird yang diproteksi</a> tetapi masih ada sedikit masalah yang perlu diselesaikan.</p>

<p>Biar lebih lengkap saya tulis ulang saja pertanyaannya.</p>

<blockquote><p>thx beart om admin buat tutor singkatnya, sangat bermanfaat.
ada sedikit masalah, setelah kita “bongkar” db zahir-nya ternyata ga bisa di pake lagi di aplikasi Zahirnya ya. Harus kita balikin lagi setting FB-nya ke default/original (khususnya user ZAHIRDBA).
ada work-around-nya untuk masalah ini om admin?</p></blockquote>

<!-- more -->


<p>Jadi langkah-langkah berikut ini akan menghapus role &ldquo;SYSDBA&rdquo; sehingga kita bisa login lagi menggunakan user default Firebird yaitu SYSDBA.</p>

<p>Berikut langkah-langkahnya :</p>

<ol>
<li><p>Sudah berhasil <a href="https://coding4ever.wordpress.com/2011/01/03/menembus-pertahanan-database-firebird-yang-diproteksi/">menembus pertahanan database Firebird yang diproteksi</a></p></li>
<li><p>Login menggunakan user ZAHIRDBA</p></li>
</ol>


<p><a href="http://coding4ever.files.wordpress.com/2013/06/25062013-1.png"><img src="http://coding4ever.files.wordpress.com/2013/06/25062013-1.png" alt="25062013-1" /></a></p>

<ol>
<li>Hapus role SYSDBA menggunakan perintah</li>
</ol>


<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>DELETE FROM rdb$roles
</span><span class='line'>WHERE rdb$role_name = &lsquo;SYSDBA&rsquo; AND rdb$owner_name = &lsquo;ZAHIRDBA&rsquo;</span></code></pre></td></tr></table></div></figure></p>

<p><a href="http://coding4ever.files.wordpress.com/2013/06/25062013-2.png"><img src="http://coding4ever.files.wordpress.com/2013/06/25062013-2.png" alt="25062013-2" /></a></p>

<p>sampai tahap ini kita sudah bisa menggunakan user sysdba lagi</p>

<ol>
<li>Login ulang menggunakan user SYSDBA</li>
</ol>


<p><a href="http://coding4ever.files.wordpress.com/2013/06/25062013-3.png"><img src="http://coding4ever.files.wordpress.com/2013/06/25062013-3.png" alt="25062013-3" /></a></p>

<ol>
<li>Hapus user ZAHIRDBA dari menu Tools -> User Manager</li>
</ol>


<p><a href="http://coding4ever.files.wordpress.com/2013/06/25062013-4.png"><img src="http://coding4ever.files.wordpress.com/2013/06/25062013-4.png" alt="25062013-4" /></a></p>

<ol>
<li>Selesai :)</li>
</ol>


<p><a href="http://coding4ever.files.wordpress.com/2013/06/25062013-5.png"><img src="http://coding4ever.files.wordpress.com/2013/06/25062013-5.png" alt="25062013-5" /></a></p>

<p>Selamat mencoba :)</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Database Firebird Versi Embedded]]></title>
    <link href="http://coding4ever.net/blog/2013/01/09/database-firebird-versi-embedded/"/>
    <updated>2013-01-09T11:10:00+07:00</updated>
    <id>http://coding4ever.net/blog/2013/01/09/database-firebird-versi-embedded</id>
    <content type="html"><![CDATA[<p>Horeee akhirnya bisa nulis lagi dan ini postingan pertama saya di awal tahun 2013 :)</p>

<p>Beberapa waktu yang lalu saya sering menggunakan database Ms Access untuk pembuatan aplikasi standalone tetapi mengingat beberapa kekurangan yang dimiliki oleh database Ms Access seperti pembengkakan ukuran database yang sangat &ldquo;mengerikan&rdquo; :D dan terkadang terjadi kerusakan database sehingga memaksa saya untuk mencari alternatif lain yang bisa menggantikan database Ms Access.</p>

<!-- more -->


<p>Usut punya usut ternyata database favorit saya (Firebird) juga menyediakan library yang memungkinan database Firebrid bisa diperlakukan seperti layaknya database Ms Access (tanpa membutuhkan konfigurasi server sama sekali).</p>

<p>Pada postingan saya kali ini kita akan membahas apa saja yang diperlukan untuk memanfaatkan database Firebird versi Embedded setelah itu akan kita coba mengaksesnya dari bahasa pemrograman C#.</p>

<ol>
<li>Download terlebih dulu library database <a href="http://www.firebirdsql.org/en/firebird-2-5-2/">Firebird versi Embedded</a></li>
</ol>


<p><a href="http://coding4ever.files.wordpress.com/2013/01/09012013-1.png"><img src="http://coding4ever.files.wordpress.com/2013/01/09012013-1.png" alt="09012013-1" /></a></p>

<p>Ekstrak file Firebird-2.5.2.26539-0_Win32_embed.zip kemudian dari file-file yang ada, yang kita butuhkan hanya file fbembed.dll, icudt30.dll, icuin30.dll dan icuuc30.dll.</p>

<p><a href="http://coding4ever.files.wordpress.com/2013/01/09012013-3.png"><img src="http://coding4ever.files.wordpress.com/2013/01/09012013-3.png" alt="09012013-3" /></a></p>

<p>Semua file diatas harus dicopykan ke folder aplikasi (bin\debug atau bin\release).</p>

<ol>
<li>Download <a href="http://www.firebirdsql.org/en/net-provider/">Firebird ADO.NET Data Provider</a></li>
</ol>


<p><a href="http://coding4ever.files.wordpress.com/2013/01/09012013-2.png"><img src="http://coding4ever.files.wordpress.com/2013/01/09012013-2.png" alt="09012013-2" /></a></p>

<p>Pada gambar di atas saya mendownload file NETProvider-3.0.2.0-NET35.7z karena saya menggunakan C# 2008 yang membutuhkan .NET Framework 3.5 kemudian ekstrak file tersebut.</p>

<p><a href="http://coding4ever.files.wordpress.com/2013/01/09012013-4.png"><img src="http://coding4ever.files.wordpress.com/2013/01/09012013-4.png" alt="09012013-4" /></a></p>

<p>Yang kita butuhkan cukup file FirebirdSql.Data.FirebirdClient.dll</p>

<ol>
<li>String koneksi yang digunakan</li>
</ol>


<p>String koneksi yang digunakan untuk mengakses database Firebird versi non Embedded adalah seperti berikut :</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='c#'><span class='line'><span class="kt">var</span> <span class="n">strConn</span> <span class="p">=</span> <span class="err">@</span><span class="p">&amp;</span><span class="n">ldquo</span><span class="p">;</span><span class="n">User</span> <span class="n">ID</span><span class="p">=</span><span class="n">SYSDBA</span><span class="p">;</span><span class="n">Password</span><span class="p">=</span><span class="n">masterkey</span><span class="p">;</span><span class="n">Database</span><span class="p">=</span><span class="n">localhost</span><span class="p">:</span><span class="n">c</span><span class="p">:</span><span class="err">\</span><span class="n">database</span><span class="err">\</span><span class="n">test</span><span class="p">.</span><span class="n">fdb</span><span class="p">&amp;</span><span class="n">rdquo</span><span class="p">;;</span>
</span></code></pre></td></tr></table></div></figure></p>

<p>Sedangkan untuk versi Embeddednya seperti berikut :</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='c#'><span class='line'><span class="kt">var</span> <span class="n">strConn</span> <span class="p">=</span> <span class="err">@</span><span class="p">&amp;</span><span class="n">ldquo</span><span class="p">;</span><span class="n">ServerType</span><span class="p">=</span><span class="m">1</span><span class="p">;</span><span class="n">User</span><span class="p">=</span><span class="n">SYSDBA</span><span class="p">;</span><span class="n">Password</span><span class="p">=</span><span class="n">masterkey</span><span class="p">;</span><span class="n">Dialect</span><span class="p">=</span><span class="m">3</span><span class="p">;</span><span class="n">Database</span><span class="p">=</span><span class="n">c</span><span class="p">:</span><span class="err">\</span><span class="n">database</span><span class="err">\</span><span class="n">test</span><span class="p">&amp;</span><span class="n">rdquo</span><span class="p">;;</span>
</span></code></pre></td></tr></table></div></figure></p>

<p>Setelah semua persiapan lengkap saatnya kita menuliskan kode untuk mengakses database Firebird versi Embedded</p>

<ol>
<li>Buat project baru, untuk contoh disini saya menggunakan project dengan tipe Console Application</li>
</ol>


<p><a href="http://coding4ever.files.wordpress.com/2013/01/09012013-5.png"><img src="http://coding4ever.files.wordpress.com/2013/01/09012013-5.png" alt="09012013-5" /></a></p>

<ol>
<li>Menambahkan referensi Firebird ADO.NET Data Provider</li>
</ol>


<p>Untuk mengakses database Firebird kita membutuhkan libaray Firebird ADO.NET Data Provider.</p>

<p>Untuk menambahkan library tersebut kedalam project, caranya cukup mudah hanya dengan mengklik kanan Project -> Add Reference&hellip;</p>

<p><a href="http://coding4ever.files.wordpress.com/2013/01/09012013-6.png"><img src="http://coding4ever.files.wordpress.com/2013/01/09012013-6.png" alt="09012013-6" /></a></p>

<p>Kemudian tentukan lokasi file FirebirdSql.Data.FirebirdClient.dll</p>

<p><a href="http://coding4ever.files.wordpress.com/2013/01/09012013-7.png"><img src="http://coding4ever.files.wordpress.com/2013/01/09012013-7.png" alt="09012013-7" /></a></p>

<p>Kemudian dilanjutkan dengan melakukan proses Build</p>

<p><a href="http://coding4ever.files.wordpress.com/2013/01/09012013-8.png"><img src="http://coding4ever.files.wordpress.com/2013/01/09012013-8.png" alt="09012013-8" /></a></p>

<p>Proses ini dibutuhkan untuk menghasilkan folder bin\Debug atau bin\Release</p>

<ol>
<li>Mengcopykan file fbembed.dll, icudt30.dll, icuin30.dll dan icuuc30.dll ke folder bin\Debug atau bin\Release</li>
</ol>


<p><a href="http://coding4ever.files.wordpress.com/2013/01/09012013-9.png"><img src="http://coding4ever.files.wordpress.com/2013/01/09012013-9.png" alt="09012013-9" /></a></p>

<p>Setelah itu kita akan coba kode untuk melakukan koneksi ke database dan menampilkan datanya.</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
</pre></td><td class='code'><pre><code class='c#'><span class='line'><span class="k">namespace</span> <span class="nn">AksesFirebirdEmbedded</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'>    <span class="k">class</span> <span class="nc">Program</span>
</span><span class='line'>    <span class="p">{</span>
</span><span class='line'>        <span class="k">static</span> <span class="k">void</span> <span class="nf">Main</span><span class="p">(</span><span class="kt">string</span><span class="p">[]</span> <span class="n">args</span><span class="p">)</span>
</span><span class='line'>        <span class="p">{</span>
</span><span class='line'>            <span class="kt">var</span> <span class="n">appPath</span> <span class="p">=</span> <span class="n">System</span><span class="p">.</span><span class="n">IO</span><span class="p">.</span><span class="n">Directory</span><span class="p">.</span><span class="n">GetCurrentDirectory</span><span class="p">();</span>
</span><span class='line'>            <span class="kt">var</span> <span class="n">strConn</span> <span class="p">=</span> <span class="p">&amp;</span><span class="n">ldquo</span><span class="p">;</span><span class="n">ServerType</span><span class="p">=</span><span class="m">1</span><span class="p">;</span><span class="n">User</span><span class="p">=</span><span class="n">SYSDBA</span><span class="p">;</span><span class="n">Password</span><span class="p">=</span><span class="n">masterkey</span><span class="p">;</span><span class="n">Dialect</span><span class="p">=</span><span class="m">3</span><span class="p">;</span><span class="n">Database</span><span class="p">=&amp;</span><span class="n">rdquo</span><span class="p">;</span> <span class="p">+</span> <span class="n">appPath</span> <span class="p">+</span> <span class="p">&amp;</span><span class="n">ldquo</span><span class="p">;</span><span class="err">\</span><span class="n">TEST</span><span class="p">.</span><span class="n">FDB</span><span class="p">&amp;</span><span class="n">rdquo</span><span class="p">;;&lt;/</span><span class="n">p</span><span class="p">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="p">&lt;</span><span class="n">pre</span><span class="p">&gt;&lt;</span><span class="n">code</span><span class="p">&gt;</span>        <span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="n">conn</span> <span class="p">=</span> <span class="k">new</span> <span class="n">FbConnection</span><span class="p">(</span><span class="n">strConn</span><span class="p">))</span>
</span><span class='line'>        <span class="p">{</span>
</span><span class='line'>            <span class="n">conn</span><span class="p">.</span><span class="n">Open</span><span class="p">();</span>
</span><span class='line'>
</span><span class='line'>            <span class="kt">var</span> <span class="n">strSql</span> <span class="p">=</span> <span class="s">&quot;SELECT idagama, deskripsi FROM agama&quot;</span><span class="p">;</span>
</span><span class='line'>            <span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="n">cmd</span> <span class="p">=</span> <span class="k">new</span> <span class="n">FbCommand</span><span class="p">(</span><span class="n">strSql</span><span class="p">,</span> <span class="n">conn</span><span class="p">))</span>
</span><span class='line'>            <span class="p">{</span>
</span><span class='line'>                <span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="n">dtr</span> <span class="p">=</span> <span class="n">cmd</span><span class="p">.</span><span class="n">ExecuteReader</span><span class="p">())</span>
</span><span class='line'>                <span class="p">{</span>
</span><span class='line'>                    <span class="k">while</span> <span class="p">(</span><span class="n">dtr</span><span class="p">.</span><span class="n">Read</span><span class="p">())</span>
</span><span class='line'>                    <span class="p">{</span>
</span><span class='line'>                        <span class="n">Console</span><span class="p">.</span><span class="n">WriteLine</span><span class="p">(</span><span class="n">dtr</span><span class="p">.</span><span class="n">GetString</span><span class="p">(</span><span class="m">0</span><span class="p">)</span> <span class="p">+</span> <span class="s">&quot;, &quot;</span> <span class="p">+</span> <span class="n">dtr</span><span class="p">.</span><span class="n">GetString</span><span class="p">(</span><span class="m">1</span><span class="p">));</span>
</span><span class='line'>                    <span class="p">}</span>
</span><span class='line'>                <span class="p">}</span>
</span><span class='line'>            <span class="p">}</span>
</span><span class='line'>        <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>        <span class="n">Console</span><span class="p">.</span><span class="n">ReadKey</span><span class="p">();</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'><span class="p">&lt;/</span><span class="n">code</span><span class="p">&gt;&lt;/</span><span class="n">pre</span><span class="p">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="p">&lt;</span><span class="n">p</span><span class="p">&gt;}</span>
</span></code></pre></td></tr></table></div></figure></p>

<p><a href="http://coding4ever.files.wordpress.com/2013/01/09012013-10.png"><img src="http://coding4ever.files.wordpress.com/2013/01/09012013-10.png" alt="09012013-10" /></a></p>

<p>Selamat <a href="https://github.com/k4m4r82/AksesFirebirdEmbedded">MENCOBA</a> :)</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[The Power of Firebird Events]]></title>
    <link href="http://coding4ever.net/blog/2012/07/23/the-power-of-firebird-events/"/>
    <updated>2012-07-23T14:52:33+07:00</updated>
    <id>http://coding4ever.net/blog/2012/07/23/the-power-of-firebird-events</id>
    <content type="html"><![CDATA[<p><strong>Intro</strong></p>

<p>Judul postingan kali ini sy ambil dari dokumentasi resmi website <a href="http://www.firebirdsql.org">Firebird</a> dengan sub dokumen <a href="http://www.firebirdsql.org/en/white-papers-presentations/">White Papers &amp; Presentations</a>.</p>

<p>Sudah lama sy mengetahui adanya fitur keren ini, hanya saja karna waktu itu masih aktif coding menggunakan VB 6 jadi sy kurang tertarik untuk mencobanya (habis mau gimana lagi vb6 memang belum mendukung fitur ini kok :D) CMIIW.</p>

<!-- more -->


<p>Ketika kita diminta untuk membuat aplikasi real time yang akan selalu merefresh data yang ditampilkan, pilihan kita biasanya selalu menggunakan objek timer, thread atau yang sejenisnya untuk selalu mengecek apa ada data baru yang ditambahkan/diperbaiki/dihapus.</p>

<p>Penggunaan objek2x ini sedikit banyaknya akan memakan resource yg lumayan apalagi untuk aplikasi2x yang masa aktifnya lama seperti aplikasi sms gateway.</p>

<p>Contoh lain misalnya kita ingin membuat aplikasi sms yg otomatis mengirimkan sms notifikasi ke nomor2x tertentu setiap ada data pembelian yang diinputkan.</p>

<p>Jadi dengan memanfaatkan fitur ini kita tidak perlu lagi atau minimal mengurangi ketergantungan terhadap objek2x timer dan sejenisnya.</p>

<p>Dan sesuai dengan nama fitur ini yaitu &ldquo;Events&rdquo;, mungkin sudah terlintas dipikiran kita bahwa fitur ini sangat cocok jika digabungkan dengan fitur <a href="http://www.firebirdsql.org/">Firebird</a> lainnya yaitu <a href="/blog/2010/03/15/membuat-store-procedure-trigger-dan-view-di-firebird/">Trigger</a>.</p>

<p><strong>Membuat Event</strong></p>

<p>Untuk demo membuat event ini sy menggunakan tool IBExpert dan sudah pernah sy bahas bagaimana cara penggunaan tool ini di<a href="/blog/2010/01/06/berkenalan-dengan-database-firebird/">sini</a>.</p>

<p>Untuk contoh kasus kali ini kita akan menambahkan dua event, masing2x pada tabel CUSTOMER dan SUPPLIER, adapun struktur tabelnya seperti berikut :</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
</pre></td><td class='code'><pre><code class='mysql'><span class='line'><span class="k">CREATE</span> <span class="k">TABLE</span> <span class="nf">SUPPLIER</span> <span class="p">(</span>
</span><span class='line'>    <span class="n">ID</span>      <span class="kt">INTEGER</span> <span class="k">NOT</span> <span class="no">NULL</span><span class="p">,</span>
</span><span class='line'>    <span class="n">NAMA</span>    <span class="kt">VARCHAR</span><span class="p">(</span><span class="mi">30</span><span class="p">),</span>
</span><span class='line'>    <span class="n">ALAMAT</span>  <span class="kt">VARCHAR</span><span class="p">(</span><span class="mi">30</span><span class="p">)</span>
</span><span class='line'><span class="p">);</span><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span><span class="k">CREATE</span> <span class="k">TABLE</span> <span class="nf">CUSTOMER</span> <span class="p">(</span>
</span><span class='line'>    <span class="n">ID</span>      <span class="kt">INTEGER</span> <span class="k">NOT</span> <span class="no">NULL</span><span class="p">,</span>
</span><span class='line'>    <span class="n">NAMA</span>    <span class="kt">VARCHAR</span><span class="p">(</span><span class="mi">30</span><span class="p">),</span>
</span><span class='line'>    <span class="n">ALAMAT</span>  <span class="kt">VARCHAR</span><span class="p">(</span><span class="mi">30</span><span class="p">)</span>
</span><span class='line'><span class="p">);</span>
</span></code></pre></td></tr></table></div></figure></p>

<p>Event kita tambahkan pada saat pembuatan trigger, berikut langkah-langkahnya :</p>

<ol>
<li>Aktifkan salah satu tabel misal Customer, kemudian pilih tab trigger</li>
</ol>


<p><a href="http://coding4ever.files.wordpress.com/2012/07/23072012-1.png"><img src="http://coding4ever.files.wordpress.com/2012/07/23072012-1.png" alt="" /></a></p>

<ol>
<li>Klik kanan pada item After Insert</li>
</ol>


<p><a href="http://coding4ever.files.wordpress.com/2012/07/23072012-2.png"><img src="http://coding4ever.files.wordpress.com/2012/07/23072012-2.png" alt="" /></a></p>

<ol>
<li>Kemudian lengkapi kode triggernya seperti gambar berikut :</li>
</ol>


<p><a href="http://coding4ever.files.wordpress.com/2012/07/23072012-3.png"><img src="http://coding4ever.files.wordpress.com/2012/07/23072012-3.png" alt="" /></a></p>

<p>Pada contoh di atas kita menambahkan sebuah event dengan nama NEW_CUSTOMER yang otomatis akan dieksekusi pada saat terjadi proses INSERT pada tabel Customer.</p>

<p>Untuk selanjutnya kita ulangi lagi langkah-langkah diatas untuk menambahkan event dengan nama NEW_SUPPLIER pada tabel Supplier.</p>

<p><strong>Menangkap Event dari Aplikasi</strong></p>

<p>Untuk mendemokan bagaimana menangkap event firebird dari aplikasi, sy menggunakan C# dengan tipe project Windows Application.</p>

<p>C# sendiri tidak otomatis bisa mengakses database firebird tetapi harus menambahkan library FirebirdClient - ADO.NET Data Provider yang bisa didownload di<a href="http://www.firebirdsql.org/en/net-provider/">sini</a>.</p>

<p>Berikut langkah-langkah untuk menambahkan library FirebirdClient - ADO.NET Data Provider</p>

<ol>
<li>Klik kanan node References -> Add Reference..</li>
</ol>


<p><a href="http://coding4ever.files.wordpress.com/2012/07/23072012-4.png"><img src="http://coding4ever.files.wordpress.com/2012/07/23072012-4.png" alt="" /></a></p>

<ol>
<li>Pilih library FirebirdClient - ADO.NET Data Provider yang sudah didownload kemudian klik Ok</li>
</ol>


<p><a href="http://coding4ever.files.wordpress.com/2012/07/23072012-5.png"><img src="http://coding4ever.files.wordpress.com/2012/07/23072012-5.png" alt="" /></a></p>

<p>Adapun kode lengkapnya seperti berikut :</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='c#'><span class='line'><span class="k">using</span> <span class="nn">FirebirdSql.Data.FirebirdClient</span><span class="p">;</span>
</span></code></pre></td></tr></table></div></figure>
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
</pre></td><td class='code'><pre><code class='c#'><span class='line'><span class="k">private</span> <span class="n">FbConnection</span> <span class="n">conn</span> <span class="p">=</span> <span class="k">null</span><span class="p">;&lt;/</span><span class="n">p</span><span class="p">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="p">&lt;</span><span class="n">p</span><span class="p">&gt;</span><span class="k">public</span> <span class="n">Form1</span><span class="p">()</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'>    <span class="n">InitializeComponent</span><span class="p">();&lt;/</span><span class="n">p</span><span class="p">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="p">&lt;</span><span class="n">pre</span><span class="p">&gt;&lt;</span><span class="n">code</span><span class="p">&gt;</span><span class="kt">string</span> <span class="n">dbPath</span> <span class="p">=</span> <span class="n">System</span><span class="p">.</span><span class="n">IO</span><span class="p">.</span><span class="n">Directory</span><span class="p">.</span><span class="n">GetCurrentDirectory</span><span class="p">()</span> <span class="p">+</span> <span class="s">&quot;\\FBEVENT.FDB&quot;</span><span class="p">;</span>
</span><span class='line'><span class="kt">string</span> <span class="n">server</span> <span class="p">=</span> <span class="s">&quot;127.0.0.1&quot;</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'><span class="kt">string</span> <span class="n">strCon</span> <span class="p">=</span> <span class="s">&quot;User ID=SYSDBA;Password=masterkey;Database=&quot;</span> <span class="p">+</span> <span class="n">server</span> <span class="p">+</span> <span class="s">&quot;:&quot;</span> <span class="p">+</span> <span class="n">dbPath</span><span class="p">;</span>
</span><span class='line'><span class="n">conn</span> <span class="p">=</span> <span class="k">new</span> <span class="n">FbConnection</span><span class="p">(</span><span class="n">strCon</span><span class="p">);</span>
</span><span class='line'><span class="n">conn</span><span class="p">.</span><span class="n">Open</span><span class="p">();</span>
</span><span class='line'>
</span><span class='line'><span class="c1">// mendaftarkan event yang akan ditangkap</span>
</span><span class='line'><span class="kt">string</span><span class="p">[]</span> <span class="n">daftarEvent</span> <span class="p">=</span> <span class="p">{</span> <span class="s">&quot;NEW_CUSTOMER&quot;</span><span class="p">,</span> <span class="s">&quot;NEW_SUPPLIER&quot;</span> <span class="p">};</span>
</span><span class='line'><span class="n">FbRemoteEvent</span> <span class="n">remoteEvent</span> <span class="p">=</span> <span class="k">new</span> <span class="n">FbRemoteEvent</span><span class="p">(</span><span class="n">conn</span><span class="p">,</span> <span class="n">daftarEvent</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'><span class="c1">// proses delegate, untuk mendaftarkan method RemoteEventCounts pada event FbRemoteEventEventHandler</span>
</span><span class='line'><span class="n">remoteEvent</span><span class="p">.</span><span class="n">RemoteEventCounts</span> <span class="p">+=</span> <span class="k">new</span> <span class="n">FbRemoteEventEventHandler</span><span class="p">(</span><span class="n">RemoteEventCounts</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'><span class="n">remoteEvent</span><span class="p">.</span><span class="n">QueueEvents</span><span class="p">();</span>
</span><span class='line'><span class="p">&lt;/</span><span class="n">code</span><span class="p">&gt;&lt;/</span><span class="n">pre</span><span class="p">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="p">&lt;</span><span class="n">p</span><span class="p">&gt;}&lt;/</span><span class="n">p</span><span class="p">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="p">&lt;</span><span class="n">p</span><span class="p">&gt;</span><span class="k">private</span> <span class="k">void</span> <span class="n">RemoteEventCounts</span><span class="p">(</span><span class="kt">object</span> <span class="n">sender</span><span class="p">,</span> <span class="n">FbRemoteEventEventArgs</span> <span class="n">args</span><span class="p">)</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'>    <span class="k">if</span> <span class="p">(</span><span class="n">args</span><span class="p">.</span><span class="n">Counts</span> <span class="p">==</span> <span class="m">1</span><span class="p">)</span>
</span><span class='line'>    <span class="p">{</span>
</span><span class='line'>        <span class="k">switch</span> <span class="p">(</span><span class="n">args</span><span class="p">.</span><span class="n">Name</span><span class="p">)</span>
</span><span class='line'>        <span class="p">{</span>
</span><span class='line'>            <span class="k">case</span> <span class="p">&amp;</span><span class="n">ldquo</span><span class="p">;</span><span class="n">NEW_CUSTOMER</span><span class="p">&amp;</span><span class="n">rdquo</span><span class="p">;:</span>
</span><span class='line'>                <span class="n">LoadData</span><span class="p">(&amp;</span><span class="n">ldquo</span><span class="p">;</span><span class="n">customer</span><span class="p">&amp;</span><span class="n">rdquo</span><span class="p">;,</span> <span class="n">lstCustomer</span><span class="p">);</span>
</span><span class='line'>                <span class="k">break</span><span class="p">;&lt;/</span><span class="n">p</span><span class="p">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="p">&lt;</span><span class="n">pre</span><span class="p">&gt;&lt;</span><span class="n">code</span><span class="p">&gt;</span>        <span class="k">case</span> <span class="s">&quot;NEW_SUPPLIER&quot;</span><span class="p">:</span>
</span><span class='line'>            <span class="n">LoadData</span><span class="p">(</span><span class="s">&quot;supplier&quot;</span><span class="p">,</span> <span class="n">lstSupplier</span><span class="p">);</span>
</span><span class='line'>            <span class="k">break</span><span class="p">;</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'><span class="p">&lt;/</span><span class="n">code</span><span class="p">&gt;&lt;/</span><span class="n">pre</span><span class="p">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="p">&lt;</span><span class="n">p</span><span class="p">&gt;}</span>
</span></code></pre></td></tr></table></div></figure></p>

<p>Yang perlu diperhatikan pada method RemoteEventCounts diatas adalah setiap ada event yang masuk otomatis akan memanggil method LoadData</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
</pre></td><td class='code'><pre><code class='c#'><span class='line'><span class="k">private</span> <span class="k">void</span> <span class="nf">LoadData</span><span class="p">(</span><span class="kt">string</span> <span class="n">tableName</span><span class="p">,</span> <span class="n">ListBox</span> <span class="n">lst</span><span class="p">)</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'>    <span class="kt">string</span> <span class="n">strSql</span> <span class="p">=</span> <span class="p">&amp;</span><span class="n">ldquo</span><span class="p">;</span><span class="n">SELECT</span> <span class="n">nama</span><span class="p">,</span> <span class="n">alamat</span> <span class="n">FROM</span> <span class="p">&amp;</span><span class="n">rdquo</span><span class="p">;</span> <span class="p">+</span> <span class="n">tableName</span><span class="p">;&lt;/</span><span class="n">p</span><span class="p">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="p">&lt;</span><span class="n">pre</span><span class="p">&gt;&lt;</span><span class="n">code</span><span class="p">&gt;</span><span class="n">lst</span><span class="p">.</span><span class="n">Items</span><span class="p">.</span><span class="n">Clear</span><span class="p">();</span>
</span><span class='line'><span class="k">using</span> <span class="p">(</span><span class="n">FbCommand</span> <span class="n">cmd</span> <span class="p">=</span> <span class="k">new</span> <span class="n">FbCommand</span><span class="p">(</span><span class="n">strSql</span><span class="p">,</span> <span class="n">conn</span><span class="p">))</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'>    <span class="k">using</span> <span class="p">(</span><span class="n">FbDataReader</span> <span class="n">dtr</span> <span class="p">=</span> <span class="n">cmd</span><span class="p">.</span><span class="n">ExecuteReader</span><span class="p">())</span>
</span><span class='line'>    <span class="p">{</span>
</span><span class='line'>        <span class="k">while</span> <span class="p">(</span><span class="n">dtr</span><span class="p">.</span><span class="n">Read</span><span class="p">())</span>
</span><span class='line'>        <span class="p">{</span>
</span><span class='line'>            <span class="n">lst</span><span class="p">.</span><span class="n">Items</span><span class="p">.</span><span class="n">Add</span><span class="p">(</span><span class="n">dtr</span><span class="p">.</span><span class="n">GetString</span><span class="p">(</span><span class="m">0</span><span class="p">)</span> <span class="p">+</span> <span class="s">&quot;, &quot;</span> <span class="p">+</span> <span class="n">dtr</span><span class="p">.</span><span class="n">GetString</span><span class="p">(</span><span class="m">1</span><span class="p">));</span>
</span><span class='line'>        <span class="p">}</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'><span class="p">&lt;/</span><span class="n">code</span><span class="p">&gt;&lt;/</span><span class="n">pre</span><span class="p">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="p">&lt;</span><span class="n">p</span><span class="p">&gt;}</span>
</span></code></pre></td></tr></table></div></figure></p>

<p>Yuph sampe disini sudah selesai, saatnya kita uji coba aplikasi ini.</p>

<p><strong>Demo Menangkap Event</strong></p>

<p>Untuk membuktikan bahwa fitur event ini berfungsi dengan baik, sy akan menambahkan data secara langsung menggunakan tool IBExpert.</p>

<p>Perhatikan gambar awal sebelum perintah INSERT dijalankan.</p>

<p><a href="http://coding4ever.files.wordpress.com/2012/07/23072012-6.png"><img src="http://coding4ever.files.wordpress.com/2012/07/23072012-6.png" alt="" /></a></p>

<p>Setelah sy menjalankan printah INSERT diatas, aplikasi yg sy buat menggunakan C# secara otomatis menampilkan data yg sy inputkan melalui tool IBExpert.</p>

<p><a href="http://coding4ever.files.wordpress.com/2012/07/23072012-7.png"><img src="http://coding4ever.files.wordpress.com/2012/07/23072012-7.png" alt="" /></a></p>

<p>Selamat <a href="https://github.com/k4m4r82/DemoFirebirdEvent">MENCOBA</a> :)</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Berlindung Di Belakang SYSDBA :D]]></title>
    <link href="http://coding4ever.net/blog/2012/05/19/berlindung-di-belakang-sysdba/"/>
    <updated>2012-05-19T13:17:43+07:00</updated>
    <id>http://coding4ever.net/blog/2012/05/19/berlindung-di-belakang-sysdba</id>
    <content type="html"><![CDATA[<p>Beberapa waktu yang lalu sy pernah menulis bagaimana cara <a href="/blog/2011/01/03/menembus-pertahanan-database-firebird-yang-diproteksi/">Menembus pertahanan database Firebird yang diproteksi</a> menggunakan SYSDBA sebagai tamengnya :D, nah biar imbang sekarang kita akan bahas bagaimana langkah-langkah pembuatannya.</p>

<p>Tool yang digunakan juga masih sama yaitu <a href="http://www.4shared.com/file/qA3GI_Z1/ibexpert_personal_edition_v200.html">IBExpert personal edition</a> (free), oke langsung saja kita mulai :).</p>

<!-- more -->


<p><strong>1. Persiapkan database yang akan diproteksi</strong></p>

<p>Untuk contoh disini sy menggunakan database dg nama db_sample.fdb yang di tempatkan di drive C:\</p>

<p>Berikut langkah-langkah untuk mendaftarkan database firebird ke IBExpert.</p>

<ol type="a">
<li>Klik menu Database -> Register Database</li>
</ol>


<p><a href="http://coding4ever.files.wordpress.com/2012/05/19052012-1.png"><img src="http://coding4ever.files.wordpress.com/2012/05/19052012-1.png" alt="" /></a></p>

<p><a href="http://coding4ever.files.wordpress.com/2012/05/19052012-2.png"><img src="http://coding4ever.files.wordpress.com/2012/05/19052012-2.png" alt="" /></a></p>

<p>Kemudian login menggunakan user default Firebird yaitu <strong>SYSDBA</strong> dengan password<strong> masterkey</strong>.</p>

<p>Untuk versi server tinggal disesuaikan dengan versi Firebird yang terinstall.</p>

<ol type="a">
<li>Aktifkan database sample dengan cara klik ganda node DB SAMPLE</li>
</ol>


<p><a href="http://coding4ever.files.wordpress.com/2012/05/19052012-11.png"><img src="http://coding4ever.files.wordpress.com/2012/05/19052012-11.png" alt="" /></a></p>

<p><strong>2. Buat user baru yang akan kita jadikan sebagai pengganti SYSDBA, misal K4M4R82.</strong></p>

<p>User baru ini akan kita berikan hak akses untuk menghakses semua tabel dan obej-objek lain yang diperlukan.</p>

<p>Berikut langkah-langkahnya :</p>

<ol type="a">
<li>Klik menu Tools -> User Management, kemudian login menggunakan user <strong>SYSDBA</strong> dan password <strong>masterkey</strong>.</li>
</ol>


<p><a href="http://coding4ever.files.wordpress.com/2012/05/19052012-3.png"><img src="http://coding4ever.files.wordpress.com/2012/05/19052012-3.png" alt="" /></a></p>

<ol type="a">
<li>Tambahkan user baru dengan mengklik tombol Add</li>
</ol>


<p><a href="http://coding4ever.files.wordpress.com/2012/05/19052012-4.png"><img src="http://coding4ever.files.wordpress.com/2012/05/19052012-4.png" alt="" /></a></p>

<p>Kita akan menambahkan user baru dengan nama <strong>K4M4R82</strong> dan password <strong>rahasia</strong>.</p>

<p>Jika berhasil akan terlihat seperti berikut :</p>

<p><a href="http://coding4ever.files.wordpress.com/2012/05/19052012-5.png"><img src="http://coding4ever.files.wordpress.com/2012/05/19052012-5.png" alt="" /></a></p>

<p><strong>3. Mengatur hak akses user</strong></p>

<p>IBExpert mempunyai fitur untuk mengatur hak akses user, sayangnya fitur ini tidak aktif untuk versi personal edition (free), jadi kita akan mencoba solusi lain yaitu dengan membuat stored procedure dengan nama <strong>GRANT_USER</strong>.</p>

<p>Berikut scriptnya :</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
</pre></td><td class='code'><pre><code class='mysql'><span class='line'><span class="kt">SET</span> <span class="n">TERM</span> <span class="o">^</span> <span class="p">;</span><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span><span class="k">CREATE</span> <span class="k">OR</span> <span class="k">ALTER</span> <span class="k">PROCEDURE</span> <span class="nf">GRANT_USER</span> <span class="p">(</span>
</span><span class='line'>    <span class="n">user_name</span> <span class="kt">varchar</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>
</span><span class='line'><span class="k">as</span>
</span><span class='line'><span class="k">declare</span> <span class="n">variable</span> <span class="n">table_name</span> <span class="kt">varchar</span><span class="p">(</span><span class="mi">50</span><span class="p">);</span>
</span><span class='line'><span class="n">BEGIN</span>
</span><span class='line'>  <span class="o">&amp;</span><span class="n">ndash</span><span class="p">;</span> <span class="n">reset</span> <span class="n">hak</span> <span class="n">akses</span>
</span><span class='line'>  <span class="k">DELETE</span> <span class="k">FROM</span> <span class="n">rdb</span><span class="err">$</span><span class="n">user_privileges</span>
</span><span class='line'>  <span class="k">WHERE</span> <span class="n">rdb</span><span class="err">$</span><span class="n">user</span> <span class="o">=</span> <span class="p">:</span><span class="n">user_name</span> <span class="k">AND</span> <span class="n">rdb</span><span class="err">$</span><span class="n">privilege</span> <span class="k">IN</span> <span class="p">(</span><span class="o">&amp;</span><span class="n">lsquo</span><span class="p">;</span><span class="n">I</span><span class="o">&amp;</span><span class="n">rsquo</span><span class="p">;,</span> <span class="o">&amp;</span><span class="n">lsquo</span><span class="p">;</span><span class="n">U</span><span class="o">&amp;</span><span class="n">rsquo</span><span class="p">;,</span> <span class="o">&amp;</span><span class="n">rsquo</span><span class="p">;</span><span class="n">D</span><span class="s1">&#39;, &amp;rsquo;S&#39;</span><span class="p">)</span> <span class="k">AND</span> <span class="n">rdb</span><span class="err">$</span><span class="n">user_type</span> <span class="o">=</span> <span class="mi">8</span> <span class="k">AND</span> <span class="n">rdb</span><span class="err">$</span><span class="n">object_type</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span>  <span class="k">FOR</span> <span class="o">&amp;</span><span class="n">ndash</span><span class="p">;</span> <span class="n">ambil</span> <span class="n">informasi</span> <span class="n">nama</span><span class="o">-</span><span class="n">nama</span> <span class="n">tabel</span>
</span><span class='line'>        <span class="k">SELECT</span> <span class="n">RDB</span><span class="err">$</span><span class="n">RELATION_NAME</span>
</span><span class='line'>        <span class="k">FROM</span> <span class="n">RDB</span><span class="err">$</span><span class="n">RELATIONS</span>
</span><span class='line'>        <span class="k">WHERE</span> <span class="n">RDB</span><span class="err">$</span><span class="n">SYSTEM_FLAG</span><span class="o">=</span><span class="mi">0</span> <span class="k">INTO</span> <span class="p">:</span><span class="n">table_name</span>
</span><span class='line'>    <span class="n">DO</span>
</span><span class='line'>    <span class="n">BEGIN</span><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">pre</span><span class="o">&gt;&lt;</span><span class="n">code</span><span class="o">&gt;</span>    <span class="c1">-- INSERT</span>
</span><span class='line'>    <span class="k">INSERT</span> <span class="k">INTO</span> <span class="n">rdb</span><span class="err">$</span><span class="nf">user_privileges</span> <span class="p">(</span><span class="n">rdb</span><span class="err">$</span><span class="n">user</span><span class="p">,</span> <span class="n">rdb</span><span class="err">$</span><span class="n">grantor</span><span class="p">,</span> <span class="n">rdb</span><span class="err">$</span><span class="n">privilege</span><span class="p">,</span> <span class="n">rdb</span><span class="err">$</span><span class="n">grant_option</span><span class="p">,</span> <span class="n">rdb</span><span class="err">$</span><span class="n">relation_name</span><span class="p">,</span> <span class="n">rdb</span><span class="err">$</span><span class="n">user_type</span><span class="p">,</span> <span class="n">rdb</span><span class="err">$</span><span class="n">object_type</span><span class="p">)</span>
</span><span class='line'>    <span class="k">VALUES</span> <span class="p">(:</span><span class="n">user_name</span><span class="p">,</span> <span class="s1">&#39;SYSDBA&#39;</span><span class="p">,</span> <span class="s1">&#39;I&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="p">:</span><span class="n">table_name</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'>    <span class="c1">-- UPDATE</span>
</span><span class='line'>    <span class="k">INSERT</span> <span class="k">INTO</span> <span class="n">rdb</span><span class="err">$</span><span class="nf">user_privileges</span> <span class="p">(</span><span class="n">rdb</span><span class="err">$</span><span class="n">user</span><span class="p">,</span> <span class="n">rdb</span><span class="err">$</span><span class="n">grantor</span><span class="p">,</span> <span class="n">rdb</span><span class="err">$</span><span class="n">privilege</span><span class="p">,</span> <span class="n">rdb</span><span class="err">$</span><span class="n">grant_option</span><span class="p">,</span> <span class="n">rdb</span><span class="err">$</span><span class="n">relation_name</span><span class="p">,</span> <span class="n">rdb</span><span class="err">$</span><span class="n">user_type</span><span class="p">,</span> <span class="n">rdb</span><span class="err">$</span><span class="n">object_type</span><span class="p">)</span>
</span><span class='line'>    <span class="k">VALUES</span> <span class="p">(:</span><span class="n">user_name</span><span class="p">,</span> <span class="s1">&#39;SYSDBA&#39;</span><span class="p">,</span> <span class="s1">&#39;U&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="p">:</span><span class="n">table_name</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'>    <span class="c1">-- DELETE</span>
</span><span class='line'>    <span class="k">INSERT</span> <span class="k">INTO</span> <span class="n">rdb</span><span class="err">$</span><span class="nf">user_privileges</span> <span class="p">(</span><span class="n">rdb</span><span class="err">$</span><span class="n">user</span><span class="p">,</span> <span class="n">rdb</span><span class="err">$</span><span class="n">grantor</span><span class="p">,</span> <span class="n">rdb</span><span class="err">$</span><span class="n">privilege</span><span class="p">,</span> <span class="n">rdb</span><span class="err">$</span><span class="n">grant_option</span><span class="p">,</span> <span class="n">rdb</span><span class="err">$</span><span class="n">relation_name</span><span class="p">,</span> <span class="n">rdb</span><span class="err">$</span><span class="n">user_type</span><span class="p">,</span> <span class="n">rdb</span><span class="err">$</span><span class="n">object_type</span><span class="p">)</span>
</span><span class='line'>    <span class="k">VALUES</span> <span class="p">(:</span><span class="n">user_name</span><span class="p">,</span> <span class="s1">&#39;SYSDBA&#39;</span><span class="p">,</span> <span class="s1">&#39;D&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="p">:</span><span class="n">table_name</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'>    <span class="c1">-- SELECT</span>
</span><span class='line'>    <span class="k">INSERT</span> <span class="k">INTO</span> <span class="n">rdb</span><span class="err">$</span><span class="nf">user_privileges</span> <span class="p">(</span><span class="n">rdb</span><span class="err">$</span><span class="n">user</span><span class="p">,</span> <span class="n">rdb</span><span class="err">$</span><span class="n">grantor</span><span class="p">,</span> <span class="n">rdb</span><span class="err">$</span><span class="n">privilege</span><span class="p">,</span> <span class="n">rdb</span><span class="err">$</span><span class="n">grant_option</span><span class="p">,</span> <span class="n">rdb</span><span class="err">$</span><span class="n">relation_name</span><span class="p">,</span> <span class="n">rdb</span><span class="err">$</span><span class="n">user_type</span><span class="p">,</span> <span class="n">rdb</span><span class="err">$</span><span class="n">object_type</span><span class="p">)</span>
</span><span class='line'>    <span class="k">VALUES</span> <span class="p">(:</span><span class="n">user_name</span><span class="p">,</span> <span class="s1">&#39;SYSDBA&#39;</span><span class="p">,</span> <span class="s1">&#39;S&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="p">:</span><span class="n">table_name</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
</span><span class='line'><span class="n">END</span>
</span><span class='line'>
</span><span class='line'><span class="k">INSERT</span> <span class="k">INTO</span> <span class="n">rdb</span><span class="err">$</span><span class="nf">user_privileges</span> <span class="p">(</span><span class="n">rdb</span><span class="err">$</span><span class="n">user</span><span class="p">,</span> <span class="n">rdb</span><span class="err">$</span><span class="n">grantor</span><span class="p">,</span> <span class="n">rdb</span><span class="err">$</span><span class="n">privilege</span><span class="p">,</span> <span class="n">rdb</span><span class="err">$</span><span class="n">grant_option</span><span class="p">,</span> <span class="n">rdb</span><span class="err">$</span><span class="n">relation_name</span><span class="p">,</span> <span class="n">rdb</span><span class="err">$</span><span class="n">user_type</span><span class="p">,</span> <span class="n">rdb</span><span class="err">$</span><span class="n">object_type</span><span class="p">)</span>
</span><span class='line'><span class="k">VALUES</span> <span class="p">(:</span><span class="n">user_name</span><span class="p">,</span> <span class="s1">&#39;SYSDBA&#39;</span><span class="p">,</span> <span class="s1">&#39;S&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;RDB$RELATIONS&#39;</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
</span><span class='line'><span class="o">&lt;/</span><span class="n">code</span><span class="o">&gt;&lt;/</span><span class="n">pre</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span><span class="n">END</span>
</span><span class='line'><span class="o">^&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span><span class="kt">SET</span> <span class="n">TERM</span> <span class="p">;</span> <span class="o">^</span>
</span></code></pre></td></tr></table></div></figure></p>

<p>Untuk menjalankan script diatas kita akan menggunakan editor Script Executive (CTRL+F12)</p>

<p><a href="http://coding4ever.files.wordpress.com/2012/05/19052012-6.png"><img src="http://coding4ever.files.wordpress.com/2012/05/19052012-6.png" alt="" /></a></p>

<p><strong>4. Eksekusi stored procedure grant_user</strong></p>

<p>Setelah langkah sebelumnya selesai kita tinggal panggil stored procedure grant_user seperti berikut :</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='mysql'><span class='line'><span class="n">EXECUTE</span> <span class="k">PROCEDURE</span> <span class="nf">grant_user</span><span class="p">(</span><span class="o">&amp;</span><span class="n">lsquo</span><span class="p">;</span><span class="n">K4M4R82</span><span class="o">&amp;</span><span class="n">rsquo</span><span class="p">;)</span>
</span></code></pre></td></tr></table></div></figure></p>

<p><strong>5. Menambahkan role &lsquo;SYSDBA&rsquo;</strong></p>

<p>Informasi role tersimpan di dalam tabel sistem yang bernama rdb$roles, sehingga untuk menambahkannya kita bisa menggunakan perintah INSERT yang sudah biasa kita gunakan.</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='mysql'><span class='line'><span class="k">INSERT</span> <span class="k">INTO</span> <span class="n">rdb</span><span class="err">$</span><span class="nf">roles</span> <span class="p">(</span><span class="n">rdb</span><span class="err">$</span><span class="n">role_name</span><span class="p">,</span> <span class="n">rdb</span><span class="err">$</span><span class="n">owner_name</span><span class="p">,</span> <span class="n">rdb</span><span class="err">$</span><span class="n">system_flag</span><span class="p">)</span>
</span><span class='line'><span class="k">VALUES</span> <span class="p">(</span><span class="o">&amp;</span><span class="n">lsquo</span><span class="p">;</span><span class="n">SYSDBA</span><span class="o">&amp;</span><span class="n">rsquo</span><span class="p">;,</span> <span class="o">&amp;</span><span class="n">lsquo</span><span class="p">;</span><span class="n">K4M4R82</span><span class="o">&amp;</span><span class="n">rsquo</span><span class="p">;,</span> <span class="mi">0</span><span class="p">)</span>
</span></code></pre></td></tr></table></div></figure></p>

<p><strong>6. Disconnect dari database sample</strong></p>

<p><a href="http://coding4ever.files.wordpress.com/2012/05/19052012-7.png"><img src="http://coding4ever.files.wordpress.com/2012/05/19052012-7.png" alt="" /></a></p>

<p><strong>7. Aktifkan kembali database sample dengan cara klik ganda node DB SAMPLE</strong></p>

<p><a href="http://coding4ever.files.wordpress.com/2012/05/19052012-11.png"><img src="http://coding4ever.files.wordpress.com/2012/05/19052012-11.png" alt="" /></a></p>

<p>Jika muncul peringatan berikut</p>

<p><a href="http://coding4ever.files.wordpress.com/2012/05/19052012-8.png"><img src="http://coding4ever.files.wordpress.com/2012/05/19052012-8.png" alt="" /></a></p>

<p>berarti database kita sudah terlindungi oleh SYSDBA :)</p>

<p><strong>8. Terakhir kita coba login ulang dengan menggunakan user K4M4R82</strong></p>

<p><a href="http://coding4ever.files.wordpress.com/2012/05/19052012-9.png"><img src="http://coding4ever.files.wordpress.com/2012/05/19052012-9.png" alt="" /></a></p>

<p><a href="http://coding4ever.files.wordpress.com/2012/05/19052012-10.png"><img src="http://coding4ever.files.wordpress.com/2012/05/19052012-10.png" alt="" /></a></p>

<p>Selamat MENCOBA :)</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[SELECT SCOPE_IDENTITY(), SELECT LAST_INSERT_ID() Dan RETURNING PK]]></title>
    <link href="http://coding4ever.net/blog/2011/02/27/select-scope_identity-select-last_insert_id-dan-returning-pk/"/>
    <updated>2011-02-27T13:51:22+07:00</updated>
    <id>http://coding4ever.net/blog/2011/02/27/select-scope_identity-select-last_insert_id-dan-returning-pk</id>
    <content type="html"><![CDATA[<p>Yuph kali ini kita akan membahas fungsi menarik (SELECT SCOPE_IDENTITY(), SELECT LAST_INSERT_ID() dan RETURNING PK) yang dimiliki oleh database2x terkenal seperti SQL Server, MySQL dan Firebird.</p>

<p>Dari nama fungsinya kita bisa menebak kegunaan dari fungsi diatas yaitu untuk mendapatkan nilai ID terakhir (biasanya bertipe angka) yang diinputkan.</p>

<p>Saya dan mungkin Anda biasanya dalam merancang tabel untuk selalu menambahkan field ID dengan attribut IDENTITY/AUTONUMBER dan sekaligus dijadikan sebagai PRIMARY KEY.</p>

<p>Tentunya hal ini kita lakukan untuk mempermudah dalam proses manipulasi data (edit dan delete).</p>

<p>Contoh beberapa tabel yang biasanya menggunakan field ID untuk PRIMARY KEY dan sekaligus diset dengan attribut IDENTITY/AUTONUMBER</p>

<!-- more -->


<p><a href="http://coding4ever.files.wordpress.com/2011/02/table1.png"><img src="http://coding4ever.files.wordpress.com/2011/02/table1.png?w=300" alt="" /></a></p>

<p>Bagi yang males membaca referensi (termasuk sy :D) biasa menuliskan kode berikut untuk mengINSERTkan dan mendapatkan nilai ID yang terakhir, kita ambil contoh tabel provinsi.</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
</pre></td><td class='code'><pre><code class='vbnet'><span class='line'><span class="k">Private</span> <span class="k">Sub</span> <span class="nf">btnInsert_Click</span><span class="p">(</span><span class="k">ByVal</span> <span class="n">sender</span> <span class="ow">As</span> <span class="n">System</span><span class="p">.</span><span class="n">Object</span><span class="p">,</span> <span class="k">ByVal</span> <span class="n">e</span> <span class="ow">As</span> <span class="n">System</span><span class="p">.</span><span class="n">EventArgs</span><span class="p">)</span> <span class="k">Handles</span> <span class="n">btnInsert</span><span class="p">.</span><span class="n">Click</span>
</span><span class='line'>    <span class="k">Dim</span> <span class="n">lastID</span> <span class="ow">As</span> <span class="kt">Long</span> <span class="o">=</span> <span class="mi">0</span><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="na">&lt;pre&gt;</span><span class="o">&lt;</span><span class="n">code</span><span class="o">&gt;</span><span class="c">&#39; langkah 1 - menambahkan data</span>
</span><span class='line'><span class="n">strSql</span> <span class="o">=</span> <span class="s">&quot;INSERT INTO provinsi (keterangan) VALUES (@1)&quot;</span>
</span><span class='line'><span class="k">Using</span> <span class="n">cmd</span> <span class="ow">As</span> <span class="k">New</span> <span class="n">SqlClient</span><span class="p">.</span><span class="n">SqlCommand</span><span class="p">(</span><span class="n">strSql</span><span class="p">,</span> <span class="n">conn</span><span class="p">)</span>
</span><span class='line'>    <span class="k">With</span> <span class="n">cmd</span>
</span><span class='line'>        <span class="p">.</span><span class="n">Parameters</span><span class="p">.</span><span class="n">Clear</span><span class="p">()</span>
</span><span class='line'>        <span class="p">.</span><span class="n">Parameters</span><span class="p">.</span><span class="n">AddWithValue</span><span class="p">(</span><span class="s">&quot;@1&quot;</span><span class="p">,</span> <span class="s">&quot;Riau&quot;</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'>        <span class="p">.</span><span class="n">ExecuteNonQuery</span><span class="p">()</span>
</span><span class='line'>    <span class="k">End</span> <span class="k">With</span>
</span><span class='line'><span class="k">End</span> <span class="k">Using</span>
</span><span class='line'>
</span><span class='line'><span class="c">&#39; langkah 2 - mengambil id terakhir dg memanfaatkan fungsi MAX</span>
</span><span class='line'><span class="n">strSql</span> <span class="o">=</span> <span class="s">&quot;SELECT MAX(id) FROM provinsi&quot;</span>
</span><span class='line'><span class="k">Using</span> <span class="n">cmd</span> <span class="ow">As</span> <span class="k">New</span> <span class="n">SqlClient</span><span class="p">.</span><span class="n">SqlCommand</span><span class="p">(</span><span class="n">strSql</span><span class="p">,</span> <span class="n">conn</span><span class="p">)</span>
</span><span class='line'>    <span class="n">lastID</span> <span class="o">=</span> <span class="n">Convert</span><span class="p">.</span><span class="n">ToInt32</span><span class="p">(</span><span class="n">cmd</span><span class="p">.</span><span class="n">ExecuteScalar</span><span class="p">())</span>
</span><span class='line'><span class="k">End</span> <span class="k">Using</span>
</span><span class='line'>
</span><span class='line'><span class="c">&#39; tampilkan ID terakhir</span>
</span><span class='line'><span class="n">MessageBox</span><span class="p">.</span><span class="n">Show</span><span class="p">(</span><span class="s">&quot;Last ID : &quot;</span> <span class="o">&amp;</span><span class="n">amp</span><span class="err">;</span> <span class="n">lastID</span><span class="p">.</span><span class="n">ToString</span><span class="p">())</span>
</span><span class='line'><span class="na">&lt;/code&gt;</span><span class="o">&lt;/</span><span class="n">pre</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="na">&lt;p&gt;</span><span class="k">End</span> <span class="k">Sub</span>
</span></code></pre></td></tr></table></div></figure></p>

<p>Sekarang kita lihat bedanya jika memanfaatkan fungsi SELECT SCOPE_IDENTITY().</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
</pre></td><td class='code'><pre><code class='vbnet'><span class='line'><span class="k">Private</span> <span class="k">Sub</span> <span class="nf">btnInsert_Click</span><span class="p">(</span><span class="k">ByVal</span> <span class="n">sender</span> <span class="ow">As</span> <span class="n">System</span><span class="p">.</span><span class="n">Object</span><span class="p">,</span> <span class="k">ByVal</span> <span class="n">e</span> <span class="ow">As</span> <span class="n">System</span><span class="p">.</span><span class="n">EventArgs</span><span class="p">)</span> <span class="k">Handles</span> <span class="n">btnInsert</span><span class="p">.</span><span class="n">Click</span>
</span><span class='line'>    <span class="k">Dim</span> <span class="n">lastID</span> <span class="ow">As</span> <span class="kt">Long</span> <span class="o">=</span> <span class="mi">0</span><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="na">&lt;pre&gt;</span><span class="o">&lt;</span><span class="n">code</span><span class="o">&gt;</span><span class="n">strSql</span> <span class="o">=</span> <span class="s">&quot;INSERT INTO provinsi (keterangan) VALUES (@1) SELECT SCOPE_IDENTITY()&quot;</span> <span class="c">&#39; ada tambahan SELECT SCOPE_IDENTITY()</span>
</span><span class='line'><span class="k">Using</span> <span class="n">cmd</span> <span class="ow">As</span> <span class="k">New</span> <span class="n">SqlClient</span><span class="p">.</span><span class="n">SqlCommand</span><span class="p">(</span><span class="n">strSql</span><span class="p">,</span> <span class="n">conn</span><span class="p">)</span>
</span><span class='line'>    <span class="k">With</span> <span class="n">cmd</span>
</span><span class='line'>        <span class="p">.</span><span class="n">Parameters</span><span class="p">.</span><span class="n">Clear</span><span class="p">()</span>
</span><span class='line'>        <span class="p">.</span><span class="n">Parameters</span><span class="p">.</span><span class="n">AddWithValue</span><span class="p">(</span><span class="s">&quot;@1&quot;</span><span class="p">,</span> <span class="s">&quot;Riau&quot;</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'>        <span class="n">lastID</span> <span class="o">=</span> <span class="n">Convert</span><span class="p">.</span><span class="n">ToInt32</span><span class="p">(.</span><span class="n">ExecuteScalar</span><span class="p">())</span>
</span><span class='line'>    <span class="k">End</span> <span class="k">With</span>
</span><span class='line'><span class="k">End</span> <span class="k">Using</span>
</span><span class='line'>
</span><span class='line'><span class="n">MessageBox</span><span class="p">.</span><span class="n">Show</span> <span class="p">(</span><span class="s">&quot;Last ID : &quot;</span> <span class="o">&amp;</span><span class="n">amp</span><span class="err">;</span> <span class="n">lastID</span><span class="p">.</span><span class="n">ToString</span><span class="p">())</span>
</span><span class='line'><span class="na">&lt;/code&gt;</span><span class="o">&lt;/</span><span class="n">pre</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="na">&lt;p&gt;</span><span class="k">End</span> <span class="k">Sub</span>
</span></code></pre></td></tr></table></div></figure></p>

<p>Gimana lebih simple kan ? :)</p>

<p>Oke sekarang kita lihat kode untuk MySQL(SELECT LAST_INSERT_ID) dan Firebird (RETURN KOLOM_PK).</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
</pre></td><td class='code'><pre><code class='vbnet'><span class='line'><span class="o">&amp;</span><span class="n">lsquo</span><span class="err">;</span> <span class="n">MySQL</span>
</span><span class='line'><span class="k">Private</span> <span class="k">Sub</span> <span class="nf">btnInsert_Click</span><span class="p">(</span><span class="k">ByVal</span> <span class="n">sender</span> <span class="ow">As</span> <span class="n">System</span><span class="p">.</span><span class="n">Object</span><span class="p">,</span> <span class="k">ByVal</span> <span class="n">e</span> <span class="ow">As</span> <span class="n">System</span><span class="p">.</span><span class="n">EventArgs</span><span class="p">)</span> <span class="k">Handles</span> <span class="n">btnInsert</span><span class="p">.</span><span class="n">Click</span>
</span><span class='line'>    <span class="k">Dim</span> <span class="n">lastID</span> <span class="ow">As</span> <span class="kt">Long</span> <span class="o">=</span> <span class="mi">0</span><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="na">&lt;pre&gt;</span><span class="o">&lt;</span><span class="n">code</span><span class="o">&gt;</span><span class="n">strSql</span> <span class="o">=</span> <span class="s">&quot;INSERT INTO provinsi (keterangan) VALUES (@1); SELECT LAST_INSERT_ID()&quot;</span>
</span><span class='line'><span class="k">Using</span> <span class="n">cmd</span> <span class="ow">As</span> <span class="k">New</span> <span class="n">MySqlClient</span><span class="p">.</span><span class="n">MySqlCommand</span><span class="p">(</span><span class="n">strSql</span><span class="p">,</span> <span class="n">conn</span><span class="p">)</span>
</span><span class='line'>    <span class="k">With</span> <span class="n">cmd</span>
</span><span class='line'>        <span class="p">.</span><span class="n">Parameters</span><span class="p">.</span><span class="n">Clear</span><span class="p">()</span>
</span><span class='line'>        <span class="p">.</span><span class="n">Parameters</span><span class="p">.</span><span class="n">AddWithValue</span><span class="p">(</span><span class="s">&quot;@1&quot;</span><span class="p">,</span> <span class="s">&quot;Riau&quot;</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'>        <span class="n">lastID</span> <span class="o">=</span> <span class="n">Convert</span><span class="p">.</span><span class="n">ToInt32</span><span class="p">(.</span><span class="n">ExecuteScalar</span><span class="p">())</span>
</span><span class='line'>    <span class="k">End</span> <span class="k">With</span>
</span><span class='line'><span class="k">End</span> <span class="k">Using</span>
</span><span class='line'>
</span><span class='line'><span class="n">MessageBox</span><span class="p">.</span><span class="n">Show</span> <span class="p">(</span><span class="s">&quot;Last ID : &quot;</span> <span class="o">&amp;</span><span class="n">amp</span><span class="err">;</span> <span class="n">lastID</span><span class="p">.</span><span class="n">ToString</span><span class="p">())</span>
</span><span class='line'><span class="na">&lt;/code&gt;</span><span class="o">&lt;/</span><span class="n">pre</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="na">&lt;p&gt;</span><span class="k">End</span> <span class="k">Sub</span><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="na">&lt;p&gt;</span><span class="o">&amp;</span><span class="n">lsquo</span><span class="err">;</span> <span class="n">Firebird</span>
</span><span class='line'><span class="k">Private</span> <span class="k">Sub</span> <span class="nf">btnInsert_Click</span><span class="p">(</span><span class="k">ByVal</span> <span class="n">sender</span> <span class="ow">As</span> <span class="n">System</span><span class="p">.</span><span class="n">Object</span><span class="p">,</span> <span class="k">ByVal</span> <span class="n">e</span> <span class="ow">As</span> <span class="n">System</span><span class="p">.</span><span class="n">EventArgs</span><span class="p">)</span> <span class="k">Handles</span> <span class="n">btnInsert</span><span class="p">.</span><span class="n">Click</span>
</span><span class='line'>    <span class="k">Dim</span> <span class="n">lastID</span> <span class="ow">As</span> <span class="kt">Long</span> <span class="o">=</span> <span class="mi">0</span><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="na">&lt;pre&gt;</span><span class="o">&lt;</span><span class="n">code</span><span class="o">&gt;</span><span class="n">strSql</span> <span class="o">=</span> <span class="s">&quot;INSERT INTO provinsi (keterangan) VALUES (@1) RETURNING ID&quot;</span> <span class="c">&#39; ID -&amp;gt; kolom primary key</span>
</span><span class='line'><span class="k">Using</span> <span class="n">cmd</span> <span class="ow">As</span> <span class="k">New</span> <span class="n">FirebirdClient</span><span class="p">.</span><span class="n">FbCommand</span><span class="p">(</span><span class="n">strSql</span><span class="p">,</span> <span class="n">conn</span><span class="p">)</span>
</span><span class='line'>    <span class="k">With</span> <span class="n">cmd</span>
</span><span class='line'>        <span class="p">.</span><span class="n">Parameters</span><span class="p">.</span><span class="n">Clear</span><span class="p">()</span>
</span><span class='line'>        <span class="p">.</span><span class="n">Parameters</span><span class="p">.</span><span class="n">AddWithValue</span><span class="p">(</span><span class="s">&quot;@1&quot;</span><span class="p">,</span> <span class="s">&quot;Riau&quot;</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'>        <span class="n">lastID</span> <span class="o">=</span> <span class="n">Convert</span><span class="p">.</span><span class="n">ToInt32</span><span class="p">(.</span><span class="n">ExecuteScalar</span><span class="p">())</span>
</span><span class='line'>    <span class="k">End</span> <span class="k">With</span>
</span><span class='line'><span class="k">End</span> <span class="k">Using</span>
</span><span class='line'>
</span><span class='line'><span class="n">MessageBox</span><span class="p">.</span><span class="n">Show</span> <span class="p">(</span><span class="s">&quot;Last ID : &quot;</span> <span class="o">&amp;</span><span class="n">amp</span><span class="err">;</span> <span class="n">lastID</span><span class="p">.</span><span class="n">ToString</span><span class="p">())</span>
</span><span class='line'><span class="na">&lt;/code&gt;</span><span class="o">&lt;/</span><span class="n">pre</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="na">&lt;p&gt;</span><span class="k">End</span> <span class="k">Sub</span>
</span></code></pre></td></tr></table></div></figure></p>

<p>Untuk bisa mengakses database MySQL dan Firebird di Visual Basic .NET kita harus menginstall <a href="http://dev.mysql.com/downloads/connector/net/">MySQL Connector/Net</a> dan <a href="http://firebirdsql.org/index.php?op=files&amp;id=netprovider">Firebird ADO.NET Data Provider</a>.</p>

<p>Selamat mencoba :)</p>
]]></content>
  </entry>
  
</feed>
