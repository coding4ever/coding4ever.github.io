<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Category: Firebird | Coding4ever's Blog]]></title>
  <link href="http://coding4ever.net/blog/categories/firebird/atom.xml" rel="self"/>
  <link href="http://coding4ever.net/"/>
  <updated>2015-04-20T10:31:03+07:00</updated>
  <id>http://coding4ever.net/</id>
  <author>
    <name><![CDATA[Admin]]></name>
    
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[Menembus Pertahanan Database Firebird Yang Diproteksi Bagian 2]]></title>
    <link href="http://coding4ever.net/blog/2013/06/25/menembus-pertahanan-database-firebird-yang-diproteksi-bagian-2/"/>
    <updated>2013-06-25T11:04:17+07:00</updated>
    <id>http://coding4ever.net/blog/2013/06/25/menembus-pertahanan-database-firebird-yang-diproteksi-bagian-2</id>
    <content type="html"><![CDATA[<p>Postingan saya kali ini merupakan jawaban untuk om guys yang sudah berhasil <a href="https://coding4ever.wordpress.com/2011/01/03/menembus-pertahanan-database-firebird-yang-diproteksi/">Menembus pertahanan database Firebird yang diproteksi</a> tetapi masih ada sedikit masalah yang perlu diselesaikan.</p>

<p>Biar lebih lengkap saya tulis ulang saja pertanyaannya.</p>

<blockquote><p>thx beart om admin buat tutor singkatnya, sangat bermanfaat.
ada sedikit masalah, setelah kita “bongkar” db zahir-nya ternyata ga bisa di pake lagi di aplikasi Zahirnya ya. Harus kita balikin lagi setting FB-nya ke default/original (khususnya user ZAHIRDBA).
ada work-around-nya untuk masalah ini om admin?</p></blockquote>

<!-- more -->


<p>Jadi langkah-langkah berikut ini akan menghapus role &ldquo;SYSDBA&rdquo; sehingga kita bisa login lagi menggunakan user default Firebird yaitu SYSDBA.</p>

<p>Berikut langkah-langkahnya :</p>

<ol>
<li><p>Sudah berhasil <a href="https://coding4ever.wordpress.com/2011/01/03/menembus-pertahanan-database-firebird-yang-diproteksi/">menembus pertahanan database Firebird yang diproteksi</a></p></li>
<li><p>Login menggunakan user ZAHIRDBA</p></li>
</ol>


<p><a href="http://coding4ever.files.wordpress.com/2013/06/25062013-1.png"><img src="http://coding4ever.files.wordpress.com/2013/06/25062013-1.png" alt="25062013-1" /></a></p>

<ol>
<li>Hapus role SYSDBA menggunakan perintah</li>
</ol>


<p>{% codeblock %}
DELETE FROM rdb$roles
WHERE rdb$role_name = &lsquo;SYSDBA&rsquo; AND rdb$owner_name = &lsquo;ZAHIRDBA&rsquo;
{% endcodeblock %}</p>

<p><a href="http://coding4ever.files.wordpress.com/2013/06/25062013-2.png"><img src="http://coding4ever.files.wordpress.com/2013/06/25062013-2.png" alt="25062013-2" /></a></p>

<p>sampai tahap ini kita sudah bisa menggunakan user sysdba lagi</p>

<ol>
<li>Login ulang menggunakan user SYSDBA</li>
</ol>


<p><a href="http://coding4ever.files.wordpress.com/2013/06/25062013-3.png"><img src="http://coding4ever.files.wordpress.com/2013/06/25062013-3.png" alt="25062013-3" /></a></p>

<ol>
<li>Hapus user ZAHIRDBA dari menu Tools -> User Manager</li>
</ol>


<p><a href="http://coding4ever.files.wordpress.com/2013/06/25062013-4.png"><img src="http://coding4ever.files.wordpress.com/2013/06/25062013-4.png" alt="25062013-4" /></a></p>

<ol>
<li>Selesai :)</li>
</ol>


<p><a href="http://coding4ever.files.wordpress.com/2013/06/25062013-5.png"><img src="http://coding4ever.files.wordpress.com/2013/06/25062013-5.png" alt="25062013-5" /></a></p>

<p>Selamat mencoba :)</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Database Firebird Versi Embedded]]></title>
    <link href="http://coding4ever.net/blog/2013/01/09/database-firebird-versi-embedded/"/>
    <updated>2013-01-09T11:10:00+07:00</updated>
    <id>http://coding4ever.net/blog/2013/01/09/database-firebird-versi-embedded</id>
    <content type="html"><![CDATA[<p>Horeee akhirnya bisa nulis lagi dan ini postingan pertama saya di awal tahun 2013 :)</p>

<p>Beberapa waktu yang lalu saya sering menggunakan database Ms Access untuk pembuatan aplikasi standalone tetapi mengingat beberapa kekurangan yang dimiliki oleh database Ms Access seperti pembengkakan ukuran database yang sangat &ldquo;mengerikan&rdquo; :D dan terkadang terjadi kerusakan database sehingga memaksa saya untuk mencari alternatif lain yang bisa menggantikan database Ms Access.</p>

<!-- more -->


<p>Usut punya usut ternyata database favorit saya (Firebird) juga menyediakan library yang memungkinan database Firebrid bisa diperlakukan seperti layaknya database Ms Access (tanpa membutuhkan konfigurasi server sama sekali).</p>

<p>Pada postingan saya kali ini kita akan membahas apa saja yang diperlukan untuk memanfaatkan database Firebird versi Embedded setelah itu akan kita coba mengaksesnya dari bahasa pemrograman C#.</p>

<ol>
<li>Download terlebih dulu library database <a href="http://www.firebirdsql.org/en/firebird-2-5-2/">Firebird versi Embedded</a></li>
</ol>


<p><a href="http://coding4ever.files.wordpress.com/2013/01/09012013-1.png"><img src="http://coding4ever.files.wordpress.com/2013/01/09012013-1.png" alt="09012013-1" /></a></p>

<p>Ekstrak file Firebird-2.5.2.26539-0_Win32_embed.zip kemudian dari file-file yang ada, yang kita butuhkan hanya file fbembed.dll, icudt30.dll, icuin30.dll dan icuuc30.dll.</p>

<p><a href="http://coding4ever.files.wordpress.com/2013/01/09012013-3.png"><img src="http://coding4ever.files.wordpress.com/2013/01/09012013-3.png" alt="09012013-3" /></a></p>

<p>Semua file diatas harus dicopykan ke folder aplikasi (bin\debug atau bin\release).</p>

<ol>
<li>Download <a href="http://www.firebirdsql.org/en/net-provider/">Firebird ADO.NET Data Provider</a></li>
</ol>


<p><a href="http://coding4ever.files.wordpress.com/2013/01/09012013-2.png"><img src="http://coding4ever.files.wordpress.com/2013/01/09012013-2.png" alt="09012013-2" /></a></p>

<p>Pada gambar di atas saya mendownload file NETProvider-3.0.2.0-NET35.7z karena saya menggunakan C# 2008 yang membutuhkan .NET Framework 3.5 kemudian ekstrak file tersebut.</p>

<p><a href="http://coding4ever.files.wordpress.com/2013/01/09012013-4.png"><img src="http://coding4ever.files.wordpress.com/2013/01/09012013-4.png" alt="09012013-4" /></a></p>

<p>Yang kita butuhkan cukup file FirebirdSql.Data.FirebirdClient.dll</p>

<ol>
<li>String koneksi yang digunakan</li>
</ol>


<p>String koneksi yang digunakan untuk mengakses database Firebird versi non Embedded adalah seperti berikut :</p>

<p>{% codeblock lang:c# %}
var strConn = @&ldquo;User ID=SYSDBA;Password=masterkey;Database=localhost:c:\database\test.fdb&rdquo;;
{% endcodeblock %}</p>

<p>Sedangkan untuk versi Embeddednya seperti berikut :</p>

<p>{% codeblock lang:c# %}
var strConn = @&ldquo;ServerType=1;User=SYSDBA;Password=masterkey;Dialect=3;Database=c:\database\test&rdquo;;
{% endcodeblock %}</p>

<p>Setelah semua persiapan lengkap saatnya kita menuliskan kode untuk mengakses database Firebird versi Embedded</p>

<ol>
<li>Buat project baru, untuk contoh disini saya menggunakan project dengan tipe Console Application</li>
</ol>


<p><a href="http://coding4ever.files.wordpress.com/2013/01/09012013-5.png"><img src="http://coding4ever.files.wordpress.com/2013/01/09012013-5.png" alt="09012013-5" /></a></p>

<ol>
<li>Menambahkan referensi Firebird ADO.NET Data Provider</li>
</ol>


<p>Untuk mengakses database Firebird kita membutuhkan libaray Firebird ADO.NET Data Provider.</p>

<p>Untuk menambahkan library tersebut kedalam project, caranya cukup mudah hanya dengan mengklik kanan Project -> Add Reference&hellip;</p>

<p><a href="http://coding4ever.files.wordpress.com/2013/01/09012013-6.png"><img src="http://coding4ever.files.wordpress.com/2013/01/09012013-6.png" alt="09012013-6" /></a></p>

<p>Kemudian tentukan lokasi file FirebirdSql.Data.FirebirdClient.dll</p>

<p><a href="http://coding4ever.files.wordpress.com/2013/01/09012013-7.png"><img src="http://coding4ever.files.wordpress.com/2013/01/09012013-7.png" alt="09012013-7" /></a></p>

<p>Kemudian dilanjutkan dengan melakukan proses Build</p>

<p><a href="http://coding4ever.files.wordpress.com/2013/01/09012013-8.png"><img src="http://coding4ever.files.wordpress.com/2013/01/09012013-8.png" alt="09012013-8" /></a></p>

<p>Proses ini dibutuhkan untuk menghasilkan folder bin\Debug atau bin\Release</p>

<ol>
<li>Mengcopykan file fbembed.dll, icudt30.dll, icuin30.dll dan icuuc30.dll ke folder bin\Debug atau bin\Release</li>
</ol>


<p><a href="http://coding4ever.files.wordpress.com/2013/01/09012013-9.png"><img src="http://coding4ever.files.wordpress.com/2013/01/09012013-9.png" alt="09012013-9" /></a></p>

<p>Setelah itu kita akan coba kode untuk melakukan koneksi ke database dan menampilkan datanya.</p>

<p>{% codeblock lang:c# %}
namespace AksesFirebirdEmbedded
{
    class Program
    {
        static void Main(string[] args)
        {
            var appPath = System.IO.Directory.GetCurrentDirectory();
            var strConn = &ldquo;ServerType=1;User=SYSDBA;Password=masterkey;Dialect=3;Database=&rdquo; + appPath + &ldquo;\TEST.FDB&rdquo;;</p>

<pre><code>        using (var conn = new FbConnection(strConn))
        {
            conn.Open();

            var strSql = "SELECT idagama, deskripsi FROM agama";
            using (var cmd = new FbCommand(strSql, conn))
            {
                using (var dtr = cmd.ExecuteReader())
                {
                    while (dtr.Read())
                    {
                        Console.WriteLine(dtr.GetString(0) + ", " + dtr.GetString(1));
                    }
                }
            }
        }

        Console.ReadKey();
    }
}
</code></pre>

<p>}
{% endcodeblock %}</p>

<p><a href="http://coding4ever.files.wordpress.com/2013/01/09012013-10.png"><img src="http://coding4ever.files.wordpress.com/2013/01/09012013-10.png" alt="09012013-10" /></a></p>

<p>Selamat <a href="https://github.com/k4m4r82/AksesFirebirdEmbedded">MENCOBA</a> :)</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[The Power of Firebird Events]]></title>
    <link href="http://coding4ever.net/blog/2012/07/23/the-power-of-firebird-events/"/>
    <updated>2012-07-23T14:52:33+07:00</updated>
    <id>http://coding4ever.net/blog/2012/07/23/the-power-of-firebird-events</id>
    <content type="html"><![CDATA[<p><strong>Intro</strong></p>

<p>Judul postingan kali ini saya ambil dari dokumentasi resmi website <a href="http://www.firebirdsql.org">Firebird</a> dengan sub dokumen <a href="http://www.firebirdsql.org/en/white-papers-presentations/">White Papers &amp; Presentations</a>.</p>

<p>Sudah lama saya mengetahui adanya fitur keren ini, hanya saja karna waktu itu masih aktif ngoding menggunakan VB Classic jadi saya kurang tertarik untuk mencobanya (habis mau gimana lagi VB Classic memang belum mendukung fitur ini kok :-D) CMIIW.</p>

<!-- more -->


<p>Ketika kita diminta untuk membuat aplikasi real time yang akan selalu merefresh data yang ditampilkan, pilihan kita biasanya selalu menggunakan objek timer, thread atau yang sejenisnya untuk selalu mengecek apa ada data baru yang ditambahkan/diperbaiki/dihapus.</p>

<p>Penggunaan objek-objek ini sedikit banyaknya akan memakan resource yang lumayan apalagi untuk aplikasi yang masa aktifnya lama seperti aplikasi sms gateway.</p>

<p>Contoh lain misalnya kita ingin membuat aplikasi sms yang otomatis mengirimkan sms notifikasi ke nomor-nomor tertentu setiap ada data pembelian yang diinputkan.</p>

<p>Jadi dengan memanfaatkan fitur ini kita tidak perlu lagi atau minimal mengurangi ketergantungan terhadap objek-objek timer dan sejenisnya.</p>

<p>Dan sesuai dengan nama fitur ini yaitu &ldquo;Events&rdquo;, mungkin sudah terlintas dipikiran kita bahwa fitur ini sangat cocok jika digabungkan dengan fitur <a href="http://www.firebirdsql.org/">Firebird</a> lainnya yaitu <a href="{{%20site.url%20}}/blog/2010/03/15/membuat-store-procedure-trigger-dan-view-di-firebird/">Trigger</a>.</p>

<p><strong>Membuat Event</strong></p>

<p>Untuk demo membuat event ini saya menggunakan tool IBExpert dan sudah pernah saya bahas bagaimana cara penggunaan tool ini di<a href="{{%20site.url%20}}/blog/2010/01/06/berkenalan-dengan-database-firebird/">sini</a>.</p>

<p>Untuk contoh kasus kali ini kita akan menambahkan dua event, masing-masing pada tabel CUSTOMER dan SUPPLIER, adapun struktur tabelnya seperti berikut :</p>

<p>{% codeblock lang:mysql %}
CREATE TABLE SUPPLIER (
    ID      INTEGER NOT NULL,
    NAMA    VARCHAR(30),
    ALAMAT  VARCHAR(30)
);</p>

<p>CREATE TABLE CUSTOMER (
    ID      INTEGER NOT NULL,
    NAMA    VARCHAR(30),
    ALAMAT  VARCHAR(30)
);
{% endcodeblock %}</p>

<p>Event kita tambahkan pada saat pembuatan trigger, berikut langkah-langkahnya :</p>

<ol>
<li><p>Aktifkan salah satu tabel misal Customer, kemudian pilih tab trigger</p>

<p> <a href="http://coding4ever.files.wordpress.com/2012/07/23072012-1.png"><img src="http://coding4ever.files.wordpress.com/2012/07/23072012-1.png" alt="" /></a></p></li>
<li><p>Klik kanan pada item After Insert</p>

<p> <a href="http://coding4ever.files.wordpress.com/2012/07/23072012-2.png"><img src="http://coding4ever.files.wordpress.com/2012/07/23072012-2.png" alt="" /></a></p></li>
<li><p>Kemudian lengkapi kode triggernya seperti gambar berikut :</p>

<p> <a href="http://coding4ever.files.wordpress.com/2012/07/23072012-3.png"><img src="http://coding4ever.files.wordpress.com/2012/07/23072012-3.png" alt="" /></a></p></li>
</ol>


<p>Pada contoh di atas kita menambahkan sebuah event dengan nama NEW_CUSTOMER yang otomatis akan dieksekusi pada saat terjadi proses INSERT pada tabel Customer.</p>

<p>Untuk selanjutnya kita ulangi lagi langkah-langkah diatas untuk menambahkan event dengan nama NEW_SUPPLIER pada tabel Supplier.</p>

<p><strong>Menangkap Event dari Aplikasi</strong></p>

<p>Untuk mendemokan bagaimana menangkap event firebird dari aplikasi, saya menggunakan C# dengan tipe project Windows Application.</p>

<p>C# sendiri tidak otomatis bisa mengakses database firebird tetapi harus menambahkan library FirebirdClient - ADO.NET Data Provider yang bisa didownload di<a href="http://www.firebirdsql.org/en/net-provider/">sini</a>.</p>

<p>Berikut langkah-langkah untuk menambahkan library FirebirdClient - ADO.NET Data Provider</p>

<ol>
<li><p>Klik kanan node References -> Add Reference..</p>

<p> <a href="http://coding4ever.files.wordpress.com/2012/07/23072012-4.png"><img src="http://coding4ever.files.wordpress.com/2012/07/23072012-4.png" alt="" /></a></p></li>
<li><p>Pilih library FirebirdClient - ADO.NET Data Provider yang sudah didownload kemudian klik Ok</p>

<p> <a href="http://coding4ever.files.wordpress.com/2012/07/23072012-5.png"><img src="http://coding4ever.files.wordpress.com/2012/07/23072012-5.png" alt="" /></a></p></li>
</ol>


<p>Adapun kode lengkapnya seperti berikut :</p>

<p>{% codeblock lang:c# %}
using FirebirdSql.Data.FirebirdClient;
{% endcodeblock %}
{% codeblock lang:c# %}
private FbConnection conn = null;</p>

<p>public Form1()
{
    InitializeComponent();</p>

<pre><code>string dbPath = System.IO.Directory.GetCurrentDirectory() + "\\FBEVENT.FDB";
string server = "127.0.0.1";

string strCon = "User ID=SYSDBA;Password=masterkey;Database=" + server + ":" + dbPath;
conn = new FbConnection(strCon);
conn.Open();

// mendaftarkan event yang akan ditangkap
string[] daftarEvent = { "NEW_CUSTOMER", "NEW_SUPPLIER" };
FbRemoteEvent remoteEvent = new FbRemoteEvent(conn, daftarEvent);

// proses delegate, untuk mendaftarkan method RemoteEventCounts pada event FbRemoteEventEventHandler
remoteEvent.RemoteEventCounts += new FbRemoteEventEventHandler(RemoteEventCounts);

remoteEvent.QueueEvents();
</code></pre>

<p>}</p>

<p>private void RemoteEventCounts(object sender, FbRemoteEventEventArgs args)
{
    if (args.Counts == 1)
    {
        switch (args.Name)
        {
            case &ldquo;NEW_CUSTOMER&rdquo;:
                LoadData(&ldquo;customer&rdquo;, lstCustomer);
                break;</p>

<pre><code>        case "NEW_SUPPLIER":
            LoadData("supplier", lstSupplier);
            break;
    }
}
</code></pre>

<p>}
{% endcodeblock %}</p>

<p>Yang perlu diperhatikan pada method RemoteEventCounts diatas adalah setiap ada event yang masuk otomatis akan memanggil method LoadData</p>

<p>{% codeblock lang:c# %}
private void LoadData(string tableName, ListBox lst)
{
    string strSql = &ldquo;SELECT nama, alamat FROM &rdquo; + tableName;</p>

<pre><code>lst.Items.Clear();
using (FbCommand cmd = new FbCommand(strSql, conn))
{
    using (FbDataReader dtr = cmd.ExecuteReader())
    {
        while (dtr.Read())
        {
            lst.Items.Add(dtr.GetString(0) + ", " + dtr.GetString(1));
        }
    }
}
</code></pre>

<p>}
{% endcodeblock %}</p>

<p>Yuph sampe disini sudah selesai, saatnya kita uji coba aplikasi ini.</p>

<p><strong>Demo Menangkap Event</strong></p>

<p>Untuk membuktikan bahwa fitur event ini berfungsi dengan baik, saya akan menambahkan data secara langsung menggunakan tool IBExpert.</p>

<p>Perhatikan gambar awal sebelum perintah INSERT dijalankan.</p>

<p><a href="http://coding4ever.files.wordpress.com/2012/07/23072012-6.png"><img src="http://coding4ever.files.wordpress.com/2012/07/23072012-6.png" alt="" /></a></p>

<p>Setelah saya menjalankan printah INSERT diatas, aplikasi yang saya buat menggunakan C# secara otomatis menampilkan data yang saya inputkan melalui tool IBExpert.</p>

<p><a href="http://coding4ever.files.wordpress.com/2012/07/23072012-7.png"><img src="http://coding4ever.files.wordpress.com/2012/07/23072012-7.png" alt="" /></a></p>

<p>Selamat <a href="https://github.com/k4m4r82/DemoFirebirdEvent">MENCOBA</a> :)</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Berlindung Di Belakang SYSDBA :D]]></title>
    <link href="http://coding4ever.net/blog/2012/05/19/berlindung-di-belakang-sysdba/"/>
    <updated>2012-05-19T13:17:43+07:00</updated>
    <id>http://coding4ever.net/blog/2012/05/19/berlindung-di-belakang-sysdba</id>
    <content type="html"><![CDATA[<p>Beberapa waktu yang lalu sy pernah menulis bagaimana cara <a href="{{%20site.url%20}}/blog/2011/01/03/menembus-pertahanan-database-firebird-yang-diproteksi/">Menembus pertahanan database Firebird yang diproteksi</a> menggunakan SYSDBA sebagai tamengnya :D, nah biar imbang sekarang kita akan bahas bagaimana langkah-langkah pembuatannya.</p>

<p>Tool yang digunakan juga masih sama yaitu <a href="http://www.4shared.com/file/qA3GI_Z1/ibexpert_personal_edition_v200.html">IBExpert personal edition</a> (free), oke langsung saja kita mulai :).</p>

<!-- more -->


<p><strong>1. Persiapkan database yang akan diproteksi</strong></p>

<p>Untuk contoh disini sy menggunakan database dg nama db_sample.fdb yang di tempatkan di drive C:\</p>

<p>Berikut langkah-langkah untuk mendaftarkan database firebird ke IBExpert.</p>

<ol type="a">
<li>Klik menu Database -> Register Database</li>
</ol>


<p><a href="http://coding4ever.files.wordpress.com/2012/05/19052012-1.png"><img src="http://coding4ever.files.wordpress.com/2012/05/19052012-1.png" alt="" /></a></p>

<p><a href="http://coding4ever.files.wordpress.com/2012/05/19052012-2.png"><img src="http://coding4ever.files.wordpress.com/2012/05/19052012-2.png" alt="" /></a></p>

<p>Kemudian login menggunakan user default Firebird yaitu <strong>SYSDBA</strong> dengan password<strong> masterkey</strong>.</p>

<p>Untuk versi server tinggal disesuaikan dengan versi Firebird yang terinstall.</p>

<ol type="a">
<li>Aktifkan database sample dengan cara klik ganda node DB SAMPLE</li>
</ol>


<p><a href="http://coding4ever.files.wordpress.com/2012/05/19052012-11.png"><img src="http://coding4ever.files.wordpress.com/2012/05/19052012-11.png" alt="" /></a></p>

<p><strong>2. Buat user baru yang akan kita jadikan sebagai pengganti SYSDBA, misal K4M4R82.</strong></p>

<p>User baru ini akan kita berikan hak akses untuk menghakses semua tabel dan obej-objek lain yang diperlukan.</p>

<p>Berikut langkah-langkahnya :</p>

<ol type="a">
<li>Klik menu Tools -> User Management, kemudian login menggunakan user <strong>SYSDBA</strong> dan password <strong>masterkey</strong>.</li>
</ol>


<p><a href="http://coding4ever.files.wordpress.com/2012/05/19052012-3.png"><img src="http://coding4ever.files.wordpress.com/2012/05/19052012-3.png" alt="" /></a></p>

<ol type="a">
<li>Tambahkan user baru dengan mengklik tombol Add</li>
</ol>


<p><a href="http://coding4ever.files.wordpress.com/2012/05/19052012-4.png"><img src="http://coding4ever.files.wordpress.com/2012/05/19052012-4.png" alt="" /></a></p>

<p>Kita akan menambahkan user baru dengan nama <strong>K4M4R82</strong> dan password <strong>rahasia</strong>.</p>

<p>Jika berhasil akan terlihat seperti berikut :</p>

<p><a href="http://coding4ever.files.wordpress.com/2012/05/19052012-5.png"><img src="http://coding4ever.files.wordpress.com/2012/05/19052012-5.png" alt="" /></a></p>

<p><strong>3. Mengatur hak akses user</strong></p>

<p>IBExpert mempunyai fitur untuk mengatur hak akses user, sayangnya fitur ini tidak aktif untuk versi personal edition (free), jadi kita akan mencoba solusi lain yaitu dengan membuat stored procedure dengan nama <strong>GRANT_USER</strong>.</p>

<p>Berikut scriptnya :</p>

<p>{% codeblock lang:mysql %}
SET TERM ^ ;</p>

<p>CREATE OR ALTER PROCEDURE GRANT_USER (
    user_name varchar(10))
as
declare variable table_name varchar(50);
BEGIN
  &ndash; reset hak akses
  DELETE FROM rdb$user_privileges
  WHERE rdb$user = :user_name AND rdb$privilege IN (&lsquo;I&rsquo;, &lsquo;U&rsquo;, &rsquo;D&#8217;, &rsquo;S&#8217;) AND rdb$user_type = 8 AND rdb$object_type = 0;</p>

<p>  FOR &ndash; ambil informasi nama-nama tabel
        SELECT RDB$RELATION_NAME
        FROM RDB$RELATIONS
        WHERE RDB$SYSTEM_FLAG=0 INTO :table_name
    DO
    BEGIN</p>

<pre><code>    -- INSERT
    INSERT INTO rdb$user_privileges (rdb$user, rdb$grantor, rdb$privilege, rdb$grant_option, rdb$relation_name, rdb$user_type, rdb$object_type)
    VALUES (:user_name, 'SYSDBA', 'I', 1, :table_name, 8, 0);

    -- UPDATE
    INSERT INTO rdb$user_privileges (rdb$user, rdb$grantor, rdb$privilege, rdb$grant_option, rdb$relation_name, rdb$user_type, rdb$object_type)
    VALUES (:user_name, 'SYSDBA', 'U', 1, :table_name, 8, 0);

    -- DELETE
    INSERT INTO rdb$user_privileges (rdb$user, rdb$grantor, rdb$privilege, rdb$grant_option, rdb$relation_name, rdb$user_type, rdb$object_type)
    VALUES (:user_name, 'SYSDBA', 'D', 1, :table_name, 8, 0);

    -- SELECT
    INSERT INTO rdb$user_privileges (rdb$user, rdb$grantor, rdb$privilege, rdb$grant_option, rdb$relation_name, rdb$user_type, rdb$object_type)
    VALUES (:user_name, 'SYSDBA', 'S', 1, :table_name, 8, 0);
END

INSERT INTO rdb$user_privileges (rdb$user, rdb$grantor, rdb$privilege, rdb$grant_option, rdb$relation_name, rdb$user_type, rdb$object_type)
VALUES (:user_name, 'SYSDBA', 'S', 1, 'RDB$RELATIONS', 8, 0);
</code></pre>

<p>END
^</p>

<p>SET TERM ; ^
{% endcodeblock %}</p>

<p>Untuk menjalankan script diatas kita akan menggunakan editor Script Executive (CTRL+F12)</p>

<p><a href="http://coding4ever.files.wordpress.com/2012/05/19052012-6.png"><img src="http://coding4ever.files.wordpress.com/2012/05/19052012-6.png" alt="" /></a></p>

<p><strong>4. Eksekusi stored procedure grant_user</strong></p>

<p>Setelah langkah sebelumnya selesai kita tinggal panggil stored procedure grant_user seperti berikut :</p>

<p>{% codeblock lang:mysql %}
EXECUTE PROCEDURE grant_user(&lsquo;K4M4R82&rsquo;)
{% endcodeblock %}</p>

<p><strong>5. Menambahkan role &lsquo;SYSDBA&rsquo;</strong></p>

<p>Informasi role tersimpan di dalam tabel sistem yang bernama rdb$roles, sehingga untuk menambahkannya kita bisa menggunakan perintah INSERT yang sudah biasa kita gunakan.</p>

<p>{% codeblock lang:mysql %}
INSERT INTO rdb$roles (rdb$role_name, rdb$owner_name, rdb$system_flag)
VALUES (&lsquo;SYSDBA&rsquo;, &lsquo;K4M4R82&rsquo;, 0)
{% endcodeblock %}</p>

<p><strong>6. Disconnect dari database sample</strong></p>

<p><a href="http://coding4ever.files.wordpress.com/2012/05/19052012-7.png"><img src="http://coding4ever.files.wordpress.com/2012/05/19052012-7.png" alt="" /></a></p>

<p><strong>7. Aktifkan kembali database sample dengan cara klik ganda node DB SAMPLE</strong></p>

<p><a href="http://coding4ever.files.wordpress.com/2012/05/19052012-11.png"><img src="http://coding4ever.files.wordpress.com/2012/05/19052012-11.png" alt="" /></a></p>

<p>Jika muncul peringatan berikut</p>

<p><a href="http://coding4ever.files.wordpress.com/2012/05/19052012-8.png"><img src="http://coding4ever.files.wordpress.com/2012/05/19052012-8.png" alt="" /></a></p>

<p>berarti database kita sudah terlindungi oleh SYSDBA :)</p>

<p><strong>8. Terakhir kita coba login ulang dengan menggunakan user K4M4R82</strong></p>

<p><a href="http://coding4ever.files.wordpress.com/2012/05/19052012-9.png"><img src="http://coding4ever.files.wordpress.com/2012/05/19052012-9.png" alt="" /></a></p>

<p><a href="http://coding4ever.files.wordpress.com/2012/05/19052012-10.png"><img src="http://coding4ever.files.wordpress.com/2012/05/19052012-10.png" alt="" /></a></p>

<p>Selamat MENCOBA :)</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[SELECT SCOPE_IDENTITY(), SELECT LAST_INSERT_ID() Dan RETURNING PK]]></title>
    <link href="http://coding4ever.net/blog/2011/02/27/select-scope_identity-select-last_insert_id-dan-returning-pk/"/>
    <updated>2011-02-27T13:51:22+07:00</updated>
    <id>http://coding4ever.net/blog/2011/02/27/select-scope_identity-select-last_insert_id-dan-returning-pk</id>
    <content type="html"><![CDATA[<p>Yuph kali ini kita akan membahas fungsi menarik (SELECT SCOPE_IDENTITY(), SELECT LAST_INSERT_ID() dan RETURNING PK) yang dimiliki oleh database2x terkenal seperti SQL Server, MySQL dan Firebird.</p>

<p>Dari nama fungsinya kita bisa menebak kegunaan dari fungsi diatas yaitu untuk mendapatkan nilai ID terakhir (biasanya bertipe angka) yang diinputkan.</p>

<p>Saya dan mungkin Anda biasanya dalam merancang tabel untuk selalu menambahkan field ID dengan attribut IDENTITY/AUTONUMBER dan sekaligus dijadikan sebagai PRIMARY KEY.</p>

<p>Tentunya hal ini kita lakukan untuk mempermudah dalam proses manipulasi data (edit dan delete).</p>

<p>Contoh beberapa tabel yang biasanya menggunakan field ID untuk PRIMARY KEY dan sekaligus diset dengan attribut IDENTITY/AUTONUMBER</p>

<!-- more -->


<p><a href="http://coding4ever.files.wordpress.com/2011/02/table1.png"><img src="http://coding4ever.files.wordpress.com/2011/02/table1.png?w=300" alt="" /></a></p>

<p>Bagi yang males membaca referensi (termasuk sy :D) biasa menuliskan kode berikut untuk mengINSERTkan dan mendapatkan nilai ID yang terakhir, kita ambil contoh tabel provinsi.</p>

<p>{% codeblock lang:vbnet %}
Private Sub btnInsert_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles btnInsert.Click
    Dim lastID As Long = 0</p>

<pre><code>' langkah 1 - menambahkan data
strSql = "INSERT INTO provinsi (keterangan) VALUES (@1)"
Using cmd As New SqlClient.SqlCommand(strSql, conn)
    With cmd
        .Parameters.Clear()
        .Parameters.AddWithValue("@1", "Riau")

        .ExecuteNonQuery()
    End With
End Using

' langkah 2 - mengambil id terakhir dg memanfaatkan fungsi MAX
strSql = "SELECT MAX(id) FROM provinsi"
Using cmd As New SqlClient.SqlCommand(strSql, conn)
    lastID = Convert.ToInt32(cmd.ExecuteScalar())
End Using

' tampilkan ID terakhir
MessageBox.Show("Last ID : " &amp; lastID.ToString())
</code></pre>

<p>End Sub
{% endcodeblock %}</p>

<p>Sekarang kita lihat bedanya jika memanfaatkan fungsi SELECT SCOPE_IDENTITY().</p>

<p>{% codeblock lang:vbnet %}
Private Sub btnInsert_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles btnInsert.Click
    Dim lastID As Long = 0</p>

<pre><code>strSql = "INSERT INTO provinsi (keterangan) VALUES (@1) SELECT SCOPE_IDENTITY()" ' ada tambahan SELECT SCOPE_IDENTITY()
Using cmd As New SqlClient.SqlCommand(strSql, conn)
    With cmd
        .Parameters.Clear()
        .Parameters.AddWithValue("@1", "Riau")

        lastID = Convert.ToInt32(.ExecuteScalar())
    End With
End Using

MessageBox.Show ("Last ID : " &amp; lastID.ToString())
</code></pre>

<p>End Sub
{% endcodeblock %}</p>

<p>Gimana lebih simple kan ? :)</p>

<p>Oke sekarang kita lihat kode untuk MySQL(SELECT LAST_INSERT_ID) dan Firebird (RETURN KOLOM_PK).</p>

<p>{% codeblock lang:vbnet %}
&lsquo; MySQL
Private Sub btnInsert_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles btnInsert.Click
    Dim lastID As Long = 0</p>

<pre><code>strSql = "INSERT INTO provinsi (keterangan) VALUES (@1); SELECT LAST_INSERT_ID()"
Using cmd As New MySqlClient.MySqlCommand(strSql, conn)
    With cmd
        .Parameters.Clear()
        .Parameters.AddWithValue("@1", "Riau")

        lastID = Convert.ToInt32(.ExecuteScalar())
    End With
End Using

MessageBox.Show ("Last ID : " &amp; lastID.ToString())
</code></pre>

<p>End Sub</p>

<p>&lsquo; Firebird
Private Sub btnInsert_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles btnInsert.Click
    Dim lastID As Long = 0</p>

<pre><code>strSql = "INSERT INTO provinsi (keterangan) VALUES (@1) RETURNING ID" ' ID -&gt; kolom primary key
Using cmd As New FirebirdClient.FbCommand(strSql, conn)
    With cmd
        .Parameters.Clear()
        .Parameters.AddWithValue("@1", "Riau")

        lastID = Convert.ToInt32(.ExecuteScalar())
    End With
End Using

MessageBox.Show ("Last ID : " &amp; lastID.ToString())
</code></pre>

<p>End Sub
{% endcodeblock %}</p>

<p>Untuk bisa mengakses database MySQL dan Firebird di Visual Basic .NET kita harus menginstall <a href="http://dev.mysql.com/downloads/connector/net/">MySQL Connector/Net</a> dan <a href="http://firebirdsql.org/index.php?op=files&amp;id=netprovider">Firebird ADO.NET Data Provider</a>.</p>

<p>Selamat mencoba :)</p>
]]></content>
  </entry>
  
</feed>
