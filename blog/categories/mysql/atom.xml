<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Category: Mysql | Coding4ever's Blog]]></title>
  <link href="http://coding4ever.net/blog/categories/mysql/atom.xml" rel="self"/>
  <link href="http://coding4ever.net/"/>
  <updated>2015-07-11T09:12:48+07:00</updated>
  <id>http://coding4ever.net/</id>
  <author>
    <name><![CDATA[Admin]]></name>
    
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[Membuat Jadwal Backup Database Otomatis]]></title>
    <link href="http://coding4ever.net/blog/2015/04/30/membuat-jadwal-backup-database-otomatis/"/>
    <updated>2015-04-30T15:33:59+07:00</updated>
    <id>http://coding4ever.net/blog/2015/04/30/membuat-jadwal-backup-database-otomatis</id>
    <content type="html"><![CDATA[<p><img class="left <a" src="href="https://coding4ever.files.wordpress.com/2015/04/300415-14.png">https://coding4ever.files.wordpress.com/2015/04/300415-14.png</a>&#8221; width=&#8221;100&#8221; height=&#8221;100&#8221;>Backup database merupakan salah satu hal penting, apalagi jika kita bekerja sebagai database administrator.</p>

<p>Semakin banyaknya data-data yang tersimpan seperti data keuangan, akademik dan data penting lainnya mengharuskan kita untuk meluangkan waktu khusus untuk melakukan backup database.</p>

<p>Backup secara manual tentu saja tidak disarankan, apalagi jika datanya sudah banyak, tentu saja sedikit banyaknya akan menyita waktu kita untuk melakukan hal penting lainnya.</p>

<!-- more -->


<p>Salah satu keuntungan menggunakan backup otomatis adalah, kita bisa mengset jadwal backup diluar jam-jam kantor. Misal jam 5 sore, jam 12 malam atau jam lainnya sesuai dengan kebutuhan.</p>

<h3>Database MySQL</h3>

<p>Adapun database yang kita gunakan untuk simulasi backup otomatis ini adalah database MySQL. Untuk membackup database MySQL kita bisa gunakan tool bawaan MySQL yaitu <code>mysqldump</code>.</p>

<p>Adapun perintahnya seperti berikut :</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>&lsquo; backup
</span><span class='line'>mysqldump -uUSER_NAME -pUSER_PASSWORD &ndash;routines NAMA_DATABASE > LOKASI_FILE_BACKUP.SQL</span></code></pre></td></tr></table></div></figure></p>

<p>Parameter <code>â€“routines</code> ditambahkan jika database mempunyai fungsi/trigger.</p>

<p>Karena data backupnya yang disimpan lebih dari satu, untuk nama database akan kita buat unik dengan format : <code>nama_database-tahun-bulan-hari_jam_menit</code>. Contoh :</p>

<p><img class="center <a" src="href="https://coding4ever.files.wordpress.com/2015/04/300415-01.png">https://coding4ever.files.wordpress.com/2015/04/300415-01.png</a>&#8221;></p>

<p>Untuk mendapatkan informasi tahun, bulan, hari dan jam, kita bisa memanfaatkan batch command dengan perintah seperti berikut :</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>for /f &ldquo;tokens=2-4 delims=/ &rdquo; %%a in (&lsquo;date /T&rsquo;) do set year=%%c
</span><span class='line'>for /f &ldquo;tokens=2-4 delims=/ &rdquo; %%a in (&lsquo;date /T&rsquo;) do set month=%%a
</span><span class='line'>for /f &ldquo;tokens=2-4 delims=/ &rdquo; %%a in (&lsquo;date /T&rsquo;) do set day=%%b&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;p>for /f &ldquo;tokens=1 delims=: &rdquo; %%h in (&lsquo;time /T&rsquo;) do set hour=%%h
</span><span class='line'>for /f &ldquo;tokens=2 delims=: &rdquo; %%m in (&lsquo;time /T&rsquo;) do set minutes=%%m
</span><span class='line'>for /f &ldquo;tokens=3 delims=: &rdquo; %%a in (&lsquo;time /T&rsquo;) do set ampm=%%a&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;p>rem membuat file backup database dengan format nama_database-tahun-bulan-hari_jam_menit
</span><span class='line'>set FILE_BACKUP=D:\backup\Chinook-%year%-%month%-%day%_%hour%-%minutes%-%ampm%&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;p>rem USER_NAME, USER_PASSWORD dan NAMA_DATABASE menyesuaikan
</span><span class='line'>mysqldump -uroot -prahasia &ndash;routines Chinook > %FILE_BACKUP%.sql</span></code></pre></td></tr></table></div></figure></p>

<p>Setelah itu kode di atas kita simpan di folder <code>Instalasi MySQL\bin</code>, misal dengan nama <code>backup.cmd</code>.</p>

<p><img class="center <a" src="href="https://coding4ever.files.wordpress.com/2015/04/300415-02.png">https://coding4ever.files.wordpress.com/2015/04/300415-02.png</a>&#8221;></p>

<h3>Windows Task Scheduler</h3>

<p>Agar file <code>backup.cmd</code> ini bisa dijalankan secara berulang-ulang dan otomatis, kita bisa memanfaatkan tool yang sudah tersedia di Windows yaitu <code>Windows Task Scheduler</code>.</p>

<p>Untuk mengakses tool ini bisa dilakukan melalui menu Start -> Accessories -> System Tools -> Task Scheduler</p>

<p><img class="center <a" src="href="https://coding4ever.files.wordpress.com/2015/04/300415-03.png">https://coding4ever.files.wordpress.com/2015/04/300415-03.png</a>&#8221;></p>

<p>Berikut langkah-langkah untuk menambahkan task baru.</p>

<ol>
<li><p>Klik <code>Create Basic Task</code> di panel Actions
<img class="center <a" src="href="https://coding4ever.files.wordpress.com/2015/04/300415-04.png">https://coding4ever.files.wordpress.com/2015/04/300415-04.png</a>&#8221;>
Kemudian isikan informasi <code>Name</code> dan <code>Description</code> kemudian klik tombol Next</p>

<p><img class="center <a" src="href="https://coding4ever.files.wordpress.com/2015/04/300415-05.png">https://coding4ever.files.wordpress.com/2015/04/300415-05.png</a>&#8221;></p></li>
<li><p>Di dialog berikutnya kita akan menentukan kapan task ini akan di eksekusi. Contoh jika task ini akan dieksekusi setiap hari kita pilih <code>Daily</code>.</p>

<p><img class="center <a" src="href="https://coding4ever.files.wordpress.com/2015/04/300415-06.png">https://coding4ever.files.wordpress.com/2015/04/300415-06.png</a>&#8221;></p></li>
<li><p>Berikutnya kita akan menentukan jam berapa task ini akan dieksekusi</p>

<p><img class="center <a" src="href="https://coding4ever.files.wordpress.com/2015/04/300415-07.png">https://coding4ever.files.wordpress.com/2015/04/300415-07.png</a>&#8221;>
Pada gambar di atas, task ini akan dieksekusi setiap jam 5 sore.</p></li>
<li><p>Berikutnya kita akan menentukan apa yang akan dilakukan task ini, ketika dieksekusi. Sebagai contoh task ini akan menjalankan file <code>backup.cmd</code> yang tersimpan di folder bin MySQL</p>

<p><img class="center <a" src="href="https://coding4ever.files.wordpress.com/2015/04/300415-08.png">https://coding4ever.files.wordpress.com/2015/04/300415-08.png</a>&#8221;>
<img class="center <a" src="href="https://coding4ever.files.wordpress.com/2015/04/300415-09.png">https://coding4ever.files.wordpress.com/2015/04/300415-09.png</a>&#8221;>
Di bagian <code>Program/script</code> kita tentukan nama file <code>backup.cmd</code>, sedangkan untuk <code>Start in</code> kita tentukan lokasi/folder file <code>backup.cmd</code></p></li>
<li>Terakhir klik tombol Finish</li>
</ol>


<p><img class="center <a" src="href="https://coding4ever.files.wordpress.com/2015/04/300415-10.png">https://coding4ever.files.wordpress.com/2015/04/300415-10.png</a>&#8221;></p>

<p><img class="center <a" src="href="https://coding4ever.files.wordpress.com/2015/04/300415-11.png">https://coding4ever.files.wordpress.com/2015/04/300415-11.png</a>&#8221;></p>

<p>Untuk mencoba apakah backup berjalan dengan baik, klik kanan nama task <code>Backup Database Chinook</code> -> Run</p>

<p><img class="center <a" src="href="https://coding4ever.files.wordpress.com/2015/04/300415-12.png">https://coding4ever.files.wordpress.com/2015/04/300415-12.png</a>&#8221;></p>

<p><img class="center <a" src="href="https://coding4ever.files.wordpress.com/2015/04/300415-13.png">https://coding4ever.files.wordpress.com/2015/04/300415-13.png</a>&#8221;></p>

<p>Selamat MENCOBA :)</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Mengakses Database MySQL Menggunakan C# Bagian 2]]></title>
    <link href="http://coding4ever.net/blog/2011/06/26/mengakses-database-mysql-menggunakan-c-bagian-2/"/>
    <updated>2011-06-26T11:04:42+07:00</updated>
    <id>http://coding4ever.net/blog/2011/06/26/mengakses-database-mysql-menggunakan-c-bagian-2</id>
    <content type="html"><![CDATA[<p>Seperti yang sudah saya janjikan pada <a href="/blog/2011/06/25/mengakses-database-mysql-menggunakan-c-bagian-1/">postingan</a> sebelumnya, kali ini kita akan membahas bagaimana cara memanfaatkan class Mahasiswa dan MahasiswaDao pada Presentation layer</p>

<p>Sudah merupakan rahasia umum :D untuk melakukan koneksi ke database MySQL kita membutuhkan string koneksi berikut :</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>SERVER=nama_server;DATABASE=nama_database;UID=user_database;PASSWORD=user_password</span></code></pre></td></tr></table></div></figure></p>

<!-- more -->


<p>Terlihat dengan jelas ada beberapa informasi yang tentunya tidak ingin kita hardcode di program, kita ambil contoh informasi <strong>nama_server</strong> dan <strong>nama_database</strong>.</p>

<p>Kalo dulu mungkin kita biasanya meyimpan informasi tersebut di registry windows atau file dengan format <a href="/blog/2010/04/23/contoh-sederhana-memanipulasi-ini-file-untuk-menyimpan-informasi/">INI</a>, tapi kali ini kita akan memanfaatkan file XML yang sudah disediakan .NET</p>

<p>Bagaimana cara menambahkan file XML tersebut ikuti langkah-langkah berikut :</p>

<p><a href="http://coding4ever.files.wordpress.com/2011/06/26062011-1.png"><img src="http://coding4ever.files.wordpress.com/2011/06/26062011-1.png?w=300" alt="" /></a></p>

<p><a href="http://coding4ever.files.wordpress.com/2011/06/26062011-2.png"><img src="http://coding4ever.files.wordpress.com/2011/06/26062011-2.png?w=300" alt="" /></a></p>

<p><a href="http://coding4ever.files.wordpress.com/2011/06/26062011-3.png"><img src="http://coding4ever.files.wordpress.com/2011/06/26062011-3.png?w=300" alt="" /></a></p>

<p>kemudian kita lengkapi kodenya seperti berikut :</p>

<p><a href="http://coding4ever.files.wordpress.com/2011/06/26062011-4.png"><img src="http://coding4ever.files.wordpress.com/2011/06/26062011-4.png?w=300" alt="" /></a></p>

<p>gampang bukan ??? :)</p>

<p>Cara mengakses informasi pada file XML tersebut akan kita bahas pada saat pembuat class DBConnection.</p>

<p>Class DBConnection dari namanya kita sudah ngerti kalo class ini tugasnya untuk melakukan koneksi ke database dalam hal ini database MySQL.</p>

<p>Oke langsung saja kita tambahkan class baru.</p>

<p><a href="http://coding4ever.files.wordpress.com/2011/06/26062011-5.png"><img src="http://coding4ever.files.wordpress.com/2011/06/26062011-5.png?w=300" alt="" /></a></p>

<p><a href="http://coding4ever.files.wordpress.com/2011/06/26062011-6.png"><img src="http://coding4ever.files.wordpress.com/2011/06/26062011-6.png?w=300" alt="" /></a></p>

<p><a href="http://coding4ever.files.wordpress.com/2011/06/26062011-7.png"><img src="http://coding4ever.files.wordpress.com/2011/06/26062011-7.png?w=300" alt="" /></a></p>

<p>Namespace (package kalo istilah javanya) <strong>MySql.Data.MySqlClient</strong> kita butuhkan untuk bisa menggunakan class-class akses database MySQL.</p>

<p>Sedangkan namespace <strong>System.Configuration</strong> dibutuhkan agar kita bisa menggunakan classÂ ConfigurationSettings untuk mengakses file XML yang sudah kita buat pada langkah-langkah sebelumnya.</p>

<p>Berikut adalah kode lengkap class DBConnectionnya :</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
</pre></td><td class='code'><pre><code class='c#'><span class='line'><span class="k">using</span> <span class="nn">MySql.Data.MySqlClient</span><span class="p">;</span>
</span><span class='line'><span class="k">using</span> <span class="nn">System.Configuration</span><span class="p">;&lt;/</span><span class="n">p</span><span class="p">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="p">&lt;</span><span class="n">p</span><span class="p">&gt;</span><span class="k">namespace</span> <span class="nn">DemoDAO</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'>    <span class="k">public</span> <span class="k">class</span> <span class="nc">DBConnection</span>
</span><span class='line'>    <span class="p">{&lt;/</span><span class="n">p</span><span class="p">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="p">&lt;</span><span class="n">pre</span><span class="p">&gt;&lt;</span><span class="n">code</span><span class="p">&gt;</span>    <span class="k">private</span> <span class="n">MySqlConnection</span> <span class="n">conn</span> <span class="p">=</span> <span class="k">null</span><span class="p">;</span>
</span><span class='line'>    <span class="k">private</span> <span class="k">static</span> <span class="n">DBConnection</span> <span class="n">dbConn</span> <span class="p">=</span> <span class="k">null</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'>    <span class="c1">// constructor</span>
</span><span class='line'>    <span class="k">private</span> <span class="nf">DBConnection</span><span class="p">()</span>
</span><span class='line'>    <span class="p">{</span>
</span><span class='line'>        <span class="k">if</span> <span class="p">(</span><span class="n">conn</span> <span class="p">==</span> <span class="k">null</span><span class="p">)</span>
</span><span class='line'>        <span class="p">{</span>
</span><span class='line'>            <span class="c1">// cara membaca informasi yang ada pada file XML (App.config)</span>
</span><span class='line'>            <span class="kt">string</span> <span class="n">server</span> <span class="p">=</span> <span class="n">ConfigurationSettings</span><span class="p">.</span><span class="n">AppSettings</span><span class="p">[</span><span class="s">&quot;Server&quot;</span><span class="p">];</span>
</span><span class='line'>            <span class="kt">string</span> <span class="n">database</span> <span class="p">=</span> <span class="n">ConfigurationSettings</span><span class="p">.</span><span class="n">AppSettings</span><span class="p">[</span><span class="s">&quot;Database&quot;</span><span class="p">];</span>
</span><span class='line'>
</span><span class='line'>            <span class="kt">string</span> <span class="n">user</span> <span class="p">=</span> <span class="s">&quot;root&quot;</span><span class="p">;</span>
</span><span class='line'>            <span class="kt">string</span> <span class="n">password</span> <span class="p">=</span> <span class="s">&quot;rahasia&quot;</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'>            <span class="kt">string</span> <span class="n">strConn</span> <span class="p">=</span> <span class="s">&quot;SERVER=&quot;</span> <span class="p">+</span> <span class="n">server</span> <span class="p">+</span> <span class="s">&quot;;DATABASE=&quot;</span> <span class="p">+</span> <span class="n">database</span> <span class="p">+</span> <span class="s">&quot;;UID=&quot;</span> <span class="p">+</span> <span class="n">user</span> <span class="p">+</span> <span class="s">&quot;;PASSWORD=&quot;</span> <span class="p">+</span> <span class="n">password</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'>            <span class="n">conn</span> <span class="p">=</span> <span class="k">new</span> <span class="n">MySqlConnection</span><span class="p">(</span><span class="n">strConn</span><span class="p">);</span>
</span><span class='line'>            <span class="n">conn</span><span class="p">.</span><span class="n">Open</span><span class="p">();</span>
</span><span class='line'>        <span class="p">}</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">public</span> <span class="k">static</span> <span class="n">DBConnection</span> <span class="nf">GetInstance</span><span class="p">()</span>
</span><span class='line'>    <span class="p">{</span>
</span><span class='line'>        <span class="k">if</span> <span class="p">(</span><span class="n">dbConn</span> <span class="p">==</span> <span class="k">null</span><span class="p">)</span> <span class="p">{</span> <span class="n">dbConn</span> <span class="p">=</span> <span class="k">new</span> <span class="n">DBConnection</span><span class="p">();</span> <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>        <span class="k">return</span> <span class="n">dbConn</span><span class="p">;</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">public</span> <span class="n">MySqlConnection</span> <span class="nf">GetConnection</span><span class="p">()</span>
</span><span class='line'>    <span class="p">{</span>
</span><span class='line'>        <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="n">conn</span><span class="p">;</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'><span class="p">&lt;/</span><span class="n">code</span><span class="p">&gt;&lt;/</span><span class="n">pre</span><span class="p">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="p">&lt;</span><span class="n">p</span><span class="p">&gt;}</span>
</span></code></pre></td></tr></table></div></figure></p>

<p>Sampai disini semua persiapan sudah oke, saatnya kita melengkapi kode program untuk Presentation layer dan untuk merefresh ingatan kita saya tampilkan kembali form mahasiswa yang sudah kita rancang pada <a href="/blog/2011/06/25/mengakses-database-mysql-menggunakan-c-bagian-1/">postingan</a> sebelumnya.</p>

<p><a href="http://coding4ever.files.wordpress.com/2011/06/25062011-31.png"><img src="http://coding4ever.files.wordpress.com/2011/06/25062011-31.png?w=300" alt="" /></a></p>

<p>Aktifkan terlebih dulu FrmMahasiswanya kemudian masuk kebagian editor codenya setelah itu tambahkan kode berikut :</p>

<p><a href="http://coding4ever.files.wordpress.com/2011/06/26062011-8.png"><img src="http://coding4ever.files.wordpress.com/2011/06/26062011-8.png?w=300" alt="" /></a></p>

<p>Namespace DemoDAO.Model danÂ DemoDAO.Dao dibutuhkan agar bisa mengakses class Mahasiswa dan MahasiswaDao.</p>

<p><strong>1. Menyimpan Data</strong></p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
</pre></td><td class='code'><pre><code class='c#'><span class='line'><span class="k">private</span> <span class="k">void</span> <span class="nf">btnSimpan_Click</span><span class="p">(</span><span class="kt">object</span> <span class="n">sender</span><span class="p">,</span> <span class="n">EventArgs</span> <span class="n">e</span><span class="p">)</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'>    <span class="c1">// buat objek mhs</span>
</span><span class='line'>    <span class="n">Mahasiswa</span> <span class="n">mhs</span> <span class="p">=</span> <span class="k">new</span> <span class="n">Mahasiswa</span><span class="p">();&lt;/</span><span class="n">p</span><span class="p">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="p">&lt;</span><span class="n">pre</span><span class="p">&gt;&lt;</span><span class="n">code</span><span class="p">&gt;</span><span class="c1">// isi nilai masing-masing property</span>
</span><span class='line'><span class="n">mhs</span><span class="p">.</span><span class="n">NomorMahasiswa</span> <span class="p">=</span> <span class="n">txtNomorMahasiswa</span><span class="p">.</span><span class="n">Text</span><span class="p">;</span>
</span><span class='line'><span class="n">mhs</span><span class="p">.</span><span class="n">Nama</span> <span class="p">=</span> <span class="n">txtNama</span><span class="p">.</span><span class="n">Text</span><span class="p">;</span>
</span><span class='line'><span class="n">mhs</span><span class="p">.</span><span class="n">Alamat</span> <span class="p">=</span> <span class="n">txtAlamat</span><span class="p">.</span><span class="n">Text</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'><span class="n">result</span> <span class="p">=</span> <span class="n">mhsDao</span><span class="p">.</span><span class="n">Save</span><span class="p">(</span><span class="n">mhs</span><span class="p">);</span> <span class="c1">// panggil method Save</span>
</span><span class='line'><span class="k">if</span> <span class="p">(</span><span class="n">result</span> <span class="p">&amp;</span><span class="n">gt</span><span class="p">;</span> <span class="m">0</span><span class="p">)</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'>    <span class="n">MsgInfo</span><span class="p">(</span><span class="s">&quot;Data sudah disimpan&quot;</span><span class="p">);</span>
</span><span class='line'>    <span class="n">KosongkanInputan</span><span class="p">();</span>
</span><span class='line'>
</span><span class='line'>    <span class="n">txtNomorMahasiswa</span><span class="p">.</span><span class="n">Focus</span><span class="p">();</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'><span class="k">else</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'>    <span class="n">MsgInfo</span><span class="p">(</span><span class="s">&quot;Data gagal disimpan&quot;</span><span class="p">);</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'><span class="p">&lt;/</span><span class="n">code</span><span class="p">&gt;&lt;/</span><span class="n">pre</span><span class="p">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="p">&lt;</span><span class="n">p</span><span class="p">&gt;}</span>
</span></code></pre></td></tr></table></div></figure></p>

<p><strong>2. Mengupdate Data</strong></p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
</pre></td><td class='code'><pre><code class='c#'><span class='line'><span class="k">private</span> <span class="k">void</span> <span class="nf">btnPerbaiki_Click</span><span class="p">(</span><span class="kt">object</span> <span class="n">sender</span><span class="p">,</span> <span class="n">EventArgs</span> <span class="n">e</span><span class="p">)</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'>    <span class="c1">// buat objek mhs</span>
</span><span class='line'>    <span class="n">Mahasiswa</span> <span class="n">mhs</span> <span class="p">=</span> <span class="k">new</span> <span class="n">Mahasiswa</span><span class="p">();&lt;/</span><span class="n">p</span><span class="p">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="p">&lt;</span><span class="n">pre</span><span class="p">&gt;&lt;</span><span class="n">code</span><span class="p">&gt;</span><span class="c1">// isi nilai masing-masing property</span>
</span><span class='line'><span class="n">mhs</span><span class="p">.</span><span class="n">NomorMahasiswa</span> <span class="p">=</span> <span class="n">txtNomorMahasiswa</span><span class="p">.</span><span class="n">Text</span><span class="p">;</span>
</span><span class='line'><span class="n">mhs</span><span class="p">.</span><span class="n">Nama</span> <span class="p">=</span> <span class="n">txtNama</span><span class="p">.</span><span class="n">Text</span><span class="p">;</span>
</span><span class='line'><span class="n">mhs</span><span class="p">.</span><span class="n">Alamat</span> <span class="p">=</span> <span class="n">txtAlamat</span><span class="p">.</span><span class="n">Text</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'><span class="n">result</span> <span class="p">=</span> <span class="n">mhsDao</span><span class="p">.</span><span class="n">Update</span><span class="p">(</span><span class="n">mhs</span><span class="p">);</span> <span class="c1">// panggil method Update</span>
</span><span class='line'><span class="k">if</span> <span class="p">(</span><span class="n">result</span> <span class="p">&amp;</span><span class="n">gt</span><span class="p">;</span> <span class="m">0</span><span class="p">)</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'>    <span class="n">MsgInfo</span><span class="p">(</span><span class="s">&quot;Data sudah disimpan&quot;</span><span class="p">);</span>
</span><span class='line'>    <span class="n">KosongkanInputan</span><span class="p">();</span>
</span><span class='line'>
</span><span class='line'>    <span class="n">txtNomorMahasiswa</span><span class="p">.</span><span class="n">Focus</span><span class="p">();</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'><span class="k">else</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'>    <span class="n">MsgInfo</span><span class="p">(</span><span class="s">&quot;Data gagal disimpan&quot;</span><span class="p">);</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'><span class="p">&lt;/</span><span class="n">code</span><span class="p">&gt;&lt;/</span><span class="n">pre</span><span class="p">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="p">&lt;</span><span class="n">p</span><span class="p">&gt;}</span>
</span></code></pre></td></tr></table></div></figure></p>

<p><strong>3. Menghapus Data</strong></p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
</pre></td><td class='code'><pre><code class='c#'><span class='line'><span class="k">private</span> <span class="k">void</span> <span class="nf">btnHapus_Click</span><span class="p">(</span><span class="kt">object</span> <span class="n">sender</span><span class="p">,</span> <span class="n">EventArgs</span> <span class="n">e</span><span class="p">)</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'>    <span class="n">result</span> <span class="p">=</span> <span class="n">mhsDao</span><span class="p">.</span><span class="n">Delete</span><span class="p">(</span><span class="n">txtNomorMahasiswa</span><span class="p">.</span><span class="n">Text</span><span class="p">);</span> <span class="c1">// panggil method Delete</span>
</span><span class='line'>    <span class="k">if</span> <span class="p">(</span><span class="n">result</span> <span class="p">&gt;</span> <span class="m">0</span><span class="p">)</span>
</span><span class='line'>    <span class="p">{</span>
</span><span class='line'>        <span class="n">MsgInfo</span><span class="p">(&amp;</span><span class="n">ldquo</span><span class="p">;</span><span class="n">Data</span> <span class="n">sudah</span> <span class="n">dihapus</span><span class="p">&amp;</span><span class="n">rdquo</span><span class="p">;);</span>
</span><span class='line'>        <span class="n">KosongkanInputan</span><span class="p">();&lt;/</span><span class="n">p</span><span class="p">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="p">&lt;</span><span class="n">pre</span><span class="p">&gt;&lt;</span><span class="n">code</span><span class="p">&gt;</span>    <span class="n">txtNomorMahasiswa</span><span class="p">.</span><span class="n">Focus</span><span class="p">();</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'><span class="k">else</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'>    <span class="n">MsgInfo</span><span class="p">(</span><span class="s">&quot;Data gagal dihapus&quot;</span><span class="p">);</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'><span class="p">&lt;/</span><span class="n">code</span><span class="p">&gt;&lt;/</span><span class="n">pre</span><span class="p">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="p">&lt;</span><span class="n">p</span><span class="p">&gt;}</span>
</span></code></pre></td></tr></table></div></figure></p>

<p><strong>4. Menampilkan data</strong></p>

<p>Untuk menampilkan data kita membutuhkan 2 methode yaitu <strong>FillToListView</strong> untuk menambahkan objek mahasiswa ke ListView dan <strong>LoadDataMahasiswa</strong> untuk mengambil data mahasiswa dari database dan menyimpannya ke objek mahasiswa.</p>

<p>Karena data mahasiswa yang ditampilkan bisa lebih dari satu disini kita bisa menggunakan class List untuk menampung objeknya.</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
</pre></td><td class='code'><pre><code class='c#'><span class='line'><span class="k">private</span> <span class="k">void</span> <span class="nf">FillToListView</span><span class="p">(</span><span class="n">Mahasiswa</span> <span class="n">mhs</span><span class="p">)</span>
</span><span class='line'><span class="p">{&lt;/</span><span class="n">p</span><span class="p">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="p">&lt;</span><span class="n">pre</span><span class="p">&gt;&lt;</span><span class="n">code</span><span class="p">&gt;</span><span class="kt">int</span> <span class="n">noUrut</span> <span class="p">=</span> <span class="n">lvwMahasiswa</span><span class="p">.</span><span class="n">Items</span><span class="p">.</span><span class="n">Count</span> <span class="p">+</span> <span class="m">1</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'><span class="n">ListViewItem</span> <span class="n">item</span> <span class="p">=</span> <span class="k">new</span> <span class="n">ListViewItem</span><span class="p">(</span><span class="n">noUrut</span><span class="p">.</span><span class="n">ToString</span><span class="p">());</span>
</span><span class='line'>
</span><span class='line'><span class="n">item</span><span class="p">.</span><span class="n">SubItems</span><span class="p">.</span><span class="n">Add</span><span class="p">(</span><span class="n">mhs</span><span class="p">.</span><span class="n">NomorMahasiswa</span><span class="p">);</span>
</span><span class='line'><span class="n">item</span><span class="p">.</span><span class="n">SubItems</span><span class="p">.</span><span class="n">Add</span><span class="p">(</span><span class="n">mhs</span><span class="p">.</span><span class="n">Nama</span><span class="p">);</span>
</span><span class='line'><span class="n">item</span><span class="p">.</span><span class="n">SubItems</span><span class="p">.</span><span class="n">Add</span><span class="p">(</span><span class="n">mhs</span><span class="p">.</span><span class="n">Alamat</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'><span class="n">lvwMahasiswa</span><span class="p">.</span><span class="n">Items</span><span class="p">.</span><span class="n">Add</span><span class="p">(</span><span class="n">item</span><span class="p">);</span>
</span><span class='line'><span class="p">&lt;/</span><span class="n">code</span><span class="p">&gt;&lt;/</span><span class="n">pre</span><span class="p">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="p">&lt;</span><span class="n">p</span><span class="p">&gt;}&lt;/</span><span class="n">p</span><span class="p">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="p">&lt;</span><span class="n">p</span><span class="p">&gt;</span><span class="k">private</span> <span class="k">void</span> <span class="n">LoadDataMahasiswa</span><span class="p">()</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'>    <span class="n">lvwMahasiswa</span><span class="p">.</span><span class="n">Items</span><span class="p">.</span><span class="n">Clear</span><span class="p">();&lt;/</span><span class="n">p</span><span class="p">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="p">&lt;</span><span class="n">pre</span><span class="p">&gt;&lt;</span><span class="n">code</span><span class="p">&gt;</span><span class="n">List</span><span class="p">&amp;</span><span class="n">lt</span><span class="p">;</span><span class="n">Mahasiswa</span><span class="p">&amp;</span><span class="n">gt</span><span class="p">;</span> <span class="n">daftarMhs</span> <span class="p">=</span> <span class="n">mhsDao</span><span class="p">.</span><span class="n">GetAll</span><span class="p">();</span>
</span><span class='line'><span class="k">foreach</span> <span class="p">(</span><span class="n">Mahasiswa</span> <span class="n">mhs</span> <span class="k">in</span> <span class="n">daftarMhs</span><span class="p">)</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'>    <span class="n">FillToListView</span><span class="p">(</span><span class="n">mhs</span><span class="p">);</span> <span class="c1">// panggil method FillToListView</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'><span class="p">&lt;/</span><span class="n">code</span><span class="p">&gt;&lt;/</span><span class="n">pre</span><span class="p">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="p">&lt;</span><span class="n">p</span><span class="p">&gt;}</span>
</span></code></pre></td></tr></table></div></figure></p>

<p>Setelah itu tinggal panggil method LoadDataMahasiswa di constructorÂ FrmMahasiswa</p>

<p><a href="http://coding4ever.files.wordpress.com/2011/06/26062011-9.png"><img src="http://coding4ever.files.wordpress.com/2011/06/26062011-9.png?w=300" alt="" /></a></p>

<p><strong>5. Pencarian Data Berdasarkan Nama</strong></p>

<p>Untuk pencarian data kita tinggal mengoverload methodÂ  LoadDataMahasiswa dimana kita menambahkan parameter nama dengan tipe string, selain itu method MahasiswaDao yang kita panggil adalah GetByName</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
</pre></td><td class='code'><pre><code class='c#'><span class='line'><span class="k">private</span> <span class="k">void</span> <span class="nf">LoadDataMahasiswa</span><span class="p">(</span><span class="kt">string</span> <span class="n">nama</span><span class="p">)</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'>    <span class="n">lvwMahasiswa</span><span class="p">.</span><span class="n">Items</span><span class="p">.</span><span class="n">Clear</span><span class="p">();&lt;/</span><span class="n">p</span><span class="p">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="p">&lt;</span><span class="n">pre</span><span class="p">&gt;&lt;</span><span class="n">code</span><span class="p">&gt;</span><span class="n">List</span><span class="p">&amp;</span><span class="n">lt</span><span class="p">;</span><span class="n">Mahasiswa</span><span class="p">&amp;</span><span class="n">gt</span><span class="p">;</span> <span class="n">daftarMhs</span> <span class="p">=</span> <span class="n">mhsDao</span><span class="p">.</span><span class="n">GetByName</span><span class="p">(</span><span class="n">nama</span><span class="p">);</span>
</span><span class='line'><span class="k">foreach</span> <span class="p">(</span><span class="n">Mahasiswa</span> <span class="n">mhs</span> <span class="k">in</span> <span class="n">daftarMhs</span><span class="p">)</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'>    <span class="n">FillToListView</span><span class="p">(</span><span class="n">mhs</span><span class="p">);</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'><span class="p">&lt;/</span><span class="n">code</span><span class="p">&gt;&lt;/</span><span class="n">pre</span><span class="p">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="p">&lt;</span><span class="n">p</span><span class="p">&gt;}</span>
</span></code></pre></td></tr></table></div></figure></p>

<p>Selanjutnya tinggal dipanggil di eventÂ btnCari_Click</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='c#'><span class='line'><span class="k">private</span> <span class="k">void</span> <span class="nf">btnCari_Click</span><span class="p">(</span><span class="kt">object</span> <span class="n">sender</span><span class="p">,</span> <span class="n">EventArgs</span> <span class="n">e</span><span class="p">)</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'>    <span class="n">LoadDataMahasiswa</span><span class="p">(</span><span class="n">txtKeywordPencarian</span><span class="p">.</span><span class="n">Text</span><span class="p">);</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure></p>

<p>Sebagai bonus :) saya akan tambahkan satu lagi method untuk pencarian data berdasarkan nomor mahasiswa, untuk melakukan ini kita akan menambahkan method <strong>GetByNoMahasiswa</strong>, adapun kodenya sebgai berikut :</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
</pre></td><td class='code'><pre><code class='c#'><span class='line'><span class="k">public</span> <span class="n">Mahasiswa</span> <span class="nf">GetByNoMahasiswa</span><span class="p">(</span><span class="kt">string</span> <span class="n">nomorMahasiswa</span><span class="p">)</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'>    <span class="n">Mahasiswa</span> <span class="n">mhs</span> <span class="p">=</span> <span class="k">null</span><span class="p">;&lt;/</span><span class="n">p</span><span class="p">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="p">&lt;</span><span class="n">pre</span><span class="p">&gt;&lt;</span><span class="n">code</span><span class="p">&gt;</span><span class="n">strSql</span> <span class="p">=</span> <span class="s">&quot;SELECT nomor_mahasiswa, nama, alamat FROM mahasiswa &quot;</span> <span class="p">+</span>
</span><span class='line'>         <span class="s">&quot;WHERE nomor_mahasiswa = @1&quot;</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'><span class="k">using</span> <span class="p">(</span><span class="n">MySqlCommand</span> <span class="n">cmd</span> <span class="p">=</span> <span class="k">new</span> <span class="n">MySqlCommand</span><span class="p">(</span><span class="n">strSql</span><span class="p">,</span> <span class="n">conn</span><span class="p">))</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'>    <span class="n">cmd</span><span class="p">.</span><span class="n">Parameters</span><span class="p">.</span><span class="n">AddWithValue</span><span class="p">(</span><span class="s">&quot;@1&quot;</span><span class="p">,</span> <span class="n">nomorMahasiswa</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">using</span> <span class="p">(</span><span class="n">MySqlDataReader</span> <span class="n">dtr</span> <span class="p">=</span> <span class="n">cmd</span><span class="p">.</span><span class="n">ExecuteReader</span><span class="p">())</span>
</span><span class='line'>    <span class="p">{</span>
</span><span class='line'>        <span class="k">if</span> <span class="p">(</span><span class="n">dtr</span><span class="p">.</span><span class="n">Read</span><span class="p">())</span>
</span><span class='line'>        <span class="p">{</span>
</span><span class='line'>            <span class="n">mhs</span> <span class="p">=</span> <span class="n">MappingRowToObject</span><span class="p">(</span><span class="n">dtr</span><span class="p">);</span>
</span><span class='line'>        <span class="p">}</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="k">return</span> <span class="n">mhs</span><span class="p">;</span>
</span><span class='line'><span class="p">&lt;/</span><span class="n">code</span><span class="p">&gt;&lt;/</span><span class="n">pre</span><span class="p">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="p">&lt;</span><span class="n">p</span><span class="p">&gt;}</span>
</span></code></pre></td></tr></table></div></figure></p>

<p>Method tersebut ditambahkan di class MahasiswaDao, selain itu kita juga menambahkan satu button lagi di FrmMahasiswa untuk memanggil method tersebut.</p>

<p><a href="http://coding4ever.files.wordpress.com/2011/06/26062011-10.png"><img src="http://coding4ever.files.wordpress.com/2011/06/26062011-10.png?w=300" alt="" /></a></p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
</pre></td><td class='code'><pre><code class='c#'><span class='line'><span class="k">private</span> <span class="k">void</span> <span class="nf">btnCariByNoMhs_Click</span><span class="p">(</span><span class="kt">object</span> <span class="n">sender</span><span class="p">,</span> <span class="n">EventArgs</span> <span class="n">e</span><span class="p">)</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'>    <span class="n">Mahasiswa</span> <span class="n">mhs</span> <span class="p">=</span> <span class="n">mhsDao</span><span class="p">.</span><span class="n">GetByNoMahasiswa</span><span class="p">(</span><span class="n">txtNomorMahasiswa</span><span class="p">.</span><span class="n">Text</span><span class="p">);</span>
</span><span class='line'>    <span class="k">if</span> <span class="p">(</span><span class="n">mhs</span> <span class="p">!=</span> <span class="k">null</span><span class="p">)</span>
</span><span class='line'>    <span class="p">{</span>
</span><span class='line'>        <span class="n">txtNomorMahasiswa</span><span class="p">.</span><span class="n">Text</span> <span class="p">=</span> <span class="n">mhs</span><span class="p">.</span><span class="n">NomorMahasiswa</span><span class="p">;</span>
</span><span class='line'>        <span class="n">txtNama</span><span class="p">.</span><span class="n">Text</span> <span class="p">=</span> <span class="n">mhs</span><span class="p">.</span><span class="n">Nama</span><span class="p">;</span>
</span><span class='line'>        <span class="n">txtAlamat</span><span class="p">.</span><span class="n">Text</span> <span class="p">=</span> <span class="n">mhs</span><span class="p">.</span><span class="n">Alamat</span><span class="p">;&lt;/</span><span class="n">p</span><span class="p">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="p">&lt;</span><span class="n">pre</span><span class="p">&gt;&lt;</span><span class="n">code</span><span class="p">&gt;</span>    <span class="n">MsgInfo</span><span class="p">(</span><span class="s">&quot;Data mahasiswa ditemukan&quot;</span><span class="p">);</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'><span class="k">else</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'>    <span class="n">MsgInfo</span><span class="p">(</span><span class="s">&quot;Nomor mahasiswa tidak ditemukan&quot;</span><span class="p">);</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'><span class="p">&lt;/</span><span class="n">code</span><span class="p">&gt;&lt;/</span><span class="n">pre</span><span class="p">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="p">&lt;</span><span class="n">p</span><span class="p">&gt;}</span>
</span></code></pre></td></tr></table></div></figure></p>

<p>Akhirnya selesai juga, tapi mungkin saya butuh satu postingan lagi untuk menutup artikel berseri ini, insya Allah :).</p>

<p>Selamat <a href="http://www.4shared.com/file/MSyZd_nN/DemoDAO2.html">MENCOBA</a> :)</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Mengakses Database MySQL Menggunakan C# Bagian 1]]></title>
    <link href="http://coding4ever.net/blog/2011/06/25/mengakses-database-mysql-menggunakan-c-bagian-1/"/>
    <updated>2011-06-25T20:28:26+07:00</updated>
    <id>http://coding4ever.net/blog/2011/06/25/mengakses-database-mysql-menggunakan-c-bagian-1</id>
    <content type="html"><![CDATA[<p>Berhubung sudah mulai bosan bermain-main dengan Visual Basic 6 dan Visual Basic .NET kali ini kita akan menggunakan C# untuk mencoba membuat aplikasi sederhana mengakses database.</p>

<p>Database yang akan kita gunakan adalah MySQL versi 5.x dan untuk C# nya saya menggunakan versi .NET 2008.</p>

<p>Untuk menyederhanan postingan kali ini saya cukupkan dulu untuk mengakses 1 tabel yaitu tabel mahasiswa.</p>

<p>Adapun struktur tabelnya seperti berikut :</p>

<p><a href="http://coding4ever.files.wordpress.com/2011/06/25062011-0.png"><img src="http://coding4ever.files.wordpress.com/2011/06/25062011-0.png" alt="" /></a><!-- more --></p>

<p>Untuk akses database kali ini kita akan menggunakan konsep <a href="http://en.wikipedia.org/wiki/Data_access_object">DAO</a>, walaupun enggak 100% :D, dimana kita akan memisahkan modul program menjadi beberapa layer/lapisan yaitu :</p>

<ol>
<li><p> Presentation</p></li>
<li><p> Business Logic</p></li>
<li><p> Data Access</p></li>
</ol>


<p>Kok mirip <a href="http://en.wikipedia.org/wiki/Multitier_architecture">3-Tier Architecture</a> ya? :D</p>

<p>Untuk presentation layer berhubungan dengan UI (user interface) dalam artikel ini kita akan menggunakan Windows Form.</p>

<p>Business Logic biasanya berhubungannya dengan entity class dan entity class sendiri merupakan representasi tabel-tabel yang ada di database.</p>

<p>Terakhir Data Access yaitu bagian yang menangani urusan akses database.</p>

<p><strong>1. Memulai project baru</strong></p>

<p>Jalankan Visual Studio .NET kemudian aktifkan menu File -> New -> Project &hellip;</p>

<p><a href="http://coding4ever.files.wordpress.com/2011/06/25062011-1.png"><img src="http://coding4ever.files.wordpress.com/2011/06/25062011-1.png?w=300" alt="" /></a></p>

<p><a href="http://coding4ever.files.wordpress.com/2011/06/25062011-2.png"><img src="http://coding4ever.files.wordpress.com/2011/06/25062011-2.png?w=300" alt="" /></a></p>

<p><strong>2. Membuat Presentation Layer</strong></p>

<p>Presentation layer berhubungan dengan user interface atau tampilan, dan untuk tampilannya kita akan desain seperti berikut :</p>

<p><a href="http://coding4ever.files.wordpress.com/2011/06/25062011-31.png"><img src="http://coding4ever.files.wordpress.com/2011/06/25062011-31.png?w=300" alt="" /></a></p>

<p><strong>3. Membuat Business Logic</strong></p>

<p>Business Logic ada hubungannya dengan entity class yang merupakan representasi dari tabel-tabel yang ada didatabase.</p>

<p>Berdasarkan struktur tabel diatas kita akan menambahkan class baru dengan nama Mahasiswa yang memiliki tiga property yaitu NomorMahasiswa, Nama dan Alamat.</p>

<p>Jadi property ini sudah mewakili method mutator dan accessor yang sudah biasa kita kenal penggunakannya di Java.</p>

<p>Sebelum kita menambahkan class Mahasiswa kita tambahkan dulu folder untuk mengelompok ke tiga layer diatas, caranya dengan mengklik kan project -> Add -> New Folder</p>

<p><a href="http://coding4ever.files.wordpress.com/2011/06/25062011-4.png"><img src="http://coding4ever.files.wordpress.com/2011/06/25062011-4.png?w=300" alt="" /></a></p>

<p>kita akan menambahkan 3 folder yaitu Dao, Model dan View</p>

<p><a href="http://coding4ever.files.wordpress.com/2011/06/25062011-5.png"><img src="http://coding4ever.files.wordpress.com/2011/06/25062011-5.png?w=300" alt="" /></a></p>

<p>jika sudah kita klik kanan folder Model -> Add -> Class &hellip;</p>

<p><a href="http://coding4ever.files.wordpress.com/2011/06/25062011-6.png"><img src="http://coding4ever.files.wordpress.com/2011/06/25062011-6.png?w=300" alt="" /></a></p>

<p><a href="http://coding4ever.files.wordpress.com/2011/06/25062011-7.png"><img src="http://coding4ever.files.wordpress.com/2011/06/25062011-7.png?w=300" alt="" /></a></p>

<p><a href="http://coding4ever.files.wordpress.com/2011/06/25062011-8.png"><img src="http://coding4ever.files.wordpress.com/2011/06/25062011-8.png?w=300" alt="" /></a></p>

<p>pada gambar diatas tambahkan access modifier public agar class Mahasiswa bisa digunakan antar namespace (package kalo istilah javanya).</p>

<p>Oke sampai disini kita tinggal melengkapi kode untuk class Mahasiswa diatas, kode lengkapnya sebagai berikut :</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
</pre></td><td class='code'><pre><code class='c#'><span class='line'><span class="k">namespace</span> <span class="nn">DemoDAO.Model</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'>    <span class="k">public</span> <span class="k">class</span> <span class="nc">Mahasiswa</span>
</span><span class='line'>    <span class="p">{</span>
</span><span class='line'>        <span class="k">private</span> <span class="kt">string</span> <span class="n">nomorMahasiswa</span><span class="p">;</span>
</span><span class='line'>        <span class="k">public</span> <span class="kt">string</span> <span class="n">NomorMahasiswa</span>
</span><span class='line'>        <span class="p">{</span>
</span><span class='line'>            <span class="k">get</span> <span class="p">{</span> <span class="k">return</span> <span class="n">nomorMahasiswa</span><span class="p">;</span> <span class="p">}</span>
</span><span class='line'>            <span class="k">set</span> <span class="p">{</span> <span class="n">nomorMahasiswa</span> <span class="p">=</span> <span class="k">value</span><span class="p">;</span> <span class="p">}</span>
</span><span class='line'>        <span class="p">}&lt;/</span><span class="n">p</span><span class="p">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="p">&lt;</span><span class="n">pre</span><span class="p">&gt;&lt;</span><span class="n">code</span><span class="p">&gt;</span>    <span class="k">private</span> <span class="kt">string</span> <span class="n">nama</span><span class="p">;</span>
</span><span class='line'>    <span class="k">public</span> <span class="kt">string</span> <span class="n">Nama</span>
</span><span class='line'>    <span class="p">{</span>
</span><span class='line'>        <span class="k">get</span> <span class="p">{</span> <span class="k">return</span> <span class="n">nama</span><span class="p">;</span> <span class="p">}</span>
</span><span class='line'>        <span class="k">set</span> <span class="p">{</span> <span class="n">nama</span> <span class="p">=</span> <span class="k">value</span><span class="p">;</span> <span class="p">}</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">private</span> <span class="kt">string</span> <span class="n">alamat</span><span class="p">;</span>
</span><span class='line'>    <span class="k">public</span> <span class="kt">string</span> <span class="n">Alamat</span>
</span><span class='line'>    <span class="p">{</span>
</span><span class='line'>        <span class="k">get</span> <span class="p">{</span> <span class="k">return</span> <span class="n">alamat</span><span class="p">;</span> <span class="p">}</span>
</span><span class='line'>        <span class="k">set</span> <span class="p">{</span> <span class="n">alamat</span> <span class="p">=</span> <span class="k">value</span><span class="p">;</span> <span class="p">}</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'><span class="p">&lt;/</span><span class="n">code</span><span class="p">&gt;&lt;/</span><span class="n">pre</span><span class="p">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="p">&lt;</span><span class="n">p</span><span class="p">&gt;}</span>
</span></code></pre></td></tr></table></div></figure></p>

<p><strong>4. Membuat Data Access</strong></p>

<p>Lapisan ini biasanya berisi operasi CRUD (Create, Read, Update, Delete), tapi kita akan menggunakan istilah yang sedikit berbeda untuk nama operasinya yaitu :</p>

<ol>
<li><p> Save</p></li>
<li><p> Update</p></li>
<li><p> Delete</p></li>
<li><p> GetAll</p></li>
<li><p> GetByName</p></li>
</ol>


<p>Biasanya untuk penamaan classnya cukup menambahkan Akhiran (Suffixes) Dao untuk setiap class entitynya.</p>

<p>Contoh untuk class entity Mahasiswa, biasanya class Data Accessnya diberi nama MahasiswaDao.</p>

<p>Oke langsung aja kita klik kanan folder Dao -> Add -> Class &hellip;</p>

<p><a href="http://coding4ever.files.wordpress.com/2011/06/25062011-9.png"><img src="http://coding4ever.files.wordpress.com/2011/06/25062011-9.png?w=300" alt="" /></a></p>

<p><a href="http://coding4ever.files.wordpress.com/2011/06/25062011-10.png"><img src="http://coding4ever.files.wordpress.com/2011/06/25062011-10.png?w=300" alt="" /></a></p>

<p><a href="http://coding4ever.files.wordpress.com/2011/06/25062011-11.png"><img src="http://coding4ever.files.wordpress.com/2011/06/25062011-11.png?w=300" alt="" /></a></p>

<p>jangan lupa tambahkan juga keyword public pada class MahasiswaDaonya.</p>

<p>jadi hasil akhir sementar project kita seperti berikut :</p>

<p><a href="http://coding4ever.files.wordpress.com/2011/06/25062011-12.png"><img src="http://coding4ever.files.wordpress.com/2011/06/25062011-12.png" alt="" /></a></p>

<p>Untuk mengakses database MySQL kita membutuhkan library MySql Connection yang bisa didownload di<a href="http://dev.mysql.com/downloads/connector/net/6.2.html">sini</a>.</p>

<p>Untuk tutorial kali ini saya menggunakan versi <a href="http://dev.mysql.com/downloads/connector/net/6.2.html">MySQL Connector/Net 6.2.4</a></p>

<p>Silahkan download library tersebut kemudian lakukan instalasi.</p>

<p>Adapun langkah-langkah untuk menambahkan library tersebut kedalam project adalah sebagi berikut :</p>

<p><strong>Klik kanan References -> Add References &hellip;</strong></p>

<p><a href="http://coding4ever.files.wordpress.com/2011/06/25062011-13.png"><img src="http://coding4ever.files.wordpress.com/2011/06/25062011-13.png" alt="" /></a></p>

<p><a href="http://coding4ever.files.wordpress.com/2011/06/25062011-14.png"><img src="http://coding4ever.files.wordpress.com/2011/06/25062011-14.png?w=300" alt="" /></a></p>

<p>Selanjutnya kita tinggal melengkapi class MahasiswaDaonya.</p>

<p><strong>1. Menambahkan namespace MySql.Data.MySqlClient dan DemoDAO.Model</strong></p>

<p><a href="http://coding4ever.files.wordpress.com/2011/06/25062011-15.png"><img src="http://coding4ever.files.wordpress.com/2011/06/25062011-15.png?w=300" alt="" /></a></p>

<p>namespace MySql.Data.MySqlClient dibutuhkan agar bisa menggunakan class-class untuk mengakses database MySQL sedangkan namespaceÂ DemoDAO.Model agar bisa mengakses class Mahasiswa dari class MahasiswaDao.</p>

<p><strong>2. Menambah beberapa variabel pendukung seperti conn, strSql dan sebuah constructor</strong></p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class='c#'><span class='line'><span class="k">private</span> <span class="n">MySqlConnection</span> <span class="n">conn</span><span class="p">;</span>
</span><span class='line'><span class="k">private</span> <span class="kt">string</span> <span class="n">strSql</span> <span class="p">=</span> <span class="kt">string</span><span class="p">.</span><span class="n">Empty</span><span class="p">;&lt;/</span><span class="n">p</span><span class="p">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="p">&lt;</span><span class="n">p</span><span class="p">&gt;</span><span class="c1">// constructor</span>
</span><span class='line'><span class="k">public</span> <span class="nf">MahasiswaDao</span><span class="p">(</span><span class="n">MySqlConnection</span> <span class="n">conn</span><span class="p">)</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'>    <span class="k">this</span><span class="p">.</span><span class="n">conn</span> <span class="p">=</span> <span class="n">conn</span><span class="p">;</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure></p>

<p><strong>3. Menambahkan method Save, Update dan Delete</strong></p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
</pre></td><td class='code'><pre><code class='c#'><span class='line'><span class="k">public</span> <span class="kt">int</span> <span class="nf">Save</span><span class="p">(</span><span class="n">Mahasiswa</span> <span class="n">mhs</span><span class="p">)</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'>    <span class="n">strSql</span> <span class="p">=</span> <span class="p">&amp;</span><span class="n">ldquo</span><span class="p">;</span><span class="n">INSERT</span> <span class="n">INTO</span> <span class="n">mahasiswa</span> <span class="p">(</span><span class="n">nomor_mahasiswa</span><span class="p">,</span> <span class="n">nama</span><span class="p">,</span> <span class="n">alamat</span><span class="p">)</span> <span class="n">VALUES</span> <span class="p">(</span><span class="err">@</span><span class="m">1</span><span class="p">,</span> <span class="err">@</span><span class="m">2</span><span class="p">,</span> <span class="err">@</span><span class="m">3</span><span class="p">)&amp;</span><span class="n">rdquo</span><span class="p">;;&lt;/</span><span class="n">p</span><span class="p">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="p">&lt;</span><span class="n">pre</span><span class="p">&gt;&lt;</span><span class="n">code</span><span class="p">&gt;</span><span class="k">using</span> <span class="p">(</span><span class="n">MySqlCommand</span> <span class="n">cmd</span> <span class="p">=</span> <span class="k">new</span> <span class="n">MySqlCommand</span><span class="p">(</span><span class="n">strSql</span><span class="p">,</span> <span class="n">conn</span><span class="p">))</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'>    <span class="n">cmd</span><span class="p">.</span><span class="n">Parameters</span><span class="p">.</span><span class="n">AddWithValue</span><span class="p">(</span><span class="s">&quot;@1&quot;</span><span class="p">,</span> <span class="n">mhs</span><span class="p">.</span><span class="n">NomorMahasiswa</span><span class="p">);</span>
</span><span class='line'>    <span class="n">cmd</span><span class="p">.</span><span class="n">Parameters</span><span class="p">.</span><span class="n">AddWithValue</span><span class="p">(</span><span class="s">&quot;@2&quot;</span><span class="p">,</span> <span class="n">mhs</span><span class="p">.</span><span class="n">Nama</span><span class="p">);</span>
</span><span class='line'>    <span class="n">cmd</span><span class="p">.</span><span class="n">Parameters</span><span class="p">.</span><span class="n">AddWithValue</span><span class="p">(</span><span class="s">&quot;@3&quot;</span><span class="p">,</span> <span class="n">mhs</span><span class="p">.</span><span class="n">Alamat</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">return</span> <span class="n">cmd</span><span class="p">.</span><span class="n">ExecuteNonQuery</span><span class="p">();</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'><span class="p">&lt;/</span><span class="n">code</span><span class="p">&gt;&lt;/</span><span class="n">pre</span><span class="p">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="p">&lt;</span><span class="n">p</span><span class="p">&gt;}&lt;/</span><span class="n">p</span><span class="p">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="p">&lt;</span><span class="n">p</span><span class="p">&gt;</span><span class="k">public</span> <span class="kt">int</span> <span class="n">Update</span><span class="p">(</span><span class="n">Mahasiswa</span> <span class="n">mhs</span><span class="p">)</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'>    <span class="n">strSql</span> <span class="p">=</span> <span class="p">&amp;</span><span class="n">ldquo</span><span class="p">;</span><span class="n">UPDATE</span> <span class="n">mahasiswa</span> <span class="n">SET</span> <span class="n">nama</span> <span class="p">=</span> <span class="err">@</span><span class="m">1</span><span class="p">,</span> <span class="n">alamat</span> <span class="p">=</span> <span class="err">@</span><span class="m">2</span> <span class="n">WHERE</span> <span class="n">nomor_mahasiswa</span> <span class="p">=</span> <span class="err">@</span><span class="m">3</span><span class="p">&amp;</span><span class="n">rdquo</span><span class="p">;;&lt;/</span><span class="n">p</span><span class="p">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="p">&lt;</span><span class="n">pre</span><span class="p">&gt;&lt;</span><span class="n">code</span><span class="p">&gt;</span><span class="k">using</span> <span class="p">(</span><span class="n">MySqlCommand</span> <span class="n">cmd</span> <span class="p">=</span> <span class="k">new</span> <span class="n">MySqlCommand</span><span class="p">(</span><span class="n">strSql</span><span class="p">,</span> <span class="n">conn</span><span class="p">))</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'>    <span class="n">cmd</span><span class="p">.</span><span class="n">Parameters</span><span class="p">.</span><span class="n">AddWithValue</span><span class="p">(</span><span class="s">&quot;@1&quot;</span><span class="p">,</span> <span class="n">mhs</span><span class="p">.</span><span class="n">Nama</span><span class="p">);</span>
</span><span class='line'>    <span class="n">cmd</span><span class="p">.</span><span class="n">Parameters</span><span class="p">.</span><span class="n">AddWithValue</span><span class="p">(</span><span class="s">&quot;@2&quot;</span><span class="p">,</span> <span class="n">mhs</span><span class="p">.</span><span class="n">Alamat</span><span class="p">);</span>
</span><span class='line'>    <span class="n">cmd</span><span class="p">.</span><span class="n">Parameters</span><span class="p">.</span><span class="n">AddWithValue</span><span class="p">(</span><span class="s">&quot;@3&quot;</span><span class="p">,</span> <span class="n">mhs</span><span class="p">.</span><span class="n">NomorMahasiswa</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">return</span> <span class="n">cmd</span><span class="p">.</span><span class="n">ExecuteNonQuery</span><span class="p">();</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'><span class="p">&lt;/</span><span class="n">code</span><span class="p">&gt;&lt;/</span><span class="n">pre</span><span class="p">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="p">&lt;</span><span class="n">p</span><span class="p">&gt;}&lt;/</span><span class="n">p</span><span class="p">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="p">&lt;</span><span class="n">p</span><span class="p">&gt;</span><span class="k">public</span> <span class="kt">int</span> <span class="n">Delete</span><span class="p">(</span><span class="kt">string</span> <span class="n">nomorMahasiswa</span><span class="p">)</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'>    <span class="n">strSql</span> <span class="p">=</span> <span class="p">&amp;</span><span class="n">ldquo</span><span class="p">;</span><span class="n">DELETE</span> <span class="n">FROM</span> <span class="n">mahasiswa</span> <span class="n">WHERE</span> <span class="n">nomor_mahasiswa</span> <span class="p">=</span> <span class="err">@</span><span class="m">1</span><span class="p">&amp;</span><span class="n">rdquo</span><span class="p">;;&lt;/</span><span class="n">p</span><span class="p">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="p">&lt;</span><span class="n">pre</span><span class="p">&gt;&lt;</span><span class="n">code</span><span class="p">&gt;</span><span class="k">using</span> <span class="p">(</span><span class="n">MySqlCommand</span> <span class="n">cmd</span> <span class="p">=</span> <span class="k">new</span> <span class="n">MySqlCommand</span><span class="p">(</span><span class="n">strSql</span><span class="p">,</span> <span class="n">conn</span><span class="p">))</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'>    <span class="n">cmd</span><span class="p">.</span><span class="n">Parameters</span><span class="p">.</span><span class="n">AddWithValue</span><span class="p">(</span><span class="s">&quot;@1&quot;</span><span class="p">,</span> <span class="n">nomorMahasiswa</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">return</span> <span class="n">cmd</span><span class="p">.</span><span class="n">ExecuteNonQuery</span><span class="p">();</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'><span class="p">&lt;/</span><span class="n">code</span><span class="p">&gt;&lt;/</span><span class="n">pre</span><span class="p">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="p">&lt;</span><span class="n">p</span><span class="p">&gt;}</span>
</span></code></pre></td></tr></table></div></figure></p>

<p><strong>4. Menambahkan method GetAll dan GetByName</strong></p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
<span class='line-number'>56</span>
<span class='line-number'>57</span>
<span class='line-number'>58</span>
<span class='line-number'>59</span>
<span class='line-number'>60</span>
<span class='line-number'>61</span>
</pre></td><td class='code'><pre><code class='c#'><span class='line'><span class="k">private</span> <span class="n">Mahasiswa</span> <span class="nf">MappingRowToObject</span><span class="p">(</span><span class="n">MySqlDataReader</span> <span class="n">dtr</span><span class="p">)</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'>    <span class="n">Mahasiswa</span> <span class="n">mhs</span> <span class="p">=</span> <span class="k">new</span> <span class="n">Mahasiswa</span><span class="p">();&lt;/</span><span class="n">p</span><span class="p">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="p">&lt;</span><span class="n">pre</span><span class="p">&gt;&lt;</span><span class="n">code</span><span class="p">&gt;</span><span class="n">mhs</span><span class="p">.</span><span class="n">NomorMahasiswa</span> <span class="p">=</span> <span class="n">dtr</span><span class="p">[</span><span class="s">&quot;nomor_mahasiswa&quot;</span><span class="p">]</span> <span class="k">is</span> <span class="n">DBNull</span> <span class="p">?</span> <span class="kt">string</span><span class="p">.</span><span class="n">Empty</span> <span class="p">:</span> <span class="n">dtr</span><span class="p">[</span><span class="s">&quot;nomor_mahasiswa&quot;</span><span class="p">].</span><span class="n">ToString</span><span class="p">();</span>
</span><span class='line'><span class="n">mhs</span><span class="p">.</span><span class="n">Nama</span> <span class="p">=</span> <span class="n">dtr</span><span class="p">[</span><span class="s">&quot;nama&quot;</span><span class="p">]</span> <span class="k">is</span> <span class="n">DBNull</span> <span class="p">?</span> <span class="kt">string</span><span class="p">.</span><span class="n">Empty</span> <span class="p">:</span> <span class="n">dtr</span><span class="p">[</span><span class="s">&quot;nama&quot;</span><span class="p">].</span><span class="n">ToString</span><span class="p">();</span>
</span><span class='line'><span class="n">mhs</span><span class="p">.</span><span class="n">Alamat</span> <span class="p">=</span> <span class="n">dtr</span><span class="p">[</span><span class="s">&quot;alamat&quot;</span><span class="p">]</span> <span class="k">is</span> <span class="n">DBNull</span> <span class="p">?</span> <span class="kt">string</span><span class="p">.</span><span class="n">Empty</span> <span class="p">:</span> <span class="n">dtr</span><span class="p">[</span><span class="s">&quot;alamat&quot;</span><span class="p">].</span><span class="n">ToString</span><span class="p">();</span>
</span><span class='line'>
</span><span class='line'><span class="k">return</span> <span class="n">mhs</span><span class="p">;</span>
</span><span class='line'><span class="p">&lt;/</span><span class="n">code</span><span class="p">&gt;&lt;/</span><span class="n">pre</span><span class="p">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="p">&lt;</span><span class="n">p</span><span class="p">&gt;}&lt;/</span><span class="n">p</span><span class="p">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="p">&lt;</span><span class="n">p</span><span class="p">&gt;</span><span class="k">public</span> <span class="n">List</span><span class="p">&lt;</span><span class="n">Mahasiswa</span><span class="p">&gt;</span> <span class="n">GetAll</span><span class="p">()</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'>    <span class="n">List</span><span class="p">&lt;</span><span class="n">Mahasiswa</span><span class="p">&gt;</span> <span class="n">daftarMhs</span> <span class="p">=</span> <span class="k">new</span> <span class="n">List</span><span class="p">&lt;</span><span class="n">Mahasiswa</span><span class="p">&gt;();&lt;/</span><span class="n">p</span><span class="p">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="p">&lt;</span><span class="n">pre</span><span class="p">&gt;&lt;</span><span class="n">code</span><span class="p">&gt;</span><span class="n">strSql</span> <span class="p">=</span> <span class="s">&quot;SELECT nomor_mahasiswa, nama, alamat FROM mahasiswa &quot;</span> <span class="p">+</span>
</span><span class='line'>         <span class="s">&quot;ORDER BY nama&quot;</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'><span class="k">using</span> <span class="p">(</span><span class="n">MySqlCommand</span> <span class="n">cmd</span> <span class="p">=</span> <span class="k">new</span> <span class="n">MySqlCommand</span><span class="p">(</span><span class="n">strSql</span><span class="p">,</span> <span class="n">conn</span><span class="p">))</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'>    <span class="k">using</span> <span class="p">(</span><span class="n">MySqlDataReader</span> <span class="n">dtr</span> <span class="p">=</span> <span class="n">cmd</span><span class="p">.</span><span class="n">ExecuteReader</span><span class="p">())</span>
</span><span class='line'>    <span class="p">{</span>
</span><span class='line'>        <span class="k">while</span> <span class="p">(</span><span class="n">dtr</span><span class="p">.</span><span class="n">Read</span><span class="p">())</span>
</span><span class='line'>        <span class="p">{</span>
</span><span class='line'>            <span class="n">daftarMhs</span><span class="p">.</span><span class="n">Add</span><span class="p">(</span><span class="n">MappingRowToObject</span><span class="p">(</span><span class="n">dtr</span><span class="p">));</span>
</span><span class='line'>        <span class="p">}</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="k">return</span> <span class="n">daftarMhs</span><span class="p">;</span>
</span><span class='line'><span class="p">&lt;/</span><span class="n">code</span><span class="p">&gt;&lt;/</span><span class="n">pre</span><span class="p">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="p">&lt;</span><span class="n">p</span><span class="p">&gt;}&lt;/</span><span class="n">p</span><span class="p">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="p">&lt;</span><span class="n">p</span><span class="p">&gt;</span><span class="k">public</span> <span class="n">List</span><span class="p">&lt;</span><span class="n">Mahasiswa</span><span class="p">&gt;</span> <span class="n">GetByName</span><span class="p">(</span><span class="kt">string</span> <span class="n">nama</span><span class="p">)</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'>    <span class="n">List</span><span class="p">&lt;</span><span class="n">Mahasiswa</span><span class="p">&gt;</span> <span class="n">daftarMhs</span> <span class="p">=</span> <span class="k">new</span> <span class="n">List</span><span class="p">&lt;</span><span class="n">Mahasiswa</span><span class="p">&gt;();&lt;/</span><span class="n">p</span><span class="p">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="p">&lt;</span><span class="n">pre</span><span class="p">&gt;&lt;</span><span class="n">code</span><span class="p">&gt;</span><span class="n">strSql</span> <span class="p">=</span> <span class="s">&quot;SELECT nomor_mahasiswa, nama, alamat FROM mahasiswa &quot;</span> <span class="p">+</span>
</span><span class='line'>         <span class="s">&quot;WHERE nama LIKE @1 &quot;</span> <span class="p">+</span>
</span><span class='line'>         <span class="s">&quot;ORDER BY nama&quot;</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'><span class="k">using</span> <span class="p">(</span><span class="n">MySqlCommand</span> <span class="n">cmd</span> <span class="p">=</span> <span class="k">new</span> <span class="n">MySqlCommand</span><span class="p">(</span><span class="n">strSql</span><span class="p">,</span> <span class="n">conn</span><span class="p">))</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'>    <span class="n">cmd</span><span class="p">.</span><span class="n">Parameters</span><span class="p">.</span><span class="n">AddWithValue</span><span class="p">(</span><span class="s">&quot;@1&quot;</span><span class="p">,</span> <span class="s">&quot;%&quot;</span> <span class="p">+</span> <span class="n">nama</span> <span class="p">+</span> <span class="s">&quot;%&quot;</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">using</span> <span class="p">(</span><span class="n">MySqlDataReader</span> <span class="n">dtr</span> <span class="p">=</span> <span class="n">cmd</span><span class="p">.</span><span class="n">ExecuteReader</span><span class="p">())</span>
</span><span class='line'>    <span class="p">{</span>
</span><span class='line'>        <span class="k">while</span> <span class="p">(</span><span class="n">dtr</span><span class="p">.</span><span class="n">Read</span><span class="p">())</span>
</span><span class='line'>        <span class="p">{</span>
</span><span class='line'>            <span class="n">daftarMhs</span><span class="p">.</span><span class="n">Add</span><span class="p">(</span><span class="n">MappingRowToObject</span><span class="p">(</span><span class="n">dtr</span><span class="p">));</span>
</span><span class='line'>        <span class="p">}</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="k">return</span> <span class="n">daftarMhs</span><span class="p">;</span>
</span><span class='line'><span class="p">&lt;/</span><span class="n">code</span><span class="p">&gt;&lt;/</span><span class="n">pre</span><span class="p">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="p">&lt;</span><span class="n">p</span><span class="p">&gt;}</span>
</span></code></pre></td></tr></table></div></figure></p>

<p>Selesai sudah pembuatan class MahasiswaDaonya sekarang tinggal bagaimana cara menggunakan class Mahasiswa dan MahasiswaDao pada Presentation layer, tapi &hellip; akan saya bahas pada <a href="/blog/2011/06/26/mengakses-database-mysql-menggunakan-c-bagian-2/">postingan</a> berikutnya :D insya Allah.</p>

<p>Selamat <a href="http://www.4shared.com/file/6vack9Yi/DemoDAO.html">MENCOBA</a> :)</p>

<p>Referensi : <a href="http://netindonesia.net/">Geeks Portal .NET Indonesia</a></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Backup Dan Restore Database MySQL Dari Aplikasi]]></title>
    <link href="http://coding4ever.net/blog/2011/03/20/backup-dan-restore-database-mysql-dari-aplikasi/"/>
    <updated>2011-03-20T13:19:18+07:00</updated>
    <id>http://coding4ever.net/blog/2011/03/20/backup-dan-restore-database-mysql-dari-aplikasi</id>
    <content type="html"><![CDATA[<p>Artikel kali ini hanya posting ulang dari jawaban saya yang ada di artikel <a href="https://coding4ever.wordpress.com/2010/01/16/membuat-paket-instalasi-vb-mysql-dengan-nsis/">Membuat paket instalasi vb + mysql dengan NSIS</a>, karena masih ada beberapa pengunjung yang bertanya tentang masalah ini.</p>

<p>Untuk proses backup kita cukup menggunakan tool bawaan MySQL yaitu <strong>mysqldump</strong> dan untuk restorenya menggunakan <strong>mysql</strong>.</p>

<p>Adapun perintah dasar untuk melakukan backup dan restore adalah sebagai berikut :</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>&lsquo; backup
</span><span class='line'>mysqldump -uUSER_NAME -pUSER_PASSWORD &ndash;routines NAMA_DATABASE > LOKASI_FILE_BACKUP.SQL&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;p>&lsquo; restore
</span><span class='line'>mysql -uUSER_NAME -pUSER_PASSWORD NAMA_DATABASE &lt; LOKASI_FILE_BACKUP.SQL</span></code></pre></td></tr></table></div></figure></p>

<!-- more -->


<p>parameter &ndash;routines ditambahkan jika database mempunyai fungsi/trigger</p>

<p>Sekarang tinggal kita siapkan kode berikut :</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>Private Declare Function OpenProcess Lib &ldquo;kernel32&rdquo; (ByVal dwDesiredAccess As Long, ByVal bInheritHandle As Long, ByVal dwProcessId As Long) As Long
</span><span class='line'>Private Declare Function WaitForSingleObject Lib &ldquo;kernel32&rdquo; (ByVal hHandle As Long, ByVal dwMilliseconds As Long) As Long
</span><span class='line'>Private Declare Function CloseHandle Lib &ldquo;kernel32&rdquo; (ByVal hObject As Long) As Long&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;p>Private Const SYNCHRONIZE       As Long = &amp;H100000
</span><span class='line'>Private Const INFINITE          As Long = &amp;HFFFF&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;p>Private Sub execCommand(ByVal cmd As String)
</span><span class='line'>    Dim result  As Long
</span><span class='line'>    Dim lPid    As Long
</span><span class='line'>    Dim lHnd    As Long
</span><span class='line'>    Dim lRet    As Long&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;pre>&lt;code>cmd = "cmd /c " &amp; cmd
</span><span class='line'>result = Shell(cmd, vbHide)
</span><span class='line'>
</span><span class='line'>lPid = result
</span><span class='line'>If lPid &lt;&gt; 0 Then
</span><span class='line'>    lHnd = OpenProcess(SYNCHRONIZE, 0, lPid)
</span><span class='line'>    If lHnd &lt;&gt; 0 Then
</span><span class='line'>        lRet = WaitForSingleObject(lHnd, INFINITE)
</span><span class='line'>        CloseHandle (lHnd)
</span><span class='line'>    End If
</span><span class='line'>End If
</span><span class='line'>&lt;/code>&lt;/pre>
</span><span class='line'>
</span><span class='line'>&lt;p>End Sub</span></code></pre></td></tr></table></div></figure></p>

<p>kemudian tinggal panggil di masing-masing proses (backup dan restore)</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>Dim cmd As String&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;p>Private Sub cmdBackup_Click()
</span><span class='line'>    Screen.MousePointer = vbHourglass
</span><span class='line'>    DoEvents&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;pre>&lt;code>cmd = Chr(34) &amp; "C:\Program Files\MySQL\MySQL Server 5.1\bin\mysqldump" &amp; Chr(34) &amp; " -uroot -prahasia --routines --comments nama_database &gt; c:\nama_database.sql"
</span><span class='line'>Call execCommand(cmd)
</span><span class='line'>
</span><span class='line'>Screen.MousePointer = vbDefault
</span><span class='line'>MsgBox "done"
</span><span class='line'>&lt;/code>&lt;/pre>
</span><span class='line'>
</span><span class='line'>&lt;p>End Sub&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;p>Private Sub cmdRestore_Click()
</span><span class='line'>    Screen.MousePointer = vbHourglass
</span><span class='line'>    DoEvents&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;pre>&lt;code>cmd = Chr(34) &amp; "C:\Program Files\MySQL\MySQL Server 5.1\bin\mysql" &amp; Chr(34) &amp; " -uroot -prahasia --comments nama_database &lt; c:\nama_database.sql"
</span><span class='line'>Call execCommand(cmd)
</span><span class='line'>
</span><span class='line'>Screen.MousePointer = vbDefault
</span><span class='line'>MsgBox "done"
</span><span class='line'>&lt;/code>&lt;/pre>
</span><span class='line'>
</span><span class='line'>&lt;p>End Sub</span></code></pre></td></tr></table></div></figure></p>

<p>kode diatas dengan asumsi direktori bin MySQL ada di folder &ldquo;C:\Program Files\MySQL\MySQL Server 5.1\bin&rdquo;.</p>

<p>Selamat mencoba :)</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Menyimpan Dan Menampilkan Gambar Di MySQL]]></title>
    <link href="http://coding4ever.net/blog/2011/03/15/menyimpan-dan-menampilkan-gambar-di-mysql/"/>
    <updated>2011-03-15T20:15:34+07:00</updated>
    <id>http://coding4ever.net/blog/2011/03/15/menyimpan-dan-menampilkan-gambar-di-mysql</id>
    <content type="html"><![CDATA[<p>Ternyata masih ada sebagian om2x :D yang masih kesulitan untuk melakukan hal ini, tapi oke lah berhubung udah lama enggax posting kayaxnya enggak salah juga membahas permasalahan yang satu ini.</p>

<p>Dengan asumsi MySQL dan Visual Basic .NET sudah terinstall dengan baik hal selanjutnya yang perlu disiapkan adalahÂ <a href="http://dev.mysql.com/downloads/connector/net/6.2.html#downloads">MySQL Connector/Net</a>, disini saya menggunakan versiÂ 6.2.4</p>

<p>Jadi silahkan download kemudian lakukan instalasi.</p>

<p>Selanjutnya kita akan menyiapkan sebuah tabel, misal dengan nama mahasiswa dengan struktur seperti berikut :</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>CREATE TABLE mahasiswa (
</span><span class='line'>    npm VARCHAR(10),
</span><span class='line'>    nama VARCHAR(50),
</span><span class='line'>    foto MEDIUMBLOB
</span><span class='line'>)</span></code></pre></td></tr></table></div></figure></p>

<!-- more -->


<p>Gimana udah selesai ? Klo udah kita lanjutkan dengan membuat project baru kemudian tambahkan referensi MySql.Data (menu Project -> Add Reference&hellip;)</p>

<p><a href="http://coding4ever.files.wordpress.com/2011/03/15032011-1.jpg"><img src="http://coding4ever.files.wordpress.com/2011/03/15032011-1.jpg?w=300" alt="" /></a></p>

<p>Apakah udah cukup ? Belum tambahkan juga namespace (package klo istilah javanya)Â MySql.Data pada bagian paling atas kode program</p>

<p><a href="http://coding4ever.files.wordpress.com/2011/03/15032011-2.jpg"><img src="http://coding4ever.files.wordpress.com/2011/03/15032011-2.jpg?w=300" alt="" /></a></p>

<p>Perintah diatas berguna untuk menyingkat penulisan kode program contoh :</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>Private conn As New MySql.Data.MySqlClient.MySqlConnection</span></code></pre></td></tr></table></div></figure></p>

<p>bisa disingkat menjadi</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>Private conn As New MySqlClient.MySqlConnection</span></code></pre></td></tr></table></div></figure></p>

<p>Selanjutnya kita akan desain tampilan program seperti gambar dibawah ini</p>

<p><a href="http://coding4ever.files.wordpress.com/2011/03/15032011-3.jpg"><img src="http://coding4ever.files.wordpress.com/2011/03/15032011-3.jpg?w=300" alt="" /></a></p>

<p>komponen yang yang dibutuhkan 1 buah PictureBox dan 2 buah Button.</p>

<p><strong>Melakukan koneksi</strong></p>

<p>Nah cara yang paling gampang kita tempatkan aja kodenya dibagian <a href="http://en.wikipedia.org/wiki/Constructor_(object-oriented_programming">constructor</a>)</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>Private conn As New MySqlClient.MySqlConnection
</span><span class='line'>Private strSql As String = String.Empty&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;p>Public Sub New()&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;pre>&lt;code>' This call is required by the Windows Form Designer.
</span><span class='line'>InitializeComponent()
</span><span class='line'>
</span><span class='line'>' Add any initialization after the InitializeComponent() call.
</span><span class='line'>
</span><span class='line'>' kode untuk melakukan koneksi mulai dari sini
</span><span class='line'>Dim strConn As String = "server=127.0.0.1;uid=root;pwd=rahasia;database=test"
</span><span class='line'>conn.ConnectionString = strConn
</span><span class='line'>conn.Open()
</span><span class='line'>&lt;/code>&lt;/pre>
</span><span class='line'>
</span><span class='line'>&lt;p>End Sub</span></code></pre></td></tr></table></div></figure></p>

<p>Klo kelupaan lokasi constructornya dimana :D, caranya lihat gambar :</p>

<p><a href="http://coding4ever.files.wordpress.com/2011/03/15032011-4.jpg"><img src="http://coding4ever.files.wordpress.com/2011/03/15032011-4.jpg?w=300" alt="" /></a></p>

<p><strong>Meyimpan gambar</strong></p>

<p>Kodenya sederhana banget, kita lihat cuplikannya</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>Private Sub btnSimpan_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles btnSimpan.Click
</span><span class='line'>    &lsquo; untuk contoh disini lokasi gambarnya saya hardcode
</span><span class='line'>    &rsquo; kita bisa kembangkan dengan memanfaatkan komponen OpenFileDialog
</span><span class='line'>    Dim fileName As String = &ldquo;E:\Gambar\k4m4r82.jpg&rdquo;&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;pre>&lt;code>strSql = "INSERT INTO mahasiswa (npm, nama, foto) VALUES (@1, @2, @3)" ' ini perintah insert biasa
</span><span class='line'>Using cmd As New MySqlClient.MySqlCommand(strSql, conn)
</span><span class='line'>    With cmd
</span><span class='line'>        .Parameters.Clear()
</span><span class='line'>        .Parameters.AddWithValue("@1", "02.02.4114") ' npm
</span><span class='line'>        .Parameters.AddWithValue("@2", "Kamarudin") ' nama
</span><span class='line'>        .Parameters.AddWithValue("@3", IO.File.ReadAllBytes(fileName)) ' foto
</span><span class='line'>
</span><span class='line'>        .ExecuteNonQuery()
</span><span class='line'>    End With
</span><span class='line'>End Using
</span><span class='line'>
</span><span class='line'>MessageBox.Show("Data sudah disimpan", "Informasi", MessageBoxButtons.OK, MessageBoxIcon.Information)
</span><span class='line'>&lt;/code>&lt;/pre>
</span><span class='line'>
</span><span class='line'>&lt;p>End Sub</span></code></pre></td></tr></table></div></figure></p>

<p><strong>Menampilkan gambar</strong></p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>Private Sub btnTampil_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles btnTampil.Click
</span><span class='line'>    strSql = &ldquo;SELECT foto FROM mhs WHERE npm = @1&rdquo;&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;pre>&lt;code>Using cmd As New MySqlClient.MySqlCommand(strSql, conn)
</span><span class='line'>    With cmd
</span><span class='line'>        .Parameters.Clear()
</span><span class='line'>        .Parameters.AddWithValue("@1", "02.02.4114") ' npm
</span><span class='line'>
</span><span class='line'>        Using dtr As MySqlClient.MySqlDataReader = .ExecuteReader()
</span><span class='line'>            If dtr.HasRows Then
</span><span class='line'>                If dtr.Read() Then
</span><span class='line'>                    Dim ms As New IO.MemoryStream(CType(dtr.Item("foto"), Byte()))
</span><span class='line'>                    PictureBox1.Image = Image.FromStream(ms) ' tampilkan gambarnya
</span><span class='line'>                End If
</span><span class='line'>            End If
</span><span class='line'>        End Using
</span><span class='line'>    End With
</span><span class='line'>End Using
</span><span class='line'>&lt;/code>&lt;/pre>
</span><span class='line'>
</span><span class='line'>&lt;p>End Sub</span></code></pre></td></tr></table></div></figure></p>

<p><a href="http://coding4ever.files.wordpress.com/2011/03/15032011-5.jpg"><img src="http://coding4ever.files.wordpress.com/2011/03/15032011-5.jpg?w=300" alt="" /></a></p>

<p>Selamat mencoba :)</p>
]]></content>
  </entry>
  
</feed>
