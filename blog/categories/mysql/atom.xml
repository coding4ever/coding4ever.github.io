<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Category: Mysql | Coding4ever's Blog]]></title>
  <link href="http://coding4ever.net/blog/categories/mysql/atom.xml" rel="self"/>
  <link href="http://coding4ever.net/"/>
  <updated>2015-04-20T10:31:03+07:00</updated>
  <id>http://coding4ever.net/</id>
  <author>
    <name><![CDATA[Admin]]></name>
    
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[Backup Dan Restore Database MySQL Dari Aplikasi]]></title>
    <link href="http://coding4ever.net/blog/2011/03/20/backup-dan-restore-database-mysql-dari-aplikasi/"/>
    <updated>2011-03-20T13:19:18+07:00</updated>
    <id>http://coding4ever.net/blog/2011/03/20/backup-dan-restore-database-mysql-dari-aplikasi</id>
    <content type="html"><![CDATA[<p>Artikel kali ini hanya posting ulang dari jawaban saya yang ada di artikel <a href="https://coding4ever.wordpress.com/2010/01/16/membuat-paket-instalasi-vb-mysql-dengan-nsis/">Membuat paket instalasi vb + mysql dengan NSIS</a>, karena masih ada beberapa pengunjung yang bertanya tentang masalah ini.</p>

<p>Untuk proses backup kita cukup menggunakan tool bawaan MySQL yaitu <strong>mysqldump</strong> dan untuk restorenya menggunakan <strong>mysql</strong>.</p>

<p>Adapun perintah dasar untuk melakukan backup dan restore adalah sebagai berikut :</p>

<p>{% codeblock %}
&lsquo; backup
mysqldump -uUSER_NAME -pUSER_PASSWORD &ndash;routines NAMA_DATABASE > LOKASI_FILE_BACKUP.SQL</p>

<p>&lsquo; restore
mysql -uUSER_NAME -pUSER_PASSWORD NAMA_DATABASE &lt; LOKASI_FILE_BACKUP.SQL
{% endcodeblock %}</p>

<!-- more -->


<p>parameter &ndash;routines ditambahkan jika database mempunyai fungsi/trigger</p>

<p>Sekarang tinggal kita siapkan kode berikut :</p>

<p>{% codeblock %}
Private Declare Function OpenProcess Lib &ldquo;kernel32&rdquo; (ByVal dwDesiredAccess As Long, ByVal bInheritHandle As Long, ByVal dwProcessId As Long) As Long
Private Declare Function WaitForSingleObject Lib &ldquo;kernel32&rdquo; (ByVal hHandle As Long, ByVal dwMilliseconds As Long) As Long
Private Declare Function CloseHandle Lib &ldquo;kernel32&rdquo; (ByVal hObject As Long) As Long</p>

<p>Private Const SYNCHRONIZE       As Long = &amp;H100000
Private Const INFINITE          As Long = &amp;HFFFF</p>

<p>Private Sub execCommand(ByVal cmd As String)
    Dim result  As Long
    Dim lPid    As Long
    Dim lHnd    As Long
    Dim lRet    As Long</p>

<pre><code>cmd = "cmd /c " &amp; cmd
result = Shell(cmd, vbHide)

lPid = result
If lPid &lt;&gt; 0 Then
    lHnd = OpenProcess(SYNCHRONIZE, 0, lPid)
    If lHnd &lt;&gt; 0 Then
        lRet = WaitForSingleObject(lHnd, INFINITE)
        CloseHandle (lHnd)
    End If
End If
</code></pre>

<p>End Sub
{% endcodeblock %}</p>

<p>kemudian tinggal panggil di masing-masing proses (backup dan restore)</p>

<p>{% codeblock %}
Dim cmd As String</p>

<p>Private Sub cmdBackup_Click()
    Screen.MousePointer = vbHourglass
    DoEvents</p>

<pre><code>cmd = Chr(34) &amp; "C:\Program Files\MySQL\MySQL Server 5.1\bin\mysqldump" &amp; Chr(34) &amp; " -uroot -prahasia --routines --comments nama_database &gt; c:\nama_database.sql"
Call execCommand(cmd)

Screen.MousePointer = vbDefault
MsgBox "done"
</code></pre>

<p>End Sub</p>

<p>Private Sub cmdRestore_Click()
    Screen.MousePointer = vbHourglass
    DoEvents</p>

<pre><code>cmd = Chr(34) &amp; "C:\Program Files\MySQL\MySQL Server 5.1\bin\mysql" &amp; Chr(34) &amp; " -uroot -prahasia --comments nama_database &lt; c:\nama_database.sql"
Call execCommand(cmd)

Screen.MousePointer = vbDefault
MsgBox "done"
</code></pre>

<p>End Sub
{% endcodeblock %}</p>

<p>kode diatas dengan asumsi direktori bin MySQL ada di folder &ldquo;C:\Program Files\MySQL\MySQL Server 5.1\bin&rdquo;.</p>

<p>Selamat mencoba :)</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Menyimpan Dan Menampilkan Gambar Di MySQL]]></title>
    <link href="http://coding4ever.net/blog/2011/03/15/menyimpan-dan-menampilkan-gambar-di-mysql/"/>
    <updated>2011-03-15T20:15:34+07:00</updated>
    <id>http://coding4ever.net/blog/2011/03/15/menyimpan-dan-menampilkan-gambar-di-mysql</id>
    <content type="html"><![CDATA[<p>Ternyata masih ada sebagian om2x :D yang masih kesulitan untuk melakukan hal ini, tapi oke lah berhubung udah lama enggax posting kayaxnya enggak salah juga membahas permasalahan yang satu ini.</p>

<p>Dengan asumsi MySQL dan Visual Basic .NET sudah terinstall dengan baik hal selanjutnya yang perlu disiapkan adalah <a href="http://dev.mysql.com/downloads/connector/net/6.2.html#downloads">MySQL Connector/Net</a>, disini saya menggunakan versi 6.2.4</p>

<p>Jadi silahkan download kemudian lakukan instalasi.</p>

<p>Selanjutnya kita akan menyiapkan sebuah tabel, misal dengan nama mahasiswa dengan struktur seperti berikut :</p>

<p>{% codeblock %}
CREATE TABLE mahasiswa (
    npm VARCHAR(10),
    nama VARCHAR(50),
    foto MEDIUMBLOB
)
{% endcodeblock %}</p>

<!-- more -->


<p>Gimana udah selesai ? Klo udah kita lanjutkan dengan membuat project baru kemudian tambahkan referensi MySql.Data (menu Project -> Add Reference&hellip;)</p>

<p><a href="http://coding4ever.files.wordpress.com/2011/03/15032011-1.jpg"><img src="http://coding4ever.files.wordpress.com/2011/03/15032011-1.jpg?w=300" alt="" /></a></p>

<p>Apakah udah cukup ? Belum tambahkan juga namespace (package klo istilah javanya) MySql.Data pada bagian paling atas kode program</p>

<p><a href="http://coding4ever.files.wordpress.com/2011/03/15032011-2.jpg"><img src="http://coding4ever.files.wordpress.com/2011/03/15032011-2.jpg?w=300" alt="" /></a></p>

<p>Perintah diatas berguna untuk menyingkat penulisan kode program contoh :</p>

<p>{% codeblock %}
Private conn As New MySql.Data.MySqlClient.MySqlConnection
{% endcodeblock %}</p>

<p>bisa disingkat menjadi</p>

<p>{% codeblock %}
Private conn As New MySqlClient.MySqlConnection
{% endcodeblock %}</p>

<p>Selanjutnya kita akan desain tampilan program seperti gambar dibawah ini</p>

<p><a href="http://coding4ever.files.wordpress.com/2011/03/15032011-3.jpg"><img src="http://coding4ever.files.wordpress.com/2011/03/15032011-3.jpg?w=300" alt="" /></a></p>

<p>komponen yang yang dibutuhkan 1 buah PictureBox dan 2 buah Button.</p>

<p><strong>Melakukan koneksi</strong></p>

<p>Nah cara yang paling gampang kita tempatkan aja kodenya dibagian <a href="http://en.wikipedia.org/wiki/Constructor_(object-oriented_programming">constructor</a>)</p>

<p>{% codeblock %}
Private conn As New MySqlClient.MySqlConnection
Private strSql As String = String.Empty</p>

<p>Public Sub New()</p>

<pre><code>' This call is required by the Windows Form Designer.
InitializeComponent()

' Add any initialization after the InitializeComponent() call.

' kode untuk melakukan koneksi mulai dari sini
Dim strConn As String = "server=127.0.0.1;uid=root;pwd=rahasia;database=test"
conn.ConnectionString = strConn
conn.Open()
</code></pre>

<p>End Sub
{% endcodeblock %}</p>

<p>Klo kelupaan lokasi constructornya dimana :D, caranya lihat gambar :</p>

<p><a href="http://coding4ever.files.wordpress.com/2011/03/15032011-4.jpg"><img src="http://coding4ever.files.wordpress.com/2011/03/15032011-4.jpg?w=300" alt="" /></a></p>

<p><strong>Meyimpan gambar</strong></p>

<p>Kodenya sederhana banget, kita lihat cuplikannya</p>

<p>{% codeblock %}
Private Sub btnSimpan_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles btnSimpan.Click
    &lsquo; untuk contoh disini lokasi gambarnya saya hardcode
    &rsquo; kita bisa kembangkan dengan memanfaatkan komponen OpenFileDialog
    Dim fileName As String = &ldquo;E:\Gambar\k4m4r82.jpg&rdquo;</p>

<pre><code>strSql = "INSERT INTO mahasiswa (npm, nama, foto) VALUES (@1, @2, @3)" ' ini perintah insert biasa
Using cmd As New MySqlClient.MySqlCommand(strSql, conn)
    With cmd
        .Parameters.Clear()
        .Parameters.AddWithValue("@1", "02.02.4114") ' npm
        .Parameters.AddWithValue("@2", "Kamarudin") ' nama
        .Parameters.AddWithValue("@3", IO.File.ReadAllBytes(fileName)) ' foto

        .ExecuteNonQuery()
    End With
End Using

MessageBox.Show("Data sudah disimpan", "Informasi", MessageBoxButtons.OK, MessageBoxIcon.Information)
</code></pre>

<p>End Sub
{% endcodeblock %}</p>

<p><strong>Menampilkan gambar</strong></p>

<p>{% codeblock %}
Private Sub btnTampil_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles btnTampil.Click
    strSql = &ldquo;SELECT foto FROM mhs WHERE npm = @1&rdquo;</p>

<pre><code>Using cmd As New MySqlClient.MySqlCommand(strSql, conn)
    With cmd
        .Parameters.Clear()
        .Parameters.AddWithValue("@1", "02.02.4114") ' npm

        Using dtr As MySqlClient.MySqlDataReader = .ExecuteReader()
            If dtr.HasRows Then
                If dtr.Read() Then
                    Dim ms As New IO.MemoryStream(CType(dtr.Item("foto"), Byte()))
                    PictureBox1.Image = Image.FromStream(ms) ' tampilkan gambarnya
                End If
            End If
        End Using
    End With
End Using
</code></pre>

<p>End Sub
{% endcodeblock %}</p>

<p><a href="http://coding4ever.files.wordpress.com/2011/03/15032011-5.jpg"><img src="http://coding4ever.files.wordpress.com/2011/03/15032011-5.jpg?w=300" alt="" /></a></p>

<p>Selamat mencoba :)</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[SELECT SCOPE_IDENTITY(), SELECT LAST_INSERT_ID() Dan RETURNING PK]]></title>
    <link href="http://coding4ever.net/blog/2011/02/27/select-scope_identity-select-last_insert_id-dan-returning-pk/"/>
    <updated>2011-02-27T13:51:22+07:00</updated>
    <id>http://coding4ever.net/blog/2011/02/27/select-scope_identity-select-last_insert_id-dan-returning-pk</id>
    <content type="html"><![CDATA[<p>Yuph kali ini kita akan membahas fungsi menarik (SELECT SCOPE_IDENTITY(), SELECT LAST_INSERT_ID() dan RETURNING PK) yang dimiliki oleh database2x terkenal seperti SQL Server, MySQL dan Firebird.</p>

<p>Dari nama fungsinya kita bisa menebak kegunaan dari fungsi diatas yaitu untuk mendapatkan nilai ID terakhir (biasanya bertipe angka) yang diinputkan.</p>

<p>Saya dan mungkin Anda biasanya dalam merancang tabel untuk selalu menambahkan field ID dengan attribut IDENTITY/AUTONUMBER dan sekaligus dijadikan sebagai PRIMARY KEY.</p>

<p>Tentunya hal ini kita lakukan untuk mempermudah dalam proses manipulasi data (edit dan delete).</p>

<p>Contoh beberapa tabel yang biasanya menggunakan field ID untuk PRIMARY KEY dan sekaligus diset dengan attribut IDENTITY/AUTONUMBER</p>

<!-- more -->


<p><a href="http://coding4ever.files.wordpress.com/2011/02/table1.png"><img src="http://coding4ever.files.wordpress.com/2011/02/table1.png?w=300" alt="" /></a></p>

<p>Bagi yang males membaca referensi (termasuk sy :D) biasa menuliskan kode berikut untuk mengINSERTkan dan mendapatkan nilai ID yang terakhir, kita ambil contoh tabel provinsi.</p>

<p>{% codeblock lang:vbnet %}
Private Sub btnInsert_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles btnInsert.Click
    Dim lastID As Long = 0</p>

<pre><code>' langkah 1 - menambahkan data
strSql = "INSERT INTO provinsi (keterangan) VALUES (@1)"
Using cmd As New SqlClient.SqlCommand(strSql, conn)
    With cmd
        .Parameters.Clear()
        .Parameters.AddWithValue("@1", "Riau")

        .ExecuteNonQuery()
    End With
End Using

' langkah 2 - mengambil id terakhir dg memanfaatkan fungsi MAX
strSql = "SELECT MAX(id) FROM provinsi"
Using cmd As New SqlClient.SqlCommand(strSql, conn)
    lastID = Convert.ToInt32(cmd.ExecuteScalar())
End Using

' tampilkan ID terakhir
MessageBox.Show("Last ID : " &amp; lastID.ToString())
</code></pre>

<p>End Sub
{% endcodeblock %}</p>

<p>Sekarang kita lihat bedanya jika memanfaatkan fungsi SELECT SCOPE_IDENTITY().</p>

<p>{% codeblock lang:vbnet %}
Private Sub btnInsert_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles btnInsert.Click
    Dim lastID As Long = 0</p>

<pre><code>strSql = "INSERT INTO provinsi (keterangan) VALUES (@1) SELECT SCOPE_IDENTITY()" ' ada tambahan SELECT SCOPE_IDENTITY()
Using cmd As New SqlClient.SqlCommand(strSql, conn)
    With cmd
        .Parameters.Clear()
        .Parameters.AddWithValue("@1", "Riau")

        lastID = Convert.ToInt32(.ExecuteScalar())
    End With
End Using

MessageBox.Show ("Last ID : " &amp; lastID.ToString())
</code></pre>

<p>End Sub
{% endcodeblock %}</p>

<p>Gimana lebih simple kan ? :)</p>

<p>Oke sekarang kita lihat kode untuk MySQL(SELECT LAST_INSERT_ID) dan Firebird (RETURN KOLOM_PK).</p>

<p>{% codeblock lang:vbnet %}
&lsquo; MySQL
Private Sub btnInsert_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles btnInsert.Click
    Dim lastID As Long = 0</p>

<pre><code>strSql = "INSERT INTO provinsi (keterangan) VALUES (@1); SELECT LAST_INSERT_ID()"
Using cmd As New MySqlClient.MySqlCommand(strSql, conn)
    With cmd
        .Parameters.Clear()
        .Parameters.AddWithValue("@1", "Riau")

        lastID = Convert.ToInt32(.ExecuteScalar())
    End With
End Using

MessageBox.Show ("Last ID : " &amp; lastID.ToString())
</code></pre>

<p>End Sub</p>

<p>&lsquo; Firebird
Private Sub btnInsert_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles btnInsert.Click
    Dim lastID As Long = 0</p>

<pre><code>strSql = "INSERT INTO provinsi (keterangan) VALUES (@1) RETURNING ID" ' ID -&gt; kolom primary key
Using cmd As New FirebirdClient.FbCommand(strSql, conn)
    With cmd
        .Parameters.Clear()
        .Parameters.AddWithValue("@1", "Riau")

        lastID = Convert.ToInt32(.ExecuteScalar())
    End With
End Using

MessageBox.Show ("Last ID : " &amp; lastID.ToString())
</code></pre>

<p>End Sub
{% endcodeblock %}</p>

<p>Untuk bisa mengakses database MySQL dan Firebird di Visual Basic .NET kita harus menginstall <a href="http://dev.mysql.com/downloads/connector/net/">MySQL Connector/Net</a> dan <a href="http://firebirdsql.org/index.php?op=files&amp;id=netprovider">Firebird ADO.NET Data Provider</a>.</p>

<p>Selamat mencoba :)</p>
]]></content>
  </entry>
  
</feed>
