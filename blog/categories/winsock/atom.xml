<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Category: Winsock | Coding4ever's Blog]]></title>
  <link href="http://coding4ever.net/blog/categories/winsock/atom.xml" rel="self"/>
  <link href="http://coding4ever.net/"/>
  <updated>2015-04-20T10:43:05+07:00</updated>
  <id>http://coding4ever.net/</id>
  <author>
    <name><![CDATA[Admin]]></name>
    
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[Aplikasi Antrian]]></title>
    <link href="http://coding4ever.net/blog/2012/02/26/aplikasi-antrian/"/>
    <updated>2012-02-26T10:02:09+07:00</updated>
    <id>http://coding4ever.net/blog/2012/02/26/aplikasi-antrian</id>
    <content type="html"><![CDATA[<p>Aplikasi ini merupakan pengembangan dari sample aplikasi yg sudah pernah saya bahas pada postingan <a href="{{%20site.url%20}}/blog/2010/01/30/belajar-winsock-bagian-3-%e2%80%93-multiple-connection/">sebelumnya</a>, aplikasi ini terdiri dari 2 project yaitu :</p>

<ol>
<li><p> Aplikasi server memanfaatkan array winsock karena akan menghandle minimal 1 koneksi</p></li>
<li><p> Untuk aplikasi klien cukup menggunakan winsock standar (non array).</p></li>
</ol>


<!-- more -->


<p><a href="http://coding4ever.files.wordpress.com/2012/02/26022012-2.png"><img src="http://coding4ever.files.wordpress.com/2012/02/26022012-2.png" alt="" /></a></p>

<p>Sekarang akan kita bahas cara pembuatannya.</p>

<p><strong>Aplikasi server</strong></p>

<p>Aplikasi server menggunakan winsock yg dijadikan array karena akan menerima lebih dari 1 koneksi, untuk menjadikan sebuah winsock menjadi array cukup dengan mengeset properties index = 0</p>

<p><a href="http://coding4ever.files.wordpress.com/2012/02/26022012-1.png"><img src="http://coding4ever.files.wordpress.com/2012/02/26022012-1.png" alt="" /></a></p>

<p>Selain itu agar sebuah winsock bisa menerima koneksi yg masuk, maka winsocknya harus dalam mode &ldquo;Listen&rdquo;, untuk keperluan ini kita akan menyiapkan sebuah fungsi misal dengan nama startListening</p>

<p>{% codeblock lang:vbnet %}
Private Function startListening(ByVal localPort As Long) As Boolean
    On Error GoTo errHandle</p>

<pre><code>If localPort &gt; 0 Then
    'If the socket is already listening, and it's listening on the same port, don't bother restarting it.
    If (wckServer(0).State &lt;&gt; sckListening) Or (wckServer(0).localPort &lt;&gt; localPort) Then
        With wckServer(0)
            Call .Close
            .localPort = localPort
            Call .Listen
        End With
    End If

    'Return true, since the server is now listening for clients.
    startListening = True
</code></pre>

<p>   End If</p>

<p>   Exit Function
errHandle:
   startListening = False
End Function
{% endcodeblock %}</p>

<p>Selanjutnya tinggal kita panggil pada event Form_Load</p>

<p>{% codeblock lang:vbnet %}
Private Sub Form_Load()
    &lsquo;1234 adalah port yg digunakan untuk komunikasi
    &#8216;antara server dan klien, nilainya bisa disesuaikan
    If startListening(1234) Then
        MsgBox &ldquo;Status Server ON&rdquo;
    Else
        MsgBox &ldquo;Status Server OFF&rdquo;
    End If
End Sub
{% endcodeblock %}</p>

<p>Selain itu ada beberapa kode yang harus kita lengkapi pada event2x yg dimiliki oleh winsock yaitu event Close, ConnectionRequest, DataArrival dan Error</p>

<p>{% codeblock lang:vbnet %}
Private Sub wckServer_Close(Index As Integer)
    &lsquo; Close the socket and raise the event to the parent.
    Call wckServer(Index).Close
End Sub
{% endcodeblock %}
{% codeblock lang:vbnet %}
Private Sub wckServer_ConnectionRequest(Index As Integer, ByVal requestID As Long)
    Dim i          As Long
    Dim j          As Long
    Dim blnLoaded  As Boolean</p>

<pre><code>On Error GoTo errHandle

' We shouldn't get ConnectionRequests on any other socket than the listener
' (index 0), but check anyway. Also check that we're not going to exceed
' the MaxClients property.
If (Index = 0) Then
    ' Check to see if we've got any sockets that are free.
    For i = 1 To wckServer.UBound
        If (wckServer(i).State = sckClosed) Then
            j = i
            Exit For
        End If
    Next i

    ' If we don't have any free sockets, load another on the array.
    If (j = 0) Then
        blnLoaded = True
        Call Load(wckServer(wckServer.UBound + 1))
        j = wckServer.Count - 1
    End If

    ' With the selected socket, reset it and accept the new connection.
    With wckServer(j)
        Call .Close
        Call .Accept(requestID)
    End With

End If

Exit Sub
'
</code></pre>

<p>errHandle:
    &lsquo; Close the Winsock that caused the error.
    Call wckServer(0).Close
End Sub
{% endcodeblock %}</p>

<p>Event ConnectionRequest berfungsi untuk memfilter koneksi yg masuk, jika ada koneksi yg masuk akan dilakukan pengecekan terlebih dulu apakah ada winsock yg idle (ngangur) jika ada maka koneksi tersebut akan langsung dihandle oleh winsock yg idle tadi, jika tidak maka akan diload terlebih dulu winsock yg baru kemudian langsung menghandle koneksi yg baru masuk tadi.</p>

<p>Teknik ini merupakah salah satu cara untuk melakukan optimasi program jangan sampai aplikasi server meload secara terus menerus objek winsock yg baru untuk setiap koneksi yg masuk.</p>

<p>{% codeblock lang:vbnet %}
Private Sub wckServer_DataArrival(Index As Integer, ByVal bytesTotal As Long)
    Dim cmd     As String</p>

<pre><code>On Error GoTo errHandle

' Grab the data from the specified Winsock object, and pass it to the parent.
Call wckServer(Index).GetData(cmd)

Select Case cmd
    Case "get_no_antrian"
        Call send(Index, CStr(noAntrian))

        lblNoAntrian.Caption = noAntrian
        noAntrian = noAntrian + 1 ' naikkan counter nomor antrian

    Case Else
        Call send(Index, "perintah tidak dikenal")
End Select

Exit Sub
</code></pre>

<p>errHandle:
   Call wckServer(Index).Close
End Sub
{% endcodeblock %}</p>

<p>Event DataArrival berfungsi untuk memproses data yg masuk, untuk kasus aplikasi antrian ini data yang paling valid hanya berupa string &ldquo;get_no_antrian&rdquo;, jika datanya valid akan langsung dikirimkan nomor antrian terakhir ke klien yg mengirimkan string &ldquo;get_no_antrian&rdquo; dg memanggil prosedur send.</p>

<p>{% codeblock lang:vbnet %}
Private Sub send(ByVal lngIndex As Long, ByVal strData As String)
    If (wckServer(lngIndex).State = sckConnected) Then
        Call wckServer(lngIndex).SendData(strData): DoEvents
    Else
        Exit Sub
    End If
End Sub
{% endcodeblock %}
{% codeblock lang:vbnet %}
Private Sub wckServer_Error(Index As Integer, ByVal Number As Integer, Description As String, ByVal Scode As Long, ByVal Source As String, ByVal HelpFile As String, ByVal HelpContext As Long, CancelDisplay As Boolean)
    Call wckServer(Index).Close
End Sub
{% endcodeblock %}</p>

<p>Untuk aplikasi server sy rasa sudah cukup akan kita lanjutkan dg aplikasi klien.</p>

<p><strong>Aplikasi Klien</strong></p>

<p>Untuk aplikasi klien lebih sederhana lagi, yg kita butuhkan cukup sebuah fungsi untuk melakukan koneksi ke server</p>

<p>{% codeblock lang:vbnet %}
Private Const conTunggu As Long = 100000
{% endcodeblock %}
{% codeblock lang:vbnet %}
Private Function isConnected(ByVal ipServer As String, ByVal port As Long) As Boolean
    Static i As Long</p>

<pre><code>On Error Resume Next

If myClient.State &lt;&gt; sckClosed Then myClient.Close ' close existing connection
myClient.RemoteHost = ipServer
myClient.RemotePort = port
myClient.Connect

With myClient
    Do Until .State = sckConnected
        DoEvents
        i = i + 1
        If i &gt;= conTunggu Then
            i = 0
            Exit Function
        End If
    Loop
End With

isConnected = myClient.State = sckConnected
</code></pre>

<p>End Function
{% endcodeblock %}</p>

<p>Contoh pemanggilan fungsi diatas seperti berikut :</p>

<p>{% codeblock lang:vbnet %}
Private Sub cmdAmbilNoAntrian_Click()
    Dim ipServer    As String
    Dim cmd         As String</p>

<pre><code>ipServer = "127.0.0.1"
cmd = "get_no_antrian"

' 1234 ada port yg menyesuaikan port yg ada di server
If isConnected(ipServer, 1234) Then
    myClient.SendData cmd
End If
</code></pre>

<p>End Sub
{% endcodeblock %}</p>

<p>Untuk mengetahui data yang dikirim balik oleh server kita bisa memanfaatkan event DataArrival yg dimiliki oleh objek winsock</p>

<p>{% codeblock lang:vbnet %}
Private Sub myClient_DataArrival(ByVal bytesTotal As Long)
    Dim noAntrian As String</p>

<pre><code>On Error Resume Next

myClient.GetData noAntrian
lblNoAntrian.Caption = noAntrian
</code></pre>

<p>End Sub
{% endcodeblock %}</p>

<p>Selesai :)</p>

<p>Aplikasi diatas belum menggunakan database sama sekali, sehingga jika aplikasi server ditutup maka counter nomor antrian akan dimulai dari 1 lagi, dan sy berharap tidak ada pertanyaan bagaimana menyimpan counter nomor antriannya ke database atw bagaimana cara menampilkan nomor atrian terakhir klo servernya error :D.</p>

<p>Selamat <a href="https://github.com/k4m4r82/Antrian">MENCOBA</a> :)</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Belajar Winsock Bagian Akhir – Contoh Kasus Mengakses Data Stok Barang Dari Luar]]></title>
    <link href="http://coding4ever.net/blog/2010/02/04/belajar-winsock-bagian-akhir-e28093-contoh-kasus-mengakses-data-stok-barang-dari-luar/"/>
    <updated>2010-02-04T16:47:57+07:00</updated>
    <id>http://coding4ever.net/blog/2010/02/04/belajar-winsock-bagian-akhir-e28093-contoh-kasus-mengakses-data-stok-barang-dari-luar</id>
    <content type="html"><![CDATA[<p>Akhirnya rilis juga artikel terakhir dari 5 seri belajar winsock ini, sebelum kita melanjutkan pembahasan ada baiknya kita melakukan sedikit review :</p>

<ol>
<li><p> <a href="{{%20site.url%20}}/blog/2010/01/26/belajar-winsock-bagian-1-intro/">Dasar-dasar penggunaan winsock</a> sudah kita pelajari</p></li>
<li><p> Ini terbukti dengan suksesnya kita membuat <a href="{{%20site.url%20}}/blog/2010/01/28/belajar-winsock-bagian-2-membuat-aplikasi-chat-sederhana-11/">aplikasi chat sederhana</a></p></li>
<li><p> Di tambah lagi ada teman kita yang mau nebeng sehingga terciptanya <a href="{{%20site.url%20}}/blog/2010/01/30/belajar-winsock-bagian-3-%E2%80%93-multiple-connection/">aplikasi chat multiple connection</a></p></li>
<li><p> <a href="{{%20site.url%20}}/blog/2010/02/02/belajar-winsock-bagian-4-%e2%80%93-membuat-jaringan-vpn-sendiri/">Jalan tol</a> antara laptop mas Paijo dan komputer server tokonya juga udah selesai dibangun dengan anggaran 0 Rp :D</p></li>
</ol>


<!-- more -->


<p>Berarti sekarang waktu yang tepat untuk mencoba ketangguhan mas Win (maksudnya Winsock :D) kalo lari jarak dekat (jaringan LAN) masih bisa diandalkan, bagai mana dengan lari jarak jauh (via internet) apakah juga masih bisa diandalkan ?</p>

<p>Objek-objek yang akan dijadikan korban untuk uji coba kali ini :</p>

<ol>
<li><p> Database barang dengan format ms access</p></li>
<li><p> Aplikasi server</p></li>
<li><p> Aplikasi klien</p></li>
</ol>


<p>Data yang dikirim dari server dibatasi maksimal 1024 karakter dalam sekali kirim, otomatis jika data > 1024 akan dipecah menjadi beberapa paket, berikut cuplikan kodenya (server) :</p>

<p>{% codeblock %}
Option Explicit</p>

<p>Private Const LOCAL_PORT As Long = 1007</p>

<p>Private Const REC_SPR As String * 1 = &ldquo;|&rdquo; &lsquo;separator baris
Private Const FLD_SPR As String * 1 = &ldquo;#&rdquo; &#8216;separator kolom
Private Const MAX_LIMIT As Long = 1024 &#8216;1x kirim dibatasi 1 kb, kalo untuk jaringan lokal masih bisa set 4096</p>

<p>Private Function pembulatanKeAtas(ByVal X As Double, Optional ByVal Factor As Double = 1) As Double
    Dim temp As Double</p>

<pre><code>temp = Int(X * Factor)
pembulatanKeAtas = (temp + IIf(X = temp, 0, 1)) / Factor
</code></pre>

<p>End Function</p>

<p>Private Function getDataBarang(ByVal param As String) As String()
    Dim rs          As ADODB.Recordset</p>

<pre><code>Dim div         As Long
Dim lengthData  As Long
Dim n           As Long
Dim i           As Long

Dim tmp         As String
Dim arrTmp()    As String

strSql = "SELECT UCASE(nama), harga, stok FROM barang " &amp; param &amp; ""
Set rs = openRecordset(strSql)
If Not rs.EOF Then
    For i = 1 To getRecordCount(rs)
        tmp = tmp &amp; rs(0).Value &amp; FLD_SPR &amp; rs(1).Value &amp; FLD_SPR &amp; rs(2).Value &amp; REC_SPR

        rs.MoveNext
    Next i
    If Len(tmp) &gt; 0 Then tmp = Left(tmp, Len(tmp) - 1)

    'karakter ~ sebagai penanda awal dan akhir data
    'untuk memudahkan pengecekan di klien bahwa data yg diterima sudah lengkap/belum
    'ex : ~DATA BARANG + SEPARATOR KOLOM DAN BARIS~

    'contoh format data disini ada 2 :
    '1. jika data &lt;= 1024 karakter : ~~DATA BARANG + SEPARATOR KOLOM DAN BARIS
    '2. jika data &gt; 1024 karakter  : ~DATA BARANG + SEPARATOR KOLOM DAN BARIS~

    If Len(tmp) &gt; 0 Then tmp = "~" &amp; Left(tmp, Len(tmp) - 1) &amp; "~"
    If Not Len(tmp) &gt; MAX_LIMIT Then
        tmp = Left(tmp, Len(tmp) - 1)
        tmp = "~" &amp; tmp
    End If

    lengthData = Len(tmp)
    If lengthData &gt; 0 Then
        If lengthData &gt; MAX_LIMIT Then 'data &gt; 1024 karakter
            'data dibuat menjadi beberapa package
            'ex : jika jumlah karakter 2345
            '     package 1 -&gt; 1024
            '     package 2 -&gt; 1024
            '     package 3 -&gt; 297
            '     berarti data yg dikirim ke klien sebanyak 3 x

            div = pembulatanKeAtas(lengthData / MAX_LIMIT)
            ReDim arrTmp(div)

            n = 1
            For i = 1 To div
                arrTmp(i - 1) = Mid(tmp, n, MAX_LIMIT)
                n = n + MAX_LIMIT
            Next i

        Else
            ReDim arrTmp(0)
            arrTmp(0) = tmp
        End If

    Else
        ReDim arrTmp(0)
        arrTmp(0) = tmp
    End If

Else
    ReDim arrTmp(0)
    arrTmp(0) = "EOF" 'data barang tidak ditemukan
End If
Call closeRecordset(rs)

getDataBarang = arrTmp
</code></pre>

<p>End Function
{% endcodeblock %}</p>

<p>pengiriman data ke klien akan dihandle oleh event DataArrival :</p>

<p>{% codeblock %}
Private Sub Socket_DataArrival(Index As Integer, ByVal bytesTotal As Long)
    Dim i           As Long
    Dim strData     As String
    Dim ret         As Boolean</p>

<pre><code>Dim arrTmp()    As String

'On Error GoTo errHandle

' Grab the data from the specified Winsock object, and pass it to the parent.
Call Socket(Index).GetData(strData)
DoEvents

arrTmp = getDataBarang(strData)
For i = LBound(arrTmp) To UBound(arrTmp)
    If Len(arrTmp(i)) &gt; 0 Then ret = send(Index, arrTmp(i))
Next i

Exit Sub
</code></pre>

<p>errHandle:
   Call Socket(Index).Close
End Sub
{% endcodeblock %}</p>

<p>sedangkan untuk aplikasi klien bagian yg bertugas menerima data masih di event yang sama yaitu DataArrival :</p>

<p>{% codeblock %}
Private Sub Socket_DataArrival(ByVal bytesTotal As Long)
    Dim dataMasuk   As String</p>

<pre><code>'On Error Resume Next

Socket.GetData dataMasuk

If Left(dataMasuk, 2) = "~~" Then 'package data &lt;= 1024
    Call execOutput(dataMasuk)

ElseIf dataMasuk = "EOF" Then 'data tidak ditemukan
    Call execOutput(dataMasuk)

Else
    'package data &gt; 1024
    'berikut kode untuk penggabungan package data
    tmp = tmp &amp; dataMasuk
    If InStr(1, dataMasuk, "~") &gt; 0 Then packageHdr = packageHdr &amp; "~"

    If Len(packageHdr) = 2 Then Call execOutput(tmp) 'penggabungan package data selesai
End If
</code></pre>

<p>End Sub
{% endcodeblock %}</p>

<p>dan ini prosedure yang bertanggung jawab untuk memparsing data dan menampilkan ke ListView :</p>

<p>{% codeblock %}
Private Sub execOutput(ByVal data As String)
    Dim rec()   As String
    Dim fld()   As String</p>

<pre><code>Dim x       As Long
Dim noUrut  As Long

On Error GoTo errHandle

Screen.MousePointer = vbHourglass
DoEvents

If Left(data, 2) = "~~" Then 'complete
    data = Replace(data, "~~", "")

ElseIf data = "EOF" Then
    'do nothing

Else
    data = Left(data, Len(data) - 1) 'remove ~ left
    data = Right(data, Len(data) - 1) 'remove ~ right
End If

lsvBarang.ListItems.Clear

If data = "EOF" Then
    Screen.MousePointer = vbDefault
    MsgBox "Data barang dengan keyword '" &amp; txtNamaBarang.Text &amp; "' tidak ditemukan", vbInformation, "Informasi"

Else
    'contoh data :
    '~~SUSU KEDELAI ABC 200M#1000#24|SUSU KEDELAI MELILEA 500#1000#0|KOPI SUSU KPL API 3P#1000#0|SUSU KEDELAI ABC 200#1000#2
    '| -&gt; pemisah baris
    '# -&gt; pemisah kolom

    rec = Split(data, REC_SPR)

    With lsvBarang
        noUrut = 1
        For x = LBound(rec) To UBound(rec)
            fld = Split(rec(x), FLD_SPR)

            .ListItems.Add , , noUrut
            .ListItems(noUrut).SubItems(1) = fld(0) 'nama barang
            .ListItems(noUrut).SubItems(2) = FormatNumber(fld(1), 0) 'harga
            .ListItems(noUrut).SubItems(3) = fld(2) 'stok

            noUrut = noUrut + 1
        Next x
    End With
End If

Screen.MousePointer = vbDefault

Exit Sub
</code></pre>

<p>errHandle:
    Screen.MousePointer = vbDefault
End Sub
{% endcodeblock %}</p>

<p>dan ini hasilnya</p>

<p><a href="http://coding4ever.files.wordpress.com/2010/02/04022010-1.jpg"><img src="http://coding4ever.files.wordpress.com/2010/02/04022010-1.jpg?w=300" alt="" /></a></p>

<p>mas Paijo mengetikan keyword <strong>mie</strong> kemudian mengirimkannya ke server dan akan diproses dengan hasil rincian sbb :</p>

<ol>
<li><p> Jumlah record yang ditemukan sebanyak 181 record</p></li>
<li><p> Jumlah karakter nama barang + harga + stok + seperator = 5084 karakter dan dikirim menjadi beberapa paket</p></li>
<li><p> Hasil akhir klien juga menampilkan sebanyak 181 record, yang berarti bahwa uji coba kita berhasil :D</p></li>
</ol>


<p>Dan yang terpenting dari pembahasan ini, sample programnya bisa didownload di<a href="https://github.com/k4m4r82/AplikasiChat3">sini</a> :)</p>

<p>Selamat mencoba :)</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Belajar Winsock Bagian 4 – Membuat Jaringan VPN Sendiri]]></title>
    <link href="http://coding4ever.net/blog/2010/02/02/belajar-winsock-bagian-4-e28093-membuat-jaringan-vpn-sendiri/"/>
    <updated>2010-02-02T03:19:07+07:00</updated>
    <id>http://coding4ever.net/blog/2010/02/02/belajar-winsock-bagian-4-e28093-membuat-jaringan-vpn-sendiri</id>
    <content type="html"><![CDATA[<p>Pada artikel kali ini kita stop dulu untuk mengetikan baris-baris kode yang indah itu :D dan kita akan mencoba untuk membuat jaringan <a href="http://id.wikipedia.org/wiki/VPN">VPN</a> sendiri yang tentunya dengan investasi yang murah meriah :D dan nyaris dengan biaya 0 rupiah. G percaya ? Oke kita ikuti saja pembahasan berikut.</p>

<p>Misalkan kita punya klien sebutnya saja namanya mas Paijo yang sudah menggunakan program retail kita selama beberapa tahun. Mas Paijo ini sering berbelanja untuk keperluan tokonya ke luar kota dan masalah yang dihadapinya adalah kesulitan untuk mengecek jumlah stok barang di toko (selama ini untuk menanyakan jumlah stok masih telp2xan :D), dan baru-baru ini mas Paijo menghubungi kita untuk minta dibuatkan program kecil yang hanya sekedar untuk mengecek stok barang.</p>

<!-- more -->


<p>Hasil akhir pembicaraan disepakati perangkat jaringan yang akan digunakan adalah sebagai berikut :</p>

<ol>
<li><p> Komputer server untuk akses internetnya cukup menggunakan speedy dan hanya mendapatkan ip private.</p></li>
<li><p> Laptop mas Paijo rencananya menggunakan modem CDMA (bisa starone atau lainnya) kita anggap saja menggunakan starone.</p></li>
</ol>


<p>Beberapa solusi yang bisa kita tawarkan adalah sebagai berikut :</p>

<ol>
<li><p> Menggunakan program remote seperti <a href="www.teamviewer.com">Teamviewer</a> atau <a href="www.crossloop.com">CrossLoop</a>. Loh kok enggak pake program remote seperti <a href="www.radmin.com">Radmin</a>, <a href="www.netsupportmanager.com">Net Support Manager</a>, atau <a href="www.realvnc.com">RealVNC</a> ? Ya jelas enggak bisa, karena komputer servernya hanya mendapatkan ip private kecuali kalo kita mau direportkan dengan menyeting <a href="http://portforward.com/">portforwarding</a>nya.</p></li>
<li><p> Membuat program sendiri dengan menggunakan komponen Winsock, nah kalo ini cocox karena memang itu intinya dibuat artikel ke 4 ini :D</p></li>
</ol>


<p>Oke sampai disini kita sudah menentukan pilihan tetapi masalah baru muncul jangankan untuk mengakses data di komputer toko mau ngePING aja selalu Request timed out.</p>

<p>Tapi jangan kuatir setiap masalah selalu ada penyelesaiannya dan penyelesaian yang paling sederhana untuk kasus kita kali ini adalah membuat jaringan VPN sendiri dengan bantuan <a href="https://secure.logmein.com/US/products/hamachi2/">LogMeIn Hamachi</a>.</p>

<p>Berikut adalah langkah-langkah mulai dari pendaftaran, konfigurasi dan tentu saja sampai ngPINGnya berhasil :D</p>

<ol>
<li>Mendaftar dulu di<a href="https://secure.logmein.com/US/products/hamachi2/register.aspx">sini</a></li>
</ol>


<p><a href="http://coding4ever.files.wordpress.com/2010/02/02022010-1.jpg"><img src="http://coding4ever.files.wordpress.com/2010/02/02022010-1.jpg?w=266" alt="" /></a></p>

<p><a href="http://coding4ever.files.wordpress.com/2010/02/02022010-2.jpg"><img src="http://coding4ever.files.wordpress.com/2010/02/02022010-2.jpg?w=300" alt="" /></a></p>

<ol>
<li>Setelah proses mendaftar selesai kita lanjutkan dengan membuat jaringan</li>
</ol>


<p><a href="http://coding4ever.files.wordpress.com/2010/02/02022010-3.jpg"><img src="http://coding4ever.files.wordpress.com/2010/02/02022010-3.jpg?w=300" alt="" /></a></p>

<p><a href="http://coding4ever.files.wordpress.com/2010/02/02022010-4.jpg"><img src="http://coding4ever.files.wordpress.com/2010/02/02022010-4.jpg?w=300" alt="" /></a></p>

<p><a href="http://coding4ever.files.wordpress.com/2010/02/02022010-5.jpg"><img src="http://coding4ever.files.wordpress.com/2010/02/02022010-5.jpg?w=300" alt="" /></a></p>

<p><a href="http://coding4ever.files.wordpress.com/2010/02/02022010-6.jpg"><img src="http://coding4ever.files.wordpress.com/2010/02/02022010-6.jpg?w=300" alt="" /></a></p>

<p><a href="http://coding4ever.files.wordpress.com/2010/02/02022010-7.jpg"><img src="http://coding4ever.files.wordpress.com/2010/02/02022010-7.jpg?w=300" alt="" /></a></p>

<ol>
<li>Langkah berikutnya adalah mendownload LogMeIn Hamachi Installer</li>
</ol>


<p><a href="http://coding4ever.files.wordpress.com/2010/02/02022010-8.jpg"><img src="http://coding4ever.files.wordpress.com/2010/02/02022010-8.jpg?w=300" alt="" /></a></p>

<p><a href="http://coding4ever.files.wordpress.com/2010/02/02022010-9.jpg"><img src="http://coding4ever.files.wordpress.com/2010/02/02022010-9.jpg?w=300" alt="" /></a></p>

<p><a href="http://coding4ever.files.wordpress.com/2010/02/02022010-10.jpg"><img src="http://coding4ever.files.wordpress.com/2010/02/02022010-10.jpg?w=300" alt="" /></a></p>

<p>Sambil menungu proses download selesai kita bisa logout dulu dari situs LogMeIn Hamachi.</p>

<ol>
<li>Setelah download selesai copykan file installer tadi ke laptop mas Paijo dan lakukan instalasi, setelah itu jalankan program LogMeIn Hamachi</li>
</ol>


<p><a href="http://coding4ever.files.wordpress.com/2010/02/02022010-111.jpg"><img src="http://coding4ever.files.wordpress.com/2010/02/02022010-111.jpg?w=300" alt="" /></a></p>

<ol>
<li>Selanjutkan kita akan mengganti informasi nama komputer dengan cara klik menu System -> Preferences &hellip;</li>
</ol>


<p><a href="http://coding4ever.files.wordpress.com/2010/02/02022010-12.jpg"><img src="http://coding4ever.files.wordpress.com/2010/02/02022010-12.jpg?w=300" alt="" /></a></p>

<p><a href="http://coding4ever.files.wordpress.com/2010/02/02022010-13.jpg"><img src="http://coding4ever.files.wordpress.com/2010/02/02022010-13.jpg?w=300" alt="" /></a></p>

<ol>
<li>Bergabung dengan <strong>Jaringan Tokonya Mas Paijo</strong> dengan mengklik menu Network -> Join an existing network &hellip; atau cukup dengan mengklik tombol Join an existing network &hellip;</li>
</ol>


<p><a href="http://coding4ever.files.wordpress.com/2010/02/02022010-19.jpg"><img src="http://coding4ever.files.wordpress.com/2010/02/02022010-19.jpg?w=186" alt="" /></a></p>

<p>Setelah itu kita diminta untuk memasukkan Network ID dan Password</p>

<p><a href="http://coding4ever.files.wordpress.com/2010/02/02022010-141.jpg"><img src="http://coding4ever.files.wordpress.com/2010/02/02022010-141.jpg?w=300" alt="" /></a></p>

<p>jika berhasil akan kita dapatkan tampilan lebih kurang seperti berikut :</p>

<p><a href="http://coding4ever.files.wordpress.com/2010/02/02022010-15.jpg"><img src="http://coding4ever.files.wordpress.com/2010/02/02022010-15.jpg?w=186" alt="" /></a></p>

<ol>
<li><p>Ulangi langkah 4 sampai 6 di komputer server</p></li>
<li><p>Setelah instalasi + konfigurasi di komputer server selesai, coba kita cek masing-masing program LogMeIn Hamachi maka kita akan mendapatkan tampilan seperti berikut :</p></li>
</ol>


<p><a href="http://coding4ever.files.wordpress.com/2010/02/02022010-16.jpg"><img src="http://coding4ever.files.wordpress.com/2010/02/02022010-16.jpg?w=300" alt="" /></a></p>

<ol>
<li>Biar semakin manteb kita login ulang ke<a href="https://secure.logmein.com/US/products/hamachi2/">sini</a> dan jika kita mendapatkan tampilannya seperti berikut berarti langkah-langkah sebelumnya sudah 100% berhasil :)</li>
</ol>


<p><a href="http://coding4ever.files.wordpress.com/2010/02/02022010-17.jpg"><img src="http://coding4ever.files.wordpress.com/2010/02/02022010-17.jpg?w=300" alt="" /></a></p>

<p>dan otomatis kita juga bisa langsung menggunakan program-program remote seperti <a href="www.radmin.com">Radmin</a>, <a href="www.netsupportmanager.com">Net Support Manager</a>, atau <a href="www.realvnc.com">RealVNC</a> karena kita sudah mendapatkan IP Publik sendiri</p>

<ol>
<li>Terakhir kita akan mencoba ngePING komputer server</li>
</ol>


<p><a href="http://coding4ever.files.wordpress.com/2010/02/02022010-18.jpg"><img src="http://coding4ever.files.wordpress.com/2010/02/02022010-18.jpg?w=300" alt="" /></a></p>

<p>Jika hasil ping masih Request timed out coba nonaktifkan windows firewall di komputer server kemudian coba di ping lagi.</p>

<p>Oke sampai disini kita sudah berhasil membuat jaringan VPN sendiri dan memudahkan saya untuk menulis artikel terakhir yang insya Alloh dengan judul <a href="{{%20site.url%20}}/blog/2010/02/04/belajar-winsock-bagian-akhir-%e2%80%93-contoh-kasus-mengakses-data-stok-barang-dari-luar/">Belajar Winsock bagian akhir – Contoh kasus mengakses data stok barang dari luar</a>.</p>

<p>Selamat mencoba :)</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Belajar Winsock Bagian 3 – Multiple Connection]]></title>
    <link href="http://coding4ever.net/blog/2010/01/30/belajar-winsock-bagian-3-e28093-multiple-connection/"/>
    <updated>2010-01-30T10:52:28+07:00</updated>
    <id>http://coding4ever.net/blog/2010/01/30/belajar-winsock-bagian-3-e28093-multiple-connection</id>
    <content type="html"><![CDATA[<p>Di <a href="{{%20site.url%20}}/blog/2010/01/28/belajar-winsock-bagian-2-membuat-aplikasi-chat-sederhana-11/">postingan</a> saya sebelumnya kita sudah mengetahui bagai mana cara membuat aplikasi chat sederhana yang hanya melibatkan saya dan Anda :D, dan bagai mana jika ada teman saya yang lain ikut nimbrung ?</p>

<p>Jelas ini tidak bisa karena 1 winsock hanya bisa menangani 1 port, trus bagaimana jika kita ingin teman kita yang lain bisa konek di port yang sama dan hanya menggunakan 1 winsock? Jawabannya sederhana objek winsocknya kita jadikan array.</p>

<!-- more -->


<p>Oke, masukkan objek winsock ke form kemudian untuk menjadikannya sebagai objek array kita cukup mengset properties Index=0, jadi winsock dengan index 0 bertugas untuk mengecek permintaan koneksi masuk dan mengalokasikannya kepada yang berhak :) dan tentu saja untuk melakukan hal ini harus dalam mode mendengarkan/Listen</p>

<p>{% codeblock %}
Private Sub Form_Load()
    With Winsock1(0)
        .Close
        .LocalPort = 11111 &lsquo;nilai port ini bisa diganti
        .Listen
    End With
End Sub
{% endcodeblock %}</p>

<p>Ketika ada permintaan koneksi di port 11111, kita harus menambahkan objek winsock baru untuk menerima permintaan koneksi tersebut dan karena objek winsock yang baru tidak kita set properties LocalPortnya otomatis windows yang akan memberikan nilai Port secara acak.</p>

<p>{% codeblock %}
Private Sub Winsock1_ConnectionRequest(Index As Integer, ByVal requestID As Long)
    &lsquo;we should only be getting connection requests from
    &#8216;Index 0 because thats the only one that is listening</p>

<pre><code>'load a new winsock
Load Winsock1(Winsock1.UBound + 1)

'accept the incoming connection on our new control
Winsock1(Winsock1.UBound).Accept requestID
</code></pre>

<p>End Sub
{% endcodeblock %}</p>

<p>Fungsi <strong>UBound</strong> digunakan untuk mendapatkan nilai index terakhir dari objek array, jadi untuk mengetahui berapa jumlah objek arraynya kita cukup memanggil fungsi <strong>UBound + 1</strong>.</p>

<p>Solusi menggunakan winsock array diatas masih mempunyai sedikit masalah, misalkan kita sudah mempunyai 5 koneksi di port 11111 ini artinya kita sudah mempunyai 6 objek winsock yang aktif, index 0 dalam mode mendengarkan/Listen, dan 1 sampai 5 konek ke klien.</p>

<p>Apa yang terjadi jika 3 klien tidak terkoneksi lagi? Sebenarnya sih enggak terlalu bermasalah, masalahnya adalah jika ada klien lain yang konek ke server otomatis objek winsock baru ditambahkan lagi untuk menerima koneksi yang baru, padahal ada 3 objek winsock yang sedang nganggur/idle.</p>

<p>Bayangkan jika kita diminta untuk membuat aplikasi billing warnet dengan 100 klien, ada 50 klien yang sudah disconnect kemudian ada 50 klien lagi yang baru konek. Ini artinya kita mempunyai 50 objek winsock nganggur/idle yang jelas-jelas merupakan pemborosan memory dan bagai mana jika hal tersebut terulang lagi, lagi dan lagi.</p>

<p>Bagaimana solusinya? Yaph sebenarnya ini juga gampang, jadi jika ada permintaan koneksi dari klien kita cek dulu ada nggak objek winsock yang idle, kalo ada arahkan agar winsock yang idle tadi untuk menerima koneksi tersebut, jika tidak ada baru kita tambahkan objek winsock yang baru untuk menerima koneksi tersebut sehingga kode sebelumnya harus kita revisi menjadi :</p>

<p>{% codeblock %}
Private Sub Winsock1_ConnectionRequest(Index As Integer, ByVal requestID As Long)
    Dim i          As Long
    Dim j          As Long</p>

<pre><code>On Error GoTo errHandle

If Index = 0 Then 'ingat yang bertugas untuk mengecek permintaan koneksi adalah objek winsock dengan index = 0
    'ini bagian yang bertugas untuk mengecek winsock yang idle
    For i = 1 To Winsock1.UBound
        If Winsock1(i).State = sckClosed Or Winsock1(i).State = sckClosing Then
            j = i   'var j menampung index winsock yang idle
            Exit For
        End If
    Next i

    'jika j = 0 berarti semua winsock kepakai, otomatis kita harus menambahkan winsock yang baru
    If j = 0 Then
        Call Load(Winsock1(Winsock1.UBound + 1))
        j = Winsock1.UBound
    End If

    'terima koneksi yang baru
    With Winsock1(j)
        Call .Close
        Call .Accept(requestID)
    End With

End If

Exit Sub
</code></pre>

<p>errHandle:
    Call Winsock1(0).Close
End Sub
{% endcodeblock %}</p>

<p>Yaph cukup itu saja, contoh programnya bisa didownload di<a href="https://github.com/k4m4r82/AplikasiChat2">sini</a>.</p>

<p>Artikel berikutnya insya Alloh dengan judul <a href="{{%20site.url%20}}/blog/2010/02/02/belajar-winsock-bagian-4-%E2%80%93-membuat-jaringan-vpn-sendiri/">Belajar Winsock bagian 4 – Membuat jaringan VPN sendiri</a>.</p>

<p>Di artikel tersebut saya sudah tidak membahas penggunaan winsock lagi tetapi artikel tersebut dibutuhkan agar saya bisa menulis artikel terakhir dari 5 seri belajar Winsock ini yang berjudul <a href="{{%20site.url%20}}/blog/2010/02/04/belajar-winsock-bagian-akhir-%e2%80%93-contoh-kasus-mengakses-data-stok-barang-dari-luar/">Belajar Winsock bagian akhir – Contoh kasus mengakses data stok barang dari luar</a>.</p>

<p>Dan tentunya ini bukan via web (kalo yang ini sudah enggak perlu dibahas lagi) tetapi tetap dengan mengembangkan contoh-contoh program winsock sebelumnya, dan sebagai uji coba untuk komputer server toko yang akan diakses menggunakan speedy sedangkan saya menggunakan starone dan mudah-mudahan saja uji coba ini berhasil :).</p>

<p>Selamat mencoba :)</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Belajar Winsock Bagian 2 - Membuat Aplikasi Chat Sederhana 1:1]]></title>
    <link href="http://coding4ever.net/blog/2010/01/28/belajar-winsock-bagian-2-membuat-aplikasi-chat-sederhana-11/"/>
    <updated>2010-01-28T14:26:04+07:00</updated>
    <id>http://coding4ever.net/blog/2010/01/28/belajar-winsock-bagian-2-membuat-aplikasi-chat-sederhana-11</id>
    <content type="html"><![CDATA[<p>Setelah memahami <a href="{{%20site.url%20}}/blog/2010/01/26/belajar-winsock-bagian-1/">properties-properties dasar</a> yang harus disetting untuk membuat aplikasi sederhana menggunakan winsock, pada artikel ke 2 dari 5 seri belajar winsock ini kita akan membuat aplikasi chat sederhana dengan pola 1:1 atau dengan istilah lainnya single connection.</p>

<p>Membuat aplikasi chatting seperti MSN Messenger atau Yahoo Messenger sebenarnya mudah (tapi tidak termasuk saya ya :D) dan kita sudah mempelajari bagaimana membuat koneksi sederhana menggunakan winsock, selanjutnya kita tinggal mengirimkan data menggunakan method <strong>.SendData</strong> dan menghandle data yang diterima melalui event <strong>Winsock_DataArrival</strong>.</p>

<!-- more -->


<p>Contoh penggunaan method SendData :</p>

<p>{% codeblock %}
Private Sub cmdSend_Click()
    With Winsock1
        .SendData &ldquo;Belajar Winsock Bagian 2&rdquo;
    End With
    DoEvents
End Sub
{% endcodeblock %}</p>

<p>Pemanggilan fungsi DoEvents untuk memberikan jeda waktu untuk menyelesaikan pengiriman data.</p>

<p>Kode untuk menghandle data yang masuk juga sangat sederhana. Winsock menerima data dan menyimpannya di dalam <a href="http://id.wikipedia.org/wiki/Buffer">buffer</a>. Untuk memanggil data ini, kita tinggal memanggil method <strong>.GetData</strong> dan ingat kita tidak bisa memanggil method ini setiap waktu karena setelah itu buffer otomatis dikosongkan. Jadi waktu yang tepat untuk memanggil method ini adalah pada saat event <strong>Winsock_DataArrival</strong> dijalankan.</p>

<p>Contoh penggunaan method GetData :</p>

<p>{% codeblock %}
Private Sub Winsock1_DataArrival(ByVal bytesTotal As Long)
    Dim strData As String</p>

<pre><code>Call Winsock1.GetData(strData)
MsgBox strData
</code></pre>

<p>End Sub
{% endcodeblock %}</p>

<p>Oke, sampai disini kita sudah mengetahui dasar-dasar untuk membuat aplikasi chat sederhana dan untuk mendemokan ini kita akan membutuhkan 2 program kita sebut saja klien dan server. Adapun persiapan untuk aplikasi server/klien :</p>

<ol>
<li><p> Objek Winsock</p></li>
<li><p> Label</p></li>
<li><p> 2 TextBox</p></li>
<li><p> CommandButton</p></li>
</ol>


<p>Source code lengkap aplikasi server :</p>

<p>{% codeblock %}
Option Explicit</p>

<p>Private Sub cmdSend_Click()
    Winsock1.SendData txtChat.Text
    DoEvents</p>

<pre><code>txtMain.Text = txtMain.Text &amp; vbCrLf &amp; txtChat.Text
txtChat.Text = ""
</code></pre>

<p>End Sub</p>

<p>Private Sub Form_Load()
    Winsock1.LocalPort = 11111
    Winsock1.Listen
End Sub</p>

<p>Private Sub Winsock1_ConnectionRequest(ByVal requestID As Long)
    &lsquo;reset the socket, and accept the new connection
    Winsock1.Close
    Winsock1.Accept requestID
End Sub</p>

<p>Private Sub Winsock1_DataArrival(ByVal bytesTotal As Long)
    Dim strData As String</p>

<pre><code>'get the data and display it in the textbox
Winsock1.GetData strData
txtMain.Text = txtMain.Text &amp; vbCrLf &amp; strData
txtMain.SelStart = Len(txtMain.Text)
</code></pre>

<p>End Sub
{% endcodeblock %}</p>

<p>Aplikasi server tinggal duduk maniz :D dan menunggu koneksi yang masuk.</p>

<p>Source code lengkap aplikasi klien :</p>

<p>{% codeblock %}
Option Explicit</p>

<p>Private Sub Form_Load()
    &lsquo;set up the Winsock1 to connect to the local computer
    Winsock1.RemoteHost = &ldquo;127.0.0.1&rdquo;
    Winsock1.RemotePort = 11111
    Winsock1.Connect
End Sub</p>

<p>Private Sub cmdSend_Click()
    &lsquo;send the data thats in the text box and
    &#8216;clear it to prepare for the next chat message
    Winsock1.SendData txtChat.Text
    DoEvents</p>

<pre><code>txtMain.Text = txtMain.Text &amp; vbCrLf &amp; txtChat.Text
txtChat.Text = ""
</code></pre>

<p>End Sub</p>

<p>Private Sub Winsock1_Connect()
    &lsquo;we are connected!
    MsgBox &ldquo;Connected&rdquo;
End Sub</p>

<p>Private Sub Winsock1_DataArrival(ByVal bytesTotal As Long)
    Dim strData As String</p>

<pre><code>' get the data from the socket
Winsock1.GetData strData
' display it in the textbox
txtMain.Text = txtMain.Text &amp; vbCrLf &amp; strData
' scroll the box down
txtMain.SelStart = Len(txtMain.Text)
</code></pre>

<p>End Sub</p>

<p>Private Sub Winsock1_Error(ByVal Number As Integer, Description As String, ByVal Scode As Long, ByVal Source As String, ByVal HelpFile As String, ByVal HelpContext As Long, CancelDisplay As Boolean)
    &lsquo; an error has occured somewhere, so let the user know
    MsgBox &ldquo;Error: &rdquo; &amp; Description
    &rsquo; close the socket, ready to go again
    Winsock1.Close
End Sub
{% endcodeblock %}</p>

<p>Sample program bisa didownload di<a href="https://github.com/k4m4r82/AplikasiChat1">sini</a> dan artikel berikutnya insya Alloh dengan judul <a href="{{%20site.url%20}}/blog/2010/01/30/belajar-winsock-bagian-3-%e2%80%93-multiple-connection/">Belajar Winsock bagian 3 – Multiple Connection</a> segera menyusul.</p>

<p>Selamat mencoba :)</p>
]]></content>
  </entry>
  
</feed>
