<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Category: Sql Server | Coding4ever's Blog]]></title>
  <link href="http://coding4ever.net/blog/categories/sql-server/atom.xml" rel="self"/>
  <link href="http://coding4ever.net/"/>
  <updated>2016-02-15T07:42:23+07:00</updated>
  <id>http://coding4ever.net/</id>
  <author>
    <name><![CDATA[Admin]]></name>
    
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[Membuat Fungsi Koneksi Untuk Beberapa Database (Firebird, MySQL, Ms SQL Server Dan Ms Access)]]></title>
    <link href="http://coding4ever.net/blog/2009/12/29/membuat-fungsi-koneksi-untuk-beberapa-database-firebird-mysql-ms-sql-server-dan-ms-access/"/>
    <updated>2009-12-29T14:55:07+07:00</updated>
    <id>http://coding4ever.net/blog/2009/12/29/membuat-fungsi-koneksi-untuk-beberapa-database-firebird-mysql-ms-sql-server-dan-ms-access</id>
    <content type="html"><![CDATA[<p><strong>1. Tambahkan sebuah modul dan copy paste kode berikut :</strong></p>

<p>{% codeblock %}
Public conn As ADODB.Connection</p>

<p>Public Enum TIPE_DATABASE
   FIREBIRD = 1
   MYSQL = 2
   SQLSERVER = 3
   MSACCESS = 4
End Enum</p>

<p>Public Function connToDB(ByVal tipeDb As TIPE_DATABASE, Optional ByVal serverName As String = &ldquo;&rdquo;, _
   Optional ByVal userName As String = &ldquo;&rdquo;, Optional ByVal userPass As String = &ldquo;&rdquo;, _
   Optional ByVal dbPath As String = &ldquo;&rdquo;, Optional ByVal dbName As String = &ldquo;&rdquo;) As Boolean</p>

<p>   Dim strCon As String</p>

<p>   On Error GoTo errHandle</p>

<p>   Select Case tipeDb
      Case FIREBIRD
         strCon = &ldquo;DRIVER=Firebird/Interbase&reg; Driver;UID=&rdquo; &amp; userName &amp; &ldquo;;PWD=&rdquo; &amp; userPass &amp; &ldquo;;&rdquo; &amp; _
         &ldquo;DBNAME=&rdquo; &amp; serverName &amp; &ldquo;:&rdquo; &amp; dbPath &amp; &ldquo;\&rdquo; &amp; dbName &amp; &ldquo;&rdquo;</p>

<pre><code>  Case MYSQL
     strCon = "DRIVER={MySQL ODBC 5.1 Driver};SERVER=" &amp; serverName &amp; ";DATABASE=" &amp; dbName &amp; ";" &amp; _
     "UID=" &amp; userName &amp; ";PWD=" &amp; userPass &amp; ";OPTION=3"

  Case SQLSERVER
     strCon = "Provider=SQLOLEDB.1;User ID=" &amp; userName &amp; ";Pwd=" &amp; userPass &amp; ";" &amp; _
     "Initial Catalog=" &amp; dbName &amp; ";Data Source=" &amp; serverName &amp; ""

  Case MSACCESS
    If Len(userPass) &gt; 0 Then
       strCon = "Provider=Microsoft.Jet.OLEDB.4.0;Data Source= " &amp; dbPath &amp; "\" &amp; dbName &amp; ";" &amp; _
       "Jet OLEDB:Database Password=" &amp; userPass &amp; ""
    Else
       strCon = "Provider=Microsoft.Jet.OLEDB.4.0;Data Source= " &amp; dbPath &amp; "\" &amp; dbName &amp; ""
    End If
</code></pre>

<p>   End Select</p>

<p>   Set conn = New ADODB.Connection
   conn.ConnectionString = strCon
   conn.Open</p>

<p>   connToDB = True</p>

<p>   Exit Function
errHandle:
   connToDB = False
End Function
{% endcodeblock %}</p>

<p><strong>2. Pada form tambahkan sebuah objek command dan set properties Name = cmdTesKoneksi</strong></p>

<p>copy paste kode berikut :</p>

<p>{% codeblock %}
Private Sub cmdTesKoneksi_Click()
   Dim result  As Boolean</p>

<p>   &lsquo;Firebird
   result = connToDB(FIREBIRD, &ldquo;127.0.0.1&rdquo;, &ldquo;SYSDBA&rdquo;, &ldquo;masterkey&rdquo;, &ldquo;d:\data&rdquo;, &ldquo;db_akademik.fdb&rdquo;)
   Debug.Print result</p>

<p>   &lsquo;MySQL
   result = connToDB(MYSQL, &ldquo;127.0.0.1&rdquo;, &ldquo;root&rdquo;, &ldquo;masterkey&rdquo;, , &ldquo;db_akademik&rdquo;)
   Debug.Print result</p>

<p>   &lsquo;SQL Server 2000
   result = connToDB(SQLSERVER, &ldquo;127.0.0.1&rdquo;, &ldquo;sa&rdquo;, &ldquo;masterkey&rdquo;, , &ldquo;db_akademik&rdquo;)
   Debug.Print result</p>

<p>   &lsquo;Ms Access - tanpa password
   result = connToDB(MSACCESS, , , , &ldquo;d:\data&rdquo;, &ldquo;db_akademik.mdb&rdquo;)
   Debug.Print result</p>

<p>   &lsquo;Ms Access - menggunakan password
   result = connToDB(MSACCESS, , , &ldquo;masterkey&rdquo;, &ldquo;d:\data&rdquo;, &ldquo;db_akademik.mdb&rdquo;)
   Debug.Print result
End Sub
{% endcodeblock %}</p>

<p>Untuk nilai semua parameter fungsi connToDB disesuaikan dengan kondisi komputer Anda. Selamat mencoba :)</p>
]]></content>
  </entry>
  
</feed>
