<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Category: Visual Basic | Coding4ever's Blog]]></title>
  <link href="http://coding4ever.net/blog/categories/visual-basic/atom.xml" rel="self"/>
  <link href="http://coding4ever.net/"/>
  <updated>2015-04-15T13:27:27+07:00</updated>
  <id>http://coding4ever.net/</id>
  <author>
    <name><![CDATA[Admin]]></name>
    
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[Menggunakan Library .NET Di VB 6]]></title>
    <link href="http://coding4ever.net/blog/2012/06/01/menggunakan-library-net-di-vb-6/"/>
    <updated>2012-06-01T16:53:49+07:00</updated>
    <id>http://coding4ever.net/blog/2012/06/01/menggunakan-library-net-di-vb-6</id>
    <content type="html"><![CDATA[<p>Ini postingan lama sebenarnya, jawaban sy untuk salah satu pertanyaan member di forum <a href="http://www.i-bego.com/visual-basic-net/cara-buat-file-dll-net-assembly-com-visible-t2377.html">i-bego</a>.</p>

<p>Sy posting kembali disini untuk tujuan dokumentasi saja, mana tau suatu saat sy butuhkan.</p>

<p>Untuk contoh kasusnya adalah kita akan mengambil salah satu project open source yg bernama <a href="http://www.codeproject.com/Articles/20574/Open-Source-QRCode-Library">QRCode Library</a> dibuat menggunakan C#, dan dengan sedikit modifikasi library .NET ini akan bisa kita gunakan untuk VB 6.</p>

<!-- more -->


<p>Tapi sebelumnya kita lihat dulu apa itu QR Code ???</p>

<blockquote><p>QR Code (abbreviated from Quick Response Code) is the trademark for a type of matrix barcode (or two-dimensional code) first designed for the automotive industry. More recently, the system has become popular outside the industry due to its fast readability and large storage capacity compared to standard UPC barcodes. The code consists of black modules (square dots) arranged in a square pattern on a white background. The information encoded can be made up of four standardized kinds (&ldquo;modes&rdquo;) of data (numeric, alphanumeric, byte/binary, Kanji), or through supported extensions, virtually any kind of data.</p></blockquote>

<p>Sumber : <a href="http://en.wikipedia.org/wiki/QR_code">http://en.wikipedia.org/wiki/QR_code</a></p>

<p>Contoh QR Code</p>

<p><a href="http://coding4ever.files.wordpress.com/2012/06/qrcode.png"><img src="http://coding4ever.files.wordpress.com/2012/06/qrcode.png" alt="" /></a></p>

<p>Oke langsung saja download <a href="http://www.codeproject.com/Articles/20574/Open-Source-QRCode-Library">QRCode Library</a>, untuk contoh disini sy menggunakan C# 2005</p>

<ol>
<li>Aktifkan terlebih dulu project <a href="http://www.codeproject.com/Articles/20574/Open-Source-QRCode-Library">QRCode Library</a></li>
</ol>


<p><a href="http://coding4ever.files.wordpress.com/2012/06/qrcode-lib.png"><img src="http://coding4ever.files.wordpress.com/2012/06/qrcode-lib.png" alt="" /></a></p>

<ol>
<li>klik kanan Project (QRCodeLib) -> Properties, aktifkan tab Application kemudian klik tombol Assembly Information &hellip; kemudian aktifkan pilihan Make assembly COM-Visible</li>
</ol>


<p><a href="http://coding4ever.files.wordpress.com/2011/09/18092011-1.png"><img src="http://coding4ever.files.wordpress.com/2011/09/18092011-1.png" alt="" /></a></p>

<p><a href="http://coding4ever.files.wordpress.com/2011/09/18092011-2.png"><img src="http://coding4ever.files.wordpress.com/2011/09/18092011-2.png" alt="" /></a></p>

<ol>
<li>Aktifkan tab Build kemudian aktifkan pilihan Register for COM interop</li>
</ol>


<p><a href="http://coding4ever.files.wordpress.com/2011/09/18092011-3.png"><img src="http://coding4ever.files.wordpress.com/2011/09/18092011-3.png" alt="" /></a></p>

<ol>
<li>Mendaftarkan file ThoughtWorks.QRCode.dll dan ThoughtWorks.QRCode.tlb menggunakan tool RegAsm.exe yg ada di folder NET Framework</li>
</ol>


<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>C:\Windows\Microsoft.NET\Framework\v2.0.50727</span></code></pre></td></tr></table></div></figure></p>

<p>Contoh saya menggunakan dot NET Framework 2, adapun perintahnya seperti berikut :</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>regasm ThoughtWorks.QRCode.dll /tlb: ThoughtWorks.QRCode.tlb /codebase</span></code></pre></td></tr></table></div></figure></p>

<p>Sampai disini QRCode Library sudah bisa diakses dari VB 6</p>

<p><a href="http://coding4ever.files.wordpress.com/2011/09/18092011-4.png"><img src="http://coding4ever.files.wordpress.com/2011/09/18092011-4.png" alt="" /></a></p>

<p>Sekarang kita lihat sample asli dari QRCode Library</p>

<p><a href="http://coding4ever.files.wordpress.com/2011/09/18092011-5.png"><img src="http://coding4ever.files.wordpress.com/2011/09/18092011-5.png" alt="" /></a></p>

<p>Dari sample tersebut kode (C#) untuk melakukan encode sebuah data bertipe string menjadi gambar dengan format <a href="http://id.wikipedia.org/wiki/Kode_QR">QR Code</a> adalah seperti berikut :</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
</pre></td><td class='code'><pre><code class='c#'><span class='line'><span class="k">private</span> <span class="k">void</span> <span class="nf">btnEncode_Click_1</span><span class="p">(</span><span class="kt">object</span> <span class="n">sender</span><span class="p">,</span> <span class="n">EventArgs</span> <span class="n">e</span><span class="p">)</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'>    <span class="k">if</span> <span class="p">(</span><span class="n">txtEncodeData</span><span class="p">.</span><span class="n">Text</span><span class="p">.</span><span class="n">Trim</span><span class="p">()</span> <span class="p">==</span> <span class="n">String</span><span class="p">.</span><span class="n">Empty</span><span class="p">)</span>
</span><span class='line'>    <span class="p">{</span>
</span><span class='line'>        <span class="n">MessageBox</span><span class="p">.</span><span class="n">Show</span><span class="p">(&amp;</span><span class="n">ldquo</span><span class="p">;</span><span class="n">Data</span> <span class="n">must</span> <span class="n">not</span> <span class="n">be</span> <span class="n">empty</span><span class="p">.&amp;</span><span class="n">rdquo</span><span class="p">;);</span>
</span><span class='line'>        <span class="k">return</span><span class="p">;</span>
</span><span class='line'>    <span class="p">}&lt;/</span><span class="n">p</span><span class="p">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="p">&lt;</span><span class="n">pre</span><span class="p">&gt;&lt;</span><span class="n">code</span><span class="p">&gt;</span><span class="n">QRCodeEncoder</span> <span class="n">qrCodeEncoder</span> <span class="p">=</span> <span class="k">new</span> <span class="n">QRCodeEncoder</span><span class="p">();</span>
</span><span class='line'><span class="n">String</span> <span class="n">encoding</span> <span class="p">=</span> <span class="n">cboEncoding</span><span class="p">.</span><span class="n">Text</span> <span class="p">;</span>
</span><span class='line'><span class="k">if</span> <span class="p">(</span><span class="n">encoding</span> <span class="p">==</span> <span class="s">&quot;Byte&quot;</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>    <span class="n">qrCodeEncoder</span><span class="p">.</span><span class="n">QRCodeEncodeMode</span> <span class="p">=</span> <span class="n">QRCodeEncoder</span><span class="p">.</span><span class="n">ENCODE_MODE</span><span class="p">.</span><span class="n">BYTE</span><span class="p">;</span>
</span><span class='line'><span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">encoding</span> <span class="p">==</span> <span class="s">&quot;AlphaNumeric&quot;</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>    <span class="n">qrCodeEncoder</span><span class="p">.</span><span class="n">QRCodeEncodeMode</span> <span class="p">=</span> <span class="n">QRCodeEncoder</span><span class="p">.</span><span class="n">ENCODE_MODE</span><span class="p">.</span><span class="n">ALPHA_NUMERIC</span><span class="p">;</span>
</span><span class='line'><span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">encoding</span> <span class="p">==</span> <span class="s">&quot;Numeric&quot;</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>    <span class="n">qrCodeEncoder</span><span class="p">.</span><span class="n">QRCodeEncodeMode</span> <span class="p">=</span> <span class="n">QRCodeEncoder</span><span class="p">.</span><span class="n">ENCODE_MODE</span><span class="p">.</span><span class="n">NUMERIC</span><span class="p">;</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'><span class="k">try</span> <span class="p">{</span>
</span><span class='line'>    <span class="kt">int</span> <span class="n">scale</span> <span class="p">=</span> <span class="n">Convert</span><span class="p">.</span><span class="n">ToInt16</span><span class="p">(</span><span class="n">txtSize</span><span class="p">.</span><span class="n">Text</span><span class="p">);</span>
</span><span class='line'>    <span class="n">qrCodeEncoder</span><span class="p">.</span><span class="n">QRCodeScale</span> <span class="p">=</span> <span class="n">scale</span><span class="p">;</span>
</span><span class='line'><span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="n">Exception</span> <span class="n">ex</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>    <span class="n">MessageBox</span><span class="p">.</span><span class="n">Show</span><span class="p">(</span><span class="s">&quot;Invalid size!&quot;</span><span class="p">);</span>
</span><span class='line'>    <span class="k">return</span><span class="p">;</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'><span class="k">try</span> <span class="p">{</span>
</span><span class='line'>    <span class="kt">int</span> <span class="n">version</span> <span class="p">=</span> <span class="n">Convert</span><span class="p">.</span><span class="n">ToInt16</span><span class="p">(</span><span class="n">cboVersion</span><span class="p">.</span><span class="n">Text</span><span class="p">)</span> <span class="p">;</span>
</span><span class='line'>    <span class="n">qrCodeEncoder</span><span class="p">.</span><span class="n">QRCodeVersion</span> <span class="p">=</span> <span class="n">version</span><span class="p">;</span>
</span><span class='line'><span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="n">Exception</span> <span class="n">ex</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>    <span class="n">MessageBox</span><span class="p">.</span><span class="n">Show</span><span class="p">(</span><span class="s">&quot;Invalid version !&quot;</span><span class="p">);</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="kt">string</span> <span class="n">errorCorrect</span> <span class="p">=</span> <span class="n">cboCorrectionLevel</span><span class="p">.</span><span class="n">Text</span><span class="p">;</span>
</span><span class='line'><span class="k">if</span> <span class="p">(</span><span class="n">errorCorrect</span> <span class="p">==</span> <span class="s">&quot;L&quot;</span><span class="p">)</span>
</span><span class='line'>    <span class="n">qrCodeEncoder</span><span class="p">.</span><span class="n">QRCodeErrorCorrect</span> <span class="p">=</span> <span class="n">QRCodeEncoder</span><span class="p">.</span><span class="n">ERROR_CORRECTION</span><span class="p">.</span><span class="n">L</span><span class="p">;</span>
</span><span class='line'><span class="k">else</span> <span class="nf">if</span> <span class="p">(</span><span class="n">errorCorrect</span> <span class="p">==</span> <span class="s">&quot;M&quot;</span><span class="p">)</span>
</span><span class='line'>    <span class="n">qrCodeEncoder</span><span class="p">.</span><span class="n">QRCodeErrorCorrect</span> <span class="p">=</span> <span class="n">QRCodeEncoder</span><span class="p">.</span><span class="n">ERROR_CORRECTION</span><span class="p">.</span><span class="n">M</span><span class="p">;</span>
</span><span class='line'><span class="k">else</span> <span class="nf">if</span> <span class="p">(</span><span class="n">errorCorrect</span> <span class="p">==</span> <span class="s">&quot;Q&quot;</span><span class="p">)</span>
</span><span class='line'>    <span class="n">qrCodeEncoder</span><span class="p">.</span><span class="n">QRCodeErrorCorrect</span> <span class="p">=</span> <span class="n">QRCodeEncoder</span><span class="p">.</span><span class="n">ERROR_CORRECTION</span><span class="p">.</span><span class="n">Q</span><span class="p">;</span>
</span><span class='line'><span class="k">else</span> <span class="nf">if</span> <span class="p">(</span><span class="n">errorCorrect</span> <span class="p">==</span> <span class="s">&quot;H&quot;</span><span class="p">)</span>
</span><span class='line'>    <span class="n">qrCodeEncoder</span><span class="p">.</span><span class="n">QRCodeErrorCorrect</span> <span class="p">=</span> <span class="n">QRCodeEncoder</span><span class="p">.</span><span class="n">ERROR_CORRECTION</span><span class="p">.</span><span class="n">H</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'><span class="n">Image</span> <span class="n">image</span><span class="p">;</span>
</span><span class='line'><span class="n">String</span> <span class="n">data</span> <span class="p">=</span> <span class="n">txtEncodeData</span><span class="p">.</span><span class="n">Text</span><span class="p">;</span>
</span><span class='line'><span class="n">image</span> <span class="p">=</span> <span class="n">qrCodeEncoder</span><span class="p">.</span><span class="n">Encode</span><span class="p">(</span><span class="n">data</span><span class="p">);</span>
</span><span class='line'><span class="n">picEncode</span><span class="p">.</span><span class="n">Image</span> <span class="p">=</span> <span class="n">image</span><span class="p">;</span>
</span><span class='line'><span class="p">&lt;/</span><span class="n">code</span><span class="p">&gt;&lt;/</span><span class="n">pre</span><span class="p">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="p">&lt;</span><span class="n">p</span><span class="p">&gt;}</span>
</span></code></pre></td></tr></table></div></figure></p>

<p>Sedangkan untuk versi VB 6nya sy buat sesimple mungkin</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
</pre></td><td class='code'><pre><code class='vbnet'><span class='line'><span class="k">Private</span> <span class="k">Sub</span> <span class="nf">cmdEncode_Click</span><span class="p">()</span>
</span><span class='line'>    <span class="k">Dim</span> <span class="n">qrEncoder</span> <span class="ow">As</span> <span class="k">New</span> <span class="n">QRCodeEncoder</span><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="na">&lt;pre&gt;</span><span class="o">&lt;</span><span class="n">code</span><span class="o">&gt;</span><span class="n">qrEncoder</span><span class="p">.</span><span class="n">QRCodeEncodeMode</span> <span class="o">=</span> <span class="n">ENCODE_MODE</span><span class="p">.</span><span class="n">ENCODE_MODE_BYTE</span>
</span><span class='line'><span class="n">qrEncoder</span><span class="p">.</span><span class="n">QRCodeScale</span> <span class="o">=</span> <span class="mi">4</span>
</span><span class='line'><span class="n">qrEncoder</span><span class="p">.</span><span class="n">QRCodeVersion</span> <span class="o">=</span> <span class="mi">7</span>
</span><span class='line'><span class="n">qrEncoder</span><span class="p">.</span><span class="n">QRCodeErrorCorrect</span> <span class="o">=</span> <span class="n">ERROR_CORRECTION</span><span class="p">.</span><span class="n">ERROR_CORRECTION_M</span>
</span><span class='line'>
</span><span class='line'><span class="n">picEncode</span><span class="p">.</span><span class="n">Picture</span> <span class="o">=</span> <span class="n">qrEncoder</span><span class="p">.</span><span class="n">Encode</span><span class="p">(</span><span class="n">txtEncodeData</span><span class="p">.</span><span class="n">Text</span><span class="p">)</span> <span class="c">&#39; error : Invalid procedure call or argument</span>
</span><span class='line'><span class="na">&lt;/code&gt;</span><span class="o">&lt;/</span><span class="n">pre</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="na">&lt;p&gt;</span><span class="k">End</span> <span class="k">Sub</span>
</span></code></pre></td></tr></table></div></figure></p>

<p>tapi hasilnya malah error &lsquo;Invalid procedure call or argument&rsquo; :(, dan berdasarkan hasil pengamatan sementara, menurut sy penyebab errornya adalah karena method Encode adalah method yg dioverload sedangkan method overload belum disupport oleh VB 6.</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='c#'><span class='line'><span class="k">public</span> <span class="k">virtual</span> <span class="n">Bitmap</span> <span class="nf">Encode</span><span class="p">(</span><span class="n">String</span> <span class="n">content</span><span class="p">)</span>
</span><span class='line'><span class="k">public</span> <span class="k">virtual</span> <span class="n">Bitmap</span> <span class="nf">Encode</span><span class="p">(</span><span class="n">String</span> <span class="n">content</span><span class="p">,</span> <span class="n">Encoding</span> <span class="n">encoding</span><span class="p">)</span>
</span></code></pre></td></tr></table></div></figure></p>

<p>Jadi sy putuskan untuk menambahkan method baru dengan nama EncodeVB6, kemudian mengganti perintah</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='vbnet'><span class='line'><span class="n">picEncode</span><span class="p">.</span><span class="n">Picture</span> <span class="o">=</span> <span class="n">qrEncoder</span><span class="p">.</span><span class="n">Encode</span><span class="p">(</span><span class="n">txtEncodeData</span><span class="p">.</span><span class="n">Text</span><span class="p">)</span>
</span></code></pre></td></tr></table></div></figure></p>

<p>menjadi</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='vbnet'><span class='line'><span class="n">picEncode</span><span class="p">.</span><span class="n">Picture</span> <span class="o">=</span> <span class="n">qrEncoder</span><span class="p">.</span><span class="n">EncodeVB6</span><span class="p">(</span><span class="n">txtEncodeData</span><span class="p">.</span><span class="n">Text</span><span class="p">)</span>
</span></code></pre></td></tr></table></div></figure></p>

<p>Kode lengkap method EncodeVB6</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
</pre></td><td class='code'><pre><code class='c#'><span class='line'><span class="k">public</span> <span class="k">virtual</span> <span class="n">Bitmap</span> <span class="nf">EncodeVB6</span><span class="p">(</span><span class="n">String</span> <span class="n">content</span><span class="p">)</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'>    <span class="k">if</span> <span class="p">(</span><span class="n">QRCodeUtility</span><span class="p">.</span><span class="n">IsUniCode</span><span class="p">(</span><span class="n">content</span><span class="p">))</span>
</span><span class='line'>    <span class="p">{</span>
</span><span class='line'>        <span class="k">return</span> <span class="nf">Encode</span><span class="p">(</span><span class="n">content</span><span class="p">,</span> <span class="n">Encoding</span><span class="p">.</span><span class="n">Unicode</span><span class="p">);</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>    <span class="n">Else</span>
</span><span class='line'>    <span class="p">{</span>
</span><span class='line'>        <span class="k">return</span> <span class="nf">Encode</span><span class="p">(</span><span class="n">content</span><span class="p">,</span> <span class="n">Encoding</span><span class="p">.</span><span class="n">ASCII</span><span class="p">);</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure></p>

<p>Horeeeeee gubrakk, ternyata&hellip;. masih error :( &lsquo;Type mismatch&rsquo;</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='vbnet'><span class='line'><span class="n">picEncode</span><span class="p">.</span><span class="n">Picture</span> <span class="o">=</span> <span class="n">qrEncoder</span><span class="p">.</span><span class="n">EncodeVB6</span><span class="p">(</span><span class="n">txtEncodeData</span><span class="p">.</span><span class="n">Text</span><span class="p">)</span> <span class="o">&amp;</span><span class="n">lsquo</span><span class="err">;</span> <span class="k">error</span> <span class="p">:</span> <span class="n">Type</span> <span class="n">mismatch</span>
</span></code></pre></td></tr></table></div></figure></p>

<p>dari pesan errornya sudah jelas karena properties Picture bertipe StdPicture sedangkan method EncodeVB6 bertipe Bitmap dan di VB 6 enggak ada tipe Bitmap :(, tapi untungnya :) ada method ImageToIPicture yg diambil dari class Support (namespace Microsoft.VisualBasic.Compatibility.VB6) sehingga method EncodeVB6nya kita revisi menjadi :</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
</pre></td><td class='code'><pre><code class='c#'><span class='line'><span class="k">public</span> <span class="k">virtual</span> <span class="kt">object</span> <span class="nf">EncodeVB6</span><span class="p">(</span><span class="n">String</span> <span class="n">content</span><span class="p">)</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'>    <span class="k">if</span> <span class="p">(</span><span class="n">QRCodeUtility</span><span class="p">.</span><span class="n">IsUniCode</span><span class="p">(</span><span class="n">content</span><span class="p">))</span>
</span><span class='line'>    <span class="p">{</span>
</span><span class='line'>        <span class="k">return</span> <span class="n">Microsoft</span><span class="p">.</span><span class="n">VisualBasic</span><span class="p">.</span><span class="n">Compatibility</span><span class="p">.</span><span class="n">VB6</span><span class="p">.</span><span class="n">Support</span><span class="p">.</span><span class="n">ImageToIPicture</span><span class="p">(</span><span class="n">Encode</span><span class="p">(</span><span class="n">content</span><span class="p">,</span> <span class="n">Encoding</span><span class="p">.</span><span class="n">Unicode</span><span class="p">));</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>    <span class="n">Else</span>
</span><span class='line'>    <span class="p">{</span>
</span><span class='line'>        <span class="k">return</span> <span class="n">Microsoft</span><span class="p">.</span><span class="n">VisualBasic</span><span class="p">.</span><span class="n">Compatibility</span><span class="p">.</span><span class="n">VB6</span><span class="p">.</span><span class="n">Support</span><span class="p">.</span><span class="n">ImageToIPicture</span><span class="p">(</span><span class="n">Encode</span><span class="p">(</span><span class="n">content</span><span class="p">,</span> <span class="n">Encoding</span><span class="p">.</span><span class="n">ASCII</span><span class="p">));</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure></p>

<p>Sampai disi permasalah method EncodeVB6 sudah selesai :)</p>

<p>Terakhir kita akan melakukan proses decode</p>

<p><a href="http://coding4ever.files.wordpress.com/2011/09/18092011-6.png"><img src="http://coding4ever.files.wordpress.com/2011/09/18092011-6.png" alt="" /></a></p>

<p>dan kita lihat dulu kode aslinya (c#)</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
</pre></td><td class='code'><pre><code class='c#'><span class='line'><span class="k">private</span> <span class="k">void</span> <span class="nf">btnDecode_Click</span><span class="p">(</span><span class="kt">object</span> <span class="n">sender</span><span class="p">,</span> <span class="n">EventArgs</span> <span class="n">e</span><span class="p">)</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'>    <span class="k">try</span>
</span><span class='line'>    <span class="p">{</span>
</span><span class='line'>        <span class="n">QRCodeDecoder</span> <span class="n">decoder</span> <span class="p">=</span> <span class="k">new</span> <span class="n">QRCodeDecoder</span><span class="p">();</span>
</span><span class='line'>        <span class="n">String</span> <span class="n">decodedString</span> <span class="p">=</span> <span class="n">decoder</span><span class="p">.</span><span class="n">decode</span><span class="p">(</span><span class="k">new</span> <span class="n">QRCodeBitmapImage</span><span class="p">(</span><span class="k">new</span> <span class="n">Bitmap</span><span class="p">(</span><span class="n">picDecode</span><span class="p">.</span><span class="n">Image</span><span class="p">)));&lt;/</span><span class="n">p</span><span class="p">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="p">&lt;</span><span class="n">pre</span><span class="p">&gt;&lt;</span><span class="n">code</span><span class="p">&gt;</span>    <span class="n">txtDecodedData</span><span class="p">.</span><span class="n">Text</span> <span class="p">=</span> <span class="n">decodedString</span><span class="p">;</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'><span class="k">catch</span> <span class="p">(</span><span class="n">Exception</span> <span class="n">ex</span><span class="p">)</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'>    <span class="n">MessageBox</span><span class="p">.</span><span class="n">Show</span><span class="p">(</span><span class="n">ex</span><span class="p">.</span><span class="n">Message</span><span class="p">);</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'><span class="p">&lt;/</span><span class="n">code</span><span class="p">&gt;&lt;/</span><span class="n">pre</span><span class="p">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="p">&lt;</span><span class="n">p</span><span class="p">&gt;}</span>
</span></code></pre></td></tr></table></div></figure></p>

<p>Dari kode diatas jelas tidak bisa langsung dikonversi ke VB 6 karena VB 6 tidak mendukung pemanggilan constructor class yg mempunyai parameter.</p>

<p>Tapi ada baiknya kita lihat dulu constructor class QRCodeBitmapImage yg ternyata membutuhkan objek Bitmap pada saat dipanggil.</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class='c#'><span class='line'><span class="c1">///</span>
</span><span class='line'><span class="p">&lt;</span><span class="n">summary</span><span class="p">&gt;</span> <span class="c1">/// Constructor</span>
</span><span class='line'><span class="c1">/// &lt;/summary&gt;</span>
</span><span class='line'><span class="c1">///Bitmap image/param&gt;</span>
</span><span class='line'><span class="k">public</span> <span class="nf">QRCodeBitmapImage</span><span class="p">(</span><span class="n">Bitmap</span> <span class="n">image</span><span class="p">)</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'>    <span class="k">this</span><span class="p">.</span><span class="n">image</span> <span class="p">=</span> <span class="n">image</span><span class="p">;</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure></p>

<p>Solusinya kita akan menambahkan costructor default (constructor tanpa parameter)</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='c#'><span class='line'><span class="c1">// default constructor</span>
</span><span class='line'><span class="n">Public</span> <span class="nf">QRCodeBitmapImage</span><span class="p">()</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure></p>

<p>trus untuk melewatkan objek Bitmap ke class QRCodeBitmapImage kita akan menambahkan property baru misal dengan nama SetBitmap, adapun kodenya seperti berikut :</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='c#'><span class='line'><span class="k">public</span> <span class="k">virtual</span> <span class="n">Bitmap</span> <span class="n">SetBitmap</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'>    <span class="k">set</span> <span class="p">{</span> <span class="n">image</span> <span class="p">=</span> <span class="k">value</span><span class="p">;</span> <span class="p">}</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure></p>

<p>Properties SetBitmap diatas bertipe Bitmap, tapi sayang di VB 6 belum ada padanan tipe datanya jadi kita akan menggunakan tipe Object, kemudian untuk mengkonversi ke tipe Bitmap kita menggunakan method IPictureToImage yg diambil dari class Support (namespace Microsoft.VisualBasic.Compatibility.VB6)</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='c#'><span class='line'><span class="k">public</span> <span class="k">virtual</span> <span class="kt">object</span> <span class="n">SetBitmap</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'>    <span class="k">set</span> <span class="p">{</span> <span class="n">image</span> <span class="p">=</span> <span class="p">(</span><span class="n">System</span><span class="p">.</span><span class="n">Drawing</span><span class="p">.</span><span class="n">Bitmap</span><span class="p">)</span><span class="n">Microsoft</span><span class="p">.</span><span class="n">VisualBasic</span><span class="p">.</span><span class="n">Compatibility</span><span class="p">.</span><span class="n">VB6</span><span class="p">.</span><span class="n">Support</span><span class="p">.</span><span class="n">IPictureToImage</span><span class="p">(</span><span class="k">value</span><span class="p">);</span> <span class="p">}</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure></p>

<p>Setelah itu baru kita bisa melakukan konversi dengan aman di VB 6</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
</pre></td><td class='code'><pre><code class='vbnet'><span class='line'><span class="k">Private</span> <span class="k">Sub</span> <span class="nf">cmdDecode_Click</span><span class="p">()</span>
</span><span class='line'>    <span class="k">Dim</span> <span class="n">decoder</span> <span class="ow">As</span> <span class="k">New</span> <span class="n">QRCodeDecoder</span><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="na">&lt;pre&gt;</span><span class="o">&lt;</span><span class="n">code</span><span class="o">&gt;</span><span class="k">Dim</span> <span class="n">decodedString</span> <span class="ow">As</span> <span class="kt">String</span>
</span><span class='line'>
</span><span class='line'><span class="k">Dim</span> <span class="n">qrCodeImage</span> <span class="ow">As</span> <span class="k">New</span> <span class="n">QRCodeBitmapImage</span>
</span><span class='line'><span class="n">qrCodeImage</span><span class="p">.</span><span class="n">SetBitmap</span> <span class="o">=</span> <span class="n">picEncode</span><span class="p">.</span><span class="n">Picture</span>
</span><span class='line'>
</span><span class='line'><span class="n">decodedString</span> <span class="o">=</span> <span class="n">decoder</span><span class="p">.</span><span class="n">decodeVB6</span><span class="p">(</span><span class="n">qrCodeImage</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'><span class="n">MsgBox</span> <span class="s">&quot;Hasil decode : &quot;</span> <span class="o">&amp;</span><span class="n">amp</span><span class="err">;</span> <span class="n">vbCrLf</span> <span class="o">&amp;</span><span class="n">amp</span><span class="err">;</span> <span class="n">decodedString</span><span class="p">,</span> <span class="n">vbInformation</span><span class="p">,</span> <span class="s">&quot;Informasi&quot;</span>
</span><span class='line'><span class="na">&lt;/code&gt;</span><span class="o">&lt;/</span><span class="n">pre</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="na">&lt;p&gt;</span><span class="k">End</span> <span class="k">Sub</span>
</span></code></pre></td></tr></table></div></figure></p>

<p><a href="http://coding4ever.files.wordpress.com/2011/09/18092011-7.png"><img src="http://coding4ever.files.wordpress.com/2011/09/18092011-7.png" alt="" /></a></p>

<p>Yuph akhirnya selesai juga :)</p>

<p>Selamat <a href="http://www.4shared.com/file/PCRQSJzV/QRCode.html">MENCOBA</a> :)</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Input Data via Grid]]></title>
    <link href="http://coding4ever.net/blog/2012/05/12/input-data-via-grid/"/>
    <updated>2012-05-12T13:01:52+07:00</updated>
    <id>http://coding4ever.net/blog/2012/05/12/input-data-via-grid</id>
    <content type="html"><![CDATA[<p>Sudah lama enggak posting tentang Visual Basic 6 jadi kangen juga :D.</p>

<p>Kali ini kita akan membahas bagaimana mudahnya melakukan input data langsung di grid menggunakan komponen VSFlexGrid.</p>

<p>VSFlexGrid sudah menyediakan beberapa method dan event yang mempermudah kita untuk melakukan hal ini, kita lihat screenshotnya.</p>

<!-- more -->


<p><a href="http://coding4ever.files.wordpress.com/2012/05/13052012.png"><img src="http://coding4ever.files.wordpress.com/2012/05/13052012.png" alt="" /></a></p>

<p>Berikut beberapa fitur yang akan kita bahas :</p>

<p><strong>1. Validasi</strong></p>

<p>Pada sample program di atas kita akan menambahkan beberapa validasi input seperti konversi ke huruf besar untuk kolom NAMA BARANG dan validasi input angka untuk kolom STOK dan HARGA JUAL. Kedua fitur ini membutuhkan fungsi berikut :</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
</pre></td><td class='code'><pre><code class='vbnet'><span class='line'><span class="k">Private</span> <span class="k">Function</span> <span class="nf">convertToUpper</span><span class="p">(</span><span class="k">ByVal</span> <span class="n">keyAscii</span> <span class="ow">As</span> <span class="kt">Integer</span><span class="p">)</span> <span class="ow">As</span> <span class="kt">Integer</span>
</span><span class='line'>    <span class="n">convertToUpper</span> <span class="o">=</span> <span class="n">Asc</span><span class="p">(</span><span class="n">UCase$</span><span class="p">(</span><span class="n">Chr$</span><span class="p">(</span><span class="n">keyAscii</span><span class="p">)))</span>
</span><span class='line'><span class="k">End</span> <span class="k">Function</span><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="na">&lt;p&gt;</span><span class="k">Private</span> <span class="k">Function</span> <span class="nf">numericOnly</span><span class="p">(</span><span class="k">ByVal</span> <span class="n">keyAscii</span> <span class="ow">As</span> <span class="kt">Integer</span><span class="p">)</span> <span class="ow">As</span> <span class="kt">Integer</span>
</span><span class='line'>    <span class="k">Dim</span> <span class="n">strValid</span> <span class="ow">As</span> <span class="kt">String</span><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="na">&lt;pre&gt;</span><span class="o">&lt;</span><span class="n">code</span><span class="o">&gt;</span><span class="k">On</span> <span class="k">Error</span> <span class="k">GoTo</span> <span class="n">errHandle</span>
</span><span class='line'>
</span><span class='line'><span class="n">strValid</span> <span class="o">=</span> <span class="s">&quot;0123456789.&quot;</span>
</span><span class='line'><span class="k">If</span> <span class="n">InStr</span><span class="p">(</span><span class="n">strValid</span><span class="p">,</span> <span class="n">Chr</span><span class="p">(</span><span class="n">keyAscii</span><span class="p">))</span> <span class="o">=</span> <span class="mi">0</span> <span class="ow">And</span> <span class="k">Not</span> <span class="p">(</span><span class="n">keyAscii</span> <span class="o">=</span> <span class="n">vbKeyBack</span><span class="p">)</span> <span class="k">Then</span>
</span><span class='line'>    <span class="n">numericOnly</span> <span class="o">=</span> <span class="mi">0</span>
</span><span class='line'><span class="k">Else</span>
</span><span class='line'>    <span class="n">numericOnly</span> <span class="o">=</span> <span class="n">keyAscii</span>
</span><span class='line'><span class="k">End</span> <span class="k">If</span>
</span><span class='line'>
</span><span class='line'><span class="k">Exit</span> <span class="k">Function</span>
</span><span class='line'><span class="err">&lt;/</span><span class="nf">code</span><span class="o">&gt;&lt;/</span><span class="n">pre</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="na">&lt;p&gt;</span><span class="n">errHandle</span><span class="p">:</span>
</span><span class='line'>    <span class="n">numericOnly</span> <span class="o">=</span> <span class="mi">0</span>
</span><span class='line'><span class="k">End</span> <span class="k">Function</span>
</span></code></pre></td></tr></table></div></figure></p>

<p>Selanjutnya fungsi diatas tinggal dipanggil di event KeyPressEdit dari komponen VSFlexGrid.</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
</pre></td><td class='code'><pre><code class='vbnet'><span class='line'><span class="k">Private</span> <span class="k">Sub</span> <span class="nf">Grid1_KeyPressEdit</span><span class="p">(</span><span class="k">ByVal</span> <span class="n">Row</span> <span class="ow">As</span> <span class="kt">Long</span><span class="p">,</span> <span class="k">ByVal</span> <span class="n">Col</span> <span class="ow">As</span> <span class="kt">Long</span><span class="p">,</span> <span class="n">keyAscii</span> <span class="ow">As</span> <span class="kt">Integer</span><span class="p">)</span>
</span><span class='line'>    <span class="k">If</span> <span class="n">keyAscii</span> <span class="o">=</span> <span class="n">vbKeyReturn</span> <span class="k">Then</span>
</span><span class='line'>        <span class="k">Call</span> <span class="n">nextFocus</span>
</span><span class='line'>    <span class="k">End</span> <span class="k">If</span><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="na">&lt;pre&gt;</span><span class="o">&lt;</span><span class="n">code</span><span class="o">&gt;</span><span class="k">Select</span> <span class="k">Case</span> <span class="n">Col</span>
</span><span class='line'>    <span class="k">Case</span> <span class="mi">0</span> <span class="c">&#39; kode barang</span>
</span><span class='line'>    <span class="k">Case</span> <span class="mi">1</span> <span class="c">&#39; nama barang</span>
</span><span class='line'>        <span class="n">keyAscii</span> <span class="o">=</span> <span class="n">convertToUpper</span><span class="p">(</span><span class="n">keyAscii</span><span class="p">)</span>
</span><span class='line'>    <span class="k">Case</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span> <span class="c">&#39; stok dan harga</span>
</span><span class='line'>        <span class="n">keyAscii</span> <span class="o">=</span> <span class="n">numericOnly</span><span class="p">(</span><span class="n">keyAscii</span><span class="p">)</span>
</span><span class='line'><span class="k">End</span> <span class="k">Select</span>
</span><span class='line'><span class="na">&lt;/code&gt;</span><span class="o">&lt;/</span><span class="n">pre</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="na">&lt;p&gt;</span><span class="k">End</span> <span class="k">Sub</span>
</span></code></pre></td></tr></table></div></figure></p>

<p><strong>2. Focus dan Lostfocus backcolor</strong></p>

<p>Sesuai nama fiturnya cell grid akan berubah warna ketika cursor mouse aktif pada cell.</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
</pre></td><td class='code'><pre><code class='vbnet'><span class='line'><span class="k">Private</span> <span class="k">Sub</span> <span class="nf">Grid1_StartEdit</span><span class="p">(</span><span class="k">ByVal</span> <span class="n">Row</span> <span class="ow">As</span> <span class="kt">Long</span><span class="p">,</span> <span class="k">ByVal</span> <span class="n">Col</span> <span class="ow">As</span> <span class="kt">Long</span><span class="p">,</span> <span class="n">Cancel</span> <span class="ow">As</span> <span class="kt">Boolean</span><span class="p">)</span>
</span><span class='line'>    <span class="k">If</span> <span class="n">Col</span> <span class="o">=</span> <span class="mi">3</span> <span class="k">Then</span> <span class="o">&amp;</span><span class="n">lsquo</span><span class="err">;</span> <span class="n">harga</span> <span class="n">jual</span>
</span><span class='line'>        <span class="n">Grid1</span><span class="p">.</span><span class="n">TextMatrix</span><span class="p">(</span><span class="n">Row</span><span class="p">,</span> <span class="n">Col</span><span class="p">)</span> <span class="o">=</span> <span class="n">Replace</span><span class="p">(</span><span class="n">Grid1</span><span class="p">.</span><span class="n">TextMatrix</span><span class="p">(</span><span class="n">Row</span><span class="p">,</span> <span class="n">Col</span><span class="p">),</span> <span class="o">&amp;</span><span class="n">ldquo</span><span class="err">;</span><span class="p">,</span><span class="o">&amp;</span><span class="n">rdquo</span><span class="err">;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ldquo</span><span class="err">;</span><span class="o">&amp;</span><span class="n">rdquo</span><span class="err">;</span><span class="p">)</span>
</span><span class='line'>    <span class="k">End</span> <span class="k">If</span><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="na">&lt;pre&gt;</span><span class="o">&lt;</span><span class="n">code</span><span class="o">&gt;</span><span class="n">Grid1</span><span class="p">.</span><span class="n">CellBackColor</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">amp</span><span class="err">;</span><span class="n">HC0FFFF</span> <span class="c">&#39; warna kuning</span>
</span><span class='line'><span class="na">&lt;/code&gt;</span><span class="o">&lt;/</span><span class="n">pre</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="na">&lt;p&gt;</span><span class="k">End</span> <span class="k">Sub</span><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="na">&lt;p&gt;</span><span class="k">Private</span> <span class="k">Sub</span> <span class="nf">Grid1_AfterEdit</span><span class="p">(</span><span class="k">ByVal</span> <span class="n">Row</span> <span class="ow">As</span> <span class="kt">Long</span><span class="p">,</span> <span class="k">ByVal</span> <span class="n">Col</span> <span class="ow">As</span> <span class="kt">Long</span><span class="p">)</span>
</span><span class='line'>    <span class="k">If</span> <span class="n">Col</span> <span class="o">=</span> <span class="mi">3</span> <span class="k">Then</span> <span class="o">&amp;</span><span class="n">lsquo</span><span class="err">;</span> <span class="n">harga</span> <span class="n">jual</span>
</span><span class='line'>        <span class="k">If</span> <span class="n">IsNumeric</span><span class="p">(</span><span class="n">Grid1</span><span class="p">.</span><span class="n">TextMatrix</span><span class="p">(</span><span class="n">Row</span><span class="p">,</span> <span class="n">Col</span><span class="p">))</span> <span class="k">Then</span>
</span><span class='line'>            <span class="n">Grid1</span><span class="p">.</span><span class="n">TextMatrix</span><span class="p">(</span><span class="n">Row</span><span class="p">,</span> <span class="n">Col</span><span class="p">)</span> <span class="o">=</span> <span class="n">FormatNumber</span><span class="p">(</span><span class="n">Grid1</span><span class="p">.</span><span class="n">TextMatrix</span><span class="p">(</span><span class="n">Row</span><span class="p">,</span> <span class="n">Col</span><span class="p">),</span> <span class="mi">0</span><span class="p">)</span>
</span><span class='line'>        <span class="k">End</span> <span class="k">If</span>
</span><span class='line'>    <span class="k">End</span> <span class="k">If</span>
</span><span class='line'>    <span class="n">Grid1</span><span class="p">.</span><span class="n">CellBackColor</span> <span class="o">=</span> <span class="n">vbDefault</span>
</span><span class='line'><span class="k">End</span> <span class="k">Sub</span>
</span></code></pre></td></tr></table></div></figure></p>

<p>Terakhir agar mode edit cellnya aktif pada saat cursor mouse aktif tinggal panggil method EditCell di event Click dan EnterCell</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class='vbnet'><span class='line'><span class="k">Private</span> <span class="k">Sub</span> <span class="nf">Grid1_Click</span><span class="p">()</span>
</span><span class='line'>    <span class="n">Grid1</span><span class="p">.</span><span class="n">EditCell</span>
</span><span class='line'><span class="k">End</span> <span class="k">Sub</span><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="na">&lt;p&gt;</span><span class="k">Private</span> <span class="k">Sub</span> <span class="nf">Grid1_EnterCell</span><span class="p">()</span>
</span><span class='line'>    <span class="n">Grid1</span><span class="p">.</span><span class="n">EditCell</span>
</span><span class='line'><span class="k">End</span> <span class="k">Sub</span>
</span></code></pre></td></tr></table></div></figure></p>

<p>Selamat <a href="http://www.4shared.com/rar/t7rHkGRT/InputViaGrid.html">MENCOBA</a> :)</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Aplikasi Antrian]]></title>
    <link href="http://coding4ever.net/blog/2012/02/26/aplikasi-antrian/"/>
    <updated>2012-02-26T10:02:09+07:00</updated>
    <id>http://coding4ever.net/blog/2012/02/26/aplikasi-antrian</id>
    <content type="html"><![CDATA[<p>Aplikasi ini merupakan pengembangan dari sample aplikasi yg sudah pernah saya bahas pada postingan <a href="/blog/2010/01/30/belajar-winsock-bagian-3-%e2%80%93-multiple-connection/">sebelumnya</a>, aplikasi ini terdiri dari 2 project yaitu :</p>

<ol>
<li><p> Aplikasi server memanfaatkan array winsock karena akan menghandle minimal 1 koneksi</p></li>
<li><p> Untuk aplikasi klien cukup menggunakan winsock standar (non array).</p></li>
</ol>


<!-- more -->


<p><a href="http://coding4ever.files.wordpress.com/2012/02/26022012-2.png"><img src="http://coding4ever.files.wordpress.com/2012/02/26022012-2.png" alt="" /></a></p>

<p>Sekarang akan kita bahas cara pembuatannya.</p>

<p><strong>Aplikasi server</strong></p>

<p>Aplikasi server menggunakan winsock yg dijadikan array karena akan menerima lebih dari 1 koneksi, untuk menjadikan sebuah winsock menjadi array cukup dengan mengeset properties index = 0</p>

<p><a href="http://coding4ever.files.wordpress.com/2012/02/26022012-1.png"><img src="http://coding4ever.files.wordpress.com/2012/02/26022012-1.png" alt="" /></a></p>

<p>Selain itu agar sebuah winsock bisa menerima koneksi yg masuk, maka winsocknya harus dalam mode &ldquo;Listen&rdquo;, untuk keperluan ini kita akan menyiapkan sebuah fungsi misal dengan nama startListening</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
</pre></td><td class='code'><pre><code class='vbnet'><span class='line'><span class="k">Private</span> <span class="k">Function</span> <span class="nf">startListening</span><span class="p">(</span><span class="k">ByVal</span> <span class="n">localPort</span> <span class="ow">As</span> <span class="kt">Long</span><span class="p">)</span> <span class="ow">As</span> <span class="kt">Boolean</span>
</span><span class='line'>    <span class="k">On</span> <span class="k">Error</span> <span class="k">GoTo</span> <span class="n">errHandle</span><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="na">&lt;pre&gt;</span><span class="o">&lt;</span><span class="n">code</span><span class="o">&gt;</span><span class="k">If</span> <span class="n">localPort</span> <span class="o">&amp;</span><span class="n">gt</span><span class="err">;</span> <span class="mi">0</span> <span class="k">Then</span>
</span><span class='line'>    <span class="c">&#39;If the socket is already listening, and it&#39;s listening on the same port, don&#39;t bother restarting it.</span>
</span><span class='line'>    <span class="k">If</span> <span class="p">(</span><span class="n">wckServer</span><span class="p">(</span><span class="mi">0</span><span class="p">).</span><span class="n">State</span> <span class="o">&amp;</span><span class="n">lt</span><span class="err">;</span><span class="o">&amp;</span><span class="n">gt</span><span class="err">;</span> <span class="n">sckListening</span><span class="p">)</span> <span class="ow">Or</span> <span class="p">(</span><span class="n">wckServer</span><span class="p">(</span><span class="mi">0</span><span class="p">).</span><span class="n">localPort</span> <span class="o">&amp;</span><span class="n">lt</span><span class="err">;</span><span class="o">&amp;</span><span class="n">gt</span><span class="err">;</span> <span class="n">localPort</span><span class="p">)</span> <span class="k">Then</span>
</span><span class='line'>        <span class="k">With</span> <span class="n">wckServer</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</span><span class='line'>            <span class="k">Call</span> <span class="p">.</span><span class="n">Close</span>
</span><span class='line'>            <span class="p">.</span><span class="n">localPort</span> <span class="o">=</span> <span class="n">localPort</span>
</span><span class='line'>            <span class="k">Call</span> <span class="p">.</span><span class="n">Listen</span>
</span><span class='line'>        <span class="k">End</span> <span class="k">With</span>
</span><span class='line'>    <span class="k">End</span> <span class="k">If</span>
</span><span class='line'>
</span><span class='line'>    <span class="c">&#39;Return true, since the server is now listening for clients.</span>
</span><span class='line'>    <span class="n">startListening</span> <span class="o">=</span> <span class="k">True</span>
</span><span class='line'><span class="na">&lt;/code&gt;</span><span class="o">&lt;/</span><span class="n">pre</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="na">&lt;p&gt;</span>   <span class="k">End</span> <span class="k">If</span><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="na">&lt;p&gt;</span>   <span class="k">Exit</span> <span class="k">Function</span>
</span><span class='line'><span class="nf">errHandle</span><span class="p">:</span>
</span><span class='line'>   <span class="n">startListening</span> <span class="o">=</span> <span class="k">False</span>
</span><span class='line'><span class="k">End</span> <span class="k">Function</span>
</span></code></pre></td></tr></table></div></figure></p>

<p>Selanjutnya tinggal kita panggil pada event Form_Load</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class='vbnet'><span class='line'><span class="k">Private</span> <span class="k">Sub</span> <span class="nf">Form_Load</span><span class="p">()</span>
</span><span class='line'>    <span class="o">&amp;</span><span class="n">lsquo</span><span class="err">;</span><span class="mi">1234</span> <span class="n">adalah</span> <span class="n">port</span> <span class="n">yg</span> <span class="n">digunakan</span> <span class="n">untuk</span> <span class="n">komunikasi</span>
</span><span class='line'>    <span class="c">&#39;antara server dan klien, nilainya bisa disesuaikan</span>
</span><span class='line'>    <span class="k">If</span> <span class="n">startListening</span><span class="p">(</span><span class="mi">1234</span><span class="p">)</span> <span class="k">Then</span>
</span><span class='line'>        <span class="n">MsgBox</span> <span class="o">&amp;</span><span class="n">ldquo</span><span class="err">;</span><span class="n">Status</span> <span class="n">Server</span> <span class="k">ON</span><span class="o">&amp;</span><span class="n">rdquo</span><span class="err">;</span>
</span><span class='line'>    <span class="k">Else</span>
</span><span class='line'>        <span class="n">MsgBox</span> <span class="o">&amp;</span><span class="n">ldquo</span><span class="err">;</span><span class="n">Status</span> <span class="n">Server</span> <span class="n">OFF&amp;rdquo</span><span class="err">;</span>
</span><span class='line'>    <span class="k">End</span> <span class="k">If</span>
</span><span class='line'><span class="k">End</span> <span class="k">Sub</span>
</span></code></pre></td></tr></table></div></figure></p>

<p>Selain itu ada beberapa kode yang harus kita lengkapi pada event2x yg dimiliki oleh winsock yaitu event Close, ConnectionRequest, DataArrival dan Error</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='vbnet'><span class='line'><span class="k">Private</span> <span class="k">Sub</span> <span class="nf">wckServer_Close</span><span class="p">(</span><span class="n">Index</span> <span class="ow">As</span> <span class="kt">Integer</span><span class="p">)</span>
</span><span class='line'>    <span class="o">&amp;</span><span class="n">lsquo</span><span class="err">;</span> <span class="n">Close</span> <span class="n">the</span> <span class="n">socket</span> <span class="ow">and</span> <span class="n">raise</span> <span class="n">the</span> <span class="k">event</span> <span class="k">to</span> <span class="n">the</span> <span class="n">parent</span><span class="p">.</span>
</span><span class='line'>    <span class="k">Call</span> <span class="n">wckServer</span><span class="p">(</span><span class="n">Index</span><span class="p">).</span><span class="n">Close</span>
</span><span class='line'><span class="k">End</span> <span class="k">Sub</span>
</span></code></pre></td></tr></table></div></figure>
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
</pre></td><td class='code'><pre><code class='vbnet'><span class='line'><span class="k">Private</span> <span class="k">Sub</span> <span class="nf">wckServer_ConnectionRequest</span><span class="p">(</span><span class="n">Index</span> <span class="ow">As</span> <span class="kt">Integer</span><span class="p">,</span> <span class="k">ByVal</span> <span class="n">requestID</span> <span class="ow">As</span> <span class="kt">Long</span><span class="p">)</span>
</span><span class='line'>    <span class="k">Dim</span> <span class="n">i</span>          <span class="ow">As</span> <span class="kt">Long</span>
</span><span class='line'>    <span class="k">Dim</span> <span class="n">j</span>          <span class="ow">As</span> <span class="kt">Long</span>
</span><span class='line'>    <span class="k">Dim</span> <span class="n">blnLoaded</span>  <span class="ow">As</span> <span class="kt">Boolean</span><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="na">&lt;pre&gt;</span><span class="o">&lt;</span><span class="n">code</span><span class="o">&gt;</span><span class="k">On</span> <span class="k">Error</span> <span class="k">GoTo</span> <span class="n">errHandle</span>
</span><span class='line'>
</span><span class='line'><span class="c">&#39; We shouldn&#39;t get ConnectionRequests on any other socket than the listener</span>
</span><span class='line'><span class="c">&#39; (index 0), but check anyway. Also check that we&#39;re not going to exceed</span>
</span><span class='line'><span class="c">&#39; the MaxClients property.</span>
</span><span class='line'><span class="k">If</span> <span class="p">(</span><span class="n">Index</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">Then</span>
</span><span class='line'>    <span class="c">&#39; Check to see if we&#39;ve got any sockets that are free.</span>
</span><span class='line'>    <span class="k">For</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span> <span class="k">To</span> <span class="n">wckServer</span><span class="p">.</span><span class="n">UBound</span>
</span><span class='line'>        <span class="k">If</span> <span class="p">(</span><span class="n">wckServer</span><span class="p">(</span><span class="n">i</span><span class="p">).</span><span class="n">State</span> <span class="o">=</span> <span class="n">sckClosed</span><span class="p">)</span> <span class="k">Then</span>
</span><span class='line'>            <span class="n">j</span> <span class="o">=</span> <span class="n">i</span>
</span><span class='line'>            <span class="k">Exit</span> <span class="k">For</span>
</span><span class='line'>        <span class="k">End</span> <span class="k">If</span>
</span><span class='line'>    <span class="k">Next</span> <span class="n">i</span>
</span><span class='line'>
</span><span class='line'>    <span class="c">&#39; If we don&#39;t have any free sockets, load another on the array.</span>
</span><span class='line'>    <span class="k">If</span> <span class="p">(</span><span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">Then</span>
</span><span class='line'>        <span class="n">blnLoaded</span> <span class="o">=</span> <span class="k">True</span>
</span><span class='line'>        <span class="k">Call</span> <span class="n">Load</span><span class="p">(</span><span class="n">wckServer</span><span class="p">(</span><span class="n">wckServer</span><span class="p">.</span><span class="n">UBound</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
</span><span class='line'>        <span class="n">j</span> <span class="o">=</span> <span class="n">wckServer</span><span class="p">.</span><span class="n">Count</span> <span class="o">-</span> <span class="mi">1</span>
</span><span class='line'>    <span class="k">End</span> <span class="k">If</span>
</span><span class='line'>
</span><span class='line'>    <span class="c">&#39; With the selected socket, reset it and accept the new connection.</span>
</span><span class='line'>    <span class="k">With</span> <span class="n">wckServer</span><span class="p">(</span><span class="n">j</span><span class="p">)</span>
</span><span class='line'>        <span class="k">Call</span> <span class="p">.</span><span class="n">Close</span>
</span><span class='line'>        <span class="k">Call</span> <span class="p">.</span><span class="n">Accept</span><span class="p">(</span><span class="n">requestID</span><span class="p">)</span>
</span><span class='line'>    <span class="k">End</span> <span class="k">With</span>
</span><span class='line'>
</span><span class='line'><span class="k">End</span> <span class="k">If</span>
</span><span class='line'>
</span><span class='line'><span class="k">Exit</span> <span class="k">Sub</span>
</span><span class='line'><span class="err">&#39;</span>
</span><span class='line'><span class="na">&lt;/code&gt;</span><span class="o">&lt;/</span><span class="n">pre</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="na">&lt;p&gt;</span><span class="n">errHandle</span><span class="p">:</span>
</span><span class='line'>    <span class="o">&amp;</span><span class="n">lsquo</span><span class="err">;</span> <span class="n">Close</span> <span class="n">the</span> <span class="n">Winsock</span> <span class="n">that</span> <span class="n">caused</span> <span class="n">the</span> <span class="k">error</span><span class="p">.</span>
</span><span class='line'>    <span class="k">Call</span> <span class="n">wckServer</span><span class="p">(</span><span class="mi">0</span><span class="p">).</span><span class="n">Close</span>
</span><span class='line'><span class="k">End</span> <span class="k">Sub</span>
</span></code></pre></td></tr></table></div></figure></p>

<p>Event ConnectionRequest berfungsi untuk memfilter koneksi yg masuk, jika ada koneksi yg masuk akan dilakukan pengecekan terlebih dulu apakah ada winsock yg idle (ngangur) jika ada maka koneksi tersebut akan langsung dihandle oleh winsock yg idle tadi, jika tidak maka akan diload terlebih dulu winsock yg baru kemudian langsung menghandle koneksi yg baru masuk tadi.</p>

<p>Teknik ini merupakah salah satu cara untuk melakukan optimasi program jangan sampai aplikasi server meload secara terus menerus objek winsock yg baru untuk setiap koneksi yg masuk.</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
</pre></td><td class='code'><pre><code class='vbnet'><span class='line'><span class="k">Private</span> <span class="k">Sub</span> <span class="nf">wckServer_DataArrival</span><span class="p">(</span><span class="n">Index</span> <span class="ow">As</span> <span class="kt">Integer</span><span class="p">,</span> <span class="k">ByVal</span> <span class="n">bytesTotal</span> <span class="ow">As</span> <span class="kt">Long</span><span class="p">)</span>
</span><span class='line'>    <span class="k">Dim</span> <span class="n">cmd</span>     <span class="ow">As</span> <span class="kt">String</span><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="na">&lt;pre&gt;</span><span class="o">&lt;</span><span class="n">code</span><span class="o">&gt;</span><span class="k">On</span> <span class="k">Error</span> <span class="k">GoTo</span> <span class="n">errHandle</span>
</span><span class='line'>
</span><span class='line'><span class="c">&#39; Grab the data from the specified Winsock object, and pass it to the parent.</span>
</span><span class='line'><span class="k">Call</span> <span class="n">wckServer</span><span class="p">(</span><span class="n">Index</span><span class="p">).</span><span class="n">GetData</span><span class="p">(</span><span class="n">cmd</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'><span class="k">Select</span> <span class="k">Case</span> <span class="n">cmd</span>
</span><span class='line'>    <span class="k">Case</span> <span class="s">&quot;get_no_antrian&quot;</span>
</span><span class='line'>        <span class="k">Call</span> <span class="n">send</span><span class="p">(</span><span class="n">Index</span><span class="p">,</span> <span class="k">CStr</span><span class="p">(</span><span class="n">noAntrian</span><span class="p">))</span>
</span><span class='line'>
</span><span class='line'>        <span class="n">lblNoAntrian</span><span class="p">.</span><span class="n">Caption</span> <span class="o">=</span> <span class="n">noAntrian</span>
</span><span class='line'>        <span class="n">noAntrian</span> <span class="o">=</span> <span class="n">noAntrian</span> <span class="o">+</span> <span class="mi">1</span> <span class="c">&#39; naikkan counter nomor antrian</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">Case</span> <span class="k">Else</span>
</span><span class='line'>        <span class="k">Call</span> <span class="n">send</span><span class="p">(</span><span class="n">Index</span><span class="p">,</span> <span class="s">&quot;perintah tidak dikenal&quot;</span><span class="p">)</span>
</span><span class='line'><span class="k">End</span> <span class="k">Select</span>
</span><span class='line'>
</span><span class='line'><span class="k">Exit</span> <span class="k">Sub</span>
</span><span class='line'><span class="err">&lt;/</span><span class="nf">code</span><span class="o">&gt;&lt;/</span><span class="n">pre</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="na">&lt;p&gt;</span><span class="n">errHandle</span><span class="p">:</span>
</span><span class='line'>   <span class="k">Call</span> <span class="n">wckServer</span><span class="p">(</span><span class="n">Index</span><span class="p">).</span><span class="n">Close</span>
</span><span class='line'><span class="k">End</span> <span class="k">Sub</span>
</span></code></pre></td></tr></table></div></figure></p>

<p>Event DataArrival berfungsi untuk memproses data yg masuk, untuk kasus aplikasi antrian ini data yang paling valid hanya berupa string &ldquo;get_no_antrian&rdquo;, jika datanya valid akan langsung dikirimkan nomor antrian terakhir ke klien yg mengirimkan string &ldquo;get_no_antrian&rdquo; dg memanggil prosedur send.</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class='vbnet'><span class='line'><span class="k">Private</span> <span class="k">Sub</span> <span class="nf">send</span><span class="p">(</span><span class="k">ByVal</span> <span class="n">lngIndex</span> <span class="ow">As</span> <span class="kt">Long</span><span class="p">,</span> <span class="k">ByVal</span> <span class="n">strData</span> <span class="ow">As</span> <span class="kt">String</span><span class="p">)</span>
</span><span class='line'>    <span class="k">If</span> <span class="p">(</span><span class="n">wckServer</span><span class="p">(</span><span class="n">lngIndex</span><span class="p">).</span><span class="n">State</span> <span class="o">=</span> <span class="n">sckConnected</span><span class="p">)</span> <span class="k">Then</span>
</span><span class='line'>        <span class="k">Call</span> <span class="n">wckServer</span><span class="p">(</span><span class="n">lngIndex</span><span class="p">).</span><span class="n">SendData</span><span class="p">(</span><span class="n">strData</span><span class="p">):</span> <span class="n">DoEvents</span>
</span><span class='line'>    <span class="k">Else</span>
</span><span class='line'>        <span class="k">Exit</span> <span class="k">Sub</span>
</span><span class='line'>    <span class="nf">End</span> <span class="k">If</span>
</span><span class='line'><span class="k">End</span> <span class="k">Sub</span>
</span></code></pre></td></tr></table></div></figure>
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='vbnet'><span class='line'><span class="k">Private</span> <span class="k">Sub</span> <span class="nf">wckServer_Error</span><span class="p">(</span><span class="n">Index</span> <span class="ow">As</span> <span class="kt">Integer</span><span class="p">,</span> <span class="k">ByVal</span> <span class="n">Number</span> <span class="ow">As</span> <span class="kt">Integer</span><span class="p">,</span> <span class="n">Description</span> <span class="ow">As</span> <span class="kt">String</span><span class="p">,</span> <span class="k">ByVal</span> <span class="n">Scode</span> <span class="ow">As</span> <span class="kt">Long</span><span class="p">,</span> <span class="k">ByVal</span> <span class="n">Source</span> <span class="ow">As</span> <span class="kt">String</span><span class="p">,</span> <span class="k">ByVal</span> <span class="n">HelpFile</span> <span class="ow">As</span> <span class="kt">String</span><span class="p">,</span> <span class="k">ByVal</span> <span class="n">HelpContext</span> <span class="ow">As</span> <span class="kt">Long</span><span class="p">,</span> <span class="n">CancelDisplay</span> <span class="ow">As</span> <span class="kt">Boolean</span><span class="p">)</span>
</span><span class='line'>    <span class="k">Call</span> <span class="n">wckServer</span><span class="p">(</span><span class="n">Index</span><span class="p">).</span><span class="n">Close</span>
</span><span class='line'><span class="k">End</span> <span class="k">Sub</span>
</span></code></pre></td></tr></table></div></figure></p>

<p>Untuk aplikasi server sy rasa sudah cukup akan kita lanjutkan dg aplikasi klien.</p>

<p><strong>Aplikasi Klien</strong></p>

<p>Untuk aplikasi klien lebih sederhana lagi, yg kita butuhkan cukup sebuah fungsi untuk melakukan koneksi ke server</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='vbnet'><span class='line'><span class="k">Private</span> <span class="k">Const</span> <span class="n">conTunggu</span> <span class="ow">As</span> <span class="kt">Long</span> <span class="o">=</span> <span class="mi">100000</span>
</span></code></pre></td></tr></table></div></figure>
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
</pre></td><td class='code'><pre><code class='vbnet'><span class='line'><span class="k">Private</span> <span class="k">Function</span> <span class="nf">isConnected</span><span class="p">(</span><span class="k">ByVal</span> <span class="n">ipServer</span> <span class="ow">As</span> <span class="kt">String</span><span class="p">,</span> <span class="k">ByVal</span> <span class="n">port</span> <span class="ow">As</span> <span class="kt">Long</span><span class="p">)</span> <span class="ow">As</span> <span class="kt">Boolean</span>
</span><span class='line'>    <span class="k">Static</span> <span class="n">i</span> <span class="ow">As</span> <span class="kt">Long</span><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="na">&lt;pre&gt;</span><span class="o">&lt;</span><span class="n">code</span><span class="o">&gt;</span><span class="k">On</span> <span class="k">Error</span> <span class="k">Resume</span> <span class="k">Next</span>
</span><span class='line'>
</span><span class='line'><span class="k">If</span> <span class="n">myClient</span><span class="p">.</span><span class="n">State</span> <span class="o">&amp;</span><span class="n">lt</span><span class="err">;</span><span class="o">&amp;</span><span class="n">gt</span><span class="err">;</span> <span class="n">sckClosed</span> <span class="k">Then</span> <span class="n">myClient</span><span class="p">.</span><span class="n">Close</span> <span class="c">&#39; close existing connection</span>
</span><span class='line'><span class="n">myClient</span><span class="p">.</span><span class="n">RemoteHost</span> <span class="o">=</span> <span class="n">ipServer</span>
</span><span class='line'><span class="n">myClient</span><span class="p">.</span><span class="n">RemotePort</span> <span class="o">=</span> <span class="n">port</span>
</span><span class='line'><span class="n">myClient</span><span class="p">.</span><span class="n">Connect</span>
</span><span class='line'>
</span><span class='line'><span class="k">With</span> <span class="n">myClient</span>
</span><span class='line'>    <span class="k">Do</span> <span class="n">Until</span> <span class="p">.</span><span class="n">State</span> <span class="o">=</span> <span class="n">sckConnected</span>
</span><span class='line'>        <span class="n">DoEvents</span>
</span><span class='line'>        <span class="n">i</span> <span class="o">=</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span>
</span><span class='line'>        <span class="k">If</span> <span class="n">i</span> <span class="o">&amp;</span><span class="n">gt</span><span class="err">;</span><span class="o">=</span> <span class="n">conTunggu</span> <span class="k">Then</span>
</span><span class='line'>            <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
</span><span class='line'>            <span class="k">Exit</span> <span class="k">Function</span>
</span><span class='line'>        <span class="nf">End</span> <span class="k">If</span>
</span><span class='line'>    <span class="k">Loop</span>
</span><span class='line'><span class="k">End</span> <span class="k">With</span>
</span><span class='line'>
</span><span class='line'><span class="n">isConnected</span> <span class="o">=</span> <span class="n">myClient</span><span class="p">.</span><span class="n">State</span> <span class="o">=</span> <span class="n">sckConnected</span>
</span><span class='line'><span class="na">&lt;/code&gt;</span><span class="o">&lt;/</span><span class="n">pre</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="na">&lt;p&gt;</span><span class="k">End</span> <span class="k">Function</span>
</span></code></pre></td></tr></table></div></figure></p>

<p>Contoh pemanggilan fungsi diatas seperti berikut :</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
</pre></td><td class='code'><pre><code class='vbnet'><span class='line'><span class="k">Private</span> <span class="k">Sub</span> <span class="nf">cmdAmbilNoAntrian_Click</span><span class="p">()</span>
</span><span class='line'>    <span class="k">Dim</span> <span class="n">ipServer</span>    <span class="ow">As</span> <span class="kt">String</span>
</span><span class='line'>    <span class="k">Dim</span> <span class="n">cmd</span>         <span class="ow">As</span> <span class="kt">String</span><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="na">&lt;pre&gt;</span><span class="o">&lt;</span><span class="n">code</span><span class="o">&gt;</span><span class="n">ipServer</span> <span class="o">=</span> <span class="s">&quot;127.0.0.1&quot;</span>
</span><span class='line'><span class="n">cmd</span> <span class="o">=</span> <span class="s">&quot;get_no_antrian&quot;</span>
</span><span class='line'>
</span><span class='line'><span class="c">&#39; 1234 ada port yg menyesuaikan port yg ada di server</span>
</span><span class='line'><span class="k">If</span> <span class="n">isConnected</span><span class="p">(</span><span class="n">ipServer</span><span class="p">,</span> <span class="mi">1234</span><span class="p">)</span> <span class="k">Then</span>
</span><span class='line'>    <span class="n">myClient</span><span class="p">.</span><span class="n">SendData</span> <span class="n">cmd</span>
</span><span class='line'><span class="k">End</span> <span class="k">If</span>
</span><span class='line'><span class="na">&lt;/code&gt;</span><span class="o">&lt;/</span><span class="n">pre</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="na">&lt;p&gt;</span><span class="k">End</span> <span class="k">Sub</span>
</span></code></pre></td></tr></table></div></figure></p>

<p>Untuk mengetahui data yang dikirim balik oleh server kita bisa memanfaatkan event DataArrival yg dimiliki oleh objek winsock</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class='vbnet'><span class='line'><span class="k">Private</span> <span class="k">Sub</span> <span class="nf">myClient_DataArrival</span><span class="p">(</span><span class="k">ByVal</span> <span class="n">bytesTotal</span> <span class="ow">As</span> <span class="kt">Long</span><span class="p">)</span>
</span><span class='line'>    <span class="k">Dim</span> <span class="n">noAntrian</span> <span class="ow">As</span> <span class="kt">String</span><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="na">&lt;pre&gt;</span><span class="o">&lt;</span><span class="n">code</span><span class="o">&gt;</span><span class="k">On</span> <span class="k">Error</span> <span class="k">Resume</span> <span class="k">Next</span>
</span><span class='line'>
</span><span class='line'><span class="n">myClient</span><span class="p">.</span><span class="n">GetData</span> <span class="n">noAntrian</span>
</span><span class='line'><span class="n">lblNoAntrian</span><span class="p">.</span><span class="n">Caption</span> <span class="o">=</span> <span class="n">noAntrian</span>
</span><span class='line'><span class="na">&lt;/code&gt;</span><span class="o">&lt;/</span><span class="n">pre</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="na">&lt;p&gt;</span><span class="k">End</span> <span class="k">Sub</span>
</span></code></pre></td></tr></table></div></figure></p>

<p>Selesai :)</p>

<p>Aplikasi diatas belum menggunakan database sama sekali, sehingga jika aplikasi server ditutup maka counter nomor antrian akan dimulai dari 1 lagi, dan sy berharap tidak ada pertanyaan bagaimana menyimpan counter nomor antriannya ke database atw bagaimana cara menampilkan nomor atrian terakhir klo servernya error :D.</p>

<p>Selamat <a href="https://github.com/k4m4r82/Antrian">MENCOBA</a> :)</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Tutorial Active Report Bagian 4  Membuat Report Tanpa Database]]></title>
    <link href="http://coding4ever.net/blog/2011/10/31/tutorial-active-report-bagian-4-e28093-membuat-report-tanpa-database/"/>
    <updated>2011-10-31T01:45:00+07:00</updated>
    <id>http://coding4ever.net/blog/2011/10/31/tutorial-active-report-bagian-4-e28093-membuat-report-tanpa-database</id>
    <content type="html"><![CDATA[<p>Karena kesibukan ngajar (terutama nyiapin materi) di semester ini hampir saja membuat mata rantai postingan saya terputus dibulan ini, jadi akhirnya disempat2xin juga nulisnya :D.</p>

<p>Dan sekalian permohonan maaf buat om2x yg nanya responnya enggak bisa secepat dulu, maklum alasannya juga sama &ldquo;sok sibuk&rdquo; :D.</p>

<p>Oke, langsung saja beberapa waktu yang lalu ada yang nanya bagaimana menampilkan data yang ada di ListView ke ActiveReport.</p>

<!-- more -->


<p>Misal kita mempunyai data mahasiswa seperti berikut :</p>

<p><a href="http://coding4ever.files.wordpress.com/2011/10/10312011-11.png"><img src="http://coding4ever.files.wordpress.com/2011/10/10312011-11.png?w=300" alt="" /></a></p>

<p>Sebelumnya kita akan membuat terlebih dulu sebuah class Mahasiswa untuk menampung data diatas kemudian tinggal kita lewatkan melalui variabel public yang kita tambahkan dibagian ActiveReportnya.</p>

<p>Berikut kode lengkap class Mahasiswa</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
</pre></td><td class='code'><pre><code class='vbnet'><span class='line'><span class="k">Private</span> <span class="n">m_Npm</span>    <span class="ow">As</span> <span class="kt">String</span>
</span><span class='line'><span class="k">Private</span> <span class="n">m_nama</span>   <span class="ow">As</span> <span class="kt">String</span>
</span><span class='line'><span class="k">Private</span> <span class="n">m_kota</span>   <span class="ow">As</span> <span class="kt">String</span><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="na">&lt;p&gt;</span><span class="k">Public</span> <span class="k">Property</span> <span class="nf">Let</span> <span class="n">Npm</span><span class="p">(</span><span class="k">ByVal</span> <span class="n">vData</span> <span class="ow">As</span> <span class="kt">String</span><span class="p">)</span>
</span><span class='line'>    <span class="n">m_Npm</span> <span class="o">=</span> <span class="n">vData</span>
</span><span class='line'><span class="k">End</span> <span class="k">Property</span>
</span><span class='line'><span class="k">Public</span> <span class="k">Property</span> <span class="nf">Get</span> <span class="n">Npm</span><span class="p">()</span> <span class="ow">As</span> <span class="kt">String</span>
</span><span class='line'>    <span class="n">Npm</span> <span class="o">=</span> <span class="n">m_Npm</span>
</span><span class='line'><span class="k">End</span> <span class="k">Property</span><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="na">&lt;p&gt;</span><span class="k">Public</span> <span class="k">Property</span> <span class="nf">Let</span> <span class="n">Nama</span><span class="p">(</span><span class="k">ByVal</span> <span class="n">vData</span> <span class="ow">As</span> <span class="kt">String</span><span class="p">)</span>
</span><span class='line'>    <span class="n">m_nama</span> <span class="o">=</span> <span class="n">vData</span>
</span><span class='line'><span class="k">End</span> <span class="k">Property</span>
</span><span class='line'><span class="k">Public</span> <span class="k">Property</span> <span class="nf">Get</span> <span class="n">Nama</span><span class="p">()</span> <span class="ow">As</span> <span class="kt">String</span>
</span><span class='line'>    <span class="n">Nama</span> <span class="o">=</span> <span class="n">m_nama</span>
</span><span class='line'><span class="k">End</span> <span class="k">Property</span><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="na">&lt;p&gt;</span><span class="k">Public</span> <span class="k">Property</span> <span class="nf">Let</span> <span class="n">Kota</span><span class="p">(</span><span class="k">ByVal</span> <span class="n">vData</span> <span class="ow">As</span> <span class="kt">String</span><span class="p">)</span>
</span><span class='line'>    <span class="n">m_kota</span> <span class="o">=</span> <span class="n">vData</span>
</span><span class='line'><span class="k">End</span> <span class="k">Property</span>
</span><span class='line'><span class="k">Public</span> <span class="k">Property</span> <span class="nf">Get</span> <span class="n">Kota</span><span class="p">()</span> <span class="ow">As</span> <span class="kt">String</span>
</span><span class='line'>    <span class="n">Kota</span> <span class="o">=</span> <span class="n">m_kota</span>
</span><span class='line'><span class="k">End</span> <span class="k">Property</span>
</span></code></pre></td></tr></table></div></figure></p>

<p>Untuk ActiveReportnya buat desain seperti biasa</p>

<p><a href="http://coding4ever.files.wordpress.com/2011/10/10312011-2.png"><img src="http://coding4ever.files.wordpress.com/2011/10/10312011-2.png?w=300" alt="" /></a></p>

<p>Setelah itu lengkapi juga kodenya</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
</pre></td><td class='code'><pre><code class='vbnet'><span class='line'><span class="k">Public</span> <span class="n">daftarMhs</span>    <span class="ow">As</span> <span class="n">Dictionary</span><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="na">&lt;p&gt;</span><span class="k">Private</span> <span class="k">Sub</span> <span class="nf">ActiveReport_FetchData</span><span class="p">(</span><span class="n">EOF</span> <span class="ow">As</span> <span class="kt">Boolean</span><span class="p">)</span>
</span><span class='line'>    <span class="k">Static</span> <span class="n">i</span> <span class="ow">As</span> <span class="kt">Integer</span><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="na">&lt;pre&gt;</span><span class="o">&lt;</span><span class="n">code</span><span class="o">&gt;</span><span class="n">i</span> <span class="o">=</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span>
</span><span class='line'>
</span><span class='line'><span class="k">If</span> <span class="n">i</span> <span class="o">&amp;</span><span class="n">gt</span><span class="err">;</span> <span class="n">daftarMhs</span><span class="p">.</span><span class="n">Count</span> <span class="k">Then</span>
</span><span class='line'>    <span class="n">EOF</span> <span class="o">=</span> <span class="k">True</span>
</span><span class='line'>    <span class="k">Exit</span> <span class="k">Sub</span>
</span><span class='line'><span class="nf">Else</span>
</span><span class='line'>    <span class="n">EOF</span> <span class="o">=</span> <span class="k">False</span>
</span><span class='line'><span class="k">End</span> <span class="k">If</span>
</span><span class='line'>
</span><span class='line'><span class="k">Dim</span> <span class="n">mhs</span> <span class="ow">As</span> <span class="n">Mahasiswa</span>
</span><span class='line'>
</span><span class='line'><span class="k">Set</span> <span class="n">mhs</span> <span class="o">=</span> <span class="n">daftarMhs</span><span class="p">.</span><span class="n">Item</span><span class="p">(</span><span class="k">CStr</span><span class="p">(</span><span class="n">i</span><span class="p">))</span>
</span><span class='line'><span class="n">txtNpm</span><span class="p">.</span><span class="n">Text</span> <span class="o">=</span> <span class="n">mhs</span><span class="p">.</span><span class="n">Npm</span>
</span><span class='line'><span class="n">txtNama</span><span class="p">.</span><span class="n">Text</span> <span class="o">=</span> <span class="n">mhs</span><span class="p">.</span><span class="n">Nama</span>
</span><span class='line'><span class="n">txtKota</span><span class="p">.</span><span class="n">Text</span> <span class="o">=</span> <span class="n">mhs</span><span class="p">.</span><span class="n">Kota</span>
</span><span class='line'><span class="na">&lt;/code&gt;</span><span class="o">&lt;/</span><span class="n">pre</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="na">&lt;p&gt;</span><span class="k">End</span> <span class="k">Sub</span><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="na">&lt;p&gt;</span><span class="k">Private</span> <span class="k">Sub</span> <span class="nf">Detail_Format</span><span class="p">()</span>
</span><span class='line'>    <span class="n">txtNo</span><span class="p">.</span><span class="n">Text</span> <span class="o">=</span> <span class="n">Val</span><span class="p">(</span><span class="n">txtNo</span><span class="p">.</span><span class="n">Text</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
</span><span class='line'><span class="k">End</span> <span class="k">Sub</span>
</span></code></pre></td></tr></table></div></figure></p>

<p>Pada kode diatas terlihat variabel daftarMhs bertipe Dictionary dengan access modifier public, jadi nilainya bisa kita set dari form.</p>

<p>Class Dictionary mirip seperti class Collection di C# atau java.</p>

<p>Terakhir kode untuk menampilkan ActiveReport plus mengeset nilai variabel daftarMhs yang diambil dari ListView.</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
</pre></td><td class='code'><pre><code class='vbnet'><span class='line'><span class="k">Private</span> <span class="k">Sub</span> <span class="nf">cmdPreview_Click</span><span class="p">()</span>
</span><span class='line'>    <span class="k">Dim</span> <span class="n">rpt</span>         <span class="ow">As</span> <span class="k">New</span> <span class="n">ActiveReport1</span>
</span><span class='line'>    <span class="k">Dim</span> <span class="n">daftarMhs</span>   <span class="ow">As</span> <span class="k">New</span> <span class="n">Dictionary</span>
</span><span class='line'>    <span class="k">Dim</span> <span class="n">mhs</span>         <span class="ow">As</span> <span class="n">Mahasiswa</span>
</span><span class='line'>    <span class="k">Dim</span> <span class="n">i</span>           <span class="ow">As</span> <span class="kt">Integer</span><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="na">&lt;pre&gt;</span><span class="o">&lt;</span><span class="n">code</span><span class="o">&gt;</span><span class="k">For</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span> <span class="k">To</span> <span class="n">lsvMahasiswa</span><span class="p">.</span><span class="n">ListItems</span><span class="p">.</span><span class="n">Count</span>
</span><span class='line'>    <span class="k">Set</span> <span class="n">mhs</span> <span class="o">=</span> <span class="k">New</span> <span class="n">Mahasiswa</span>
</span><span class='line'>    <span class="k">With</span> <span class="n">mhs</span>
</span><span class='line'>        <span class="p">.</span><span class="n">Npm</span> <span class="o">=</span> <span class="n">lsvMahasiswa</span><span class="p">.</span><span class="n">ListItems</span><span class="p">(</span><span class="n">i</span><span class="p">).</span><span class="n">SubItems</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</span><span class='line'>        <span class="p">.</span><span class="n">Nama</span> <span class="o">=</span> <span class="n">lsvMahasiswa</span><span class="p">.</span><span class="n">ListItems</span><span class="p">(</span><span class="n">i</span><span class="p">).</span><span class="n">SubItems</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</span><span class='line'>        <span class="p">.</span><span class="n">Kota</span> <span class="o">=</span> <span class="n">lsvMahasiswa</span><span class="p">.</span><span class="n">ListItems</span><span class="p">(</span><span class="n">i</span><span class="p">).</span><span class="n">SubItems</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</span><span class='line'>    <span class="k">End</span> <span class="k">With</span>
</span><span class='line'>
</span><span class='line'>    <span class="n">daftarMhs</span><span class="p">.</span><span class="n">Add</span> <span class="k">CStr</span><span class="p">(</span><span class="n">i</span><span class="p">),</span> <span class="n">mhs</span>
</span><span class='line'><span class="k">Next</span> <span class="n">i</span>
</span><span class='line'>
</span><span class='line'><span class="k">With</span> <span class="n">rpt</span>
</span><span class='line'>    <span class="k">Set</span> <span class="p">.</span><span class="n">daftarMhs</span> <span class="o">=</span> <span class="n">daftarMhs</span>
</span><span class='line'>    <span class="p">.</span><span class="n">Show</span>
</span><span class='line'><span class="k">End</span> <span class="k">With</span>
</span><span class='line'><span class="na">&lt;/code&gt;</span><span class="o">&lt;/</span><span class="n">pre</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="na">&lt;p&gt;</span><span class="k">End</span> <span class="k">Sub</span>
</span></code></pre></td></tr></table></div></figure></p>

<p>Selamat <a href="http://www.4shared.com/file/ZlvryGZ4/ARTanpaDB.html">MENCOBA</a> :)</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Implementasi Konsep Data Access Object (DAO) Di VB 6]]></title>
    <link href="http://coding4ever.net/blog/2011/09/08/implementasi-konsep-data-access-object-dao-di-vb-6/"/>
    <updated>2011-09-08T09:18:53+07:00</updated>
    <id>http://coding4ever.net/blog/2011/09/08/implementasi-konsep-data-access-object-dao-di-vb-6</id>
    <content type="html"><![CDATA[<p>Maksud <a href="http://en.wikipedia.org/wiki/Data_access_object">DAO</a> disini bukan komponen <a href="http://msdn.microsoft.com/en-us/library/et1kh6d3.aspx">Microsoft DAO</a> yang populer di kalangan programmer vb untuk mengakses database tapi <a href="http://en.wikipedia.org/wiki/Data_access_object">DAO</a> disini lebih ke penerapan konsep <a href="http://en.wikipedia.org/wiki/Data_access_object">DAO</a> yang diperkenalkan Java untuk mengakses database.</p>

<!-- more -->


<p>Dalam konsep <a href="http://en.wikipedia.org/wiki/Data_access_object">DAO</a> kita akan memisahkan module program menjadi beberapa bagian/layer yaitu :</p>

<ol>
<li><p> Presentation</p></li>
<li><p> Business Logic</p></li>
<li><p> Data Access</p></li>
</ol>


<p>Untuk presentation layer berhubungan dengan UI (user interface) .</p>

<p>Business Logic biasanya berhubungannya dengan entity class dan entity class sendiri merupakan representasi tabel-tabel yang ada di database biasanya juga disebut dengan istilah class model.</p>

<p>Terakhir Data Access yaitu bagian yang menangani urusan akses database biasanya terdapat operasi CRUD (Create, Read, Update, Delete).</p>

<p>Untuk kasusnya yang gampang aja :), kita akan mencoba mengakses data siswa yang mempunyai empat field yaitu nomor induk, nama, tempat lahir dan tanggal lahir.</p>

<p><a href="http://coding4ever.files.wordpress.com/2011/09/08092011-1.png"><img src="http://coding4ever.files.wordpress.com/2011/09/08092011-1.png" alt="" /></a></p>

<p><strong>Memulai project baru</strong></p>

<p>Jalankan Visual Basih 6 kemudian pada dialog New Project aktifkan tab New kemudian pilih Standar EXE dan akhiri dengan menekan tombol Open.</p>

<p><a href="http://coding4ever.files.wordpress.com/2011/09/08092011-2.png"><img src="http://coding4ever.files.wordpress.com/2011/09/08092011-2.png?w=300" alt="" /></a></p>

<p><strong>Membuat Presentation Layer</strong></p>

<p>Pada saat membuat project baru secara default sudah disiapkan 1 buah project plus formnya</p>

<p><a href="http://coding4ever.files.wordpress.com/2011/09/08092011-3.png"><img src="http://coding4ever.files.wordpress.com/2011/09/08092011-3.png" alt="" /></a></p>

<p>kemudian lakukan perubahan properties seperti gambar berikut :</p>

<p><a href="http://coding4ever.files.wordpress.com/2011/09/08092011-4.png"><img src="http://coding4ever.files.wordpress.com/2011/09/08092011-4.png?w=300" alt="" /></a></p>

<p><a href="http://coding4ever.files.wordpress.com/2011/09/08092011-5.png"><img src="http://coding4ever.files.wordpress.com/2011/09/08092011-5.png?w=277" alt="" /></a></p>

<p>untuk tampilannya kita akan desain seperti berikut :</p>

<p><a href="http://coding4ever.files.wordpress.com/2011/09/08092011-6.png"><img src="http://coding4ever.files.wordpress.com/2011/09/08092011-6.png?w=300" alt="" /></a></p>

<p><strong>Membuat Business Logic</strong></p>

<p>Business Logic ada hubungannya dengan entity class yang merupakan representasi dari tabel-tabel yang ada didatabase.</p>

<p>Berdasarkan struktur tabel siswa diatas kita akan membuat sebuah class dengan nama Siswa yang mempunyai empat buah property yaitu Nomor Induk, Nama, Tempat Lahir dan Tanggal Lahir.</p>

<p>Jadi property ini sudah mewakili method mutator dan accessor yang sudah biasa kita kenal penggunakannya di Java.</p>

<p>Untuk menampung class-class yang berhubungan dengan Business Logic kita akan menambahkan project baru dengan tipe ActiveX DLL, adapun caranya seperti berikut :</p>

<p>Klik menu File -> Add Project setelah itu akan tampil dialog Add Project</p>

<p>kemudian pilih ActiveX DLL dan klik tombol Open</p>

<p><a href="http://coding4ever.files.wordpress.com/2011/09/08092011-7.png"><img src="http://coding4ever.files.wordpress.com/2011/09/08092011-7.png?w=300" alt="" /></a></p>

<p>setelah itu akan ditambahkan 1 buah project dan class</p>

<p><a href="http://coding4ever.files.wordpress.com/2011/09/08092011-8.png"><img src="http://coding4ever.files.wordpress.com/2011/09/08092011-8.png?w=292" alt="" /></a></p>

<p>kemudian lakukan perubahan properties seperti gambar berikut :</p>

<p><a href="http://coding4ever.files.wordpress.com/2011/09/08092011-9.png"><img src="http://coding4ever.files.wordpress.com/2011/09/08092011-9.png?w=293" alt="" /></a></p>

<p><a href="http://coding4ever.files.wordpress.com/2011/09/08092011-10.png"><img src="http://coding4ever.files.wordpress.com/2011/09/08092011-10.png?w=300" alt="" /></a></p>

<p>Adapun kode lengkap untuk class Siswanya adalah sebagai berikut :</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
</pre></td><td class='code'><pre><code class='vbnet'><span class='line'><span class="k">Private</span> <span class="n">m_nomorInduk</span>    <span class="ow">As</span> <span class="kt">String</span>
</span><span class='line'><span class="k">Private</span> <span class="n">m_nama</span>          <span class="ow">As</span> <span class="kt">String</span>
</span><span class='line'><span class="k">Private</span> <span class="n">m_tempatLahir</span>   <span class="ow">As</span> <span class="kt">String</span>
</span><span class='line'><span class="k">Private</span> <span class="n">m_tanggalLahir</span>  <span class="ow">As</span> <span class="kt">Date</span><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="na">&lt;p&gt;</span><span class="k">Public</span> <span class="k">Property</span> <span class="nf">Let</span> <span class="n">NomorInduk</span><span class="p">(</span><span class="k">ByVal</span> <span class="n">vData</span> <span class="ow">As</span> <span class="kt">String</span><span class="p">)</span>
</span><span class='line'>    <span class="n">m_nomorInduk</span> <span class="o">=</span> <span class="n">vData</span>
</span><span class='line'><span class="k">End</span> <span class="k">Property</span>
</span><span class='line'><span class="k">Public</span> <span class="k">Property</span> <span class="nf">Get</span> <span class="n">NomorInduk</span><span class="p">()</span> <span class="ow">As</span> <span class="kt">String</span>
</span><span class='line'>    <span class="n">NomorInduk</span> <span class="o">=</span> <span class="n">m_nomorInduk</span>
</span><span class='line'><span class="k">End</span> <span class="k">Property</span><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="na">&lt;p&gt;</span><span class="k">Public</span> <span class="k">Property</span> <span class="nf">Let</span> <span class="n">Nama</span><span class="p">(</span><span class="k">ByVal</span> <span class="n">vData</span> <span class="ow">As</span> <span class="kt">String</span><span class="p">)</span>
</span><span class='line'>    <span class="n">m_nama</span> <span class="o">=</span> <span class="n">vData</span>
</span><span class='line'><span class="k">End</span> <span class="k">Property</span>
</span><span class='line'><span class="k">Public</span> <span class="k">Property</span> <span class="nf">Get</span> <span class="n">Nama</span><span class="p">()</span> <span class="ow">As</span> <span class="kt">String</span>
</span><span class='line'>    <span class="n">Nama</span> <span class="o">=</span> <span class="n">m_nama</span>
</span><span class='line'><span class="k">End</span> <span class="k">Property</span><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="na">&lt;p&gt;</span><span class="k">Public</span> <span class="k">Property</span> <span class="nf">Let</span> <span class="n">TempatLahir</span><span class="p">(</span><span class="k">ByVal</span> <span class="n">vData</span> <span class="ow">As</span> <span class="kt">String</span><span class="p">)</span>
</span><span class='line'>    <span class="n">m_tempatLahir</span> <span class="o">=</span> <span class="n">vData</span>
</span><span class='line'><span class="k">End</span> <span class="k">Property</span>
</span><span class='line'><span class="k">Public</span> <span class="k">Property</span> <span class="nf">Get</span> <span class="n">TempatLahir</span><span class="p">()</span> <span class="ow">As</span> <span class="kt">String</span>
</span><span class='line'>    <span class="n">TempatLahir</span> <span class="o">=</span> <span class="n">m_tempatLahir</span>
</span><span class='line'><span class="k">End</span> <span class="k">Property</span><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="na">&lt;p&gt;</span><span class="k">Public</span> <span class="k">Property</span> <span class="nf">Let</span> <span class="n">TanggalLahir</span><span class="p">(</span><span class="k">ByVal</span> <span class="n">vData</span> <span class="ow">As</span> <span class="kt">Date</span><span class="p">)</span>
</span><span class='line'>    <span class="n">m_tanggalLahir</span> <span class="o">=</span> <span class="n">vData</span>
</span><span class='line'><span class="k">End</span> <span class="k">Property</span>
</span><span class='line'><span class="k">Public</span> <span class="k">Property</span> <span class="nf">Get</span> <span class="n">TanggalLahir</span><span class="p">()</span> <span class="ow">As</span> <span class="kt">Date</span>
</span><span class='line'>    <span class="n">TanggalLahir</span> <span class="o">=</span> <span class="n">m_tanggalLahir</span>
</span><span class='line'><span class="k">End</span> <span class="k">Property</span>
</span></code></pre></td></tr></table></div></figure></p>

<p><strong>Membuat Data Access</strong></p>

<p>Lapisan ini biasanya berisi operasi CRUD (Create, Read, Update, Delete), tapi kita akan menggunakan istilah yang sedikit berbeda untuk nama operasinya yaitu :</p>

<ol>
<li><p> Save</p></li>
<li><p> Update</p></li>
<li><p> Delete</p></li>
<li><p> GetAll</p></li>
<li><p> GetByName</p></li>
<li><p> GetByNIS</p></li>
</ol>


<p>Biasanya untuk penamaan classnya cukup menambahkan akhiran (suffixes) Dao untuk setiap class entitynya. Contoh untuk class entity Siswa, biasanya class Data Accessnya diberi nama SiswaDao.</p>

<p>Oke langsung saja kita tambahkan project baru dengan mengklik menu File -> Add Project setelah itu akan tampil dialog Add Project</p>

<p>kemudian pilih ActiveX DLL dan klik tombol Open</p>

<p><a href="http://coding4ever.files.wordpress.com/2011/09/08092011-7.png"><img src="http://coding4ever.files.wordpress.com/2011/09/08092011-7.png?w=300" alt="" /></a></p>

<p>setelah itu akan ditambahkan 1 buah project dan class</p>

<p><a href="http://coding4ever.files.wordpress.com/2011/09/08092011-11.png"><img src="http://coding4ever.files.wordpress.com/2011/09/08092011-11.png?w=278" alt="" /></a></p>

<p>kemudian lakukan perubahan properties seperti gambar berikut :</p>

<p><a href="http://coding4ever.files.wordpress.com/2011/09/08092011-12.png"><img src="http://coding4ever.files.wordpress.com/2011/09/08092011-12.png?w=282" alt="" /></a></p>

<p><a href="http://coding4ever.files.wordpress.com/2011/09/08092011-13.png"><img src="http://coding4ever.files.wordpress.com/2011/09/08092011-13.png?w=279" alt="" /></a></p>

<p>Adapun kode lengkap untuk class SiswaDaonya adalah seperti berikut :</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
</pre></td><td class='code'><pre><code class='vbnet'><span class='line'><span class="k">Private</span> <span class="n">cmd</span>     <span class="ow">As</span> <span class="n">ADODB</span><span class="p">.</span><span class="n">Command</span>
</span><span class='line'><span class="k">Private</span> <span class="n">strSql</span>  <span class="ow">As</span> <span class="kt">String</span><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="na">&lt;p&gt;</span><span class="k">Private</span> <span class="k">Function</span> <span class="nf">MappingRowToObject</span><span class="p">(</span><span class="k">ByVal</span> <span class="n">rs</span> <span class="ow">As</span> <span class="n">ADODB</span><span class="p">.</span><span class="n">Recordset</span><span class="p">)</span> <span class="ow">As</span> <span class="n">SiswaModel</span><span class="p">.</span><span class="n">siswa</span>
</span><span class='line'>    <span class="k">Dim</span> <span class="n">siswa</span> <span class="ow">As</span> <span class="k">New</span> <span class="n">SiswaModel</span><span class="p">.</span><span class="n">siswa</span><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="na">&lt;pre&gt;</span><span class="o">&lt;</span><span class="n">code</span><span class="o">&gt;</span><span class="k">With</span> <span class="n">siswa</span>
</span><span class='line'>    <span class="p">.</span><span class="n">NomorInduk</span> <span class="o">=</span> <span class="n">IIf</span><span class="p">(</span><span class="n">IsNull</span><span class="p">(</span><span class="n">rs</span><span class="p">(</span><span class="s">&quot;nomor_induk&quot;</span><span class="p">).</span><span class="n">Value</span><span class="p">),</span> <span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">rs</span><span class="p">(</span><span class="s">&quot;nomor_induk&quot;</span><span class="p">).</span><span class="n">Value</span><span class="p">)</span>
</span><span class='line'>    <span class="p">.</span><span class="n">nama</span> <span class="o">=</span> <span class="n">IIf</span><span class="p">(</span><span class="n">IsNull</span><span class="p">(</span><span class="n">rs</span><span class="p">(</span><span class="s">&quot;nama&quot;</span><span class="p">).</span><span class="n">Value</span><span class="p">),</span> <span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">rs</span><span class="p">(</span><span class="s">&quot;nama&quot;</span><span class="p">).</span><span class="n">Value</span><span class="p">)</span>
</span><span class='line'>    <span class="p">.</span><span class="n">TempatLahir</span> <span class="o">=</span> <span class="n">IIf</span><span class="p">(</span><span class="n">IsNull</span><span class="p">(</span><span class="n">rs</span><span class="p">(</span><span class="s">&quot;tempat_lahir&quot;</span><span class="p">).</span><span class="n">Value</span><span class="p">),</span> <span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">rs</span><span class="p">(</span><span class="s">&quot;tempat_lahir&quot;</span><span class="p">).</span><span class="n">Value</span><span class="p">)</span>
</span><span class='line'>    <span class="p">.</span><span class="n">TanggalLahir</span> <span class="o">=</span> <span class="n">IIf</span><span class="p">(</span><span class="n">IsNull</span><span class="p">(</span><span class="n">rs</span><span class="p">(</span><span class="s">&quot;tgl_lahir&quot;</span><span class="p">).</span><span class="n">Value</span><span class="p">),</span> <span class="s">&quot;1/1/1900&quot;</span><span class="p">,</span> <span class="n">rs</span><span class="p">(</span><span class="s">&quot;tgl_lahir&quot;</span><span class="p">).</span><span class="n">Value</span><span class="p">)</span>
</span><span class='line'><span class="k">End</span> <span class="k">With</span>
</span><span class='line'>
</span><span class='line'><span class="k">Set</span> <span class="n">MappingRowToObject</span> <span class="o">=</span> <span class="n">siswa</span>
</span><span class='line'><span class="na">&lt;/code&gt;</span><span class="o">&lt;/</span><span class="n">pre</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="na">&lt;p&gt;</span><span class="k">End</span> <span class="k">Function</span>
</span></code></pre></td></tr></table></div></figure></p>

<p><strong>1. Method Save</strong></p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
</pre></td><td class='code'><pre><code class='vbnet'><span class='line'><span class="k">Public</span> <span class="k">Function</span> <span class="nf">Save</span><span class="p">(</span><span class="k">ByVal</span> <span class="n">siswa</span> <span class="ow">As</span> <span class="n">SiswaModel</span><span class="p">.</span><span class="n">siswa</span><span class="p">,</span> <span class="k">ByVal</span> <span class="n">conn</span> <span class="ow">As</span> <span class="n">ADODB</span><span class="p">.</span><span class="n">Connection</span><span class="p">)</span> <span class="ow">As</span> <span class="kt">Integer</span>
</span><span class='line'>    <span class="k">On</span> <span class="k">Error</span> <span class="k">GoTo</span> <span class="n">errHandle</span><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="na">&lt;pre&gt;</span><span class="o">&lt;</span><span class="n">code</span><span class="o">&gt;</span><span class="n">strSql</span> <span class="o">=</span> <span class="s">&quot;INSERT INTO siswa (nomor_induk, nama, tempat_lahir, tgl_lahir) VALUES (?, ?, ?, ?)&quot;</span>
</span><span class='line'>
</span><span class='line'><span class="k">Set</span> <span class="n">cmd</span> <span class="o">=</span> <span class="k">New</span> <span class="n">ADODB</span><span class="p">.</span><span class="n">Command</span>
</span><span class='line'><span class="k">With</span> <span class="n">cmd</span>
</span><span class='line'>    <span class="p">.</span><span class="n">ActiveConnection</span> <span class="o">=</span> <span class="n">conn</span>
</span><span class='line'>    <span class="p">.</span><span class="n">CommandType</span> <span class="o">=</span> <span class="n">adCmdText</span>
</span><span class='line'>    <span class="p">.</span><span class="n">CommandText</span> <span class="o">=</span> <span class="n">strSql</span>
</span><span class='line'>
</span><span class='line'>    <span class="p">.</span><span class="n">Parameters</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="o">=</span> <span class="n">siswa</span><span class="p">.</span><span class="n">NomorInduk</span>
</span><span class='line'>    <span class="p">.</span><span class="n">Parameters</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">siswa</span><span class="p">.</span><span class="n">nama</span>
</span><span class='line'>    <span class="p">.</span><span class="n">Parameters</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">siswa</span><span class="p">.</span><span class="n">TempatLahir</span>
</span><span class='line'>    <span class="p">.</span><span class="n">Parameters</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="n">siswa</span><span class="p">.</span><span class="n">TanggalLahir</span>
</span><span class='line'>
</span><span class='line'>    <span class="p">.</span><span class="n">Execute</span> <span class="n">Save</span>
</span><span class='line'><span class="k">End</span> <span class="k">With</span>
</span><span class='line'><span class="k">Set</span> <span class="n">cmd</span> <span class="o">=</span> <span class="k">Nothing</span>
</span><span class='line'>
</span><span class='line'><span class="k">Exit</span> <span class="k">Function</span>
</span><span class='line'><span class="err">&lt;/</span><span class="nf">code</span><span class="o">&gt;&lt;/</span><span class="n">pre</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="na">&lt;p&gt;</span><span class="n">errHandle</span><span class="p">:</span>
</span><span class='line'>    <span class="n">Save</span> <span class="o">=</span> <span class="mi">0</span>
</span><span class='line'><span class="k">End</span> <span class="k">Function</span>
</span></code></pre></td></tr></table></div></figure></p>

<p><strong>2. Method Update</strong></p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
</pre></td><td class='code'><pre><code class='vbnet'><span class='line'><span class="k">Public</span> <span class="k">Function</span> <span class="nf">Update</span><span class="p">(</span><span class="k">ByVal</span> <span class="n">siswa</span> <span class="ow">As</span> <span class="n">SiswaModel</span><span class="p">.</span><span class="n">siswa</span><span class="p">,</span> <span class="k">ByVal</span> <span class="n">conn</span> <span class="ow">As</span> <span class="n">ADODB</span><span class="p">.</span><span class="n">Connection</span><span class="p">)</span> <span class="ow">As</span> <span class="kt">Integer</span>
</span><span class='line'>    <span class="k">On</span> <span class="k">Error</span> <span class="k">GoTo</span> <span class="n">errHandle</span><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="na">&lt;pre&gt;</span><span class="o">&lt;</span><span class="n">code</span><span class="o">&gt;</span><span class="n">strSql</span> <span class="o">=</span> <span class="s">&quot;UPDATE siswa SET nama = ?, tempat_lahir = ?, tgl_lahir = ? WHERE nomor_induk = ?&quot;</span>
</span><span class='line'>
</span><span class='line'><span class="k">Set</span> <span class="n">cmd</span> <span class="o">=</span> <span class="k">New</span> <span class="n">ADODB</span><span class="p">.</span><span class="n">Command</span>
</span><span class='line'><span class="k">With</span> <span class="n">cmd</span>
</span><span class='line'>    <span class="p">.</span><span class="n">ActiveConnection</span> <span class="o">=</span> <span class="n">conn</span>
</span><span class='line'>    <span class="p">.</span><span class="n">CommandType</span> <span class="o">=</span> <span class="n">adCmdText</span>
</span><span class='line'>    <span class="p">.</span><span class="n">CommandText</span> <span class="o">=</span> <span class="n">strSql</span>
</span><span class='line'>
</span><span class='line'>    <span class="p">.</span><span class="n">Parameters</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="o">=</span> <span class="n">siswa</span><span class="p">.</span><span class="n">nama</span>
</span><span class='line'>    <span class="p">.</span><span class="n">Parameters</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">siswa</span><span class="p">.</span><span class="n">TempatLahir</span>
</span><span class='line'>    <span class="p">.</span><span class="n">Parameters</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">siswa</span><span class="p">.</span><span class="n">TanggalLahir</span>
</span><span class='line'>    <span class="p">.</span><span class="n">Parameters</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="n">siswa</span><span class="p">.</span><span class="n">NomorInduk</span>
</span><span class='line'>
</span><span class='line'>    <span class="p">.</span><span class="n">Execute</span> <span class="n">Update</span>
</span><span class='line'><span class="k">End</span> <span class="k">With</span>
</span><span class='line'><span class="k">Set</span> <span class="n">cmd</span> <span class="o">=</span> <span class="k">Nothing</span>
</span><span class='line'>
</span><span class='line'><span class="k">Exit</span> <span class="k">Function</span>
</span><span class='line'><span class="err">&lt;/</span><span class="nf">code</span><span class="o">&gt;&lt;/</span><span class="n">pre</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="na">&lt;p&gt;</span><span class="n">errHandle</span><span class="p">:</span>
</span><span class='line'>    <span class="n">Update</span> <span class="o">=</span> <span class="mi">0</span>
</span><span class='line'><span class="k">End</span> <span class="k">Function</span>
</span></code></pre></td></tr></table></div></figure></p>

<p><strong>3. Method Delete</strong></p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
</pre></td><td class='code'><pre><code class='vbnet'><span class='line'><span class="k">Public</span> <span class="k">Function</span> <span class="nf">Delete</span><span class="p">(</span><span class="k">ByVal</span> <span class="n">nis</span> <span class="ow">As</span> <span class="kt">String</span><span class="p">,</span> <span class="k">ByVal</span> <span class="n">conn</span> <span class="ow">As</span> <span class="n">ADODB</span><span class="p">.</span><span class="n">Connection</span><span class="p">)</span> <span class="ow">As</span> <span class="kt">Integer</span>
</span><span class='line'>    <span class="k">On</span> <span class="k">Error</span> <span class="k">GoTo</span> <span class="n">errHandle</span><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="na">&lt;pre&gt;</span><span class="o">&lt;</span><span class="n">code</span><span class="o">&gt;</span><span class="n">strSql</span> <span class="o">=</span> <span class="s">&quot;DELETE FROM siswa WHERE nomor_induk = ?&quot;</span>
</span><span class='line'>
</span><span class='line'><span class="k">Set</span> <span class="n">cmd</span> <span class="o">=</span> <span class="k">New</span> <span class="n">ADODB</span><span class="p">.</span><span class="n">Command</span>
</span><span class='line'><span class="k">With</span> <span class="n">cmd</span>
</span><span class='line'>    <span class="p">.</span><span class="n">ActiveConnection</span> <span class="o">=</span> <span class="n">conn</span>
</span><span class='line'>    <span class="p">.</span><span class="n">CommandType</span> <span class="o">=</span> <span class="n">adCmdText</span>
</span><span class='line'>    <span class="p">.</span><span class="n">CommandText</span> <span class="o">=</span> <span class="n">strSql</span>
</span><span class='line'>
</span><span class='line'>    <span class="p">.</span><span class="n">Parameters</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="o">=</span> <span class="n">nis</span>
</span><span class='line'>
</span><span class='line'>    <span class="p">.</span><span class="n">Execute</span> <span class="n">Delete</span>
</span><span class='line'><span class="k">End</span> <span class="k">With</span>
</span><span class='line'><span class="k">Set</span> <span class="n">cmd</span> <span class="o">=</span> <span class="k">Nothing</span>
</span><span class='line'>
</span><span class='line'><span class="k">Exit</span> <span class="k">Function</span>
</span><span class='line'><span class="err">&lt;/</span><span class="nf">code</span><span class="o">&gt;&lt;/</span><span class="n">pre</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="na">&lt;p&gt;</span><span class="n">errHandle</span><span class="p">:</span>
</span><span class='line'>    <span class="n">Delete</span> <span class="o">=</span> <span class="mi">0</span>
</span><span class='line'><span class="k">End</span> <span class="k">Function</span>
</span></code></pre></td></tr></table></div></figure></p>

<p><strong>4. Method GetAll</strong></p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
</pre></td><td class='code'><pre><code class='vbnet'><span class='line'><span class="k">Public</span> <span class="k">Function</span> <span class="nf">GetAll</span><span class="p">(</span><span class="k">ByVal</span> <span class="n">conn</span> <span class="ow">As</span> <span class="n">ADODB</span><span class="p">.</span><span class="n">Connection</span><span class="p">)</span> <span class="ow">As</span> <span class="n">Scripting</span><span class="p">.</span><span class="n">Dictionary</span>
</span><span class='line'>    <span class="k">Dim</span> <span class="n">daftarSiswa</span>     <span class="ow">As</span> <span class="k">New</span> <span class="n">Scripting</span><span class="p">.</span><span class="n">Dictionary</span>
</span><span class='line'>    <span class="k">Dim</span> <span class="n">rs</span>              <span class="ow">As</span> <span class="n">ADODB</span><span class="p">.</span><span class="n">Recordset</span><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="na">&lt;pre&gt;</span><span class="o">&lt;</span><span class="n">code</span><span class="o">&gt;</span><span class="k">Dim</span> <span class="n">key</span>             <span class="ow">As</span> <span class="kt">Long</span>
</span><span class='line'>
</span><span class='line'><span class="k">On</span> <span class="k">Error</span> <span class="k">GoTo</span> <span class="n">errHandle</span>
</span><span class='line'>
</span><span class='line'><span class="n">strSql</span> <span class="o">=</span> <span class="s">&quot;SELECT nomor_induk, nama, tempat_lahir, tgl_lahir &quot;</span> <span class="o">&amp;</span><span class="n">amp</span><span class="err">;</span> <span class="n">_</span>
</span><span class='line'>         <span class="s">&quot;FROM siswa &quot;</span> <span class="o">&amp;</span><span class="n">amp</span><span class="err">;</span> <span class="n">_</span>
</span><span class='line'>         <span class="s">&quot;ORDER BY nomor_induk&quot;</span>
</span><span class='line'>
</span><span class='line'><span class="k">Set</span> <span class="n">rs</span> <span class="o">=</span> <span class="n">OpenRecordset</span><span class="p">(</span><span class="n">strSql</span><span class="p">,</span> <span class="n">conn</span><span class="p">)</span>
</span><span class='line'><span class="k">Do</span> <span class="k">While</span> <span class="k">Not</span> <span class="n">rs</span><span class="p">.</span><span class="n">EOF</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">Call</span> <span class="n">daftarSiswa</span><span class="p">.</span><span class="n">Add</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">MappingRowToObject</span><span class="p">(</span><span class="n">rs</span><span class="p">))</span>
</span><span class='line'>    <span class="n">key</span> <span class="o">=</span> <span class="n">key</span> <span class="o">+</span> <span class="mi">1</span>
</span><span class='line'>
</span><span class='line'>    <span class="n">rs</span><span class="p">.</span><span class="n">MoveNext</span>
</span><span class='line'><span class="k">Loop</span>
</span><span class='line'><span class="k">Call</span> <span class="n">CloseRecordset</span><span class="p">(</span><span class="n">rs</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'><span class="k">Set</span> <span class="n">GetAll</span> <span class="o">=</span> <span class="n">daftarSiswa</span>
</span><span class='line'>
</span><span class='line'><span class="k">Exit</span> <span class="k">Function</span>
</span><span class='line'><span class="err">&lt;/</span><span class="nf">code</span><span class="o">&gt;&lt;/</span><span class="n">pre</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="na">&lt;p&gt;</span><span class="n">errHandle</span><span class="p">:</span>
</span><span class='line'>    <span class="k">Set</span> <span class="n">GetAll</span> <span class="o">=</span> <span class="k">Nothing</span>
</span><span class='line'><span class="k">End</span> <span class="k">Function</span>
</span></code></pre></td></tr></table></div></figure></p>

<p><strong>5. Method GetByName</strong></p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
</pre></td><td class='code'><pre><code class='vbnet'><span class='line'><span class="k">Public</span> <span class="k">Function</span> <span class="nf">GetByName</span><span class="p">(</span><span class="k">ByVal</span> <span class="n">nama</span> <span class="ow">As</span> <span class="kt">String</span><span class="p">,</span> <span class="k">ByVal</span> <span class="n">conn</span> <span class="ow">As</span> <span class="n">ADODB</span><span class="p">.</span><span class="n">Connection</span><span class="p">)</span> <span class="ow">As</span> <span class="n">Scripting</span><span class="p">.</span><span class="n">Dictionary</span>
</span><span class='line'>    <span class="k">Dim</span> <span class="n">daftarSiswa</span>     <span class="ow">As</span> <span class="k">New</span> <span class="n">Scripting</span><span class="p">.</span><span class="n">Dictionary</span>
</span><span class='line'>    <span class="k">Dim</span> <span class="n">rs</span>              <span class="ow">As</span> <span class="n">ADODB</span><span class="p">.</span><span class="n">Recordset</span><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="na">&lt;pre&gt;</span><span class="o">&lt;</span><span class="n">code</span><span class="o">&gt;</span><span class="k">Dim</span> <span class="n">key</span>             <span class="ow">As</span> <span class="kt">Long</span>
</span><span class='line'>
</span><span class='line'><span class="k">On</span> <span class="k">Error</span> <span class="k">GoTo</span> <span class="n">errHandle</span>
</span><span class='line'>
</span><span class='line'><span class="n">nama</span> <span class="o">=</span> <span class="n">Replace</span><span class="p">(</span><span class="n">nama</span><span class="p">,</span> <span class="s">&quot;&#39;&quot;</span><span class="p">,</span> <span class="s">&quot;&#39;&#39;&quot;</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'><span class="n">strSql</span> <span class="o">=</span> <span class="s">&quot;SELECT nomor_induk, nama, tempat_lahir, tgl_lahir &quot;</span> <span class="o">&amp;</span><span class="n">amp</span><span class="err">;</span> <span class="n">_</span>
</span><span class='line'>         <span class="s">&quot;FROM siswa &quot;</span> <span class="o">&amp;</span><span class="n">amp</span><span class="err">;</span> <span class="n">_</span>
</span><span class='line'>         <span class="s">&quot;WHERE nama LIKE &#39;%&quot;</span> <span class="o">&amp;</span><span class="n">amp</span><span class="err">;</span> <span class="n">nama</span> <span class="o">&amp;</span><span class="n">amp</span><span class="err">;</span> <span class="s">&quot;%&#39; &quot;</span> <span class="o">&amp;</span><span class="n">amp</span><span class="err">;</span> <span class="n">_</span>
</span><span class='line'>         <span class="s">&quot;ORDER BY nomor_induk&quot;</span>
</span><span class='line'>
</span><span class='line'><span class="k">Set</span> <span class="n">rs</span> <span class="o">=</span> <span class="n">OpenRecordset</span><span class="p">(</span><span class="n">strSql</span><span class="p">,</span> <span class="n">conn</span><span class="p">)</span>
</span><span class='line'><span class="k">Do</span> <span class="k">While</span> <span class="k">Not</span> <span class="n">rs</span><span class="p">.</span><span class="n">EOF</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">Call</span> <span class="n">daftarSiswa</span><span class="p">.</span><span class="n">Add</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">MappingRowToObject</span><span class="p">(</span><span class="n">rs</span><span class="p">))</span>
</span><span class='line'>    <span class="n">key</span> <span class="o">=</span> <span class="n">key</span> <span class="o">+</span> <span class="mi">1</span>
</span><span class='line'>
</span><span class='line'>    <span class="n">rs</span><span class="p">.</span><span class="n">MoveNext</span>
</span><span class='line'><span class="k">Loop</span>
</span><span class='line'><span class="k">Call</span> <span class="n">CloseRecordset</span><span class="p">(</span><span class="n">rs</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'><span class="k">Set</span> <span class="n">GetByName</span> <span class="o">=</span> <span class="n">daftarSiswa</span>
</span><span class='line'>
</span><span class='line'><span class="k">Exit</span> <span class="k">Function</span>
</span><span class='line'><span class="err">&lt;/</span><span class="nf">code</span><span class="o">&gt;&lt;/</span><span class="n">pre</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="na">&lt;p&gt;</span><span class="n">errHandle</span><span class="p">:</span>
</span><span class='line'>    <span class="k">Set</span> <span class="n">GetByName</span> <span class="o">=</span> <span class="k">Nothing</span>
</span><span class='line'><span class="k">End</span> <span class="k">Function</span>
</span></code></pre></td></tr></table></div></figure></p>

<p><strong>6. Method GetByNIS</strong></p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
</pre></td><td class='code'><pre><code class='vbnet'><span class='line'><span class="k">Public</span> <span class="k">Function</span> <span class="nf">GetByNIS</span><span class="p">(</span><span class="k">ByVal</span> <span class="n">nis</span> <span class="ow">As</span> <span class="kt">String</span><span class="p">,</span> <span class="k">ByVal</span> <span class="n">conn</span> <span class="ow">As</span> <span class="n">ADODB</span><span class="p">.</span><span class="n">Connection</span><span class="p">)</span> <span class="ow">As</span> <span class="n">SiswaModel</span><span class="p">.</span><span class="n">siswa</span>
</span><span class='line'>    <span class="k">Dim</span> <span class="n">siswa</span>   <span class="ow">As</span> <span class="n">SiswaModel</span><span class="p">.</span><span class="n">siswa</span>
</span><span class='line'>    <span class="k">Dim</span> <span class="n">rs</span>      <span class="ow">As</span> <span class="n">ADODB</span><span class="p">.</span><span class="n">Recordset</span><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="na">&lt;pre&gt;</span><span class="o">&lt;</span><span class="n">code</span><span class="o">&gt;</span><span class="k">On</span> <span class="k">Error</span> <span class="k">GoTo</span> <span class="n">errHandle</span>
</span><span class='line'>
</span><span class='line'><span class="n">strSql</span> <span class="o">=</span> <span class="s">&quot;SELECT nomor_induk, nama, tempat_lahir, tgl_lahir &quot;</span> <span class="o">&amp;</span><span class="n">amp</span><span class="err">;</span> <span class="n">_</span>
</span><span class='line'>         <span class="s">&quot;FROM siswa &quot;</span> <span class="o">&amp;</span><span class="n">amp</span><span class="err">;</span> <span class="n">_</span>
</span><span class='line'>         <span class="s">&quot;WHERE nomor_induk = &#39;&quot;</span> <span class="o">&amp;</span><span class="n">amp</span><span class="err">;</span> <span class="n">nis</span> <span class="o">&amp;</span><span class="n">amp</span><span class="err">;</span> <span class="s">&quot;&#39;&quot;</span>
</span><span class='line'><span class="k">Set</span> <span class="n">rs</span> <span class="o">=</span> <span class="n">OpenRecordset</span><span class="p">(</span><span class="n">strSql</span><span class="p">,</span> <span class="n">conn</span><span class="p">)</span>
</span><span class='line'><span class="k">If</span> <span class="k">Not</span> <span class="n">rs</span><span class="p">.</span><span class="n">EOF</span> <span class="k">Then</span>
</span><span class='line'>    <span class="k">Set</span> <span class="n">siswa</span> <span class="o">=</span> <span class="n">MappingRowToObject</span><span class="p">(</span><span class="n">rs</span><span class="p">)</span>
</span><span class='line'><span class="k">End</span> <span class="k">If</span>
</span><span class='line'><span class="k">Call</span> <span class="n">CloseRecordset</span><span class="p">(</span><span class="n">rs</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'><span class="k">Set</span> <span class="n">GetByNIS</span> <span class="o">=</span> <span class="n">siswa</span>
</span><span class='line'>
</span><span class='line'><span class="k">Exit</span> <span class="k">Function</span>
</span><span class='line'><span class="err">&lt;/</span><span class="nf">code</span><span class="o">&gt;&lt;/</span><span class="n">pre</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="na">&lt;p&gt;</span><span class="n">errHandle</span><span class="p">:</span>
</span><span class='line'>    <span class="k">Set</span> <span class="n">GetByNIS</span> <span class="o">=</span> <span class="k">Nothing</span>
</span><span class='line'><span class="k">End</span> <span class="k">Function</span>
</span></code></pre></td></tr></table></div></figure></p>

<p>Class SiswaDao diatas membutuhkan referensi/library tambahan berikut :</p>

<p><a href="http://coding4ever.files.wordpress.com/2011/09/08092011-14.png"><img src="http://coding4ever.files.wordpress.com/2011/09/08092011-14.png?w=300" alt="" /></a></p>

<p>Karena class SiswaModel dan SiswaDao berbeda project sehingga untuk mengakses class Siswa berikut propertiesnya dari SiswaDao perlu ditambahkan referensi SiswaModel.</p>

<p>Referensi Microsoft Scripting Runtime mirip dengan class <a href="http://msdn.microsoft.com/en-us/library/cy13e6ex%28v=vs.71%29.aspx">Collection</a>.</p>

<p>Terakhir kita akan membahas bagaimana mengakses class Siswa dan SiswaDao dari form Siswa tapi sebelumnya kita harus menambahkan referensi SiswaModel, SiswaDataAccess, Microsoft ADO 2x dan Microsoft Scripting Runtime.</p>

<p><a href="http://coding4ever.files.wordpress.com/2011/09/08092011-15.png"><img src="http://coding4ever.files.wordpress.com/2011/09/08092011-15.png?w=300" alt="" /></a></p>

<p><strong>1. Menyimpan data</strong></p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
</pre></td><td class='code'><pre><code class='vbnet'><span class='line'><span class="k">Private</span> <span class="k">Sub</span> <span class="nf">cmdSimpan_Click</span><span class="p">()</span>
</span><span class='line'>    <span class="k">Dim</span> <span class="n">siswa</span> <span class="ow">As</span> <span class="k">New</span> <span class="n">SiswaModel</span><span class="p">.</span><span class="n">siswa</span><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="na">&lt;pre&gt;</span><span class="o">&lt;</span><span class="n">code</span><span class="o">&gt;</span><span class="k">With</span> <span class="n">siswa</span>
</span><span class='line'>    <span class="p">.</span><span class="n">NomorInduk</span> <span class="o">=</span> <span class="n">txtNomorInduk</span><span class="p">.</span><span class="n">Text</span>
</span><span class='line'>    <span class="p">.</span><span class="n">nama</span> <span class="o">=</span> <span class="n">txtNama</span><span class="p">.</span><span class="n">Text</span>
</span><span class='line'>    <span class="p">.</span><span class="n">TempatLahir</span> <span class="o">=</span> <span class="n">txtTempatLahir</span><span class="p">.</span><span class="n">Text</span>
</span><span class='line'>    <span class="p">.</span><span class="n">TanggalLahir</span> <span class="o">=</span> <span class="n">dtpTanggal</span><span class="p">.</span><span class="n">Value</span>
</span><span class='line'><span class="k">End</span> <span class="k">With</span>
</span><span class='line'>
</span><span class='line'><span class="n">result</span> <span class="o">=</span> <span class="n">siswaDao</span><span class="p">.</span><span class="n">Save</span><span class="p">(</span><span class="n">siswa</span><span class="p">,</span> <span class="n">conn</span><span class="p">)</span>
</span><span class='line'><span class="k">If</span> <span class="n">result</span> <span class="o">&amp;</span><span class="n">gt</span><span class="err">;</span> <span class="mi">0</span> <span class="k">Then</span>
</span><span class='line'>    <span class="n">MsgBox</span> <span class="s">&quot;Data siswa sudah disimpan&quot;</span>
</span><span class='line'>    <span class="k">Call</span> <span class="n">LoadDataSiswa</span>
</span><span class='line'>
</span><span class='line'><span class="k">Else</span>
</span><span class='line'>    <span class="n">MsgBox</span> <span class="s">&quot;Data siswa gagal disimpan&quot;</span>
</span><span class='line'><span class="k">End</span> <span class="k">If</span>
</span><span class='line'>
</span><span class='line'><span class="k">Set</span> <span class="n">siswa</span> <span class="o">=</span> <span class="k">Nothing</span>
</span><span class='line'><span class="na">&lt;/code&gt;</span><span class="o">&lt;/</span><span class="n">pre</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="na">&lt;p&gt;</span><span class="k">End</span> <span class="k">Sub</span>
</span></code></pre></td></tr></table></div></figure></p>

<p><strong>2. Mengupdate data</strong></p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
</pre></td><td class='code'><pre><code class='vbnet'><span class='line'><span class="k">Private</span> <span class="k">Sub</span> <span class="nf">cmdPerbaiki_Click</span><span class="p">()</span>
</span><span class='line'>    <span class="k">Dim</span> <span class="n">siswa</span> <span class="ow">As</span> <span class="k">New</span> <span class="n">SiswaModel</span><span class="p">.</span><span class="n">siswa</span><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="na">&lt;pre&gt;</span><span class="o">&lt;</span><span class="n">code</span><span class="o">&gt;</span><span class="k">With</span> <span class="n">siswa</span>
</span><span class='line'>    <span class="p">.</span><span class="n">NomorInduk</span> <span class="o">=</span> <span class="n">txtNomorInduk</span><span class="p">.</span><span class="n">Text</span>
</span><span class='line'>    <span class="p">.</span><span class="n">nama</span> <span class="o">=</span> <span class="n">txtNama</span><span class="p">.</span><span class="n">Text</span>
</span><span class='line'>    <span class="p">.</span><span class="n">TempatLahir</span> <span class="o">=</span> <span class="n">txtTempatLahir</span><span class="p">.</span><span class="n">Text</span>
</span><span class='line'>    <span class="p">.</span><span class="n">TanggalLahir</span> <span class="o">=</span> <span class="n">dtpTanggal</span><span class="p">.</span><span class="n">Value</span>
</span><span class='line'><span class="k">End</span> <span class="k">With</span>
</span><span class='line'>
</span><span class='line'><span class="n">result</span> <span class="o">=</span> <span class="n">siswaDao</span><span class="p">.</span><span class="n">Update</span><span class="p">(</span><span class="n">siswa</span><span class="p">,</span> <span class="n">conn</span><span class="p">)</span>
</span><span class='line'><span class="k">If</span> <span class="n">result</span> <span class="o">&amp;</span><span class="n">gt</span><span class="err">;</span> <span class="mi">0</span> <span class="k">Then</span>
</span><span class='line'>    <span class="n">MsgBox</span> <span class="s">&quot;Data siswa sudah disimpan&quot;</span>
</span><span class='line'>    <span class="k">Call</span> <span class="n">LoadDataSiswa</span>
</span><span class='line'>
</span><span class='line'><span class="k">Else</span>
</span><span class='line'>    <span class="n">MsgBox</span> <span class="s">&quot;Data siswa gagal disimpan&quot;</span>
</span><span class='line'><span class="k">End</span> <span class="k">If</span>
</span><span class='line'>
</span><span class='line'><span class="k">Set</span> <span class="n">siswa</span> <span class="o">=</span> <span class="k">Nothing</span>
</span><span class='line'><span class="na">&lt;/code&gt;</span><span class="o">&lt;/</span><span class="n">pre</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="na">&lt;p&gt;</span><span class="k">End</span> <span class="k">Sub</span>
</span></code></pre></td></tr></table></div></figure></p>

<p><strong>3. Menghapus data</strong></p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
</pre></td><td class='code'><pre><code class='vbnet'><span class='line'><span class="k">Private</span> <span class="k">Sub</span> <span class="nf">cmdHapus_Click</span><span class="p">()</span>
</span><span class='line'>    <span class="k">Dim</span> <span class="n">nis</span> <span class="ow">As</span> <span class="kt">String</span><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="na">&lt;pre&gt;</span><span class="o">&lt;</span><span class="n">code</span><span class="o">&gt;</span><span class="n">nis</span> <span class="o">=</span> <span class="n">lsvSiswa</span><span class="p">.</span><span class="n">ListItems</span><span class="p">(</span><span class="n">lsvSiswa</span><span class="p">.</span><span class="n">SelectedItem</span><span class="p">.</span><span class="n">Index</span><span class="p">).</span><span class="n">SubItems</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'><span class="k">If</span> <span class="n">MsgBox</span><span class="p">(</span><span class="s">&quot;Apakah proses penghapusan ingin dilanjutkan ?&quot;</span><span class="p">,</span> <span class="n">vbExclamation</span> <span class="o">+</span> <span class="n">vbYesNo</span><span class="p">,</span> <span class="s">&quot;Konfirmasi&quot;</span><span class="p">)</span> <span class="o">=</span> <span class="n">vbYes</span> <span class="k">Then</span>
</span><span class='line'>    <span class="n">result</span> <span class="o">=</span> <span class="n">siswaDao</span><span class="p">.</span><span class="n">Delete</span><span class="p">(</span><span class="n">nis</span><span class="p">,</span> <span class="n">conn</span><span class="p">)</span>
</span><span class='line'>    <span class="k">If</span> <span class="n">result</span> <span class="o">&amp;</span><span class="n">gt</span><span class="err">;</span> <span class="mi">0</span> <span class="k">Then</span>
</span><span class='line'>        <span class="n">MsgBox</span> <span class="s">&quot;Data siswa sudah dihapus&quot;</span>
</span><span class='line'>        <span class="k">Call</span> <span class="n">LoadDataSiswa</span>
</span><span class='line'>
</span><span class='line'>        <span class="n">txtNomorInduk</span><span class="p">.</span><span class="n">Text</span> <span class="o">=</span> <span class="s">&quot;&quot;</span>
</span><span class='line'>        <span class="n">txtNama</span><span class="p">.</span><span class="n">Text</span> <span class="o">=</span> <span class="s">&quot;&quot;</span>
</span><span class='line'>        <span class="n">txtTempatLahir</span><span class="p">.</span><span class="n">Text</span> <span class="o">=</span> <span class="s">&quot;&quot;</span>
</span><span class='line'>
</span><span class='line'>        <span class="n">txtNomorInduk</span><span class="p">.</span><span class="n">SetFocus</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">Else</span>
</span><span class='line'>        <span class="n">MsgBox</span> <span class="s">&quot;Data siswa gagal dihapus&quot;</span>
</span><span class='line'>    <span class="k">End</span> <span class="k">If</span>
</span><span class='line'><span class="k">End</span> <span class="k">If</span>
</span><span class='line'><span class="na">&lt;/code&gt;</span><span class="o">&lt;/</span><span class="n">pre</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="na">&lt;p&gt;</span><span class="k">End</span> <span class="k">Sub</span>
</span></code></pre></td></tr></table></div></figure></p>

<p><strong>4. Menampilkan semua data</strong></p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
</pre></td><td class='code'><pre><code class='vbnet'><span class='line'><span class="k">Private</span> <span class="k">Sub</span> <span class="nf">FillToListView</span><span class="p">(</span><span class="k">ByVal</span> <span class="n">siswa</span> <span class="ow">As</span> <span class="n">SiswaModel</span><span class="p">.</span><span class="n">siswa</span><span class="p">)</span>
</span><span class='line'>    <span class="k">Dim</span> <span class="n">row</span> <span class="ow">As</span> <span class="kt">Long</span><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="na">&lt;pre&gt;</span><span class="o">&lt;</span><span class="n">code</span><span class="o">&gt;</span><span class="k">With</span> <span class="n">lsvSiswa</span>
</span><span class='line'>    <span class="n">row</span> <span class="o">=</span> <span class="p">.</span><span class="n">ListItems</span><span class="p">.</span><span class="n">Count</span> <span class="o">+</span> <span class="mi">1</span>
</span><span class='line'>
</span><span class='line'>    <span class="p">.</span><span class="n">ListItems</span><span class="p">.</span><span class="n">Add</span> <span class="p">,</span> <span class="p">,</span> <span class="n">row</span>
</span><span class='line'>    <span class="p">.</span><span class="n">ListItems</span><span class="p">(</span><span class="n">row</span><span class="p">).</span><span class="n">SubItems</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">siswa</span><span class="p">.</span><span class="n">NomorInduk</span>
</span><span class='line'>    <span class="p">.</span><span class="n">ListItems</span><span class="p">(</span><span class="n">row</span><span class="p">).</span><span class="n">SubItems</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">siswa</span><span class="p">.</span><span class="n">nama</span>
</span><span class='line'>    <span class="p">.</span><span class="n">ListItems</span><span class="p">(</span><span class="n">row</span><span class="p">).</span><span class="n">SubItems</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="n">siswa</span><span class="p">.</span><span class="n">TempatLahir</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">If</span> <span class="n">siswa</span><span class="p">.</span><span class="n">TanggalLahir</span> <span class="o">&amp;</span><span class="n">lt</span><span class="err">;</span><span class="o">&amp;</span><span class="n">gt</span><span class="err">;</span> <span class="s">&quot;1/1/1900&quot;</span> <span class="k">Then</span>
</span><span class='line'>        <span class="p">.</span><span class="n">ListItems</span><span class="p">(</span><span class="n">row</span><span class="p">).</span><span class="n">SubItems</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="o">=</span> <span class="n">Format</span><span class="p">(</span><span class="n">siswa</span><span class="p">.</span><span class="n">TanggalLahir</span><span class="p">,</span> <span class="s">&quot;dd/MM/yyyy&quot;</span><span class="p">)</span>
</span><span class='line'>    <span class="k">End</span> <span class="k">If</span>
</span><span class='line'><span class="k">End</span> <span class="k">With</span>
</span><span class='line'><span class="na">&lt;/code&gt;</span><span class="o">&lt;/</span><span class="n">pre</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="na">&lt;p&gt;</span><span class="k">End</span> <span class="k">Sub</span><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="na">&lt;p&gt;</span><span class="k">Private</span> <span class="k">Sub</span> <span class="nf">LoadDataSiswa</span><span class="p">(</span><span class="k">Optional</span> <span class="k">ByVal</span> <span class="n">nama</span> <span class="ow">As</span> <span class="kt">String</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">ldquo</span><span class="err">;</span><span class="o">&amp;</span><span class="n">rdquo</span><span class="err">;</span><span class="p">)</span>
</span><span class='line'>    <span class="k">Dim</span> <span class="n">daftarSiswa</span> <span class="ow">As</span> <span class="k">New</span> <span class="n">Scripting</span><span class="p">.</span><span class="n">Dictionary</span>
</span><span class='line'>    <span class="k">Dim</span> <span class="n">siswa</span>       <span class="ow">As</span> <span class="n">SiswaModel</span><span class="p">.</span><span class="n">siswa</span><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="na">&lt;pre&gt;</span><span class="o">&lt;</span><span class="n">code</span><span class="o">&gt;</span><span class="k">Dim</span> <span class="n">key</span><span class="err"></span> <span class="ow">As</span> <span class="kt">Variant</span>
</span><span class='line'>
</span><span class='line'><span class="k">If</span> <span class="n">Len</span><span class="p">(</span><span class="n">nama</span><span class="p">)</span> <span class="o">&amp;</span><span class="n">gt</span><span class="err">;</span> <span class="mi">0</span> <span class="k">Then</span>
</span><span class='line'>    <span class="k">Set</span> <span class="n">daftarSiswa</span> <span class="o">=</span> <span class="n">siswaDao</span><span class="p">.</span><span class="n">GetByName</span><span class="p">(</span><span class="n">nama</span><span class="p">,</span> <span class="n">conn</span><span class="p">)</span>
</span><span class='line'><span class="k">Else</span>
</span><span class='line'>    <span class="k">Set</span> <span class="n">daftarSiswa</span> <span class="o">=</span> <span class="n">siswaDao</span><span class="p">.</span><span class="n">GetAll</span><span class="p">(</span><span class="n">conn</span><span class="p">)</span>
</span><span class='line'><span class="k">End</span> <span class="k">If</span>
</span><span class='line'>
</span><span class='line'><span class="n">lsvSiswa</span><span class="p">.</span><span class="n">ListItems</span><span class="p">.</span><span class="n">Clear</span>
</span><span class='line'>
</span><span class='line'><span class="k">For</span> <span class="k">Each</span> <span class="n">key</span> <span class="ow">In</span> <span class="n">daftarSiswa</span>
</span><span class='line'>    <span class="k">Set</span> <span class="n">siswa</span> <span class="o">=</span> <span class="n">daftarSiswa</span><span class="p">.</span><span class="n">Item</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">Call</span> <span class="n">FillToListView</span><span class="p">(</span><span class="n">siswa</span><span class="p">)</span>
</span><span class='line'><span class="k">Next</span>
</span><span class='line'>
</span><span class='line'><span class="k">Set</span> <span class="n">siswa</span> <span class="o">=</span> <span class="k">Nothing</span>
</span><span class='line'><span class="k">Set</span> <span class="n">daftarSiswa</span> <span class="o">=</span> <span class="k">Nothing</span>
</span><span class='line'><span class="na">&lt;/code&gt;</span><span class="o">&lt;/</span><span class="n">pre</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="na">&lt;p&gt;</span><span class="k">End</span> <span class="k">Sub</span>
</span></code></pre></td></tr></table></div></figure></p>

<p>kemudian tinggal panggil di event Form_Load</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='vbnet'><span class='line'><span class="k">Private</span> <span class="k">Sub</span> <span class="nf">Form_Load</span><span class="p">()</span>
</span><span class='line'>    <span class="k">Call</span> <span class="n">LoadDataSiswa</span>
</span><span class='line'><span class="k">End</span> <span class="k">Sub</span>
</span></code></pre></td></tr></table></div></figure></p>

<p><strong>5. Menampilkan data berdasarkan nama</strong></p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='vbnet'><span class='line'><span class="k">Private</span> <span class="k">Sub</span> <span class="nf">cmdCariByName_Click</span><span class="p">()</span>
</span><span class='line'>    <span class="k">Call</span> <span class="n">LoadDataSiswa</span><span class="p">(</span><span class="n">txtKeywordPencarian</span><span class="p">.</span><span class="n">Text</span><span class="p">)</span>
</span><span class='line'><span class="k">End</span> <span class="k">Sub</span>
</span></code></pre></td></tr></table></div></figure></p>

<p><strong>6. Menampilkan data berdasarkan nomor induk</strong></p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
</pre></td><td class='code'><pre><code class='vbnet'><span class='line'><span class="k">Private</span> <span class="k">Sub</span> <span class="nf">cmdCariByNIS_Click</span><span class="p">()</span>
</span><span class='line'>    <span class="k">Dim</span> <span class="n">siswa</span> <span class="ow">As</span> <span class="n">SiswaModel</span><span class="p">.</span><span class="n">siswa</span><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="na">&lt;pre&gt;</span><span class="o">&lt;</span><span class="n">code</span><span class="o">&gt;</span><span class="k">Set</span> <span class="n">siswa</span> <span class="o">=</span> <span class="n">siswaDao</span><span class="p">.</span><span class="n">GetByNIS</span><span class="p">(</span><span class="n">txtNomorInduk</span><span class="p">.</span><span class="n">Text</span><span class="p">,</span> <span class="n">conn</span><span class="p">)</span>
</span><span class='line'><span class="k">If</span> <span class="k">Not</span> <span class="n">siswa</span> <span class="ow">Is</span> <span class="k">Nothing</span> <span class="k">Then</span>
</span><span class='line'>    <span class="k">With</span> <span class="n">siswa</span>
</span><span class='line'>        <span class="n">txtNama</span><span class="p">.</span><span class="n">Text</span> <span class="o">=</span> <span class="p">.</span><span class="n">nama</span>
</span><span class='line'>        <span class="n">txtTempatLahir</span><span class="p">.</span><span class="n">Text</span> <span class="o">=</span> <span class="p">.</span><span class="n">TempatLahir</span>
</span><span class='line'>
</span><span class='line'>        <span class="k">If</span> <span class="p">.</span><span class="n">TanggalLahir</span> <span class="o">&amp;</span><span class="n">lt</span><span class="err">;</span><span class="o">&amp;</span><span class="n">gt</span><span class="err">;</span> <span class="s">&quot;1/1/1900&quot;</span> <span class="k">Then</span>
</span><span class='line'>            <span class="n">dtpTanggal</span><span class="p">.</span><span class="n">Value</span> <span class="o">=</span> <span class="n">siswa</span><span class="p">.</span><span class="n">TanggalLahir</span>
</span><span class='line'>        <span class="k">End</span> <span class="k">If</span>
</span><span class='line'>    <span class="k">End</span> <span class="k">With</span>
</span><span class='line'>
</span><span class='line'><span class="k">Else</span>
</span><span class='line'>    <span class="n">MsgBox</span> <span class="s">&quot;Data siswa tidak ditemukan&quot;</span>
</span><span class='line'><span class="k">End</span> <span class="k">If</span>
</span><span class='line'>
</span><span class='line'><span class="k">Set</span> <span class="n">siswa</span> <span class="o">=</span> <span class="k">Nothing</span>
</span><span class='line'><span class="na">&lt;/code&gt;</span><span class="o">&lt;/</span><span class="n">pre</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="na">&lt;p&gt;</span><span class="k">End</span> <span class="k">Sub</span>
</span></code></pre></td></tr></table></div></figure></p>

<p><a href="http://coding4ever.files.wordpress.com/2011/09/08092011-16.png"><img src="http://coding4ever.files.wordpress.com/2011/09/08092011-16.png?w=300" alt="" /></a></p>

<p>Selamat <a href="http://www.4shared.com/file/jS0iKjHn/ImplementasiDAOVB6.html">MENCOBA</a> :)</p>
]]></content>
  </entry>
  
</feed>
