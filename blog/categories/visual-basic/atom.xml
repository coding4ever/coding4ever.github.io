<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Category: Visual Basic | Coding4ever's Blog]]></title>
  <link href="http://coding4ever.net/blog/categories/visual-basic/atom.xml" rel="self"/>
  <link href="http://coding4ever.net/"/>
  <updated>2017-08-22T16:03:33+07:00</updated>
  <id>http://coding4ever.net/</id>
  <author>
    <name><![CDATA[Admin]]></name>
    
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[Menggunakan Objek Collection Dan Transaction Pada Visual Basic 6]]></title>
    <link href="http://coding4ever.net/blog/2016/02/11/menggunakan-objek-collection-dan-transaction-pada-visual-basic-6/"/>
    <updated>2016-02-11T05:44:47+07:00</updated>
    <id>http://coding4ever.net/blog/2016/02/11/menggunakan-objek-collection-dan-transaction-pada-visual-basic-6</id>
    <content type="html"><![CDATA[<p>{% img left <a href="https://coding4ever.files.wordpress.com/2016/02/visualbasic6.jpg">https://coding4ever.files.wordpress.com/2016/02/visualbasic6.jpg</a> 120 100 %}Lagi kangen :-D, udah lama enggak posting tentang <a href="{{%20site.url%20}}/blog/categories/visual-basic/">Visual Basic 6</a>. Terakhir nulis sekitar <a href="{{%20site.url%20}}/blog/categories/visual-basic/">3-4 tahun</a> yang lalu he he :-D.</p>

<p>Kali ini saya ingin membahas salah satu poin <code>penting</code> tetapi sering kali disepelekan ketika akan membuat aplikasi bisnis yaitu <a href="http://en.wikipedia.org/wiki/Database_transaction">transaction</a>. Padahal fitur ini sangat penting untuk menjaga konsistensi data, karena hampir bisa dipastikan semua aplikasi bisnis menggunakan skema header-detail.</p>

<!-- more -->


<p>Salah satu poin penting dari <a href="http://en.wikipedia.org/wiki/Database_transaction">transaction</a> adalah <a href="http://en.wikipedia.org/wiki/Atomicity_%28database_systems%29">atomic</a>, yaitu beberapa perintah dianggap sebagai satu kesatuan. Kalau satu gagal, yang lain juga harus dibatalkan.</p>

<p>Contoh pada saat terjadi order penjualan proses yang terjadi adalah :</p>

<ol>
<li>Insert 1 kali ke tabel Order</li>
<li>Insert n kali ke tabel OrderDetail</li>
<li>Mengurangi stok barang (tidak di bahas di postingan ini), karena bisa juga diselesaikan dengan database trigger</li>
</ol>


<p>Ketika insert ke tabel OrderDetail gagal, maka tabel Ordernya juga harus di batalkan (undo), klo enggak ya datanya jadi enggak konsisten, karena ada nota Order yang enggak ada OrderDetailnya.</p>

<p>Nah utk mempermudah proses <a href="http://en.wikipedia.org/wiki/Database_transaction">transaction</a>  ini kita bisa menggunakan objek collection untuk menyimpan objek OrderDetail yang kemudian kita binding ke objek Ordernya. Berhubung <a href="{{%20site.url%20}}/blog/categories/visual-basic/">Visual Basic 6</a> tidak mempunyai class collection yang sepadan dengan class collection yang ada di Visual Basic .NET atau bahasa pemrograman .NET lainnya, sebagai gantinya kita bisa menggunakan class <code>Scripting.Dictionary</code>. Tetapi untuk menggunakan class <code>Scripting.Dictionary</code> ini kita harus menambahkan referensi <code>Microsoft Scripting Runtime</code> terlebih dulu.</p>

<p>{% img center <a href="https://coding4ever.files.wordpress.com/2016/02/100216-05.png">https://coding4ever.files.wordpress.com/2016/02/100216-05.png</a> %}</p>

<p>Dengan asumsi database berikut tabelnya sudah tersedia, langkah berikutnya adalah membuat class <code>Order</code> dan <code>OrderDetail</code>. Kedua class ini dikenal dengan istilah class model, yaitu class-class yang merupakan representasi dari tabel-tabel yang ada di database.</p>

<p>{% img center <a href="https://coding4ever.files.wordpress.com/2016/02/100216-01.png">https://coding4ever.files.wordpress.com/2016/02/100216-01.png</a> %}</p>

<p>{% img center <a href="https://coding4ever.files.wordpress.com/2016/02/100216-02.png">https://coding4ever.files.wordpress.com/2016/02/100216-02.png</a> %}</p>

<p>Nah class-class model ini biasanya mempunyai beberapa property yang juga merupakan representasi field-field yang ada di dalam tabel.</p>

<p>{% gist b374ccae1ccd75e58f17 %}</p>

<p>{% gist 52d180a02053e56fae2b %}</p>

<p>Setelah class-class model selesai dibuat, untuk urusan <a href="https://en.wikipedia.org/wiki/Create,_read,_update_and_delete">CRUD</a>-nya kita buat class tersendiri atau yang dikenal dengan istilah class-class <a href="{{%20site.url%20}}/blog/2011/09/08/implementasi-konsep-data-access-object-dao-di-vb-6/">DAO</a> atau <a href="https://msdn.microsoft.com/en-us/library/ff649690.aspx">Repository</a>.</p>

<p>{% img center <a href="https://coding4ever.files.wordpress.com/2016/02/100216-03.png">https://coding4ever.files.wordpress.com/2016/02/100216-03.png</a> %}</p>

<p>Class <a href="{{%20site.url%20}}/blog/2011/09/08/implementasi-konsep-data-access-object-dao-di-vb-6/">DAO</a> ini biasanya berisi method-method standar seperti Save, Update, Delete dan Get. Tapi untuk contoh kali ini saya hanya menambahkan method Save. Karena kita ingin insert ke tabel Order dan OrderDetail dianggap sebagai satu kesatuan, maka diterapkanlah konsep <a href="http://en.wikipedia.org/wiki/Database_transaction">transaction</a> dengan menambahkan perintah-perintah <a href="http://en.wikipedia.org/wiki/Database_transaction">transaction</a> seperti <code>BeginTrans</code>, <code>CommitTrans</code> dan <code>RollbackTrans</code>.</p>

<p>{% gist 41b8f6f9570100a2dc98 %}</p>

<p>Nah klo kita perhatikan di bagian constructor (Class_Initialize), terdapat perintah untuk membuat objek Connection dengan memanggil method <code>GetOpenConnection</code> dari class <a href="https://gist.github.com/k4m4r82/de02c82aeceac1f83bd4">DbConnection</a>.</p>

<p>{% img center <a href="https://coding4ever.files.wordpress.com/2016/02/100216-04.png">https://coding4ever.files.wordpress.com/2016/02/100216-04.png</a> %}</p>

<p>{% gist de02c82aeceac1f83bd4 %}</p>

<p>Setelah semua kodenya lengkap kita tinggal melakukan testing seperti berikut :</p>

<p>{% gist ff6696a7d94a1a3e6967 %}</p>

<p>Selamat <a href="https://github.com/k4m4r82/DemoTransactionVB6">MENCOBA</a> :-)</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Menggunakan Library .NET Di VB 6]]></title>
    <link href="http://coding4ever.net/blog/2012/06/01/menggunakan-library-net-di-vb-6/"/>
    <updated>2012-06-01T16:53:49+07:00</updated>
    <id>http://coding4ever.net/blog/2012/06/01/menggunakan-library-net-di-vb-6</id>
    <content type="html"><![CDATA[<p>Ini postingan lama sebenarnya, jawaban sy untuk salah satu pertanyaan member di forum <a href="http://www.i-bego.com/visual-basic-net/cara-buat-file-dll-net-assembly-com-visible-t2377.html">i-bego</a>.</p>

<p>Sy posting kembali disini untuk tujuan dokumentasi saja, mana tau suatu saat sy butuhkan.</p>

<p>Untuk contoh kasusnya adalah kita akan mengambil salah satu project open source yg bernama <a href="http://www.codeproject.com/Articles/20574/Open-Source-QRCode-Library">QRCode Library</a> dibuat menggunakan C#, dan dengan sedikit modifikasi library .NET ini akan bisa kita gunakan untuk VB 6.</p>

<!-- more -->


<p>Tapi sebelumnya kita lihat dulu apa itu QR Code ???</p>

<blockquote><p>QR Code (abbreviated from Quick Response Code) is the trademark for a type of matrix barcode (or two-dimensional code) first designed for the automotive industry. More recently, the system has become popular outside the industry due to its fast readability and large storage capacity compared to standard UPC barcodes. The code consists of black modules (square dots) arranged in a square pattern on a white background. The information encoded can be made up of four standardized kinds (&ldquo;modes&rdquo;) of data (numeric, alphanumeric, byte/binary, Kanji), or through supported extensions, virtually any kind of data.</p></blockquote>

<p>Sumber : <a href="http://en.wikipedia.org/wiki/QR_code">http://en.wikipedia.org/wiki/QR_code</a></p>

<p>Contoh QR Code</p>

<p><a href="http://coding4ever.files.wordpress.com/2012/06/qrcode.png"><img src="http://coding4ever.files.wordpress.com/2012/06/qrcode.png" alt="" /></a></p>

<p>Oke langsung saja download <a href="http://www.codeproject.com/Articles/20574/Open-Source-QRCode-Library">QRCode Library</a>, untuk contoh disini sy menggunakan C# 2005</p>

<ol>
<li>Aktifkan terlebih dulu project <a href="http://www.codeproject.com/Articles/20574/Open-Source-QRCode-Library">QRCode Library</a></li>
</ol>


<p><a href="http://coding4ever.files.wordpress.com/2012/06/qrcode-lib.png"><img src="http://coding4ever.files.wordpress.com/2012/06/qrcode-lib.png" alt="" /></a></p>

<ol>
<li>klik kanan Project (QRCodeLib) -> Properties, aktifkan tab Application kemudian klik tombol Assembly Information &hellip; kemudian aktifkan pilihan Make assembly COM-Visible</li>
</ol>


<p><a href="http://coding4ever.files.wordpress.com/2011/09/18092011-1.png"><img src="http://coding4ever.files.wordpress.com/2011/09/18092011-1.png" alt="" /></a></p>

<p><a href="http://coding4ever.files.wordpress.com/2011/09/18092011-2.png"><img src="http://coding4ever.files.wordpress.com/2011/09/18092011-2.png" alt="" /></a></p>

<ol>
<li>Aktifkan tab Build kemudian aktifkan pilihan Register for COM interop</li>
</ol>


<p><a href="http://coding4ever.files.wordpress.com/2011/09/18092011-3.png"><img src="http://coding4ever.files.wordpress.com/2011/09/18092011-3.png" alt="" /></a></p>

<ol>
<li>Mendaftarkan file ThoughtWorks.QRCode.dll dan ThoughtWorks.QRCode.tlb menggunakan tool RegAsm.exe yg ada di folder NET Framework</li>
</ol>


<p>{% codeblock %}
C:\Windows\Microsoft.NET\Framework\v2.0.50727
{% endcodeblock %}</p>

<p>Contoh saya menggunakan dot NET Framework 2, adapun perintahnya seperti berikut :</p>

<p>{% codeblock %}
regasm ThoughtWorks.QRCode.dll /tlb: ThoughtWorks.QRCode.tlb /codebase
{% endcodeblock %}</p>

<p>Sampai disini QRCode Library sudah bisa diakses dari VB 6</p>

<p><a href="http://coding4ever.files.wordpress.com/2011/09/18092011-4.png"><img src="http://coding4ever.files.wordpress.com/2011/09/18092011-4.png" alt="" /></a></p>

<p>Sekarang kita lihat sample asli dari QRCode Library</p>

<p><a href="http://coding4ever.files.wordpress.com/2011/09/18092011-5.png"><img src="http://coding4ever.files.wordpress.com/2011/09/18092011-5.png" alt="" /></a></p>

<p>Dari sample tersebut kode (C#) untuk melakukan encode sebuah data bertipe string menjadi gambar dengan format <a href="http://id.wikipedia.org/wiki/Kode_QR">QR Code</a> adalah seperti berikut :</p>

<p>{% codeblock lang:c# %}
private void btnEncode_Click_1(object sender, EventArgs e)
{
    if (txtEncodeData.Text.Trim() == String.Empty)
    {
        MessageBox.Show(&ldquo;Data must not be empty.&rdquo;);
        return;
    }</p>

<pre><code>QRCodeEncoder qrCodeEncoder = new QRCodeEncoder();
String encoding = cboEncoding.Text ;
if (encoding == "Byte") {
    qrCodeEncoder.QRCodeEncodeMode = QRCodeEncoder.ENCODE_MODE.BYTE;
} else if (encoding == "AlphaNumeric") {
    qrCodeEncoder.QRCodeEncodeMode = QRCodeEncoder.ENCODE_MODE.ALPHA_NUMERIC;
} else if (encoding == "Numeric") {
    qrCodeEncoder.QRCodeEncodeMode = QRCodeEncoder.ENCODE_MODE.NUMERIC;
}
try {
    int scale = Convert.ToInt16(txtSize.Text);
    qrCodeEncoder.QRCodeScale = scale;
} catch (Exception ex) {
    MessageBox.Show("Invalid size!");
    return;
}
try {
    int version = Convert.ToInt16(cboVersion.Text) ;
    qrCodeEncoder.QRCodeVersion = version;
} catch (Exception ex) {
    MessageBox.Show("Invalid version !");
}

string errorCorrect = cboCorrectionLevel.Text;
if (errorCorrect == "L")
    qrCodeEncoder.QRCodeErrorCorrect = QRCodeEncoder.ERROR_CORRECTION.L;
else if (errorCorrect == "M")
    qrCodeEncoder.QRCodeErrorCorrect = QRCodeEncoder.ERROR_CORRECTION.M;
else if (errorCorrect == "Q")
    qrCodeEncoder.QRCodeErrorCorrect = QRCodeEncoder.ERROR_CORRECTION.Q;
else if (errorCorrect == "H")
    qrCodeEncoder.QRCodeErrorCorrect = QRCodeEncoder.ERROR_CORRECTION.H;

Image image;
String data = txtEncodeData.Text;
image = qrCodeEncoder.Encode(data);
picEncode.Image = image;
</code></pre>

<p>}
{% endcodeblock %}</p>

<p>Sedangkan untuk versi VB 6nya sy buat sesimple mungkin</p>

<p>{% codeblock lang:vbnet %}
Private Sub cmdEncode_Click()
    Dim qrEncoder As New QRCodeEncoder</p>

<pre><code>qrEncoder.QRCodeEncodeMode = ENCODE_MODE.ENCODE_MODE_BYTE
qrEncoder.QRCodeScale = 4
qrEncoder.QRCodeVersion = 7
qrEncoder.QRCodeErrorCorrect = ERROR_CORRECTION.ERROR_CORRECTION_M

picEncode.Picture = qrEncoder.Encode(txtEncodeData.Text) ' error : Invalid procedure call or argument
</code></pre>

<p>End Sub
{% endcodeblock %}</p>

<p>tapi hasilnya malah error &lsquo;Invalid procedure call or argument&rsquo; :(, dan berdasarkan hasil pengamatan sementara, menurut sy penyebab errornya adalah karena method Encode adalah method yg dioverload sedangkan method overload belum disupport oleh VB 6.</p>

<p>{% codeblock lang:c# %}
public virtual Bitmap Encode(String content)
public virtual Bitmap Encode(String content, Encoding encoding)
{% endcodeblock %}</p>

<p>Jadi sy putuskan untuk menambahkan method baru dengan nama EncodeVB6, kemudian mengganti perintah</p>

<p>{% codeblock lang:vbnet %}
picEncode.Picture = qrEncoder.Encode(txtEncodeData.Text)
{% endcodeblock %}</p>

<p>menjadi</p>

<p>{% codeblock lang:vbnet %}
picEncode.Picture = qrEncoder.EncodeVB6(txtEncodeData.Text)
{% endcodeblock %}</p>

<p>Kode lengkap method EncodeVB6</p>

<p>{% codeblock lang:c# %}
public virtual Bitmap EncodeVB6(String content)
{
    if (QRCodeUtility.IsUniCode(content))
    {
        return Encode(content, Encoding.Unicode);
    }
    Else
    {
        return Encode(content, Encoding.ASCII);
    }
}
{% endcodeblock %}</p>

<p>Horeeeeee gubrakk, ternyata&hellip;. masih error :( &lsquo;Type mismatch&rsquo;</p>

<p>{% codeblock lang:vbnet %}
picEncode.Picture = qrEncoder.EncodeVB6(txtEncodeData.Text) &lsquo; error : Type mismatch
{% endcodeblock %}</p>

<p>dari pesan errornya sudah jelas karena properties Picture bertipe StdPicture sedangkan method EncodeVB6 bertipe Bitmap dan di VB 6 enggak ada tipe Bitmap :(, tapi untungnya :) ada method ImageToIPicture yg diambil dari class Support (namespace Microsoft.VisualBasic.Compatibility.VB6) sehingga method EncodeVB6nya kita revisi menjadi :</p>

<p>{% codeblock lang:c# %}
public virtual object EncodeVB6(String content)
{
    if (QRCodeUtility.IsUniCode(content))
    {
        return Microsoft.VisualBasic.Compatibility.VB6.Support.ImageToIPicture(Encode(content, Encoding.Unicode));
    }
    Else
    {
        return Microsoft.VisualBasic.Compatibility.VB6.Support.ImageToIPicture(Encode(content, Encoding.ASCII));
    }
}
{% endcodeblock %}</p>

<p>Sampai disi permasalah method EncodeVB6 sudah selesai :)</p>

<p>Terakhir kita akan melakukan proses decode</p>

<p><a href="http://coding4ever.files.wordpress.com/2011/09/18092011-6.png"><img src="http://coding4ever.files.wordpress.com/2011/09/18092011-6.png" alt="" /></a></p>

<p>dan kita lihat dulu kode aslinya (c#)</p>

<p>{% codeblock lang:c# %}
private void btnDecode_Click(object sender, EventArgs e)
{
    try
    {
        QRCodeDecoder decoder = new QRCodeDecoder();
        String decodedString = decoder.decode(new QRCodeBitmapImage(new Bitmap(picDecode.Image)));</p>

<pre><code>    txtDecodedData.Text = decodedString;
}
catch (Exception ex)
{
    MessageBox.Show(ex.Message);
}
</code></pre>

<p>}
{% endcodeblock %}</p>

<p>Dari kode diatas jelas tidak bisa langsung dikonversi ke VB 6 karena VB 6 tidak mendukung pemanggilan constructor class yg mempunyai parameter.</p>

<p>Tapi ada baiknya kita lihat dulu constructor class QRCodeBitmapImage yg ternyata membutuhkan objek Bitmap pada saat dipanggil.</p>

<p>{% codeblock lang:c# %}
///
<summary> /// Constructor
/// </summary>
///Bitmap image/param>
public QRCodeBitmapImage(Bitmap image)
{
    this.image = image;
}
{% endcodeblock %}</p>

<p>Solusinya kita akan menambahkan costructor default (constructor tanpa parameter)</p>

<p>{% codeblock lang:c# %}
// default constructor
Public QRCodeBitmapImage()
{
}
{% endcodeblock %}</p>

<p>trus untuk melewatkan objek Bitmap ke class QRCodeBitmapImage kita akan menambahkan property baru misal dengan nama SetBitmap, adapun kodenya seperti berikut :</p>

<p>{% codeblock lang:c# %}
public virtual Bitmap SetBitmap
{
    set { image = value; }
}
{% endcodeblock %}</p>

<p>Properties SetBitmap diatas bertipe Bitmap, tapi sayang di VB 6 belum ada padanan tipe datanya jadi kita akan menggunakan tipe Object, kemudian untuk mengkonversi ke tipe Bitmap kita menggunakan method IPictureToImage yg diambil dari class Support (namespace Microsoft.VisualBasic.Compatibility.VB6)</p>

<p>{% codeblock lang:c# %}
public virtual object SetBitmap
{
    set { image = (System.Drawing.Bitmap)Microsoft.VisualBasic.Compatibility.VB6.Support.IPictureToImage(value); }
}
{% endcodeblock %}</p>

<p>Setelah itu baru kita bisa melakukan konversi dengan aman di VB 6</p>

<p>{% codeblock lang:vbnet %}
Private Sub cmdDecode_Click()
    Dim decoder As New QRCodeDecoder</p>

<pre><code>Dim decodedString As String

Dim qrCodeImage As New QRCodeBitmapImage
qrCodeImage.SetBitmap = picEncode.Picture

decodedString = decoder.decodeVB6(qrCodeImage)

MsgBox "Hasil decode : " &amp; vbCrLf &amp; decodedString, vbInformation, "Informasi"
</code></pre>

<p>End Sub
{% endcodeblock %}</p>

<p><a href="http://coding4ever.files.wordpress.com/2011/09/18092011-7.png"><img src="http://coding4ever.files.wordpress.com/2011/09/18092011-7.png" alt="" /></a></p>

<p>Yuph akhirnya selesai juga :)</p>

<p>Selamat <a href="http://www.4shared.com/file/PCRQSJzV/QRCode.html">MENCOBA</a> :)</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Input Data via Grid]]></title>
    <link href="http://coding4ever.net/blog/2012/05/12/input-data-via-grid/"/>
    <updated>2012-05-12T13:01:52+07:00</updated>
    <id>http://coding4ever.net/blog/2012/05/12/input-data-via-grid</id>
    <content type="html"><![CDATA[<p>Sudah lama enggak posting tentang Visual Basic 6 jadi kangen juga :D.</p>

<p>Kali ini kita akan membahas bagaimana mudahnya melakukan input data langsung di grid menggunakan komponen VSFlexGrid.</p>

<p>VSFlexGrid sudah menyediakan beberapa method dan event yang mempermudah kita untuk melakukan hal ini, kita lihat screenshotnya.</p>

<!-- more -->


<p><a href="http://coding4ever.files.wordpress.com/2012/05/13052012.png"><img src="http://coding4ever.files.wordpress.com/2012/05/13052012.png" alt="" /></a></p>

<p>Berikut beberapa fitur yang akan kita bahas :</p>

<p><strong>1. Validasi</strong></p>

<p>Pada sample program di atas kita akan menambahkan beberapa validasi input seperti konversi ke huruf besar untuk kolom NAMA BARANG dan validasi input angka untuk kolom STOK dan HARGA JUAL. Kedua fitur ini membutuhkan fungsi berikut :</p>

<p>{% codeblock lang:vbnet %}
Private Function convertToUpper(ByVal keyAscii As Integer) As Integer
    convertToUpper = Asc(UCase$(Chr$(keyAscii)))
End Function</p>

<p>Private Function numericOnly(ByVal keyAscii As Integer) As Integer
    Dim strValid As String</p>

<pre><code>On Error GoTo errHandle

strValid = "0123456789."
If InStr(strValid, Chr(keyAscii)) = 0 And Not (keyAscii = vbKeyBack) Then
    numericOnly = 0
Else
    numericOnly = keyAscii
End If

Exit Function
</code></pre>

<p>errHandle:
    numericOnly = 0
End Function
{% endcodeblock %}</p>

<p>Selanjutnya fungsi diatas tinggal dipanggil di event KeyPressEdit dari komponen VSFlexGrid.</p>

<p>{% codeblock lang:vbnet %}
Private Sub Grid1_KeyPressEdit(ByVal Row As Long, ByVal Col As Long, keyAscii As Integer)
    If keyAscii = vbKeyReturn Then
        Call nextFocus
    End If</p>

<pre><code>Select Case Col
    Case 0 ' kode barang
    Case 1 ' nama barang
        keyAscii = convertToUpper(keyAscii)
    Case 2, 3 ' stok dan harga
        keyAscii = numericOnly(keyAscii)
End Select
</code></pre>

<p>End Sub
{% endcodeblock %}</p>

<p><strong>2. Focus dan Lostfocus backcolor</strong></p>

<p>Sesuai nama fiturnya cell grid akan berubah warna ketika cursor mouse aktif pada cell.</p>

<p>{% codeblock lang:vbnet %}
Private Sub Grid1_StartEdit(ByVal Row As Long, ByVal Col As Long, Cancel As Boolean)
    If Col = 3 Then &lsquo; harga jual
        Grid1.TextMatrix(Row, Col) = Replace(Grid1.TextMatrix(Row, Col), &ldquo;,&rdquo;, &ldquo;&rdquo;)
    End If</p>

<pre><code>Grid1.CellBackColor = &amp;HC0FFFF ' warna kuning
</code></pre>

<p>End Sub</p>

<p>Private Sub Grid1_AfterEdit(ByVal Row As Long, ByVal Col As Long)
    If Col = 3 Then &lsquo; harga jual
        If IsNumeric(Grid1.TextMatrix(Row, Col)) Then
            Grid1.TextMatrix(Row, Col) = FormatNumber(Grid1.TextMatrix(Row, Col), 0)
        End If
    End If
    Grid1.CellBackColor = vbDefault
End Sub
{% endcodeblock %}</p>

<p>Terakhir agar mode edit cellnya aktif pada saat cursor mouse aktif tinggal panggil method EditCell di event Click dan EnterCell</p>

<p>{% codeblock lang:vbnet %}
Private Sub Grid1_Click()
    Grid1.EditCell
End Sub</p>

<p>Private Sub Grid1_EnterCell()
    Grid1.EditCell
End Sub
{% endcodeblock %}</p>

<p>Selamat <a href="http://www.4shared.com/rar/t7rHkGRT/InputViaGrid.html">MENCOBA</a> :)</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Aplikasi Antrian]]></title>
    <link href="http://coding4ever.net/blog/2012/02/26/aplikasi-antrian/"/>
    <updated>2012-02-26T10:02:09+07:00</updated>
    <id>http://coding4ever.net/blog/2012/02/26/aplikasi-antrian</id>
    <content type="html"><![CDATA[<p>Aplikasi ini merupakan pengembangan dari sample aplikasi yg sudah pernah saya bahas pada postingan <a href="{{%20site.url%20}}/blog/2010/01/30/belajar-winsock-bagian-3-%e2%80%93-multiple-connection/">sebelumnya</a>, aplikasi ini terdiri dari 2 project yaitu :</p>

<ol>
<li><p>Aplikasi server memanfaatkan array winsock karena akan menghandle minimal 1 koneksi</p></li>
<li><p>Untuk aplikasi klien cukup menggunakan winsock standar (non array).</p></li>
</ol>


<!-- more -->


<p><a href="http://coding4ever.files.wordpress.com/2012/02/26022012-2.png"><img src="http://coding4ever.files.wordpress.com/2012/02/26022012-2.png" alt="" /></a></p>

<p>Sekarang akan kita bahas cara pembuatannya.</p>

<p><strong>Aplikasi server</strong></p>

<p>Aplikasi server menggunakan winsock yg dijadikan array karena akan menerima lebih dari 1 koneksi, untuk menjadikan sebuah winsock menjadi array cukup dengan mengeset properties index = 0</p>

<p><a href="http://coding4ever.files.wordpress.com/2012/02/26022012-1.png"><img src="http://coding4ever.files.wordpress.com/2012/02/26022012-1.png" alt="" /></a></p>

<p>Selain itu agar sebuah winsock bisa menerima koneksi yg masuk, maka winsocknya harus dalam mode &ldquo;Listen&rdquo;, untuk keperluan ini kita akan menyiapkan sebuah fungsi misal dengan nama startListening</p>

<p>{% codeblock lang:vbnet %}
Private Function startListening(ByVal localPort As Long) As Boolean
    On Error GoTo errHandle</p>

<pre><code>If localPort &gt; 0 Then
    'If the socket is already listening, and it's listening on the same port, don't bother restarting it.
    If (wckServer(0).State &lt;&gt; sckListening) Or (wckServer(0).localPort &lt;&gt; localPort) Then
        With wckServer(0)
            Call .Close
            .localPort = localPort
            Call .Listen
        End With
    End If

    'Return true, since the server is now listening for clients.
    startListening = True
</code></pre>

<p>   End If</p>

<p>   Exit Function
errHandle:
   startListening = False
End Function
{% endcodeblock %}</p>

<p>Selanjutnya tinggal kita panggil pada event Form_Load</p>

<p>{% codeblock lang:vbnet %}
Private Sub Form_Load()
    &lsquo;1234 adalah port yg digunakan untuk komunikasi
    &#8216;antara server dan klien, nilainya bisa disesuaikan
    If startListening(1234) Then
        MsgBox &ldquo;Status Server ON&rdquo;
    Else
        MsgBox &ldquo;Status Server OFF&rdquo;
    End If
End Sub
{% endcodeblock %}</p>

<p>Selain itu ada beberapa kode yang harus kita lengkapi pada event2x yg dimiliki oleh winsock yaitu event Close, ConnectionRequest, DataArrival dan Error</p>

<p>{% codeblock lang:vbnet %}
Private Sub wckServer_Close(Index As Integer)
    &lsquo; Close the socket and raise the event to the parent.
    Call wckServer(Index).Close
End Sub
{% endcodeblock %}
{% codeblock lang:vbnet %}
Private Sub wckServer_ConnectionRequest(Index As Integer, ByVal requestID As Long)
    Dim i          As Long
    Dim j          As Long
    Dim blnLoaded  As Boolean</p>

<pre><code>On Error GoTo errHandle

' We shouldn't get ConnectionRequests on any other socket than the listener
' (index 0), but check anyway. Also check that we're not going to exceed
' the MaxClients property.
If (Index = 0) Then
    ' Check to see if we've got any sockets that are free.
    For i = 1 To wckServer.UBound
        If (wckServer(i).State = sckClosed) Then
            j = i
            Exit For
        End If
    Next i

    ' If we don't have any free sockets, load another on the array.
    If (j = 0) Then
        blnLoaded = True
        Call Load(wckServer(wckServer.UBound + 1))
        j = wckServer.Count - 1
    End If

    ' With the selected socket, reset it and accept the new connection.
    With wckServer(j)
        Call .Close
        Call .Accept(requestID)
    End With

End If

Exit Sub
'
</code></pre>

<p>errHandle:
    &lsquo; Close the Winsock that caused the error.
    Call wckServer(0).Close
End Sub
{% endcodeblock %}</p>

<p>Event ConnectionRequest berfungsi untuk memfilter koneksi yg masuk, jika ada koneksi yg masuk akan dilakukan pengecekan terlebih dulu apakah ada winsock yg idle (ngangur) jika ada maka koneksi tersebut akan langsung dihandle oleh winsock yg idle tadi, jika tidak maka akan diload terlebih dulu winsock yg baru kemudian langsung menghandle koneksi yg baru masuk tadi.</p>

<p>Teknik ini merupakah salah satu cara untuk melakukan optimasi program jangan sampai aplikasi server meload secara terus menerus objek winsock yg baru untuk setiap koneksi yg masuk.</p>

<p>{% codeblock lang:vbnet %}
Private Sub wckServer_DataArrival(Index As Integer, ByVal bytesTotal As Long)
    Dim cmd     As String</p>

<pre><code>On Error GoTo errHandle

' Grab the data from the specified Winsock object, and pass it to the parent.
Call wckServer(Index).GetData(cmd)

Select Case cmd
    Case "get_no_antrian"
        Call send(Index, CStr(noAntrian))

        lblNoAntrian.Caption = noAntrian
        noAntrian = noAntrian + 1 ' naikkan counter nomor antrian

    Case Else
        Call send(Index, "perintah tidak dikenal")
End Select

Exit Sub
</code></pre>

<p>errHandle:
   Call wckServer(Index).Close
End Sub
{% endcodeblock %}</p>

<p>Event DataArrival berfungsi untuk memproses data yg masuk, untuk kasus aplikasi antrian ini data yang paling valid hanya berupa string &ldquo;get_no_antrian&rdquo;, jika datanya valid akan langsung dikirimkan nomor antrian terakhir ke klien yg mengirimkan string &ldquo;get_no_antrian&rdquo; dg memanggil prosedur send.</p>

<p>{% codeblock lang:vbnet %}
Private Sub send(ByVal lngIndex As Long, ByVal strData As String)
    If (wckServer(lngIndex).State = sckConnected) Then
        Call wckServer(lngIndex).SendData(strData): DoEvents
    Else
        Exit Sub
    End If
End Sub
{% endcodeblock %}
{% codeblock lang:vbnet %}
Private Sub wckServer_Error(Index As Integer, ByVal Number As Integer, Description As String, ByVal Scode As Long, ByVal Source As String, ByVal HelpFile As String, ByVal HelpContext As Long, CancelDisplay As Boolean)
    Call wckServer(Index).Close
End Sub
{% endcodeblock %}</p>

<p>Untuk aplikasi server sy rasa sudah cukup akan kita lanjutkan dg aplikasi klien.</p>

<p><strong>Aplikasi Klien</strong></p>

<p>Untuk aplikasi klien lebih sederhana lagi, yg kita butuhkan cukup sebuah fungsi untuk melakukan koneksi ke server</p>

<p>{% codeblock lang:vbnet %}
Private Const conTunggu As Long = 100000
{% endcodeblock %}
{% codeblock lang:vbnet %}
Private Function isConnected(ByVal ipServer As String, ByVal port As Long) As Boolean
    Static i As Long</p>

<pre><code>On Error Resume Next

If myClient.State &lt;&gt; sckClosed Then myClient.Close ' close existing connection
myClient.RemoteHost = ipServer
myClient.RemotePort = port
myClient.Connect

With myClient
    Do Until .State = sckConnected
        DoEvents
        i = i + 1
        If i &gt;= conTunggu Then
            i = 0
            Exit Function
        End If
    Loop
End With

isConnected = myClient.State = sckConnected
</code></pre>

<p>End Function
{% endcodeblock %}</p>

<p>Contoh pemanggilan fungsi diatas seperti berikut :</p>

<p>{% codeblock lang:vbnet %}
Private Sub cmdAmbilNoAntrian_Click()
    Dim ipServer    As String
    Dim cmd         As String</p>

<pre><code>ipServer = "127.0.0.1"
cmd = "get_no_antrian"

' 1234 ada port yg menyesuaikan port yg ada di server
If isConnected(ipServer, 1234) Then
    myClient.SendData cmd
End If
</code></pre>

<p>End Sub
{% endcodeblock %}</p>

<p>Untuk mengetahui data yang dikirim balik oleh server kita bisa memanfaatkan event DataArrival yg dimiliki oleh objek winsock</p>

<p>{% codeblock lang:vbnet %}
Private Sub myClient_DataArrival(ByVal bytesTotal As Long)
    Dim noAntrian As String</p>

<pre><code>On Error Resume Next

myClient.GetData noAntrian
lblNoAntrian.Caption = noAntrian
</code></pre>

<p>End Sub
{% endcodeblock %}</p>

<p>Selesai :)</p>

<p>Aplikasi diatas belum menggunakan database sama sekali, sehingga jika aplikasi server ditutup maka counter nomor antrian akan dimulai dari 1 lagi, dan sy berharap tidak ada pertanyaan bagaimana menyimpan counter nomor antriannya ke database atw bagaimana cara menampilkan nomor atrian terakhir klo servernya error :D.</p>

<p>Selamat <a href="https://github.com/k4m4r82/Antrian">MENCOBA</a> :)</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Tutorial Active Report Bagian 4 – Membuat Report Tanpa Database]]></title>
    <link href="http://coding4ever.net/blog/2011/10/31/tutorial-active-report-bagian-4-e28093-membuat-report-tanpa-database/"/>
    <updated>2011-10-31T01:45:00+07:00</updated>
    <id>http://coding4ever.net/blog/2011/10/31/tutorial-active-report-bagian-4-e28093-membuat-report-tanpa-database</id>
    <content type="html"><![CDATA[<p>Karena kesibukan ngajar (terutama nyiapin materi) di semester ini hampir saja membuat mata rantai postingan saya terputus dibulan ini, jadi akhirnya disempat2xin juga nulisnya :D.</p>

<p>Dan sekalian permohonan maaf buat om2x yg nanya responnya enggak bisa secepat dulu, maklum alasannya juga sama &ldquo;sok sibuk&rdquo; :D.</p>

<p>Oke, langsung saja beberapa waktu yang lalu ada yang nanya bagaimana menampilkan data yang ada di ListView ke ActiveReport.</p>

<p><!-- more -->Misal kita mempunyai data mahasiswa seperti berikut :</p>

<p><a href="http://coding4ever.files.wordpress.com/2011/10/10312011-11.png"><img src="http://coding4ever.files.wordpress.com/2011/10/10312011-11.png?w=300" alt="" /></a></p>

<p>Sebelumnya kita akan membuat terlebih dulu sebuah class Mahasiswa untuk menampung data diatas kemudian tinggal kita lewatkan melalui variabel public yang kita tambahkan dibagian ActiveReportnya.</p>

<p>Berikut kode lengkap class Mahasiswa</p>

<p>{% codeblock lang:vbnet %}
Private m_Npm    As String
Private m_nama   As String
Private m_kota   As String</p>

<p>Public Property Let Npm(ByVal vData As String)
    m_Npm = vData
End Property
Public Property Get Npm() As String
    Npm = m_Npm
End Property</p>

<p>Public Property Let Nama(ByVal vData As String)
    m_nama = vData
End Property
Public Property Get Nama() As String
    Nama = m_nama
End Property</p>

<p>Public Property Let Kota(ByVal vData As String)
    m_kota = vData
End Property
Public Property Get Kota() As String
    Kota = m_kota
End Property
{% endcodeblock %}</p>

<p>Untuk ActiveReportnya buat desain seperti biasa</p>

<p><a href="http://coding4ever.files.wordpress.com/2011/10/10312011-2.png"><img src="http://coding4ever.files.wordpress.com/2011/10/10312011-2.png?w=300" alt="" /></a></p>

<p>Setelah itu lengkapi juga kodenya</p>

<p>{% codeblock lang:vbnet %}
Public daftarMhs    As Dictionary</p>

<p>Private Sub ActiveReport_FetchData(EOF As Boolean)
    Static i As Integer</p>

<pre><code>i = i + 1

If i &gt; daftarMhs.Count Then
    EOF = True
    Exit Sub
Else
    EOF = False
End If

Dim mhs As Mahasiswa

Set mhs = daftarMhs.Item(CStr(i))
txtNpm.Text = mhs.Npm
txtNama.Text = mhs.Nama
txtKota.Text = mhs.Kota
</code></pre>

<p>End Sub</p>

<p>Private Sub Detail_Format()
    txtNo.Text = Val(txtNo.Text) + 1
End Sub
{% endcodeblock %}</p>

<p>Pada kode diatas terlihat variabel daftarMhs bertipe Dictionary dengan access modifier public, jadi nilainya bisa kita set dari form.</p>

<p>Class Dictionary mirip seperti class Collection di C# atau java.</p>

<p>Terakhir kode untuk menampilkan ActiveReport plus mengeset nilai variabel daftarMhs yang diambil dari ListView.</p>

<p>{% codeblock lang:vbnet %}
Private Sub cmdPreview_Click()
    Dim rpt         As New ActiveReport1
    Dim daftarMhs   As New Dictionary
    Dim mhs         As Mahasiswa
    Dim i           As Integer</p>

<pre><code>For i = 1 To lsvMahasiswa.ListItems.Count
    Set mhs = New Mahasiswa
    With mhs
        .Npm = lsvMahasiswa.ListItems(i).SubItems(1)
        .Nama = lsvMahasiswa.ListItems(i).SubItems(2)
        .Kota = lsvMahasiswa.ListItems(i).SubItems(3)
    End With

    daftarMhs.Add CStr(i), mhs
Next i

With rpt
    Set .daftarMhs = daftarMhs
    .Show
End With
</code></pre>

<p>End Sub
{% endcodeblock %}</p>

<p>Selamat <a href="http://www.4shared.com/file/ZlvryGZ4/ARTanpaDB.html">MENCOBA</a> :)</p>
]]></content>
  </entry>
  
</feed>
