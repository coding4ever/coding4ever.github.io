<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Category: Tools Installer | Coding4ever's Blog]]></title>
  <link href="http://coding4ever.net/blog/categories/tools-installer/atom.xml" rel="self"/>
  <link href="http://coding4ever.net/"/>
  <updated>2016-01-06T16:52:18+07:00</updated>
  <id>http://coding4ever.net/</id>
  <author>
    <name><![CDATA[Admin]]></name>
    
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[Menambahkan Form Input Pada Saat Instalasi (Inno Setup)]]></title>
    <link href="http://coding4ever.net/blog/2010/12/12/menambahkan-form-input-pada-saat-instalasi-inno-setup/"/>
    <updated>2010-12-12T00:01:03+07:00</updated>
    <id>http://coding4ever.net/blog/2010/12/12/menambahkan-form-input-pada-saat-instalasi-inno-setup</id>
    <content type="html"><![CDATA[<p>Adakalanya kita ingin menyederhanan proses konfigurasi aplikasi, sehingga sebagian konfigurasi kita pindah pada saat instalasi.</p>

<p>Misal kita akan menambahkan input profil klien seperti nama, telepon, alamat dan kota.</p>

<p><a href="http://coding4ever.files.wordpress.com/2010/12/12122010-3.jpg"><img src="http://coding4ever.files.wordpress.com/2010/12/12122010-3.jpg?w=300" alt="" /></a></p>

<p>Jadi dengan menggunakan <a href="http://jrsoftware.org/">Inno Setup</a> kita bisa dengan mudah melakukan hal ini, dan untuk lokasi penyimpanannya sendiri ada 2 pilihan yaitu disimpan dalam format file <a href="/blog/2010/04/23/contoh-sederhana-memanipulasi-ini-file-untuk-menyimpan-informasi/">INI</a> atau langsung ke registry windows.</p>

<!-- more -->


<p>Kita akan bahas satu-satu kodenya dan pada artikel ini saya tidak membahas skrip lengkap <a href="http://jrsoftware.org/">Inno Setup</a>nya karna sudah saya bahas pada artikel yang <a href="http://coding4ever.wordpress.com/category/tools-installer/">lain</a>nya, jadi fokus kita kali ini hanya di section <strong>[Code]</strong>.</p>

<p>Berikut kodenya untuk menambahkan form input dan menyimpannya ke file dengan format <a href="/blog/2010/04/23/contoh-sederhana-memanipulasi-ini-file-untuk-menyimpan-informasi/">INI</a>.</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>[Code]
</span><span class='line'>var
</span><span class='line'>   INIInputPage: TInputQueryWizardPage;&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;p>procedure InitializeWizard();
</span><span class='line'>begin
</span><span class='line'>  // Form Input
</span><span class='line'>  INIInputPage := CreateInputQueryPage(wpInfoAfter, &lsquo;Konfigurasi&rsquo;, &lsquo;Konfigurasi Program.&rsquo;,
</span><span class='line'>                                       &lsquo;Isikan konfigurasi program ke dalam form di bawah ini.&rsquo;);&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;p>  INIInputPage.Add(&lsquo;Nama&rsquo;, False);
</span><span class='line'>  INIInputPage.Add(&lsquo;Telepon&rsquo;, False);
</span><span class='line'>  INIInputPage.Add(&lsquo;Alamat&rsquo;, False);
</span><span class='line'>  INIInputPage.Add(&lsquo;Kota&rsquo;, False);&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;p>  INIInputPage.Values[0] := GetPreviousData(&lsquo;Nama&rsquo;, &lsquo;&rsquo;);
</span><span class='line'>  INIInputPage.Values[1] := GetPreviousData(&lsquo;Telepon&rsquo;, &lsquo;&rsquo;);
</span><span class='line'>  INIInputPage.Values[2] := GetPreviousData(&lsquo;Alamat&rsquo;, &lsquo;&rsquo;);
</span><span class='line'>  INIInputPage.Values[3] := GetPreviousData(&lsquo;Kota&rsquo;, &lsquo;&rsquo;);
</span><span class='line'>end;&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;p>// prosedur ketika user mengklik tombol kembali, setelah pengisian form
</span><span class='line'>procedure RegisterPreviousData(PreviousDataKey: Integer);
</span><span class='line'>begin
</span><span class='line'>  // tampilkan nilai sebelumnya yang sudah diinputkan user
</span><span class='line'>  SetPreviousData(PreviousDataKey, &lsquo;Nama&rsquo;, INIInputPage.Values[0]);
</span><span class='line'>  SetPreviousData(PreviousDataKey, &lsquo;Telepon&rsquo;, INIInputPage.Values[1]);
</span><span class='line'>  SetPreviousData(PreviousDataKey, &lsquo;Alamat&rsquo;, INIInputPage.Values[2]);
</span><span class='line'>  SetPreviousData(PreviousDataKey, &lsquo;Kota&rsquo;, INIInputPage.Values[3]);
</span><span class='line'>end;&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;p>// prosedur ketika user mengklik tombol lanjut, setelah pengisian form
</span><span class='line'>function NextButtonClick(CurPageID: Integer): Boolean;
</span><span class='line'>begin
</span><span class='line'>  Result := True;
</span><span class='line'>  if CurPageID = INIInputPage.ID then begin
</span><span class='line'>    // validasi input, untuk contoh disini saya validasi semua inputan harus diisi
</span><span class='line'>    if (Trim(INIInputPage.Values[0]) = &lsquo;&rsquo;) or (Trim(INIInputPage.Values[1]) = &lsquo;&rsquo;) or
</span><span class='line'>       (Trim(INIInputPage.Values[2]) = &lsquo;&rsquo;) or (Trim(INIInputPage.Values[3]) = &lsquo;&rsquo;) then begin
</span><span class='line'>       MsgBox(&lsquo;Anda harus mengisikan data secara lengkap!&rsquo;, mbError, MB_OK);
</span><span class='line'>       Result := False;&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;pre>&lt;code>end else begin
</span><span class='line'>  // jika semua input form oke, tulis ke file dengan format INI
</span><span class='line'>  // otomatis akan disimpan di folder instalasi dengan nama konfig.ini
</span><span class='line'>  SetIniString('Konfigurasi', 'Nama', INIInputPage.Values[0], ExpandConstant('{app}') + '\konfig.ini');
</span><span class='line'>  SetIniString('Konfigurasi', 'Telepon', INIInputPage.Values[1], ExpandConstant('{app}') + '\konfig.ini');
</span><span class='line'>  SetIniString('Konfigurasi', 'Alamat', INIInputPage.Values[2], ExpandConstant('{app}') + '\konfig.ini');
</span><span class='line'>  SetIniString('Konfigurasi', 'kota', INIInputPage.Values[3], ExpandConstant('{app}') + '\konfig.ini');
</span><span class='line'>end;
</span><span class='line'>&lt;/code>&lt;/pre>
</span><span class='line'>
</span><span class='line'>&lt;p>  end;
</span><span class='line'>end;</span></code></pre></td></tr></table></div></figure></p>

<p>Berikut contoh file <a href="/blog/2010/04/23/contoh-sederhana-memanipulasi-ini-file-untuk-menyimpan-informasi/">INI</a> yang dihasilkan dari kode diatas</p>

<p><a href="http://coding4ever.files.wordpress.com/2010/12/12122010-1.jpg"><img src="http://coding4ever.files.wordpress.com/2010/12/12122010-1.jpg?w=300" alt="" /></a></p>

<p>Sedangkan untuk menyimpan langsung ke registry windows menggunakan perintah <strong>RegWriteStringValue</strong></p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>// jika semua input form oke, simpan ke registry windows
</span><span class='line'>RegWriteStringValue(HKEY_CURRENT_USER, &lsquo;Software\K4m4r82&lt;code>s Laboratory\Sistem Informasi Sekolah', 'Nama', INIInputPage.Values[0]);
</span><span class='line'>RegWriteStringValue(HKEY_CURRENT_USER, 'Software\K4m4r82&lt;/code>s Laboratory\Sistem Informasi Sekolah&rsquo;, &lsquo;Telepon&rsquo;, INIInputPage.Values[1]);
</span><span class='line'>RegWriteStringValue(HKEY_CURRENT_USER, &lsquo;Software\K4m4r82&lt;code>s Laboratory\Sistem Informasi Sekolah', 'Alamat', INIInputPage.Values[2]);
</span><span class='line'>RegWriteStringValue(HKEY_CURRENT_USER, 'Software\K4m4r82&lt;/code>s Laboratory\Sistem Informasi Sekolah&rsquo;, &lsquo;Kota&rsquo;, INIInputPage.Values[3]);</span></code></pre></td></tr></table></div></figure></p>

<p>Jika kita lihat di registry windows, hasilnya lebih kurang seperti berikut :</p>

<p><a href="http://coding4ever.files.wordpress.com/2010/12/12122010-2.jpg"><img src="http://coding4ever.files.wordpress.com/2010/12/12122010-2.jpg?w=300" alt="" /></a></p>

<p>Selamat mencoba :)</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Menambahkan Serial Number Pada Paket Instalasi (Inno Setup)]]></title>
    <link href="http://coding4ever.net/blog/2010/04/05/menambahkan-serial-number-pada-paket-instalasi-inno-setup/"/>
    <updated>2010-04-05T00:01:04+07:00</updated>
    <id>http://coding4ever.net/blog/2010/04/05/menambahkan-serial-number-pada-paket-instalasi-inno-setup</id>
    <content type="html"><![CDATA[<p>Melengkapi koleksi artikel saya tentang pembuatan <a href="http://coding4ever.wordpress.com/category/tools-installer/">paket instalasi</a>, kali ini kita akan menambahkan serial number pada <a href="http://coding4ever.wordpress.com/category/tools-installer/">paket instalasi</a> yang kita buat menggunakan <a href="http://jrsoftware.org/">Inno Setup</a>.</p>

<p><a href="http://www.mjfreelancing.com/IKG.htm">IKG</a> (Inno Key Generator) adalah <a href="http://en.wikipedia.org/wiki/Third_party">Third-Party</a> files yang akan kita gunakan pada artikel ini dan <a href="http://jrsoftware.org/">Inno Setup</a> yang saya gunakan adalah versi 5.0.8.</p>

<p>Silahkan Anda download <a href="http://www.mjfreelancing.com/IKG.htm">IKG</a> dari situs resminya atau bisa juga download di<a href="http://dc196.4shared.com/download/257069716/702b80a7">sini</a> tetapi saya lebih menyarankan Anda untuk  mendownload dari link ke <a href="http://dc196.4shared.com/download/257069716/702b80a7">dua</a> saja :D karena sudah saya seleksi file-file apa saja yang dibutuhkan.</p>

<!-- more -->


<p>Jika sudah selesai downloadnya silahkan Anda ekstrak file IKG.rarnya, berikut adalah penjelasan singkat tentang file-file yang ada di dalam file IKG.rar</p>

<ol>
<li><p> <strong>ISID.dll</strong>, file ini dibutuhkan untuk melakukan validasi serial number/unlock code yang diinputkan pada saat proses instalasi, otomatis harus kita sertakan pada saat pembuatan paket instalasi.</p></li>
<li><p> <strong>IKG.exe</strong> adalah tool untuk mengenerate file Inno Key yang berisi informasi user + serial number valid yang sudah terenkripsi,<del> jadi setiap paket instalasi yang kita buat membutuhkan file inno key yang unik (huhhhh report juga ya) namanya juga mau aman (walaupun tidak 100%) report sedikitkan engga pa2 kan</del> (ralat 1 public key inno bisa untuk beberapa user name yg berbeda).</p></li>
<li><p> <strong>IKGHelp.pdf</strong>, klo yang ini kayaxnya enggak perlu saya jelasin.</p></li>
</ol>


<p>Oke langsung saja Anda jalankan file IKG.exe, setelah itu akan tampil form berikut :</p>

<p><a href="http://coding4ever.files.wordpress.com/2010/04/05042010-1.jpg"><img src="http://coding4ever.files.wordpress.com/2010/04/05042010-1.jpg?w=300" alt="" /></a></p>

<p>Langkah pertama yang harus kita lakukan adalah mengeset password IKG, agar tidak semua orang bisa menggunakan tool ini.</p>

<p>Klik menu File -> Change Bank Password</p>

<p><a href="http://coding4ever.files.wordpress.com/2010/04/05042010-2.jpg"><img src="http://coding4ever.files.wordpress.com/2010/04/05042010-2.jpg?w=300" alt="" /></a></p>

<p>Selanjutnya kita tinggal masukkan passwordnya</p>

<p><a href="http://coding4ever.files.wordpress.com/2010/04/05042010-3.jpg"><img src="http://coding4ever.files.wordpress.com/2010/04/05042010-3.jpg" alt="" /></a></p>

<p>Untuk menyederhanakan pembahasan, informasi yang akan kita tambahkan pada saat instalasi kita batasi sebagai berikut :</p>

<ol>
<li><p> Registered Name</p></li>
<li><p> Registered Company</p></li>
<li><p> Registration Code</p></li>
<li><p> Private Key</p></li>
</ol>


<p>Maka konfigurasi yang harus kita set pada tool IKG adalah sebagai berikut :</p>

<p><a href="http://coding4ever.files.wordpress.com/2010/04/05042010-4.jpg"><img src="http://coding4ever.files.wordpress.com/2010/04/05042010-4.jpg?w=300" alt="" /></a></p>

<p>Kita tinggal menginputkan informasi Registered Name dan Organisation, untuk informasi Registration Code dan Private Key sudah otomatis terisi.</p>

<p>Jika sudah kita langsung saja simpan file Inno Keynya, file ini berisi informasi Registered Name, Registered Company, Registration Code dan Private Key (sesuai setting diatas) yang sudah dienkripsi.</p>

<p><a href="http://coding4ever.files.wordpress.com/2010/04/05042010-5.jpg"><img src="http://coding4ever.files.wordpress.com/2010/04/05042010-5.jpg?w=300" alt="" /></a></p>

<p><a href="http://coding4ever.files.wordpress.com/2010/04/05042010-6.jpg"><img src="http://coding4ever.files.wordpress.com/2010/04/05042010-6.jpg?w=300" alt="" /></a></p>

<p>Jadi jika kita akan membuat file setup berikutnya, kita harus mengetik ulang informasi Registered Name dan Registered Company yang lain (unik) dan menyimpan ulang file Inno Key (sebaiknya dengan nama yang berbeda).</p>

<p>Sampai disini kita akan memasuki bagian yang paling menyenangkan yaitu coding :D. Kita akan menambahkan beberapa baris kode pada bagian <strong>[Files]</strong> dan <strong>[Code]</strong>.</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
<span class='line-number'>56</span>
<span class='line-number'>57</span>
<span class='line-number'>58</span>
<span class='line-number'>59</span>
<span class='line-number'>60</span>
<span class='line-number'>61</span>
<span class='line-number'>62</span>
<span class='line-number'>63</span>
<span class='line-number'>64</span>
<span class='line-number'>65</span>
<span class='line-number'>66</span>
<span class='line-number'>67</span>
<span class='line-number'>68</span>
<span class='line-number'>69</span>
<span class='line-number'>70</span>
<span class='line-number'>71</span>
<span class='line-number'>72</span>
<span class='line-number'>73</span>
<span class='line-number'>74</span>
<span class='line-number'>75</span>
<span class='line-number'>76</span>
<span class='line-number'>77</span>
<span class='line-number'>78</span>
<span class='line-number'>79</span>
<span class='line-number'>80</span>
<span class='line-number'>81</span>
<span class='line-number'>82</span>
<span class='line-number'>83</span>
<span class='line-number'>84</span>
<span class='line-number'>85</span>
<span class='line-number'>86</span>
<span class='line-number'>87</span>
<span class='line-number'>88</span>
<span class='line-number'>89</span>
<span class='line-number'>90</span>
<span class='line-number'>91</span>
<span class='line-number'>92</span>
<span class='line-number'>93</span>
<span class='line-number'>94</span>
<span class='line-number'>95</span>
<span class='line-number'>96</span>
<span class='line-number'>97</span>
<span class='line-number'>98</span>
<span class='line-number'>99</span>
<span class='line-number'>100</span>
<span class='line-number'>101</span>
<span class='line-number'>102</span>
<span class='line-number'>103</span>
<span class='line-number'>104</span>
<span class='line-number'>105</span>
<span class='line-number'>106</span>
<span class='line-number'>107</span>
<span class='line-number'>108</span>
<span class='line-number'>109</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>[Files]
</span><span class='line'>;file klien-1.iky dihasilkan oleh tool IKG
</span><span class='line'>Source: klien-1.iky; DestDir: {tmp}; Flags: ignoreversion
</span><span class='line'>Source: ISID.dll; DestDir: {sys}; Flags: ignoreversion&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;p>[Code]
</span><span class='line'>function ValidateSerialNumber(InnoKeyFile, User, Orgn, ProdCode, HDD, MAC, PrivateKey, Serial: String): Boolean;
</span><span class='line'>external &lsquo;ValidateSerialNumber@files:ISID.dll stdcall&rsquo;;&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;p>const
</span><span class='line'>    INNO_KEY = &lsquo;klien-1.iky&rsquo;;&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;p>var
</span><span class='line'>    UserPage   : TInputQueryWizardPage;
</span><span class='line'>    UserValues : TArrayOfString;&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;p>procedure InitializeWizard();
</span><span class='line'>begin
</span><span class='line'>    { create the custom page }
</span><span class='line'>    UserPage := CreateInputQueryPage(wpInfoBefore, &lsquo;Informasi Registrasi&rsquo;, &lsquo;Anda memerlukan user yang valid agar bisa melanjutkan proses instalasi&rsquo;,
</span><span class='line'>        &lsquo;Masukkan informasi registrasi (case sensitive), kemudian klik tombol Lanjut >.&rsquo;);&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;pre>&lt;code>UserPage.Add('Registered Name:', False);
</span><span class='line'>UserPage.Add('Registered Company:', False);
</span><span class='line'>UserPage.Add('Registration Code:', False);
</span><span class='line'>UserPage.Add('Private Key:', False);
</span><span class='line'>
</span><span class='line'>{ Set default values }
</span><span class='line'>SetArrayLength(UserValues, 4);
</span><span class='line'>RegQueryStringValue(HKLM, 'Software\Microsoft\Windows\CurrentVersion', 'RegisteredOwner', UserValues[0]);
</span><span class='line'>RegQueryStringValue(HKLM, 'Software\Microsoft\Windows\CurrentVersion', 'RegisteredOrganization', UserValues[1]);
</span><span class='line'>if (UserValues[0] = '') and (UserValues[1] = '') then begin
</span><span class='line'>    RegQueryStringValue(HKCU, 'Software\Microsoft\MS Setup (ACME)\User Info', 'DefName', UserValues[0]);
</span><span class='line'>    RegQueryStringValue(HKCU, 'Software\Microsoft\MS Setup (ACME)\User Info', 'DefCompany', UserValues[1]);
</span><span class='line'>end;
</span><span class='line'>
</span><span class='line'>{ Try to find the settings that were stored last time (also see below). }
</span><span class='line'>UserPage.Values[0] := GetPreviousData('Name', UserValues[0]);
</span><span class='line'>UserPage.Values[1] := GetPreviousData('Company', UserValues[1]);
</span><span class='line'>UserPage.Values[2] := GetPreviousData('Unlock', UserValues[2]);
</span><span class='line'>UserPage.Values[3] := GetPreviousData('Private', UserValues[3]);
</span><span class='line'>&lt;/code>&lt;/pre>
</span><span class='line'>
</span><span class='line'>&lt;p>end;&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;p>procedure RegisterPreviousData(PreviousDataKey: Integer);
</span><span class='line'>begin
</span><span class='line'>  { Store the settings so we can restore them next time }
</span><span class='line'>  SetPreviousData(PreviousDataKey, &lsquo;Name&rsquo;, UserPage.Values[0]);
</span><span class='line'>  SetPreviousData(PreviousDataKey, &lsquo;Company&rsquo;, UserPage.Values[1]);
</span><span class='line'>  SetPreviousData(PreviousDataKey, &lsquo;Unlock&rsquo;, UserPage.Values[2]);
</span><span class='line'>  SetPreviousData(PreviousDataKey, &lsquo;Private&rsquo;, UserPage.Values[3]);
</span><span class='line'>end;&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;p>function ScriptDlgPages(CurPage: Integer; BackClicked: Boolean): Boolean;
</span><span class='line'>var
</span><span class='line'>    ExpPath: String;&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;p>begin
</span><span class='line'>    Result := True;&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;pre>&lt;code>if (CurPage = UserPage.ID) then
</span><span class='line'>begin
</span><span class='line'>    ExtractTemporaryFile(INNO_KEY);     { the public key file }
</span><span class='line'>
</span><span class='line'>    ExpPath := ExpandConstant('{tmp}\' + INNO_KEY);
</span><span class='line'>
</span><span class='line'>    Result := False;
</span><span class='line'>
</span><span class='line'>    UserValues[0] := UserPage.Values[0];
</span><span class='line'>    UserValues[1] := UserPage.Values[1];
</span><span class='line'>    UserValues[2] := UserPage.Values[2];
</span><span class='line'>    UserValues[3] := UserPage.Values[3];
</span><span class='line'>
</span><span class='line'>    if (UserValues[0] = '') or (UserValues[1] = '') or (UserValues[2] = '') or (UserValues[3] = '') then
</span><span class='line'>        MsgBox('No fields can be blank !', mbError, MB_OK)
</span><span class='line'>    else
</span><span class='line'>    begin
</span><span class='line'>        Result := ValidateSerialNumber(ExpPath, UserValues[0], UserValues[1], '', '', '', UserValues[3], UserValues[2]);
</span><span class='line'>
</span><span class='line'>        if (not Result) then
</span><span class='line'>            MsgBox('Invalid Entry !', mbError, MB_OK);
</span><span class='line'>
</span><span class='line'>    end
</span><span class='line'>end
</span><span class='line'>&lt;/code>&lt;/pre>
</span><span class='line'>
</span><span class='line'>&lt;p>end;&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;p>function NextButtonClick(CurPage: Integer): Boolean;
</span><span class='line'>begin
</span><span class='line'>  Result := ScriptDlgPages(CurPage, False);
</span><span class='line'>end;&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;p>function BackButtonClick(CurPage: Integer): Boolean;
</span><span class='line'>begin
</span><span class='line'>  Result := True;//ScriptDlgPages(CurPage, True);
</span><span class='line'>end;&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;p>function HasHtmlHelp(): Boolean;
</span><span class='line'>begin
</span><span class='line'>    { HHCTRL.OCX GUID }
</span><span class='line'>    Result := RegValueExists(HKCR, &lsquo;CLSID{4662DAB0-D393-11D0-9A56-00C04FB68B66}\InprocServer32&rsquo;, &lsquo;&rsquo;);
</span><span class='line'>end;&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;p>function HasNoHtmlHelp(): Boolean;
</span><span class='line'>begin
</span><span class='line'>    Result := not HasHtmlHelp;
</span><span class='line'>end;</span></code></pre></td></tr></table></div></figure></p>

<p>Jika sudah selesai silahkan compile (CTRL+F9) skrip inno setup Anda, dan ingat skrip diatas hanya potongan skrip inno setup. Contoh skrip yang lengkap bisa Anda lihat di<a href="/blog/2009/12/31/membuat-paket-instalasi-vb-mysql-dengan-inno-setup/">sini</a> dan <a href="/blog/2010/01/05/membuat-paket-instalasi-vb-firebird-dengan-inno-setup/">sini</a>.</p>

<p><a href="http://coding4ever.files.wordpress.com/2010/04/05042010-7.jpg"><img src="http://coding4ever.files.wordpress.com/2010/04/05042010-7.jpg?w=300" alt="" /></a>
<a href="http://coding4ever.files.wordpress.com/2010/04/05042010-8.jpg"><img src="http://coding4ever.files.wordpress.com/2010/04/05042010-8.jpg?w=300" alt="" /></a>
Jika kita mencoba memasukkan informasi registrasi yang salah, maka akan tampil pesan berikut :</p>

<p><a href="http://coding4ever.files.wordpress.com/2010/04/05042010-9.jpg"><img src="http://coding4ever.files.wordpress.com/2010/04/05042010-9.jpg" alt="" /></a></p>

<p>Selamat mencoba :)</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Menambahkan Skin Pada Paket Instalasi (Inno Setup)]]></title>
    <link href="http://coding4ever.net/blog/2010/03/31/menambahkan-skin-pada-paket-instalasi-inno-setup/"/>
    <updated>2010-03-31T02:59:21+07:00</updated>
    <id>http://coding4ever.net/blog/2010/03/31/menambahkan-skin-pada-paket-instalasi-inno-setup</id>
    <content type="html"><![CDATA[<p>Inilah krennya <a href="http://jrsoftware.org/">inno setup</a> selain gratis dan open source juga banyak tersedia Third-Party Files, salah satunya ISSkin dari <a href="http://isskin.codejock.com/">codejock</a>.</p>

<p>Sebelum kita menambahkan skin, kita lihat dulu tampilan standar paket instalasi yang dibuat menggunakan inno setup.</p>

<p><a href="http://coding4ever.files.wordpress.com/2010/03/31032010-1.jpg"><img src="http://coding4ever.files.wordpress.com/2010/03/31032010-1.jpg?w=300" alt="" /></a></p>

<p>Dan kita lihat setelah menambahkan skin</p>

<!-- more -->


<p><a href="http://coding4ever.files.wordpress.com/2010/03/31032010-2.jpg"><img src="http://coding4ever.files.wordpress.com/2010/03/31032010-2.jpg?w=300" alt="" /></a></p>

<p>Gimana ? Menarik bukan ? :)</p>

<p>Oke langsung saja download sample ISSkin di<a href="http://isskin.codejock.com/downloads/ISSkinExample.zip">sini</a>, ekstrak file ISSkinExample.zip dan terakhir jalankan file ISSkin.exe</p>

<p>Apakah cukup seperti itu saja ? Tentu tidak, kita harus menambahkan beberapa baris kode pada skrip inno setup di bagian [Files] dan [Code].</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>[Files]
</span><span class='line'>; Add the ISSkin DLL used for skinning Inno Setup installations.
</span><span class='line'>Source: ISSkin.dll; DestDir: {app}; Flags: dontcopy&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;p>; Add the Visual Style resource contains resources used for skinning,
</span><span class='line'>; you can also use Microsoft Visual Styles (*.msstyles) resources.
</span><span class='line'>Source: Styles\Office2007.cjstyles; DestDir: {tmp}; Flags: dontcopy&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;p>; The following code block is used to load the ISS, pass in
</span><span class='line'>; NormalAqua.ini as the second parameter to LoadSkin to use
</span><span class='line'>; the Aqua color scheme instead of the default Blue color
</span><span class='line'>; scheme.
</span><span class='line'>[Code]
</span><span class='line'>// Importing LoadSkin API from ISSkin.DLL
</span><span class='line'>procedure LoadSkin(lpszPath: String; lpszIniFileName: String);
</span><span class='line'>external &lsquo;LoadSkin@files:isskin.dll stdcall&rsquo;;&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;p>// Importing UnloadSkin API from ISSkin.DLL
</span><span class='line'>procedure UnloadSkin();
</span><span class='line'>external &lsquo;UnloadSkin@files:isskin.dll stdcall&rsquo;;&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;p>// Importing ShowWindow Windows API from User32.DLL
</span><span class='line'>function ShowWindow(hWnd: Integer; uType: Integer): Integer;
</span><span class='line'>external &lsquo;&lt;a href="&#109;&#97;&#x69;&#108;&#116;&#x6f;&#58;&#83;&#x68;&#x6f;&#119;&#x57;&#105;&#x6e;&#x64;&#x6f;&#x77;&#x40;&#x75;&#x73;&#x65;&#114;&#51;&#x32;&#x2e;&#100;&#x6c;&#x6c;">&#83;&#104;&#111;&#x77;&#87;&#x69;&#x6e;&#100;&#111;&#119;&#64;&#x75;&#115;&#101;&#x72;&#51;&#50;&#x2e;&#100;&#x6c;&#108;&lt;/a> stdcall&rsquo;;&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;p>function InitializeSetup(): Boolean;
</span><span class='line'>begin
</span><span class='line'>    ExtractTemporaryFile(&lsquo;Office2007.cjstyles&rsquo;);
</span><span class='line'>    LoadSkin(ExpandConstant(&lsquo;{tmp}\Office2007.cjstyles&rsquo;), &lsquo;NormalAqua.ini&rsquo;);
</span><span class='line'>    Result := True;
</span><span class='line'>end;&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;p>procedure DeinitializeSetup();
</span><span class='line'>begin
</span><span class='line'>    // Hide Window before unloading skin so user does not get
</span><span class='line'>    // a glimse of an unskinned window before it is closed.
</span><span class='line'>    ShowWindow(StrToInt(ExpandConstant(&lsquo;{wizardhwnd}&rsquo;)), 0);
</span><span class='line'>    UnloadSkin();
</span><span class='line'>end;</span></code></pre></td></tr></table></div></figure></p>

<p>Berikut adalah beberapa variasi skin hasil dari ngoprek kode berikut :</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>LoadSkin(ExpandConstant(&lsquo;{tmp}\Office2007.cjstyles&rsquo;), &lsquo;NormalAqua.ini&rsquo;);</span></code></pre></td></tr></table></div></figure></p>

<p><a href="http://coding4ever.files.wordpress.com/2010/03/31032010-3.jpg"><img src="http://coding4ever.files.wordpress.com/2010/03/31032010-3.jpg?w=300" alt="" /></a></p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>LoadSkin(ExpandConstant(&lsquo;{tmp}\Office2007.cjstyles&rsquo;), &lsquo;NormalBlack.ini&rsquo;);</span></code></pre></td></tr></table></div></figure></p>

<p><a href="http://coding4ever.files.wordpress.com/2010/03/31032010-4.jpg"><img src="http://coding4ever.files.wordpress.com/2010/03/31032010-4.jpg?w=300" alt="" /></a></p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>LoadSkin(ExpandConstant(&lsquo;{tmp}\Vista.cjstyles&rsquo;), &lsquo;NormalSilver.ini&rsquo;);</span></code></pre></td></tr></table></div></figure></p>

<p><a href="http://coding4ever.files.wordpress.com/2010/03/31032010-5.jpg"><img src="http://coding4ever.files.wordpress.com/2010/03/31032010-5.jpg?w=300" alt="" /></a></p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>LoadSkin(ExpandConstant(&lsquo;{tmp}\Vista.cjstyles&rsquo;), &lsquo;&rsquo;);</span></code></pre></td></tr></table></div></figure></p>

<p>Selamat mencoba :)</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Membuat Paket Instalasi Vb + Mysql Dengan NSIS]]></title>
    <link href="http://coding4ever.net/blog/2010/01/16/membuat-paket-instalasi-vb-mysql-dengan-nsis/"/>
    <updated>2010-01-16T09:43:35+07:00</updated>
    <id>http://coding4ever.net/blog/2010/01/16/membuat-paket-instalasi-vb-mysql-dengan-nsis</id>
    <content type="html"><![CDATA[<p>Melengkapi tulisan saya <a href="/blog/2009/12/31/membuat-paket-instalasi-vb-mysql-dengan-inno-setup/">Membuat paket instalasi vb + mysql dengan inno setup</a> kali ini kita akan membuatnya menggunakan <a href="http://nsis.sourceforge.net">NSIS</a>. <a href="http://nsis.sourceforge.net"></a></p>

<p><a href="http://nsis.sourceforge.net">NSIS</a> adalah salah satu tool gratis dan open source untuk membuat paket instalasi. Oke sebelum kita melangkah lebih jauh, berikut adalah hal-hal yang perlu kita persiapkan :</p>

<ol>
<li><p> <a href="http://nsis.sourceforge.net">NSIS</a></p></li>
<li><p> <a href="http://dev.mysql.com/downloads/mysql/">MySQL versi noninstall</a> disesuaikan dengan versi MySQL yang terinstall di komputer Anda</p></li>
<li><p> <a href="http://dev.mysql.com/downloads/connector/odbc/">Connector ODBC</a> yang sudah terinstall biasanya ada di C:\Program Files\MySQL\Connector ODBC 5.1</p></li>
<li><p> Database yang sudah di backup/dump</p></li>
<li><p> Untuk editor, bagi Anda yang buta warna cukup pake notepad :D, saya sendiri menggunakan <a href="http://notepad-plus.sourceforge.net/uk/site.htm">notepad++</a> atau kalo pengen lebih nyaman bisa menggunakan <a href="http://www.eclipse.org/downloads/">eclipse</a> kemudian download <a href="http://nsis.sourceforge.net/EclipseNSIS_-_NSIS_plugin_for_Eclipse">plug-in NSIS</a></p></li>
</ol>


<!-- more -->


<p>Memang kalo dilihat dari segi skrip,  <a href="http://jrsoftware.org/">Inno Setup</a> lebih simple dibandingkan <a href="http://nsis.sourceforge.net/">NSIS</a> tetapi setelah saya bandingkan hasil paket instalasi NSIS lebih kecil dibandingkan Inno Setup.</p>

<p>Skrip Inno Setup dan NSIS sama-sama dikelompokkan dalam section-section bedanya kalo Inno Setup untuk nama sectionnya sudah fix (misal Setup, Tasks, Files de el el) sedangkan NSIS untuk nama sectionnya bebas dan tentunya dalam penamaan section di NSIS disesuaikan dengan isinya (misal Install MySQL 5).</p>

<p>Salah satu bagian penting dari skrip NSIS yang kita bahas disini adalah skrip yang digunakan untuk membuat <strong><em>service MySQL, mendaftarkan driver MySQL Connector ODBC dan melakukan proses undump skrip databse (.sql)</em></strong>.</p>

<p>Saya ambil contoh untuk membuat service MySQL tentunya dilihat dari versi windows yang terinstall kalo keluarga Win9x jelas tidak bisa karena belum mendukung pembuatan service, oleh karena itu sebelum menjalankan perintah membuat service akan dilakukan pengecekan versi windows terlebih dulu.</p>

<p>Nah disini akan terlihat jelas perbedaan skrip Inno Setup dan NSIS dimana untuk melakukan ini inno setup cukup menambahkan flag MinVersion, misal :</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>[Run]
</span><span class='line'>;mysqld &ndash;install MySQL
</span><span class='line'>Filename: &ldquo;{app}\mysql\bin\mysqld.exe&rdquo;; Parameters: &ldquo;install &rdquo;&ldquo;MySQL&rdquo;&ldquo;&rdquo;; StatusMsg: &ldquo;Sedang menginstall service MySQL &hellip;&rdquo;; Flags: runhidden; MinVersion: 0,5.01.2600sp2; Tasks: installmysql</span></code></pre></td></tr></table></div></figure></p>

<p>Sedangkan untuk NSIS kita perlu mendownload <a href="http://nsis.sourceforge.net/mediawiki/images/4/4e/NSIS_version_plugin_02.zip">Version plug-in</a> terlebih dulu dan mengekstraknya kemudiakan mengcopykan file version.dll ke folder instalasi NSIS\Plugins, walaupun sebenarnya kita bisa membuat fungsi sendiri di NSIS untuk mengecek versi windows yang terinstall.</p>

<p>Contoh skrip NSIS untuk mengecek versi windows dan menginstall service MySQL :</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>Section &ldquo;Install MySQL 5&rdquo;
</span><span class='line'>    Version::IsWindowsXP&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;pre>&lt;code>Pop $0 ;nilai var $0 akan bersisi 1 jika windows XP selain itu 0
</span><span class='line'>StrCmp $0 "1" ItIsWindowsXP ItIsNotWindowsXP ;StrCmp sama seperti fungsi IIF di VB
</span><span class='line'>
</span><span class='line'>ItIsWindowsXP:
</span><span class='line'>Goto installservice
</span><span class='line'>
</span><span class='line'>ItIsNotWindowsXP:
</span><span class='line'>Goto done
</span><span class='line'>
</span><span class='line'>installservice:
</span><span class='line'>    DetailPrint "Sedang menginstall service MySQL ..."
</span><span class='line'>    ExecWait '"$MYSQL_DIR\bin\mysqld.exe" install "MySQL"'
</span><span class='line'>
</span><span class='line'>done:
</span><span class='line'>    ;do nothing
</span><span class='line'>&lt;/code>&lt;/pre>
</span><span class='line'>
</span><span class='line'>&lt;p>SectionEnd</span></code></pre></td></tr></table></div></figure></p>

<p>Gimana lumayan beda kan? :)</p>

<p>Khusus untuk file-file Runtime VB memerlukan penanganan khusus dan untuk memudahkan Anda mencoba sample skrip ini download terlebih dahulu file Runtime VB di<a href="http://nsis.sourceforge.net/vb6runtime.zip">sini</a> dan jangan lupa diekstrak.</p>

<p>Persiapan terakhir untuk struktur folder saya buat seperti berikut :</p>

<p><a href="http://coding4ever.files.wordpress.com/2010/01/16012010-5.jpg"><img src="http://coding4ever.files.wordpress.com/2010/01/16012010-5.jpg?w=300" alt="" /></a></p>

<p>Dan saya tidak akan menjelaskan fungsi-fungsi/perintah yang digunakan dalam skrip NSIS karena sudah saya sisipkan komentar di sample skrip instalasi NSIS.</p>

<p>Jika masih kesulitan Anda bisa langsung membaca manual NSIS yang penjelasannya sudah sangat lengkap.</p>

<p>Berikut contoh skrip instalasi lengkap menggunakan NSIS :</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
<span class='line-number'>56</span>
<span class='line-number'>57</span>
<span class='line-number'>58</span>
<span class='line-number'>59</span>
<span class='line-number'>60</span>
<span class='line-number'>61</span>
<span class='line-number'>62</span>
<span class='line-number'>63</span>
<span class='line-number'>64</span>
<span class='line-number'>65</span>
<span class='line-number'>66</span>
<span class='line-number'>67</span>
<span class='line-number'>68</span>
<span class='line-number'>69</span>
<span class='line-number'>70</span>
<span class='line-number'>71</span>
<span class='line-number'>72</span>
<span class='line-number'>73</span>
<span class='line-number'>74</span>
<span class='line-number'>75</span>
<span class='line-number'>76</span>
<span class='line-number'>77</span>
<span class='line-number'>78</span>
<span class='line-number'>79</span>
<span class='line-number'>80</span>
<span class='line-number'>81</span>
<span class='line-number'>82</span>
<span class='line-number'>83</span>
<span class='line-number'>84</span>
<span class='line-number'>85</span>
<span class='line-number'>86</span>
<span class='line-number'>87</span>
<span class='line-number'>88</span>
<span class='line-number'>89</span>
<span class='line-number'>90</span>
<span class='line-number'>91</span>
<span class='line-number'>92</span>
<span class='line-number'>93</span>
<span class='line-number'>94</span>
<span class='line-number'>95</span>
<span class='line-number'>96</span>
<span class='line-number'>97</span>
<span class='line-number'>98</span>
<span class='line-number'>99</span>
<span class='line-number'>100</span>
<span class='line-number'>101</span>
<span class='line-number'>102</span>
<span class='line-number'>103</span>
<span class='line-number'>104</span>
<span class='line-number'>105</span>
<span class='line-number'>106</span>
<span class='line-number'>107</span>
<span class='line-number'>108</span>
<span class='line-number'>109</span>
<span class='line-number'>110</span>
<span class='line-number'>111</span>
<span class='line-number'>112</span>
<span class='line-number'>113</span>
<span class='line-number'>114</span>
<span class='line-number'>115</span>
<span class='line-number'>116</span>
<span class='line-number'>117</span>
<span class='line-number'>118</span>
<span class='line-number'>119</span>
<span class='line-number'>120</span>
<span class='line-number'>121</span>
<span class='line-number'>122</span>
<span class='line-number'>123</span>
<span class='line-number'>124</span>
<span class='line-number'>125</span>
<span class='line-number'>126</span>
<span class='line-number'>127</span>
<span class='line-number'>128</span>
<span class='line-number'>129</span>
<span class='line-number'>130</span>
<span class='line-number'>131</span>
<span class='line-number'>132</span>
<span class='line-number'>133</span>
<span class='line-number'>134</span>
<span class='line-number'>135</span>
<span class='line-number'>136</span>
<span class='line-number'>137</span>
<span class='line-number'>138</span>
<span class='line-number'>139</span>
<span class='line-number'>140</span>
<span class='line-number'>141</span>
<span class='line-number'>142</span>
<span class='line-number'>143</span>
<span class='line-number'>144</span>
<span class='line-number'>145</span>
<span class='line-number'>146</span>
<span class='line-number'>147</span>
<span class='line-number'>148</span>
<span class='line-number'>149</span>
<span class='line-number'>150</span>
<span class='line-number'>151</span>
<span class='line-number'>152</span>
<span class='line-number'>153</span>
<span class='line-number'>154</span>
<span class='line-number'>155</span>
<span class='line-number'>156</span>
<span class='line-number'>157</span>
<span class='line-number'>158</span>
<span class='line-number'>159</span>
<span class='line-number'>160</span>
<span class='line-number'>161</span>
<span class='line-number'>162</span>
<span class='line-number'>163</span>
<span class='line-number'>164</span>
<span class='line-number'>165</span>
<span class='line-number'>166</span>
<span class='line-number'>167</span>
<span class='line-number'>168</span>
<span class='line-number'>169</span>
<span class='line-number'>170</span>
<span class='line-number'>171</span>
<span class='line-number'>172</span>
<span class='line-number'>173</span>
<span class='line-number'>174</span>
<span class='line-number'>175</span>
<span class='line-number'>176</span>
<span class='line-number'>177</span>
<span class='line-number'>178</span>
<span class='line-number'>179</span>
<span class='line-number'>180</span>
<span class='line-number'>181</span>
<span class='line-number'>182</span>
<span class='line-number'>183</span>
<span class='line-number'>184</span>
<span class='line-number'>185</span>
<span class='line-number'>186</span>
<span class='line-number'>187</span>
<span class='line-number'>188</span>
<span class='line-number'>189</span>
<span class='line-number'>190</span>
<span class='line-number'>191</span>
<span class='line-number'>192</span>
<span class='line-number'>193</span>
<span class='line-number'>194</span>
<span class='line-number'>195</span>
<span class='line-number'>196</span>
<span class='line-number'>197</span>
<span class='line-number'>198</span>
<span class='line-number'>199</span>
<span class='line-number'>200</span>
<span class='line-number'>201</span>
<span class='line-number'>202</span>
<span class='line-number'>203</span>
<span class='line-number'>204</span>
<span class='line-number'>205</span>
<span class='line-number'>206</span>
<span class='line-number'>207</span>
<span class='line-number'>208</span>
<span class='line-number'>209</span>
<span class='line-number'>210</span>
<span class='line-number'>211</span>
<span class='line-number'>212</span>
<span class='line-number'>213</span>
<span class='line-number'>214</span>
<span class='line-number'>215</span>
<span class='line-number'>216</span>
<span class='line-number'>217</span>
<span class='line-number'>218</span>
<span class='line-number'>219</span>
<span class='line-number'>220</span>
<span class='line-number'>221</span>
<span class='line-number'>222</span>
<span class='line-number'>223</span>
<span class='line-number'>224</span>
<span class='line-number'>225</span>
<span class='line-number'>226</span>
<span class='line-number'>227</span>
<span class='line-number'>228</span>
<span class='line-number'>229</span>
<span class='line-number'>230</span>
<span class='line-number'>231</span>
<span class='line-number'>232</span>
<span class='line-number'>233</span>
<span class='line-number'>234</span>
<span class='line-number'>235</span>
<span class='line-number'>236</span>
<span class='line-number'>237</span>
<span class='line-number'>238</span>
<span class='line-number'>239</span>
<span class='line-number'>240</span>
<span class='line-number'>241</span>
<span class='line-number'>242</span>
<span class='line-number'>243</span>
<span class='line-number'>244</span>
<span class='line-number'>245</span>
<span class='line-number'>246</span>
<span class='line-number'>247</span>
<span class='line-number'>248</span>
<span class='line-number'>249</span>
<span class='line-number'>250</span>
<span class='line-number'>251</span>
<span class='line-number'>252</span>
<span class='line-number'>253</span>
<span class='line-number'>254</span>
<span class='line-number'>255</span>
<span class='line-number'>256</span>
<span class='line-number'>257</span>
<span class='line-number'>258</span>
<span class='line-number'>259</span>
<span class='line-number'>260</span>
<span class='line-number'>261</span>
<span class='line-number'>262</span>
<span class='line-number'>263</span>
<span class='line-number'>264</span>
<span class='line-number'>265</span>
<span class='line-number'>266</span>
<span class='line-number'>267</span>
<span class='line-number'>268</span>
<span class='line-number'>269</span>
<span class='line-number'>270</span>
<span class='line-number'>271</span>
<span class='line-number'>272</span>
<span class='line-number'>273</span>
<span class='line-number'>274</span>
<span class='line-number'>275</span>
<span class='line-number'>276</span>
<span class='line-number'>277</span>
<span class='line-number'>278</span>
<span class='line-number'>279</span>
<span class='line-number'>280</span>
<span class='line-number'>281</span>
<span class='line-number'>282</span>
<span class='line-number'>283</span>
<span class='line-number'>284</span>
<span class='line-number'>285</span>
<span class='line-number'>286</span>
<span class='line-number'>287</span>
<span class='line-number'>288</span>
<span class='line-number'>289</span>
<span class='line-number'>290</span>
<span class='line-number'>291</span>
<span class='line-number'>292</span>
<span class='line-number'>293</span>
<span class='line-number'>294</span>
<span class='line-number'>295</span>
<span class='line-number'>296</span>
<span class='line-number'>297</span>
<span class='line-number'>298</span>
<span class='line-number'>299</span>
<span class='line-number'>300</span>
<span class='line-number'>301</span>
<span class='line-number'>302</span>
<span class='line-number'>303</span>
<span class='line-number'>304</span>
<span class='line-number'>305</span>
<span class='line-number'>306</span>
<span class='line-number'>307</span>
<span class='line-number'>308</span>
<span class='line-number'>309</span>
<span class='line-number'>310</span>
<span class='line-number'>311</span>
<span class='line-number'>312</span>
<span class='line-number'>313</span>
<span class='line-number'>314</span>
<span class='line-number'>315</span>
<span class='line-number'>316</span>
<span class='line-number'>317</span>
<span class='line-number'>318</span>
<span class='line-number'>319</span>
<span class='line-number'>320</span>
<span class='line-number'>321</span>
<span class='line-number'>322</span>
<span class='line-number'>323</span>
<span class='line-number'>324</span>
<span class='line-number'>325</span>
<span class='line-number'>326</span>
<span class='line-number'>327</span>
<span class='line-number'>328</span>
<span class='line-number'>329</span>
<span class='line-number'>330</span>
<span class='line-number'>331</span>
<span class='line-number'>332</span>
<span class='line-number'>333</span>
<span class='line-number'>334</span>
<span class='line-number'>335</span>
<span class='line-number'>336</span>
<span class='line-number'>337</span>
<span class='line-number'>338</span>
<span class='line-number'>339</span>
<span class='line-number'>340</span>
<span class='line-number'>341</span>
<span class='line-number'>342</span>
<span class='line-number'>343</span>
<span class='line-number'>344</span>
<span class='line-number'>345</span>
<span class='line-number'>346</span>
<span class='line-number'>347</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>;Skrip instalasi by k4m4r82
</span><span class='line'>;&lt;a href="http://coding4ever.wordpress.com">http://coding4ever.wordpress.com&lt;/a>&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;p>!include VB6RunTime.nsh&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;p>;deklarasi konstanta
</span><span class='line'>;format pemanggilan ${NAMA_KONSTANTA}
</span><span class='line'>!define APP_NAME &ldquo;Sistem Pembelian Bahan Baku PT. ALBASI&rdquo;
</span><span class='line'>!define APP_PUBLISHER &ldquo;K4m4r82&rsquo;s Laboratory&rdquo;
</span><span class='line'>!define APP_VERSION &ldquo;2.0.50&rdquo;&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;p>BrandingText /TRIMCENTER &ldquo;&ndash; ${APP_PUBLISHER} &ndash;&rdquo;
</span><span class='line'>Name &ldquo;${APP_NAME} ${APP_VERSION}&rdquo;
</span><span class='line'>Caption &ldquo;${APP_NAME} ${APP_VERSION}&rdquo;&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;p>CompletedText &ldquo;Instalasi sudah selesai&rdquo;&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;p>Icon &ldquo;setup.ico&rdquo;
</span><span class='line'>LoadLanguageFile &ldquo;${NSISDIR}\Contrib\Language files\Indonesian.nlf&rdquo;
</span><span class='line'>OutFile &ldquo;output\DemoSetupNSIS.exe&rdquo;
</span><span class='line'>ShowInstDetails show
</span><span class='line'>ShowUninstDetails show
</span><span class='line'>WindowIcon on
</span><span class='line'>XPStyle on&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;p>;informasi default folder instalasi
</span><span class='line'>InstallDir &ldquo;$PROGRAMFILES\SPBB&rdquo;&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;p>;informasi folder instalasi disimpan disini
</span><span class='line'>;informasi ini akan memudahkan kita untuk membuat program update
</span><span class='line'>InstallDirRegKey HKCU &ldquo;Software\PT ALBASI\SPBB&rdquo; &ldquo;InstallDir&rdquo;&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;p>VIAddVersionKey /LANG=${LANG_INDONESIAN} &ldquo;ProductName&rdquo; &ldquo;${APP_NAME}&rdquo;
</span><span class='line'>VIAddVersionKey /LANG=${LANG_INDONESIAN} &ldquo;Comments&rdquo; &ldquo;&rdquo;
</span><span class='line'>VIAddVersionKey /LANG=${LANG_INDONESIAN} &ldquo;CompanyName&rdquo; &ldquo;${APP_PUBLISHER}&rdquo;
</span><span class='line'>VIAddVersionKey /LANG=${LANG_INDONESIAN} &ldquo;LegalTrademarks&rdquo; &ldquo;${APP_NAME} is a trademark of ${APP_PUBLISHER}&rdquo;
</span><span class='line'>VIAddVersionKey /LANG=${LANG_INDONESIAN} &ldquo;LegalCopyright&rdquo; &ldquo;Copyright © 2009. ${APP_PUBLISHER}&rdquo;
</span><span class='line'>VIAddVersionKey /LANG=${LANG_INDONESIAN} &ldquo;FileDescription&rdquo; &ldquo;${APP_NAME}&rdquo;
</span><span class='line'>VIAddVersionKey /LANG=${LANG_INDONESIAN} &ldquo;FileVersion&rdquo; &ldquo;2.0.0.50&rdquo;
</span><span class='line'>VIProductVersion &ldquo;2.0.0.50&rdquo;&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;p>RequestExecutionLevel admin&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;p>AddBrandingImage left 150|234
</span><span class='line'>Page custom BrandingImage
</span><span class='line'>Page components
</span><span class='line'>Page directory
</span><span class='line'>Page instfiles&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;p>UninstPage custom un.BrandingImage
</span><span class='line'>UninstPage uninstConfirm
</span><span class='line'>UninstPage instfiles&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;p>;deklarsi variabel
</span><span class='line'>;format pemanggilan $NAMA_VARIABEL ingat ada sedikit perbedaan dg konstanta
</span><span class='line'>Var MainDir
</span><span class='line'>Var MySQLDir
</span><span class='line'>Var AlreadyInstalled&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;p>;section yang diawali karakter -, pilihannya tidak ditampilkan
</span><span class='line'>Section &ldquo;-Inisialisasi Variabel&rdquo;
</span><span class='line'>    StrCpy $MainDir $INSTDIR
</span><span class='line'>    StrCpy $MySQLDir $MainDir\mysql
</span><span class='line'>SectionEnd&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;p>Section &ldquo;-Visual Basic Runtime&rdquo;
</span><span class='line'>    ;download file Visual Basic Runtime di: &lt;a href="http://nsis.sourceforge.net/vb6runtime.zip">http://nsis.sourceforge.net/vb6runtime.zip&lt;/a>
</span><span class='line'>    IfFileExists &ldquo;$MainDir\Albasi.exe&rdquo; 0 new_installation
</span><span class='line'>        StrCpy $AlreadyInstalled 1&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;pre>&lt;code>new_installation:
</span><span class='line'>    !insertmacro VB6RunTimeInstall "dll&amp;ocx\vb6runtime" $AlreadyInstalled
</span><span class='line'>&lt;/code>&lt;/pre>
</span><span class='line'>
</span><span class='line'>&lt;p>SectionEnd&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;p>Section &ldquo;-My Application Runtime&rdquo;
</span><span class='line'>    SetOutPath $MainDir
</span><span class='line'>        File &ldquo;main\Albasi.exe.manifest&rdquo;
</span><span class='line'>    File &ldquo;main\Albasi.exe&rdquo;&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;pre>&lt;code>SetOutPath $SYSDIR
</span><span class='line'>
</span><span class='line'>File "dll&amp;ocx\LVbuttons.OCX"
</span><span class='line'>RegDLL "$SYSDIR\LVbuttons.ocx"
</span><span class='line'>
</span><span class='line'>File "dll&amp;ocx\MSMASK32.OCX"
</span><span class='line'>RegDLL "$SYSDIR\MSMASK32.ocx"
</span><span class='line'>
</span><span class='line'>File "dll&amp;ocx\cTreeOpt6.ocx"
</span><span class='line'>RegDLL "$SYSDIR\cTreeOpt6.ocx"
</span><span class='line'>
</span><span class='line'>File "dll&amp;ocx\Comdlg32.ocx"
</span><span class='line'>RegDLL "$SYSDIR\Comdlg32.ocx"
</span><span class='line'>
</span><span class='line'>File "dll&amp;ocx\vbalDTab6.ocx"
</span><span class='line'>RegDLL "$SYSDIR\vbalDTab6.ocx"
</span><span class='line'>
</span><span class='line'>File "dll&amp;ocx\vbalExpBar6.ocx"
</span><span class='line'>RegDLL "$SYSDIR\vbalExpBar6.ocx"
</span><span class='line'>
</span><span class='line'>File "dll&amp;ocx\MSCOMCTL.OCX"
</span><span class='line'>RegDLL "$SYSDIR\MSCOMCTL.ocx"
</span><span class='line'>
</span><span class='line'>File "dll&amp;ocx\vbalIml6.ocx"
</span><span class='line'>RegDLL "$SYSDIR\vbalIml6.ocx"
</span><span class='line'>
</span><span class='line'>File "dll&amp;ocx\cPopMenu6.ocx"
</span><span class='line'>RegDLL "$SYSDIR\cPopMenu6.ocx"
</span><span class='line'>
</span><span class='line'>File "dll&amp;ocx\cNewMenu6.dll"
</span><span class='line'>RegDLL "$SYSDIR\cNewMenu6.DLL"
</span><span class='line'>
</span><span class='line'>File "dll&amp;ocx\scrrun.dll"
</span><span class='line'>RegDLL "$SYSDIR\scrrun.DLL"
</span><span class='line'>
</span><span class='line'>File "dll&amp;ocx\vbalMDITabs6.dll"
</span><span class='line'>RegDLL "$SYSDIR\vbalMDITabs6.DLL"
</span><span class='line'>
</span><span class='line'>File "dll&amp;ocx\SSubTmr6.dll"
</span><span class='line'>RegDLL "$SYSDIR\SSubTmr6.DLL"
</span><span class='line'>
</span><span class='line'>File "dll&amp;ocx\msado21.tlb"
</span><span class='line'>RegDLL "$SYSDIR\msado21.tlb"
</span><span class='line'>&lt;/code>&lt;/pre>
</span><span class='line'>
</span><span class='line'>&lt;p>SectionEnd&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;p>; param /e -> expand
</span><span class='line'>SectionGroup /e &ldquo;Komponen Server&rdquo;
</span><span class='line'>    Section &ldquo;Install MySQL 5&rdquo;
</span><span class='line'>        ; param /r -> recursive
</span><span class='line'>        SetOutPath $MySQLDir\bin
</span><span class='line'>        File /r &ldquo;mysql-5.1.36-win32\bin*.*&rdquo;&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;pre>&lt;code>    SetOutPath $MySQLDir\Docs
</span><span class='line'>    File /r "mysql-5.1.36-win32\Docs\*.*"
</span><span class='line'>
</span><span class='line'>    SetOutPath $MySQLDir\lib
</span><span class='line'>    File /r "mysql-5.1.36-win32\lib\*.*"
</span><span class='line'>
</span><span class='line'>    SetOutPath $MySQLDir\share
</span><span class='line'>    File /r "mysql-5.1.36-win32\share\*.*"
</span><span class='line'>
</span><span class='line'>    SetOutPath $MySQLDir\data
</span><span class='line'>    File /r "mysql-5.1.36-win32\data\*.*"
</span><span class='line'>
</span><span class='line'>    SetOutPath $MySQLDir
</span><span class='line'>    File "mysql-5.1.36-win32\*.*"
</span><span class='line'>
</span><span class='line'>    ;informasi lokasi instalasi mysql
</span><span class='line'>    WriteINIStr $MySQLDir\my.ini "mysqld" "basedir" $MySQLDir
</span><span class='line'>    WriteINIStr $MySQLDir\my.ini "mysqld" "datadir" $MySQLDir\data
</span><span class='line'>
</span><span class='line'>    ;proses membuat dan menjalankan service mysql, cek versi windows terlebih dulu
</span><span class='line'>    ;untuk contoh disini baru di tes untuk windows xp sp2
</span><span class='line'>    Version::IsWindowsXP
</span><span class='line'>
</span><span class='line'>    Pop $0 ;nilai var $0 akan bersisi 1 jika windows XP selain itu 0
</span><span class='line'>    StrCmp $0 "1" ItIsWindowsXP ItIsNotWindowsXP ;StrCmp sama seperti fungsi IIF di VB
</span><span class='line'>
</span><span class='line'>    ItIsWindowsXP:
</span><span class='line'>    Goto installservice
</span><span class='line'>
</span><span class='line'>    ItIsNotWindowsXP:
</span><span class='line'>    Goto done
</span><span class='line'>
</span><span class='line'>    installservice:
</span><span class='line'>        DetailPrint "Sedang menginstall service MySQL ..."
</span><span class='line'>        ExecWait '"$MySQLDir\bin\mysqld.exe" install "MySQL"'
</span><span class='line'>
</span><span class='line'>        ;jalankan service MySQL
</span><span class='line'>        DetailPrint "Sedang menjalankan service MySQL ..."
</span><span class='line'>        ExecWait '"$SYSDIR\net.exe" start "MySQL"'
</span><span class='line'>
</span><span class='line'>        ;mendaftarkan port default mysql (3306) ke firewall
</span><span class='line'>        DetailPrint "Sedang mendaftarkan port MySQL ..."
</span><span class='line'>        ExecWait '"$SYSDIR\netsh.exe" firewall add portopening TCP 3306 "Port MySQL"'
</span><span class='line'>
</span><span class='line'>        ;mengganti password default root (blank). ex : masterkey
</span><span class='line'>        DetailPrint "Mengganti password root"
</span><span class='line'>        ExecWait '"$MySQLDir\bin\mysqladmin.exe" -uroot password masterkey'
</span><span class='line'>
</span><span class='line'>        ;menghapus user default1 (user=blank, password=blank)
</span><span class='line'>        ExecWait '"$MySQLDir\bin\mysql.exe" -uroot -pmasterkey -e "DELETE FROM mysql.user WHERE Host=$\'localhost$\' AND User=$\'$\'"'
</span><span class='line'>        ExecWait '"$MySQLDir\bin\mysql.exe" -uroot -pmasterkey -e "FLUSH PRIVILEGES"'
</span><span class='line'>
</span><span class='line'>        ;menghapus user default2 (user=root, password=blank)
</span><span class='line'>        ExecWait '"$MySQLDir\bin\mysql.exe" -uroot -pmasterkey -e "DELETE FROM mysql.user WHERE Host=$\'127.0.0.1$\' AND User=$\'root$\'"'
</span><span class='line'>        ExecWait '"$MySQLDir\bin\mysql.exe" -uroot -pmasterkey -e "FLUSH PRIVILEGES"'
</span><span class='line'>
</span><span class='line'>        ;set agar user root bisa login dari mesin lain (kalo diperlukan)
</span><span class='line'>        ExecWait '"$MySQLDir\bin\mysql.exe" -uroot -pmasterkey -e "GRANT ALL PRIVILEGES ON *.* TO root@$\'%$\' IDENTIFIED BY $\'masterkey$\'"'
</span><span class='line'>        ExecWait '"$MySQLDir\bin\mysql.exe" -uroot -pmasterkey -e "FLUSH PRIVILEGES"'
</span><span class='line'>
</span><span class='line'>    done:
</span><span class='line'>        ;do nothing
</span><span class='line'>SectionEnd
</span><span class='line'>
</span><span class='line'>Section "Install MySQL Connector ODBC"
</span><span class='line'>    SetOutPath $SYSDIR
</span><span class='line'>
</span><span class='line'>    ;dll mysql odbc tidak perlu diregistrasikan
</span><span class='line'>    ;jadi otomatis tidak perlu memanggil fungsi RegDLL
</span><span class='line'>    File "C:\Program Files\MySQL\Connector ODBC 5.1\myodbc5.dll"
</span><span class='line'>    File "C:\Program Files\MySQL\Connector ODBC 5.1\myodbc5S.dll"
</span><span class='line'>    File "C:\Program Files\MySQL\Connector ODBC 5.1\myodbc5.lib"
</span><span class='line'>    File "C:\Program Files\MySQL\Connector ODBC 5.1\myodbc5S.lib"
</span><span class='line'>    File "C:\Program Files\MySQL\Connector ODBC 5.1\myodbc-installer.exe"
</span><span class='line'>
</span><span class='line'>    Version::IsWindowsXP
</span><span class='line'>
</span><span class='line'>    Pop $0
</span><span class='line'>    StrCmp $0 "1" ItIsWindowsXP ItIsNotWindowsXP
</span><span class='line'>
</span><span class='line'>    ItIsWindowsXP:
</span><span class='line'>    Goto installdriverodbc
</span><span class='line'>
</span><span class='line'>    ItIsNotWindowsXP:
</span><span class='line'>    Goto done
</span><span class='line'>
</span><span class='line'>    installdriverodbc:
</span><span class='line'>        ;install driver myodbc
</span><span class='line'>        DetailPrint "Tunggu sedang mendaftarkan driver MySQL Connector ODBC 5.1.5"
</span><span class='line'>        ExecWait '"$SYSDIR\myodbc-installer.exe" -d -a -n "MySQL ODBC 5.1 Driver" -t "DRIVER=myodbc5.dll;SETUP=myodbc5S.dll"'
</span><span class='line'>
</span><span class='line'>    done:
</span><span class='line'>        ;do nothing
</span><span class='line'>SectionEnd
</span><span class='line'>
</span><span class='line'>Section "Install Database"
</span><span class='line'>    SetOutPath $MySQLDir\bin
</span><span class='line'>
</span><span class='line'>    File "main\albasi.sql"
</span><span class='line'>    File "main\exec.cmd"
</span><span class='line'>
</span><span class='line'>    Version::IsWindowsXP
</span><span class='line'>
</span><span class='line'>    Pop $0
</span><span class='line'>    StrCmp $0 "1" ItIsWindowsXP ItIsNotWindowsXP
</span><span class='line'>
</span><span class='line'>    ItIsWindowsXP:
</span><span class='line'>    Goto installdatabase
</span><span class='line'>
</span><span class='line'>    ItIsNotWindowsXP:
</span><span class='line'>    Goto done
</span><span class='line'>
</span><span class='line'>    installdatabase:
</span><span class='line'>        ;membuat database kosong
</span><span class='line'>        ExecWait '"$MySQLDir\bin\mysql.exe" -uroot -pmasterkey -e "CREATE DATABASE albasi"'
</span><span class='line'>
</span><span class='line'>        ;menjalankan file batch exec.cmd untuk melakukan proses undump
</span><span class='line'>        ExecWait '"$MySQLDir\bin\exec.cmd"'
</span><span class='line'>
</span><span class='line'>    done:
</span><span class='line'>        ;do nothing
</span><span class='line'>SectionEnd
</span><span class='line'>&lt;/code>&lt;/pre>
</span><span class='line'>
</span><span class='line'>&lt;p>SectionGroupEnd&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;p>SectionGroup /e &ldquo;Buat Shortcut&rdquo;
</span><span class='line'>    Section &ldquo;Start Programs&rdquo;
</span><span class='line'>        SectionIn RO ;RO -> Read Only&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;pre>&lt;code>    CreateDirectory "$SMPROGRAMS\PT. ALBASI"
</span><span class='line'>    CreateShortCut "$SMPROGRAMS\PT. ALBASI\${APP_NAME}.lnk" "$MainDir\Albasi.exe" "" "$MainDir\Albasi.exe" 0
</span><span class='line'>SectionEnd
</span><span class='line'>
</span><span class='line'>Section "Desktop"
</span><span class='line'>    ;CreateDirectory "$DESKTOP\SPBB"
</span><span class='line'>    CreateShortCut "$DESKTOP\${APP_NAME}.lnk" "$MainDir\Albasi.exe" "" "$MainDir\Albasi.exe" 0
</span><span class='line'>SectionEnd
</span><span class='line'>
</span><span class='line'>Section "Quick Launch"
</span><span class='line'>    ;CreateDirectory "$QUICKLAUNCH\SPBB"
</span><span class='line'>    CreateShortCut "$QUICKLAUNCH\${APP_NAME}.lnk" "$MainDir\Albasi.exe" "" "$MainDir\Albasi.exe" 0
</span><span class='line'>SectionEnd
</span><span class='line'>&lt;/code>&lt;/pre>
</span><span class='line'>
</span><span class='line'>&lt;p>SectionGroupEnd&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;p>Section &ldquo;-Registry Windows&rdquo;
</span><span class='line'>    ;informasi uninstall
</span><span class='line'>    WriteRegStr HKLM &ldquo;Software\Microsoft\Windows\CurrentVersion\Uninstall\SPBB&rdquo; &ldquo;DisplayName&rdquo; &ldquo;${APP_NAME}&rdquo;
</span><span class='line'>    WriteRegStr HKLM &ldquo;Software\Microsoft\Windows\CurrentVersion\Uninstall\SPBB&rdquo; &ldquo;UninstallString&rdquo; &lsquo;&ldquo;$MainDir\uninstaller.exe&rdquo;&rsquo;
</span><span class='line'>    WriteRegStr HKLM &ldquo;Software\Microsoft\Windows\CurrentVersion\Uninstall\SPBB&rdquo; &ldquo;DisplayIcon&rdquo; &lsquo;&ldquo;$MainDir\uninstaller.exe&rdquo;&rsquo;&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;pre>&lt;code>WriteRegDWORD HKLM "Software\Microsoft\Windows\CurrentVersion\Uninstall\SPBB" "NoModify" 1
</span><span class='line'>WriteRegDWORD HKLM "Software\Microsoft\Windows\CurrentVersion\Uninstall\SPBB" "NoRepair" 1
</span><span class='line'>
</span><span class='line'>WriteUninstaller $MainDir\uninstaller.exe
</span><span class='line'>&lt;/code>&lt;/pre>
</span><span class='line'>
</span><span class='line'>&lt;p>SectionEnd&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;p>Section &ldquo;-File Konfigurasi Program&rdquo;
</span><span class='line'>    WriteINIStr $MainDir\infoprogram.ini &ldquo;Sistem&rdquo; &ldquo;serverName&rdquo; &ldquo;127.0.0.1&rdquo;
</span><span class='line'>    WriteINIStr $MainDir\infoprogram.ini &ldquo;Sistem&rdquo; &ldquo;dbName&rdquo; &ldquo;albasi&rdquo;
</span><span class='line'>SectionEnd&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;p>Section &ldquo;Uninstall&rdquo;
</span><span class='line'>    ;stop service MySQL
</span><span class='line'>    DetailPrint &ldquo;Menghentikan Service MySQL &hellip;&rdquo;
</span><span class='line'>    ExecWait &lsquo;&ldquo;$SYSDIR\net.exe&rdquo; stop &ldquo;MySQL&rdquo;&rsquo;&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;pre>&lt;code>;hapus service MySQL
</span><span class='line'>DetailPrint "Sedang menghapus service MySQL ..."
</span><span class='line'>ExecWait '"$MySQLDir\bin\mysqld.exe" remove "MySQL"'
</span><span class='line'>
</span><span class='line'>;driver MySQL Connector ODBC 5.1
</span><span class='line'>DetailPrint "Tunggu sedang menghapus driver MySQL Connector ODBC 5.1"
</span><span class='line'>ExecWait '"$SYSDIR\myodbc-installer.exe" -d -r -n "MySQL ODBC 5.1 Driver"'
</span><span class='line'>
</span><span class='line'>; Remove registry keys
</span><span class='line'>DeleteRegKey HKLM "Software\Microsoft\Windows\CurrentVersion\Uninstall\SPBB"
</span><span class='line'>
</span><span class='line'>; Remove files and uninstaller
</span><span class='line'>Delete $MainDir\*.*
</span><span class='line'>RMDir $MainDir
</span><span class='line'>
</span><span class='line'>; Remove shortcuts
</span><span class='line'>Delete "$SMPROGRAMS\PT. ALBASI\*.*"
</span><span class='line'>RMDir "$SMPROGRAMS\PT. ALBASI"
</span><span class='line'>
</span><span class='line'>Delete "$DESKTOP\${APP_NAME}.lnk"
</span><span class='line'>Delete "$QUICKLAUNCH\${APP_NAME}.lnk"
</span><span class='line'>&lt;/code>&lt;/pre>
</span><span class='line'>
</span><span class='line'>&lt;p>SectionEnd&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;p>;fungsi untuk menampilkan gambar/banner pada saat instalasi
</span><span class='line'>;untuk contoh disini posisi gambar di sebelah kiri
</span><span class='line'>Function BrandingImage
</span><span class='line'>    SetOutPath &ldquo;$TEMP&rdquo;&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;pre>&lt;code>SetFileAttributes SetupModern21.bmp temporary
</span><span class='line'>File SetupModern21.bmp
</span><span class='line'>SetBrandingImage "$TEMP\SetupModern21.bmp" /resizetofit
</span><span class='line'>&lt;/code>&lt;/pre>
</span><span class='line'>
</span><span class='line'>&lt;p>FunctionEnd&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;p>;fungsi untuk menampilkan gambar/banner pada saat uninstall
</span><span class='line'>Function un.BrandingImage
</span><span class='line'>    SetBrandingImage &ldquo;$TEMP\SetupModern21.bmp&rdquo; /resizetofit
</span><span class='line'>FunctionEnd</span></code></pre></td></tr></table></div></figure></p>

<p>Di dalam skrip instalasi ada file exec.cmd, isinya adalah :</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>mysql -uroot -pmasterkey albasi &lt; albasi.sql</span></code></pre></td></tr></table></div></figure></p>

<p>Isi file exec.cmd sebenarnya untuk proses undump dan ternyata Inno Setup dan NSIS gagal menjalankan perintah tersebut, padahal perintah-perintah yang lainnya sukses.</p>

<p>Contoh hasil instalasi :</p>

<p><a href="http://coding4ever.files.wordpress.com/2010/01/16012010-1.jpg"><img src="http://coding4ever.files.wordpress.com/2010/01/16012010-1.jpg?w=299" alt="" /></a></p>

<p>Gambar 1</p>

<p><a href="http://coding4ever.files.wordpress.com/2010/01/16012010-22.jpg"><img src="http://coding4ever.files.wordpress.com/2010/01/16012010-22.jpg?w=299" alt="" /></a></p>

<p>Gambar 2</p>

<p><a href="http://coding4ever.files.wordpress.com/2010/01/16012010-3.jpg"><img src="http://coding4ever.files.wordpress.com/2010/01/16012010-3.jpg?w=299" alt="" /></a></p>

<p>Gambar 3</p>

<p><a href="http://coding4ever.files.wordpress.com/2010/01/16012010-4.jpg"><img src="http://coding4ever.files.wordpress.com/2010/01/16012010-4.jpg?w=299" alt="" /></a></p>

<p>Gambar 4</p>

<p>Selamat mencoba :)</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Membuat Paket Instalasi Vb + Firebird Dengan Inno Setup]]></title>
    <link href="http://coding4ever.net/blog/2010/01/05/membuat-paket-instalasi-vb-firebird-dengan-inno-setup/"/>
    <updated>2010-01-05T13:16:54+07:00</updated>
    <id>http://coding4ever.net/blog/2010/01/05/membuat-paket-instalasi-vb-firebird-dengan-inno-setup</id>
    <content type="html"><![CDATA[<p>Menyambung postingan saya sebelumnya <a href="/blog/2009/12/31/membuat-paket-instalasi-vb-mysql-dengan-inno-setup/">Membuat paket instalasi vb + mysql dengan inno setup</a> kali ini database yang kita paketkan adalah <a href="http://firebirdsql.org/">Firebird</a>. Adapun hal-hal yang perlu dipersiapkan :</p>

<ol>
<li><p> File <a href="http://sourceforge.net/projects/firebird/files/firebird-win32/2.1.3-Release/Firebird-2.1.3.18185_0_Win32.exe/download?use_mirror=autoselect">Setup Firebird</a> (saat postingan ini dibuat versi Firebird-2.1.3.18185_0_Win32)</p></li>
<li><p> File OdbcFb32.dll hasil dari instalasi <a href="http://firebirdsql.org/download/prerelease/odbc/Firebird_ODBC_2.0.0.148_win32.exe">Firebird ODBC</a> yang ada di c:\windows\system32</p></li>
<li><p> <a href="http://jrsoftware.org/">Inno Setup</a></p></li>
</ol>


<!-- more -->


<p>Karena semua persiapan sudah oke, berikut skrip instalasinya :</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
<span class='line-number'>56</span>
<span class='line-number'>57</span>
<span class='line-number'>58</span>
<span class='line-number'>59</span>
<span class='line-number'>60</span>
<span class='line-number'>61</span>
<span class='line-number'>62</span>
<span class='line-number'>63</span>
<span class='line-number'>64</span>
<span class='line-number'>65</span>
<span class='line-number'>66</span>
<span class='line-number'>67</span>
<span class='line-number'>68</span>
<span class='line-number'>69</span>
<span class='line-number'>70</span>
<span class='line-number'>71</span>
<span class='line-number'>72</span>
<span class='line-number'>73</span>
<span class='line-number'>74</span>
<span class='line-number'>75</span>
<span class='line-number'>76</span>
<span class='line-number'>77</span>
<span class='line-number'>78</span>
<span class='line-number'>79</span>
<span class='line-number'>80</span>
<span class='line-number'>81</span>
<span class='line-number'>82</span>
<span class='line-number'>83</span>
<span class='line-number'>84</span>
<span class='line-number'>85</span>
<span class='line-number'>86</span>
<span class='line-number'>87</span>
<span class='line-number'>88</span>
<span class='line-number'>89</span>
<span class='line-number'>90</span>
<span class='line-number'>91</span>
<span class='line-number'>92</span>
<span class='line-number'>93</span>
<span class='line-number'>94</span>
<span class='line-number'>95</span>
<span class='line-number'>96</span>
<span class='line-number'>97</span>
<span class='line-number'>98</span>
<span class='line-number'>99</span>
<span class='line-number'>100</span>
<span class='line-number'>101</span>
<span class='line-number'>102</span>
<span class='line-number'>103</span>
<span class='line-number'>104</span>
<span class='line-number'>105</span>
<span class='line-number'>106</span>
<span class='line-number'>107</span>
<span class='line-number'>108</span>
<span class='line-number'>109</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>;Skrip instalasi by k4m4r82
</span><span class='line'>;&lt;a href="http://coding4ever.wordpress.com">http://coding4ever.wordpress.com&lt;/a>&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;p>[Setup]
</span><span class='line'>AppName=Retail Manager Pro
</span><span class='line'>AppVerName=Retail Manager Pro Versi 1.0.0.50
</span><span class='line'>AppPublisher=K4m4r82&rsquo;s Laboratory
</span><span class='line'>AllowCancelDuringInstall = yes
</span><span class='line'>DefaultDirName={pf}\RetailManagerPro
</span><span class='line'>DefaultGroupName=Retail Manager Pro
</span><span class='line'>Compression = lzma
</span><span class='line'>SolidCompression = yes
</span><span class='line'>OutputBaseFilename=SetupRetailManagerPro
</span><span class='line'>AllowNoIcons = yes
</span><span class='line'>AlwaysRestart = no
</span><span class='line'>AlwaysShowComponentsList = no
</span><span class='line'>DisableProgramGroupPage = yes
</span><span class='line'>AppendDefaultDirName = yes
</span><span class='line'>CreateUninstallRegKey = yes
</span><span class='line'>DisableStartupPrompt = yes
</span><span class='line'>LanguageDetectionMethod=none
</span><span class='line'>ShowLanguageDialog=no
</span><span class='line'>Uninstallable = yes
</span><span class='line'>UninstallFilesDir={app}\uninst
</span><span class='line'>UninstallDisplayIcon={app}\RetailManager.exe,0
</span><span class='line'>UninstallDisplayName=Retail Manager Pro
</span><span class='line'>WindowVisible = no
</span><span class='line'>AppCopyright=Copyright © 2009 K4m4r82&rsquo;s Laboratory
</span><span class='line'>FlatComponentsList = yes
</span><span class='line'>PrivilegesRequired = admin
</span><span class='line'>VersionInfoVersion=1.0.0.50
</span><span class='line'>SetupIconFile=Setup.ico
</span><span class='line'>WizardImageFile=SetupModern21.bmp
</span><span class='line'>WizardSmallImageFile=SetupModernSmall21.bmp&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;p>[Languages]
</span><span class='line'>Name: ina; MessagesFile: compiler:Indonesia.isl
</span><span class='line'>Name: en; MessagesFile: compiler:Default.isl&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;p>[Tasks]
</span><span class='line'>Name: desktopicon; Description: {cm:CreateDesktopIcon}; GroupDescription: {cm:AdditionalIcons}; Flags: unchecked
</span><span class='line'>Name: quicklaunchicon; Description: {cm:CreateQuickLaunchIcon}; GroupDescription: {cm:AdditionalIcons}; Flags: unchecked&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;p>[Files]
</span><span class='line'>;Visual Basic Runtime
</span><span class='line'>Source: dll&amp;ocx\VB6STKIT.DLL; DestDir: {sys}; Flags: uninsneveruninstall onlyifdoesntexist
</span><span class='line'>Source: dll&amp;ocx\COMCAT.DLL; DestDir: {sys}; Flags: uninsneveruninstall sharedfile regserver onlyifdoesntexist
</span><span class='line'>Source: dll&amp;ocx\stdole2.tlb; DestDir: {sys}; Flags: uninsneveruninstall sharedfile regtypelib
</span><span class='line'>Source: dll&amp;ocx\asycfilt.dll; DestDir: {sys}; Flags: uninsneveruninstall onlyifdoesntexist
</span><span class='line'>Source: dll&amp;ocx\olepro32.dll; DestDir: {sys}; Flags: uninsneveruninstall sharedfile regserver onlyifdoesntexist
</span><span class='line'>Source: dll&amp;ocx\oleaut32.dll; DestDir: {sys}; Flags: uninsneveruninstall sharedfile regserver onlyifdoesntexist
</span><span class='line'>Source: dll&amp;ocx\msvbvm60.dll; DestDir: {sys}; Flags: uninsneveruninstall sharedfile regserver onlyifdoesntexist&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;p>;file hasil instalasi firebird odbc
</span><span class='line'>Source: C:\WINDOWS\system32\OdbcFb32.dll; DestDir: {sys}; Flags: restartreplace sharedfile regserver onlyifdoesntexist&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;p>;file installer database firebird sesuaikan dengan versi yang Anda download
</span><span class='line'>Source: main\Firebird-2.1.3.18185_0_Win32.exe; DestDir: &ldquo;{tmp}&rdquo;; Flags: deleteafterinstall&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;p>;My Application Runtime
</span><span class='line'>Source: main\RetailManager.exe; DestDir: {app}; Flags: ignoreversion
</span><span class='line'>Source: main\RetailManager.pdf; DestDir: {app}; Flags: ignoreversion
</span><span class='line'>Source: main\RETAIL_MANAGER.FDB; DestDir: {app}\Db; Flags: onlyifdoesntexist
</span><span class='line'>Source: main\RetailManager.exe.manifest; DestDir: {app}; Flags: ignoreversion&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;p>Source: dll&amp;ocx\cTreeOpt6.ocx; DestDir: {sys}; Flags: uninsneveruninstall sharedfile regserver onlyifdoesntexist
</span><span class='line'>Source: dll&amp;ocx\vbalDTab6.ocx; DestDir: {sys}; Flags: uninsneveruninstall sharedfile regserver onlyifdoesntexist
</span><span class='line'>Source: dll&amp;ocx\vbalExpBar6.ocx; DestDir: {sys}; Flags: uninsneveruninstall sharedfile regserver onlyifdoesntexist
</span><span class='line'>Source: dll&amp;ocx\mscomctl.ocx; DestDir: {sys}; Flags: uninsneveruninstall sharedfile regserver onlyifdoesntexist
</span><span class='line'>Source: dll&amp;ocx\vbalIml6.ocx; DestDir: {sys}; Flags: uninsneveruninstall sharedfile regserver onlyifdoesntexist
</span><span class='line'>Source: dll&amp;ocx\cPopMenu6.ocx; DestDir: {sys}; Flags: uninsneveruninstall sharedfile regserver onlyifdoesntexist
</span><span class='line'>Source: dll&amp;ocx\LVbuttons.ocx; DestDir: {sys}; Flags: uninsneveruninstall sharedfile regserver onlyifdoesntexist
</span><span class='line'>Source: dll&amp;ocx\MyTextBox.ocx; DestDir: {sys}; Flags: uninsneveruninstall sharedfile regserver onlyifdoesntexist
</span><span class='line'>Source: dll&amp;ocx\MSCOMCT2.OCX; DestDir: {sys}; Flags: uninsneveruninstall sharedfile regserver onlyifdoesntexist
</span><span class='line'>Source: dll&amp;ocx\vbalMDITabs6.dll; DestDir: {sys}; Flags: uninsneveruninstall sharedfile regserver onlyifdoesntexist
</span><span class='line'>Source: dll&amp;ocx\SSubTmr6.dll; DestDir: {sys}; Flags: uninsneveruninstall sharedfile regserver onlyifdoesntexist
</span><span class='line'>Source: dll&amp;ocx\scrrun.dll; DestDir: {sys}; Flags: uninsneveruninstall sharedfile regserver onlyifdoesntexist
</span><span class='line'>Source: dll&amp;ocx\cNewMenu6.dll; DestDir: {sys}; Flags: uninsneveruninstall sharedfile regserver onlyifdoesntexist
</span><span class='line'>Source: dll&amp;ocx\msado21.tlb; DestDir: {sys}; Flags: uninsneveruninstall sharedfile regtypelib&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;p>[Icons]
</span><span class='line'>Name: {group}\Retail Manager Pro; Filename: {app}\RetailManager.exe; WorkingDir: {app}
</span><span class='line'>Name: {group}\Retail Manager Pro User Manual; Filename: {app}\RetailManager.pdf; WorkingDir: {app}&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;p>Name: {userdesktop}\Retail Manager Pro; Filename: {app}\RetailManager.exe; WorkingDir: {app}; Tasks: desktopicon
</span><span class='line'>Name: {userappdata}\Microsoft\Internet Explorer\Quick Launch\Retail Manager Pro; Filename: {app}\RetailManager.exe; WorkingDir: {app}; Tasks: quicklaunchicon&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;p>[Registry]
</span><span class='line'>;mencatat lokasi instalasi program, ini dibutuhkan jika kita ingin membuat paket instalasi update
</span><span class='line'>Root: HKCU; Subkey: &ldquo;Software\K4m4r82`s Laboratory\RetailManager&rdquo;; ValueName: &ldquo;installDir&rdquo;; ValueType: String; ValueData: {app}; Flags: uninsdeletevalue&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;p>[INI]
</span><span class='line'>Filename: &ldquo;{app}\infoProgram.ini&rdquo;; Section: &ldquo;Sistem&rdquo;; Key: &ldquo;serverName&rdquo;; String: &ldquo;127.0.0.1&rdquo;
</span><span class='line'>Filename: &ldquo;{app}\infoProgram.ini&rdquo;; Section: &ldquo;Sistem&rdquo;; Key: &ldquo;dbPath&rdquo;; String: &ldquo;{app}\Db&rdquo;&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;p>[Run]
</span><span class='line'>;install firebird
</span><span class='line'>Filename: &ldquo;{tmp}\Firebird-2.1.3.18185_0_Win32.exe&rdquo;; Parameters: &ldquo;/SP- /NORESTART /NOCPL /NOICONS /SILENT /FORCE /COMPONENTS=&rdquo;&ldquo;servercomponent\superservercomponent, SuperServerComponent, ServerComponent, ClientComponent, DevAdminComponent&rdquo;&ldquo;&rdquo;; StatusMsg: &ldquo;Instalasi Firebird 2.0 Server&hellip;&rdquo;&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;p>;daftarkan port firebird (3050) ke windows firewall
</span><span class='line'>Filename: &ldquo;{sys}\netsh.exe&rdquo;; Parameters: &ldquo;firewall add portopening TCP 3050 &rdquo;&ldquo;Service Firebird Server&rdquo;&ldquo;&rdquo;; StatusMsg: &ldquo;Mendaftarkan port Service Firebird &hellip;&rdquo;; Flags: runhidden; MinVersion: 0,5.01.2600sp2
</span><span class='line'>Filename: &ldquo;{sys}\netsh.exe&rdquo;; Parameters: &ldquo;firewall add allowedprogram &rdquo;&ldquo;{pf}\Firebird\Firebird_2_0\bin\fbserver.exe&rdquo;&ldquo; &rdquo;&ldquo;Firebird Server&rdquo;&ldquo; ENABLE ALL&rdquo;; StatusMsg: &ldquo;Mendaftarkan Firebird Server &hellip;&rdquo;; Flags: runhidden; MinVersion: 0,5.01.2600sp2&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;p>;menjalankan service firebird
</span><span class='line'>Filename: &ldquo;{pf}\Firebird\Firebird_2_0\bin\fbserver.exe&rdquo;; Parameters: &ldquo;-a&rdquo;; StatusMsg: &ldquo;Menjalankan service firebird&rdquo;; Flags: waituntilidle&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;p>[UninstallRun]
</span><span class='line'>Filename: &ldquo;{sys}\netsh.exe&rdquo;; Parameters: &ldquo;firewall delete portopening protocol = TCP port = 3050&rdquo;; Flags: runhidden; MinVersion: 0,5.01.2600sp2
</span><span class='line'>Filename: &ldquo;{sys}\netsh.exe&rdquo;; Parameters: &ldquo;firewall delete allowedprogram &rdquo;&ldquo;{pf}\Firebird\Firebird_2_0\bin\fbserver.exe&rdquo;&ldquo;&rdquo;; Flags: runhidden; MinVersion: 0,5.01.2600sp2</span></code></pre></td></tr></table></div></figure></p>

<p>Selamat mencoba :)</p>
]]></content>
  </entry>
  
</feed>
