<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Category: Tools Installer | Coding4ever's Blog]]></title>
  <link href="http://coding4ever.net/blog/categories/tools-installer/atom.xml" rel="self"/>
  <link href="http://coding4ever.net/"/>
  <updated>2015-10-20T09:48:09+07:00</updated>
  <id>http://coding4ever.net/</id>
  <author>
    <name><![CDATA[Admin]]></name>
    
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[Menambahkan Form Input Pada Saat Instalasi (Inno Setup)]]></title>
    <link href="http://coding4ever.net/blog/2010/12/12/menambahkan-form-input-pada-saat-instalasi-inno-setup/"/>
    <updated>2010-12-12T00:01:03+07:00</updated>
    <id>http://coding4ever.net/blog/2010/12/12/menambahkan-form-input-pada-saat-instalasi-inno-setup</id>
    <content type="html"><![CDATA[<p>Adakalanya kita ingin menyederhanan proses konfigurasi aplikasi, sehingga sebagian konfigurasi kita pindah pada saat instalasi.</p>

<p>Misal kita akan menambahkan input profil klien seperti nama, telepon, alamat dan kota.</p>

<p><a href="http://coding4ever.files.wordpress.com/2010/12/12122010-3.jpg"><img src="http://coding4ever.files.wordpress.com/2010/12/12122010-3.jpg?w=300" alt="" /></a></p>

<p>Jadi dengan menggunakan <a href="http://jrsoftware.org/">Inno Setup</a> kita bisa dengan mudah melakukan hal ini, dan untuk lokasi penyimpanannya sendiri ada 2 pilihan yaitu disimpan dalam format file <a href="{{%20site.url%20}}/blog/2010/04/23/contoh-sederhana-memanipulasi-ini-file-untuk-menyimpan-informasi/">INI</a> atau langsung ke registry windows.</p>

<!-- more -->


<p>Kita akan bahas satu-satu kodenya dan pada artikel ini saya tidak membahas skrip lengkap <a href="http://jrsoftware.org/">Inno Setup</a>nya karna sudah saya bahas pada artikel yang <a href="http://coding4ever.wordpress.com/category/tools-installer/">lain</a>nya, jadi fokus kita kali ini hanya di section <strong>[Code]</strong>.</p>

<p>Berikut kodenya untuk menambahkan form input dan menyimpannya ke file dengan format <a href="{{%20site.url%20}}/blog/2010/04/23/contoh-sederhana-memanipulasi-ini-file-untuk-menyimpan-informasi/">INI</a>.</p>

<p>{% codeblock %}
[Code]
var
   INIInputPage: TInputQueryWizardPage;</p>

<p>procedure InitializeWizard();
begin
  // Form Input
  INIInputPage := CreateInputQueryPage(wpInfoAfter, &lsquo;Konfigurasi&rsquo;, &lsquo;Konfigurasi Program.&rsquo;,
                                       &lsquo;Isikan konfigurasi program ke dalam form di bawah ini.&rsquo;);</p>

<p>  INIInputPage.Add(&lsquo;Nama&rsquo;, False);
  INIInputPage.Add(&lsquo;Telepon&rsquo;, False);
  INIInputPage.Add(&lsquo;Alamat&rsquo;, False);
  INIInputPage.Add(&lsquo;Kota&rsquo;, False);</p>

<p>  INIInputPage.Values[0] := GetPreviousData(&lsquo;Nama&rsquo;, &lsquo;&rsquo;);
  INIInputPage.Values[1] := GetPreviousData(&lsquo;Telepon&rsquo;, &lsquo;&rsquo;);
  INIInputPage.Values[2] := GetPreviousData(&lsquo;Alamat&rsquo;, &lsquo;&rsquo;);
  INIInputPage.Values[3] := GetPreviousData(&lsquo;Kota&rsquo;, &lsquo;&rsquo;);
end;</p>

<p>// prosedur ketika user mengklik tombol kembali, setelah pengisian form
procedure RegisterPreviousData(PreviousDataKey: Integer);
begin
  // tampilkan nilai sebelumnya yang sudah diinputkan user
  SetPreviousData(PreviousDataKey, &lsquo;Nama&rsquo;, INIInputPage.Values[0]);
  SetPreviousData(PreviousDataKey, &lsquo;Telepon&rsquo;, INIInputPage.Values[1]);
  SetPreviousData(PreviousDataKey, &lsquo;Alamat&rsquo;, INIInputPage.Values[2]);
  SetPreviousData(PreviousDataKey, &lsquo;Kota&rsquo;, INIInputPage.Values[3]);
end;</p>

<p>// prosedur ketika user mengklik tombol lanjut, setelah pengisian form
function NextButtonClick(CurPageID: Integer): Boolean;
begin
  Result := True;
  if CurPageID = INIInputPage.ID then begin
    // validasi input, untuk contoh disini saya validasi semua inputan harus diisi
    if (Trim(INIInputPage.Values[0]) = &lsquo;&rsquo;) or (Trim(INIInputPage.Values[1]) = &lsquo;&rsquo;) or
       (Trim(INIInputPage.Values[2]) = &lsquo;&rsquo;) or (Trim(INIInputPage.Values[3]) = &lsquo;&rsquo;) then begin
       MsgBox(&lsquo;Anda harus mengisikan data secara lengkap!&rsquo;, mbError, MB_OK);
       Result := False;</p>

<pre><code>end else begin
  // jika semua input form oke, tulis ke file dengan format INI
  // otomatis akan disimpan di folder instalasi dengan nama konfig.ini
  SetIniString('Konfigurasi', 'Nama', INIInputPage.Values[0], ExpandConstant('{app}') + '\konfig.ini');
  SetIniString('Konfigurasi', 'Telepon', INIInputPage.Values[1], ExpandConstant('{app}') + '\konfig.ini');
  SetIniString('Konfigurasi', 'Alamat', INIInputPage.Values[2], ExpandConstant('{app}') + '\konfig.ini');
  SetIniString('Konfigurasi', 'kota', INIInputPage.Values[3], ExpandConstant('{app}') + '\konfig.ini');
end;
</code></pre>

<p>  end;
end;
{% endcodeblock %}</p>

<p>Berikut contoh file <a href="{{%20site.url%20}}/blog/2010/04/23/contoh-sederhana-memanipulasi-ini-file-untuk-menyimpan-informasi/">INI</a> yang dihasilkan dari kode diatas</p>

<p><a href="http://coding4ever.files.wordpress.com/2010/12/12122010-1.jpg"><img src="http://coding4ever.files.wordpress.com/2010/12/12122010-1.jpg?w=300" alt="" /></a></p>

<p>Sedangkan untuk menyimpan langsung ke registry windows menggunakan perintah <strong>RegWriteStringValue</strong></p>

<p>{% codeblock %}
// jika semua input form oke, simpan ke registry windows
RegWriteStringValue(HKEY_CURRENT_USER, &lsquo;Software\K4m4r82<code>s Laboratory\Sistem Informasi Sekolah', 'Nama', INIInputPage.Values[0]);
RegWriteStringValue(HKEY_CURRENT_USER, 'Software\K4m4r82</code>s Laboratory\Sistem Informasi Sekolah&rsquo;, &lsquo;Telepon&rsquo;, INIInputPage.Values[1]);
RegWriteStringValue(HKEY_CURRENT_USER, &lsquo;Software\K4m4r82<code>s Laboratory\Sistem Informasi Sekolah', 'Alamat', INIInputPage.Values[2]);
RegWriteStringValue(HKEY_CURRENT_USER, 'Software\K4m4r82</code>s Laboratory\Sistem Informasi Sekolah&rsquo;, &lsquo;Kota&rsquo;, INIInputPage.Values[3]);
{% endcodeblock %}</p>

<p>Jika kita lihat di registry windows, hasilnya lebih kurang seperti berikut :</p>

<p><a href="http://coding4ever.files.wordpress.com/2010/12/12122010-2.jpg"><img src="http://coding4ever.files.wordpress.com/2010/12/12122010-2.jpg?w=300" alt="" /></a></p>

<p>Selamat mencoba :)</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Menambahkan Serial Number Pada Paket Instalasi (Inno Setup)]]></title>
    <link href="http://coding4ever.net/blog/2010/04/05/menambahkan-serial-number-pada-paket-instalasi-inno-setup/"/>
    <updated>2010-04-05T00:01:04+07:00</updated>
    <id>http://coding4ever.net/blog/2010/04/05/menambahkan-serial-number-pada-paket-instalasi-inno-setup</id>
    <content type="html"><![CDATA[<p>Melengkapi koleksi artikel saya tentang pembuatan <a href="http://coding4ever.wordpress.com/category/tools-installer/">paket instalasi</a>, kali ini kita akan menambahkan serial number pada <a href="http://coding4ever.wordpress.com/category/tools-installer/">paket instalasi</a> yang kita buat menggunakan <a href="http://jrsoftware.org/">Inno Setup</a>.</p>

<p><a href="http://www.mjfreelancing.com/IKG.htm">IKG</a> (Inno Key Generator) adalah <a href="http://en.wikipedia.org/wiki/Third_party">Third-Party</a> files yang akan kita gunakan pada artikel ini dan <a href="http://jrsoftware.org/">Inno Setup</a> yang saya gunakan adalah versi 5.0.8.</p>

<p>Silahkan Anda download <a href="http://www.mjfreelancing.com/IKG.htm">IKG</a> dari situs resminya atau bisa juga download di<a href="http://dc196.4shared.com/download/257069716/702b80a7">sini</a> tetapi saya lebih menyarankan Anda untuk  mendownload dari link ke <a href="http://dc196.4shared.com/download/257069716/702b80a7">dua</a> saja :D karena sudah saya seleksi file-file apa saja yang dibutuhkan.</p>

<!-- more -->


<p>Jika sudah selesai downloadnya silahkan Anda ekstrak file IKG.rarnya, berikut adalah penjelasan singkat tentang file-file yang ada di dalam file IKG.rar</p>

<ol>
<li><p> <strong>ISID.dll</strong>, file ini dibutuhkan untuk melakukan validasi serial number/unlock code yang diinputkan pada saat proses instalasi, otomatis harus kita sertakan pada saat pembuatan paket instalasi.</p></li>
<li><p> <strong>IKG.exe</strong> adalah tool untuk mengenerate file Inno Key yang berisi informasi user + serial number valid yang sudah terenkripsi,<del> jadi setiap paket instalasi yang kita buat membutuhkan file inno key yang unik (huhhhh report juga ya) namanya juga mau aman (walaupun tidak 100%) report sedikitkan engga pa2 kan</del> (ralat 1 public key inno bisa untuk beberapa user name yg berbeda).</p></li>
<li><p> <strong>IKGHelp.pdf</strong>, klo yang ini kayaxnya enggak perlu saya jelasin.</p></li>
</ol>


<p>Oke langsung saja Anda jalankan file IKG.exe, setelah itu akan tampil form berikut :</p>

<p><a href="http://coding4ever.files.wordpress.com/2010/04/05042010-1.jpg"><img src="http://coding4ever.files.wordpress.com/2010/04/05042010-1.jpg?w=300" alt="" /></a></p>

<p>Langkah pertama yang harus kita lakukan adalah mengeset password IKG, agar tidak semua orang bisa menggunakan tool ini.</p>

<p>Klik menu File -> Change Bank Password</p>

<p><a href="http://coding4ever.files.wordpress.com/2010/04/05042010-2.jpg"><img src="http://coding4ever.files.wordpress.com/2010/04/05042010-2.jpg?w=300" alt="" /></a></p>

<p>Selanjutnya kita tinggal masukkan passwordnya</p>

<p><a href="http://coding4ever.files.wordpress.com/2010/04/05042010-3.jpg"><img src="http://coding4ever.files.wordpress.com/2010/04/05042010-3.jpg" alt="" /></a></p>

<p>Untuk menyederhanakan pembahasan, informasi yang akan kita tambahkan pada saat instalasi kita batasi sebagai berikut :</p>

<ol>
<li><p> Registered Name</p></li>
<li><p> Registered Company</p></li>
<li><p> Registration Code</p></li>
<li><p> Private Key</p></li>
</ol>


<p>Maka konfigurasi yang harus kita set pada tool IKG adalah sebagai berikut :</p>

<p><a href="http://coding4ever.files.wordpress.com/2010/04/05042010-4.jpg"><img src="http://coding4ever.files.wordpress.com/2010/04/05042010-4.jpg?w=300" alt="" /></a></p>

<p>Kita tinggal menginputkan informasi Registered Name dan Organisation, untuk informasi Registration Code dan Private Key sudah otomatis terisi.</p>

<p>Jika sudah kita langsung saja simpan file Inno Keynya, file ini berisi informasi Registered Name, Registered Company, Registration Code dan Private Key (sesuai setting diatas) yang sudah dienkripsi.</p>

<p><a href="http://coding4ever.files.wordpress.com/2010/04/05042010-5.jpg"><img src="http://coding4ever.files.wordpress.com/2010/04/05042010-5.jpg?w=300" alt="" /></a></p>

<p><a href="http://coding4ever.files.wordpress.com/2010/04/05042010-6.jpg"><img src="http://coding4ever.files.wordpress.com/2010/04/05042010-6.jpg?w=300" alt="" /></a></p>

<p>Jadi jika kita akan membuat file setup berikutnya, kita harus mengetik ulang informasi Registered Name dan Registered Company yang lain (unik) dan menyimpan ulang file Inno Key (sebaiknya dengan nama yang berbeda).</p>

<p>Sampai disini kita akan memasuki bagian yang paling menyenangkan yaitu coding :D. Kita akan menambahkan beberapa baris kode pada bagian <strong>[Files]</strong> dan <strong>[Code]</strong>.</p>

<p>{% codeblock %}
[Files]
;file klien-1.iky dihasilkan oleh tool IKG
Source: klien-1.iky; DestDir: {tmp}; Flags: ignoreversion
Source: ISID.dll; DestDir: {sys}; Flags: ignoreversion</p>

<p>[Code]
function ValidateSerialNumber(InnoKeyFile, User, Orgn, ProdCode, HDD, MAC, PrivateKey, Serial: String): Boolean;
external &lsquo;ValidateSerialNumber@files:ISID.dll stdcall&rsquo;;</p>

<p>const
    INNO_KEY = &lsquo;klien-1.iky&rsquo;;</p>

<p>var
    UserPage   : TInputQueryWizardPage;
    UserValues : TArrayOfString;</p>

<p>procedure InitializeWizard();
begin
    { create the custom page }
    UserPage := CreateInputQueryPage(wpInfoBefore, &lsquo;Informasi Registrasi&rsquo;, &lsquo;Anda memerlukan user yang valid agar bisa melanjutkan proses instalasi&rsquo;,
        &lsquo;Masukkan informasi registrasi (case sensitive), kemudian klik tombol Lanjut >.&rsquo;);</p>

<pre><code>UserPage.Add('Registered Name:', False);
UserPage.Add('Registered Company:', False);
UserPage.Add('Registration Code:', False);
UserPage.Add('Private Key:', False);

{ Set default values }
SetArrayLength(UserValues, 4);
RegQueryStringValue(HKLM, 'Software\Microsoft\Windows\CurrentVersion', 'RegisteredOwner', UserValues[0]);
RegQueryStringValue(HKLM, 'Software\Microsoft\Windows\CurrentVersion', 'RegisteredOrganization', UserValues[1]);
if (UserValues[0] = '') and (UserValues[1] = '') then begin
    RegQueryStringValue(HKCU, 'Software\Microsoft\MS Setup (ACME)\User Info', 'DefName', UserValues[0]);
    RegQueryStringValue(HKCU, 'Software\Microsoft\MS Setup (ACME)\User Info', 'DefCompany', UserValues[1]);
end;

{ Try to find the settings that were stored last time (also see below). }
UserPage.Values[0] := GetPreviousData('Name', UserValues[0]);
UserPage.Values[1] := GetPreviousData('Company', UserValues[1]);
UserPage.Values[2] := GetPreviousData('Unlock', UserValues[2]);
UserPage.Values[3] := GetPreviousData('Private', UserValues[3]);
</code></pre>

<p>end;</p>

<p>procedure RegisterPreviousData(PreviousDataKey: Integer);
begin
  { Store the settings so we can restore them next time }
  SetPreviousData(PreviousDataKey, &lsquo;Name&rsquo;, UserPage.Values[0]);
  SetPreviousData(PreviousDataKey, &lsquo;Company&rsquo;, UserPage.Values[1]);
  SetPreviousData(PreviousDataKey, &lsquo;Unlock&rsquo;, UserPage.Values[2]);
  SetPreviousData(PreviousDataKey, &lsquo;Private&rsquo;, UserPage.Values[3]);
end;</p>

<p>function ScriptDlgPages(CurPage: Integer; BackClicked: Boolean): Boolean;
var
    ExpPath: String;</p>

<p>begin
    Result := True;</p>

<pre><code>if (CurPage = UserPage.ID) then
begin
    ExtractTemporaryFile(INNO_KEY);     { the public key file }

    ExpPath := ExpandConstant('{tmp}\' + INNO_KEY);

    Result := False;

    UserValues[0] := UserPage.Values[0];
    UserValues[1] := UserPage.Values[1];
    UserValues[2] := UserPage.Values[2];
    UserValues[3] := UserPage.Values[3];

    if (UserValues[0] = '') or (UserValues[1] = '') or (UserValues[2] = '') or (UserValues[3] = '') then
        MsgBox('No fields can be blank !', mbError, MB_OK)
    else
    begin
        Result := ValidateSerialNumber(ExpPath, UserValues[0], UserValues[1], '', '', '', UserValues[3], UserValues[2]);

        if (not Result) then
            MsgBox('Invalid Entry !', mbError, MB_OK);

    end
end
</code></pre>

<p>end;</p>

<p>function NextButtonClick(CurPage: Integer): Boolean;
begin
  Result := ScriptDlgPages(CurPage, False);
end;</p>

<p>function BackButtonClick(CurPage: Integer): Boolean;
begin
  Result := True;//ScriptDlgPages(CurPage, True);
end;</p>

<p>function HasHtmlHelp(): Boolean;
begin
    { HHCTRL.OCX GUID }
    Result := RegValueExists(HKCR, &lsquo;CLSID{4662DAB0-D393-11D0-9A56-00C04FB68B66}\InprocServer32&rsquo;, &lsquo;&rsquo;);
end;</p>

<p>function HasNoHtmlHelp(): Boolean;
begin
    Result := not HasHtmlHelp;
end;
{% endcodeblock %}</p>

<p>Jika sudah selesai silahkan compile (CTRL+F9) skrip inno setup Anda, dan ingat skrip diatas hanya potongan skrip inno setup. Contoh skrip yang lengkap bisa Anda lihat di<a href="{{%20site.url%20}}/blog/2009/12/31/membuat-paket-instalasi-vb-mysql-dengan-inno-setup/">sini</a> dan <a href="{{%20site.url%20}}/blog/2010/01/05/membuat-paket-instalasi-vb-firebird-dengan-inno-setup/">sini</a>.</p>

<p><a href="http://coding4ever.files.wordpress.com/2010/04/05042010-7.jpg"><img src="http://coding4ever.files.wordpress.com/2010/04/05042010-7.jpg?w=300" alt="" /></a>
<a href="http://coding4ever.files.wordpress.com/2010/04/05042010-8.jpg"><img src="http://coding4ever.files.wordpress.com/2010/04/05042010-8.jpg?w=300" alt="" /></a>
Jika kita mencoba memasukkan informasi registrasi yang salah, maka akan tampil pesan berikut :</p>

<p><a href="http://coding4ever.files.wordpress.com/2010/04/05042010-9.jpg"><img src="http://coding4ever.files.wordpress.com/2010/04/05042010-9.jpg" alt="" /></a></p>

<p>Selamat mencoba :)</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Menambahkan Skin Pada Paket Instalasi (Inno Setup)]]></title>
    <link href="http://coding4ever.net/blog/2010/03/31/menambahkan-skin-pada-paket-instalasi-inno-setup/"/>
    <updated>2010-03-31T02:59:21+07:00</updated>
    <id>http://coding4ever.net/blog/2010/03/31/menambahkan-skin-pada-paket-instalasi-inno-setup</id>
    <content type="html"><![CDATA[<p>Inilah krennya <a href="http://jrsoftware.org/">inno setup</a> selain gratis dan open source juga banyak tersedia Third-Party Files, salah satunya ISSkin dari <a href="http://isskin.codejock.com/">codejock</a>.</p>

<p>Sebelum kita menambahkan skin, kita lihat dulu tampilan standar paket instalasi yang dibuat menggunakan inno setup.</p>

<p><a href="http://coding4ever.files.wordpress.com/2010/03/31032010-1.jpg"><img src="http://coding4ever.files.wordpress.com/2010/03/31032010-1.jpg?w=300" alt="" /></a></p>

<p>Dan kita lihat setelah menambahkan skin</p>

<!-- more -->


<p><a href="http://coding4ever.files.wordpress.com/2010/03/31032010-2.jpg"><img src="http://coding4ever.files.wordpress.com/2010/03/31032010-2.jpg?w=300" alt="" /></a></p>

<p>Gimana ? Menarik bukan ? :)</p>

<p>Oke langsung saja download sample ISSkin di<a href="http://isskin.codejock.com/downloads/ISSkinExample.zip">sini</a>, ekstrak file ISSkinExample.zip dan terakhir jalankan file ISSkin.exe</p>

<p>Apakah cukup seperti itu saja ? Tentu tidak, kita harus menambahkan beberapa baris kode pada skrip inno setup di bagian [Files] dan [Code].</p>

<p>{% codeblock %}
[Files]
; Add the ISSkin DLL used for skinning Inno Setup installations.
Source: ISSkin.dll; DestDir: {app}; Flags: dontcopy</p>

<p>; Add the Visual Style resource contains resources used for skinning,
; you can also use Microsoft Visual Styles (*.msstyles) resources.
Source: Styles\Office2007.cjstyles; DestDir: {tmp}; Flags: dontcopy</p>

<p>; The following code block is used to load the ISS, pass in
; NormalAqua.ini as the second parameter to LoadSkin to use
; the Aqua color scheme instead of the default Blue color
; scheme.
[Code]
// Importing LoadSkin API from ISSkin.DLL
procedure LoadSkin(lpszPath: String; lpszIniFileName: String);
external &lsquo;LoadSkin@files:isskin.dll stdcall&rsquo;;</p>

<p>// Importing UnloadSkin API from ISSkin.DLL
procedure UnloadSkin();
external &lsquo;UnloadSkin@files:isskin.dll stdcall&rsquo;;</p>

<p>// Importing ShowWindow Windows API from User32.DLL
function ShowWindow(hWnd: Integer; uType: Integer): Integer;
external &lsquo;<a href="&#x6d;&#x61;&#x69;&#x6c;&#116;&#111;&#x3a;&#83;&#104;&#x6f;&#x77;&#87;&#105;&#110;&#100;&#111;&#119;&#x40;&#x75;&#115;&#x65;&#114;&#51;&#x32;&#x2e;&#x64;&#108;&#108;">&#x53;&#104;&#111;&#119;&#87;&#105;&#110;&#100;&#x6f;&#x77;&#x40;&#117;&#x73;&#x65;&#x72;&#x33;&#50;&#46;&#100;&#108;&#108;</a> stdcall&rsquo;;</p>

<p>function InitializeSetup(): Boolean;
begin
    ExtractTemporaryFile(&lsquo;Office2007.cjstyles&rsquo;);
    LoadSkin(ExpandConstant(&lsquo;{tmp}\Office2007.cjstyles&rsquo;), &lsquo;NormalAqua.ini&rsquo;);
    Result := True;
end;</p>

<p>procedure DeinitializeSetup();
begin
    // Hide Window before unloading skin so user does not get
    // a glimse of an unskinned window before it is closed.
    ShowWindow(StrToInt(ExpandConstant(&lsquo;{wizardhwnd}&rsquo;)), 0);
    UnloadSkin();
end;
{% endcodeblock %}</p>

<p>Berikut adalah beberapa variasi skin hasil dari ngoprek kode berikut :</p>

<p>{% codeblock %}
LoadSkin(ExpandConstant(&lsquo;{tmp}\Office2007.cjstyles&rsquo;), &lsquo;NormalAqua.ini&rsquo;);
{% endcodeblock %}</p>

<p><a href="http://coding4ever.files.wordpress.com/2010/03/31032010-3.jpg"><img src="http://coding4ever.files.wordpress.com/2010/03/31032010-3.jpg?w=300" alt="" /></a></p>

<p>{% codeblock %}
LoadSkin(ExpandConstant(&lsquo;{tmp}\Office2007.cjstyles&rsquo;), &lsquo;NormalBlack.ini&rsquo;);
{% endcodeblock %}</p>

<p><a href="http://coding4ever.files.wordpress.com/2010/03/31032010-4.jpg"><img src="http://coding4ever.files.wordpress.com/2010/03/31032010-4.jpg?w=300" alt="" /></a></p>

<p>{% codeblock %}
LoadSkin(ExpandConstant(&lsquo;{tmp}\Vista.cjstyles&rsquo;), &lsquo;NormalSilver.ini&rsquo;);
{% endcodeblock %}</p>

<p><a href="http://coding4ever.files.wordpress.com/2010/03/31032010-5.jpg"><img src="http://coding4ever.files.wordpress.com/2010/03/31032010-5.jpg?w=300" alt="" /></a></p>

<p>{% codeblock %}
LoadSkin(ExpandConstant(&lsquo;{tmp}\Vista.cjstyles&rsquo;), &lsquo;&rsquo;);
{% endcodeblock %}</p>

<p>Selamat mencoba :)</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Membuat Paket Instalasi Vb + Mysql Dengan NSIS]]></title>
    <link href="http://coding4ever.net/blog/2010/01/16/membuat-paket-instalasi-vb-mysql-dengan-nsis/"/>
    <updated>2010-01-16T09:43:35+07:00</updated>
    <id>http://coding4ever.net/blog/2010/01/16/membuat-paket-instalasi-vb-mysql-dengan-nsis</id>
    <content type="html"><![CDATA[<p>Melengkapi tulisan saya <a href="{{%20site.url%20}}/blog/2009/12/31/membuat-paket-instalasi-vb-mysql-dengan-inno-setup/">Membuat paket instalasi vb + mysql dengan inno setup</a> kali ini kita akan membuatnya menggunakan <a href="http://nsis.sourceforge.net">NSIS</a>. <a href="http://nsis.sourceforge.net"></a></p>

<p><a href="http://nsis.sourceforge.net">NSIS</a> adalah salah satu tool gratis dan open source untuk membuat paket instalasi. Oke sebelum kita melangkah lebih jauh, berikut adalah hal-hal yang perlu kita persiapkan :</p>

<ol>
<li><p> <a href="http://nsis.sourceforge.net">NSIS</a></p></li>
<li><p> <a href="http://dev.mysql.com/downloads/mysql/">MySQL versi noninstall</a> disesuaikan dengan versi MySQL yang terinstall di komputer Anda</p></li>
<li><p> <a href="http://dev.mysql.com/downloads/connector/odbc/">Connector ODBC</a> yang sudah terinstall biasanya ada di C:\Program Files\MySQL\Connector ODBC 5.1</p></li>
<li><p> Database yang sudah di backup/dump</p></li>
<li><p> Untuk editor, bagi Anda yang buta warna cukup pake notepad :D, saya sendiri menggunakan <a href="http://notepad-plus.sourceforge.net/uk/site.htm">notepad++</a> atau kalo pengen lebih nyaman bisa menggunakan <a href="http://www.eclipse.org/downloads/">eclipse</a> kemudian download <a href="http://nsis.sourceforge.net/EclipseNSIS_-_NSIS_plugin_for_Eclipse">plug-in NSIS</a></p></li>
</ol>


<!-- more -->


<p>Memang kalo dilihat dari segi skrip,  <a href="http://jrsoftware.org/">Inno Setup</a> lebih simple dibandingkan <a href="http://nsis.sourceforge.net/">NSIS</a> tetapi setelah saya bandingkan hasil paket instalasi NSIS lebih kecil dibandingkan Inno Setup.</p>

<p>Skrip Inno Setup dan NSIS sama-sama dikelompokkan dalam section-section bedanya kalo Inno Setup untuk nama sectionnya sudah fix (misal Setup, Tasks, Files de el el) sedangkan NSIS untuk nama sectionnya bebas dan tentunya dalam penamaan section di NSIS disesuaikan dengan isinya (misal Install MySQL 5).</p>

<p>Salah satu bagian penting dari skrip NSIS yang kita bahas disini adalah skrip yang digunakan untuk membuat <strong><em>service MySQL, mendaftarkan driver MySQL Connector ODBC dan melakukan proses undump skrip databse (.sql)</em></strong>.</p>

<p>Saya ambil contoh untuk membuat service MySQL tentunya dilihat dari versi windows yang terinstall kalo keluarga Win9x jelas tidak bisa karena belum mendukung pembuatan service, oleh karena itu sebelum menjalankan perintah membuat service akan dilakukan pengecekan versi windows terlebih dulu.</p>

<p>Nah disini akan terlihat jelas perbedaan skrip Inno Setup dan NSIS dimana untuk melakukan ini inno setup cukup menambahkan flag MinVersion, misal :</p>

<p>{% codeblock %}
[Run]
;mysqld &ndash;install MySQL
Filename: &ldquo;{app}\mysql\bin\mysqld.exe&rdquo;; Parameters: &ldquo;install &rdquo;&ldquo;MySQL&rdquo;&ldquo;&rdquo;; StatusMsg: &ldquo;Sedang menginstall service MySQL &hellip;&rdquo;; Flags: runhidden; MinVersion: 0,5.01.2600sp2; Tasks: installmysql
{% endcodeblock %}</p>

<p>Sedangkan untuk NSIS kita perlu mendownload <a href="http://nsis.sourceforge.net/mediawiki/images/4/4e/NSIS_version_plugin_02.zip">Version plug-in</a> terlebih dulu dan mengekstraknya kemudiakan mengcopykan file version.dll ke folder instalasi NSIS\Plugins, walaupun sebenarnya kita bisa membuat fungsi sendiri di NSIS untuk mengecek versi windows yang terinstall.</p>

<p>Contoh skrip NSIS untuk mengecek versi windows dan menginstall service MySQL :</p>

<p>{% codeblock %}
Section &ldquo;Install MySQL 5&rdquo;
    Version::IsWindowsXP</p>

<pre><code>Pop $0 ;nilai var $0 akan bersisi 1 jika windows XP selain itu 0
StrCmp $0 "1" ItIsWindowsXP ItIsNotWindowsXP ;StrCmp sama seperti fungsi IIF di VB

ItIsWindowsXP:
Goto installservice

ItIsNotWindowsXP:
Goto done

installservice:
    DetailPrint "Sedang menginstall service MySQL ..."
    ExecWait '"$MYSQL_DIR\bin\mysqld.exe" install "MySQL"'

done:
    ;do nothing
</code></pre>

<p>SectionEnd
{% endcodeblock %}</p>

<p>Gimana lumayan beda kan? :)</p>

<p>Khusus untuk file-file Runtime VB memerlukan penanganan khusus dan untuk memudahkan Anda mencoba sample skrip ini download terlebih dahulu file Runtime VB di<a href="http://nsis.sourceforge.net/vb6runtime.zip">sini</a> dan jangan lupa diekstrak.</p>

<p>Persiapan terakhir untuk struktur folder saya buat seperti berikut :</p>

<p><a href="http://coding4ever.files.wordpress.com/2010/01/16012010-5.jpg"><img src="http://coding4ever.files.wordpress.com/2010/01/16012010-5.jpg?w=300" alt="" /></a></p>

<p>Dan saya tidak akan menjelaskan fungsi-fungsi/perintah yang digunakan dalam skrip NSIS karena sudah saya sisipkan komentar di sample skrip instalasi NSIS.</p>

<p>Jika masih kesulitan Anda bisa langsung membaca manual NSIS yang penjelasannya sudah sangat lengkap.</p>

<p>Berikut contoh skrip instalasi lengkap menggunakan NSIS :</p>

<p>{% codeblock %}
;Skrip instalasi by k4m4r82
;<a href="http://coding4ever.wordpress.com">http://coding4ever.wordpress.com</a></p>

<p>!include VB6RunTime.nsh</p>

<p>;deklarasi konstanta
;format pemanggilan ${NAMA_KONSTANTA}
!define APP_NAME &ldquo;Sistem Pembelian Bahan Baku PT. ALBASI&rdquo;
!define APP_PUBLISHER &ldquo;K4m4r82&rsquo;s Laboratory&rdquo;
!define APP_VERSION &ldquo;2.0.50&rdquo;</p>

<p>BrandingText /TRIMCENTER &ldquo;&ndash; ${APP_PUBLISHER} &ndash;&rdquo;
Name &ldquo;${APP_NAME} ${APP_VERSION}&rdquo;
Caption &ldquo;${APP_NAME} ${APP_VERSION}&rdquo;</p>

<p>CompletedText &ldquo;Instalasi sudah selesai&rdquo;</p>

<p>Icon &ldquo;setup.ico&rdquo;
LoadLanguageFile &ldquo;${NSISDIR}\Contrib\Language files\Indonesian.nlf&rdquo;
OutFile &ldquo;output\DemoSetupNSIS.exe&rdquo;
ShowInstDetails show
ShowUninstDetails show
WindowIcon on
XPStyle on</p>

<p>;informasi default folder instalasi
InstallDir &ldquo;$PROGRAMFILES\SPBB&rdquo;</p>

<p>;informasi folder instalasi disimpan disini
;informasi ini akan memudahkan kita untuk membuat program update
InstallDirRegKey HKCU &ldquo;Software\PT ALBASI\SPBB&rdquo; &ldquo;InstallDir&rdquo;</p>

<p>VIAddVersionKey /LANG=${LANG_INDONESIAN} &ldquo;ProductName&rdquo; &ldquo;${APP_NAME}&rdquo;
VIAddVersionKey /LANG=${LANG_INDONESIAN} &ldquo;Comments&rdquo; &ldquo;&rdquo;
VIAddVersionKey /LANG=${LANG_INDONESIAN} &ldquo;CompanyName&rdquo; &ldquo;${APP_PUBLISHER}&rdquo;
VIAddVersionKey /LANG=${LANG_INDONESIAN} &ldquo;LegalTrademarks&rdquo; &ldquo;${APP_NAME} is a trademark of ${APP_PUBLISHER}&rdquo;
VIAddVersionKey /LANG=${LANG_INDONESIAN} &ldquo;LegalCopyright&rdquo; &ldquo;Copyright © 2009. ${APP_PUBLISHER}&rdquo;
VIAddVersionKey /LANG=${LANG_INDONESIAN} &ldquo;FileDescription&rdquo; &ldquo;${APP_NAME}&rdquo;
VIAddVersionKey /LANG=${LANG_INDONESIAN} &ldquo;FileVersion&rdquo; &ldquo;2.0.0.50&rdquo;
VIProductVersion &ldquo;2.0.0.50&rdquo;</p>

<p>RequestExecutionLevel admin</p>

<p>AddBrandingImage left 150|234
Page custom BrandingImage
Page components
Page directory
Page instfiles</p>

<p>UninstPage custom un.BrandingImage
UninstPage uninstConfirm
UninstPage instfiles</p>

<p>;deklarsi variabel
;format pemanggilan $NAMA_VARIABEL ingat ada sedikit perbedaan dg konstanta
Var MainDir
Var MySQLDir
Var AlreadyInstalled</p>

<p>;section yang diawali karakter -, pilihannya tidak ditampilkan
Section &ldquo;-Inisialisasi Variabel&rdquo;
    StrCpy $MainDir $INSTDIR
    StrCpy $MySQLDir $MainDir\mysql
SectionEnd</p>

<p>Section &ldquo;-Visual Basic Runtime&rdquo;
    ;download file Visual Basic Runtime di: <a href="http://nsis.sourceforge.net/vb6runtime.zip">http://nsis.sourceforge.net/vb6runtime.zip</a>
    IfFileExists &ldquo;$MainDir\Albasi.exe&rdquo; 0 new_installation
        StrCpy $AlreadyInstalled 1</p>

<pre><code>new_installation:
    !insertmacro VB6RunTimeInstall "dll&amp;ocx\vb6runtime" $AlreadyInstalled
</code></pre>

<p>SectionEnd</p>

<p>Section &ldquo;-My Application Runtime&rdquo;
    SetOutPath $MainDir
        File &ldquo;main\Albasi.exe.manifest&rdquo;
    File &ldquo;main\Albasi.exe&rdquo;</p>

<pre><code>SetOutPath $SYSDIR

File "dll&amp;ocx\LVbuttons.OCX"
RegDLL "$SYSDIR\LVbuttons.ocx"

File "dll&amp;ocx\MSMASK32.OCX"
RegDLL "$SYSDIR\MSMASK32.ocx"

File "dll&amp;ocx\cTreeOpt6.ocx"
RegDLL "$SYSDIR\cTreeOpt6.ocx"

File "dll&amp;ocx\Comdlg32.ocx"
RegDLL "$SYSDIR\Comdlg32.ocx"

File "dll&amp;ocx\vbalDTab6.ocx"
RegDLL "$SYSDIR\vbalDTab6.ocx"

File "dll&amp;ocx\vbalExpBar6.ocx"
RegDLL "$SYSDIR\vbalExpBar6.ocx"

File "dll&amp;ocx\MSCOMCTL.OCX"
RegDLL "$SYSDIR\MSCOMCTL.ocx"

File "dll&amp;ocx\vbalIml6.ocx"
RegDLL "$SYSDIR\vbalIml6.ocx"

File "dll&amp;ocx\cPopMenu6.ocx"
RegDLL "$SYSDIR\cPopMenu6.ocx"

File "dll&amp;ocx\cNewMenu6.dll"
RegDLL "$SYSDIR\cNewMenu6.DLL"

File "dll&amp;ocx\scrrun.dll"
RegDLL "$SYSDIR\scrrun.DLL"

File "dll&amp;ocx\vbalMDITabs6.dll"
RegDLL "$SYSDIR\vbalMDITabs6.DLL"

File "dll&amp;ocx\SSubTmr6.dll"
RegDLL "$SYSDIR\SSubTmr6.DLL"

File "dll&amp;ocx\msado21.tlb"
RegDLL "$SYSDIR\msado21.tlb"
</code></pre>

<p>SectionEnd</p>

<p>; param /e -> expand
SectionGroup /e &ldquo;Komponen Server&rdquo;
    Section &ldquo;Install MySQL 5&rdquo;
        ; param /r -> recursive
        SetOutPath $MySQLDir\bin
        File /r &ldquo;mysql-5.1.36-win32\bin*.*&rdquo;</p>

<pre><code>    SetOutPath $MySQLDir\Docs
    File /r "mysql-5.1.36-win32\Docs\*.*"

    SetOutPath $MySQLDir\lib
    File /r "mysql-5.1.36-win32\lib\*.*"

    SetOutPath $MySQLDir\share
    File /r "mysql-5.1.36-win32\share\*.*"

    SetOutPath $MySQLDir\data
    File /r "mysql-5.1.36-win32\data\*.*"

    SetOutPath $MySQLDir
    File "mysql-5.1.36-win32\*.*"

    ;informasi lokasi instalasi mysql
    WriteINIStr $MySQLDir\my.ini "mysqld" "basedir" $MySQLDir
    WriteINIStr $MySQLDir\my.ini "mysqld" "datadir" $MySQLDir\data

    ;proses membuat dan menjalankan service mysql, cek versi windows terlebih dulu
    ;untuk contoh disini baru di tes untuk windows xp sp2
    Version::IsWindowsXP

    Pop $0 ;nilai var $0 akan bersisi 1 jika windows XP selain itu 0
    StrCmp $0 "1" ItIsWindowsXP ItIsNotWindowsXP ;StrCmp sama seperti fungsi IIF di VB

    ItIsWindowsXP:
    Goto installservice

    ItIsNotWindowsXP:
    Goto done

    installservice:
        DetailPrint "Sedang menginstall service MySQL ..."
        ExecWait '"$MySQLDir\bin\mysqld.exe" install "MySQL"'

        ;jalankan service MySQL
        DetailPrint "Sedang menjalankan service MySQL ..."
        ExecWait '"$SYSDIR\net.exe" start "MySQL"'

        ;mendaftarkan port default mysql (3306) ke firewall
        DetailPrint "Sedang mendaftarkan port MySQL ..."
        ExecWait '"$SYSDIR\netsh.exe" firewall add portopening TCP 3306 "Port MySQL"'

        ;mengganti password default root (blank). ex : masterkey
        DetailPrint "Mengganti password root"
        ExecWait '"$MySQLDir\bin\mysqladmin.exe" -uroot password masterkey'

        ;menghapus user default1 (user=blank, password=blank)
        ExecWait '"$MySQLDir\bin\mysql.exe" -uroot -pmasterkey -e "DELETE FROM mysql.user WHERE Host=$\'localhost$\' AND User=$\'$\'"'
        ExecWait '"$MySQLDir\bin\mysql.exe" -uroot -pmasterkey -e "FLUSH PRIVILEGES"'

        ;menghapus user default2 (user=root, password=blank)
        ExecWait '"$MySQLDir\bin\mysql.exe" -uroot -pmasterkey -e "DELETE FROM mysql.user WHERE Host=$\'127.0.0.1$\' AND User=$\'root$\'"'
        ExecWait '"$MySQLDir\bin\mysql.exe" -uroot -pmasterkey -e "FLUSH PRIVILEGES"'

        ;set agar user root bisa login dari mesin lain (kalo diperlukan)
        ExecWait '"$MySQLDir\bin\mysql.exe" -uroot -pmasterkey -e "GRANT ALL PRIVILEGES ON *.* TO root@$\'%$\' IDENTIFIED BY $\'masterkey$\'"'
        ExecWait '"$MySQLDir\bin\mysql.exe" -uroot -pmasterkey -e "FLUSH PRIVILEGES"'

    done:
        ;do nothing
SectionEnd

Section "Install MySQL Connector ODBC"
    SetOutPath $SYSDIR

    ;dll mysql odbc tidak perlu diregistrasikan
    ;jadi otomatis tidak perlu memanggil fungsi RegDLL
    File "C:\Program Files\MySQL\Connector ODBC 5.1\myodbc5.dll"
    File "C:\Program Files\MySQL\Connector ODBC 5.1\myodbc5S.dll"
    File "C:\Program Files\MySQL\Connector ODBC 5.1\myodbc5.lib"
    File "C:\Program Files\MySQL\Connector ODBC 5.1\myodbc5S.lib"
    File "C:\Program Files\MySQL\Connector ODBC 5.1\myodbc-installer.exe"

    Version::IsWindowsXP

    Pop $0
    StrCmp $0 "1" ItIsWindowsXP ItIsNotWindowsXP

    ItIsWindowsXP:
    Goto installdriverodbc

    ItIsNotWindowsXP:
    Goto done

    installdriverodbc:
        ;install driver myodbc
        DetailPrint "Tunggu sedang mendaftarkan driver MySQL Connector ODBC 5.1.5"
        ExecWait '"$SYSDIR\myodbc-installer.exe" -d -a -n "MySQL ODBC 5.1 Driver" -t "DRIVER=myodbc5.dll;SETUP=myodbc5S.dll"'

    done:
        ;do nothing
SectionEnd

Section "Install Database"
    SetOutPath $MySQLDir\bin

    File "main\albasi.sql"
    File "main\exec.cmd"

    Version::IsWindowsXP

    Pop $0
    StrCmp $0 "1" ItIsWindowsXP ItIsNotWindowsXP

    ItIsWindowsXP:
    Goto installdatabase

    ItIsNotWindowsXP:
    Goto done

    installdatabase:
        ;membuat database kosong
        ExecWait '"$MySQLDir\bin\mysql.exe" -uroot -pmasterkey -e "CREATE DATABASE albasi"'

        ;menjalankan file batch exec.cmd untuk melakukan proses undump
        ExecWait '"$MySQLDir\bin\exec.cmd"'

    done:
        ;do nothing
SectionEnd
</code></pre>

<p>SectionGroupEnd</p>

<p>SectionGroup /e &ldquo;Buat Shortcut&rdquo;
    Section &ldquo;Start Programs&rdquo;
        SectionIn RO ;RO -> Read Only</p>

<pre><code>    CreateDirectory "$SMPROGRAMS\PT. ALBASI"
    CreateShortCut "$SMPROGRAMS\PT. ALBASI\${APP_NAME}.lnk" "$MainDir\Albasi.exe" "" "$MainDir\Albasi.exe" 0
SectionEnd

Section "Desktop"
    ;CreateDirectory "$DESKTOP\SPBB"
    CreateShortCut "$DESKTOP\${APP_NAME}.lnk" "$MainDir\Albasi.exe" "" "$MainDir\Albasi.exe" 0
SectionEnd

Section "Quick Launch"
    ;CreateDirectory "$QUICKLAUNCH\SPBB"
    CreateShortCut "$QUICKLAUNCH\${APP_NAME}.lnk" "$MainDir\Albasi.exe" "" "$MainDir\Albasi.exe" 0
SectionEnd
</code></pre>

<p>SectionGroupEnd</p>

<p>Section &ldquo;-Registry Windows&rdquo;
    ;informasi uninstall
    WriteRegStr HKLM &ldquo;Software\Microsoft\Windows\CurrentVersion\Uninstall\SPBB&rdquo; &ldquo;DisplayName&rdquo; &ldquo;${APP_NAME}&rdquo;
    WriteRegStr HKLM &ldquo;Software\Microsoft\Windows\CurrentVersion\Uninstall\SPBB&rdquo; &ldquo;UninstallString&rdquo; &lsquo;&ldquo;$MainDir\uninstaller.exe&rdquo;&rsquo;
    WriteRegStr HKLM &ldquo;Software\Microsoft\Windows\CurrentVersion\Uninstall\SPBB&rdquo; &ldquo;DisplayIcon&rdquo; &lsquo;&ldquo;$MainDir\uninstaller.exe&rdquo;&rsquo;</p>

<pre><code>WriteRegDWORD HKLM "Software\Microsoft\Windows\CurrentVersion\Uninstall\SPBB" "NoModify" 1
WriteRegDWORD HKLM "Software\Microsoft\Windows\CurrentVersion\Uninstall\SPBB" "NoRepair" 1

WriteUninstaller $MainDir\uninstaller.exe
</code></pre>

<p>SectionEnd</p>

<p>Section &ldquo;-File Konfigurasi Program&rdquo;
    WriteINIStr $MainDir\infoprogram.ini &ldquo;Sistem&rdquo; &ldquo;serverName&rdquo; &ldquo;127.0.0.1&rdquo;
    WriteINIStr $MainDir\infoprogram.ini &ldquo;Sistem&rdquo; &ldquo;dbName&rdquo; &ldquo;albasi&rdquo;
SectionEnd</p>

<p>Section &ldquo;Uninstall&rdquo;
    ;stop service MySQL
    DetailPrint &ldquo;Menghentikan Service MySQL &hellip;&rdquo;
    ExecWait &lsquo;&ldquo;$SYSDIR\net.exe&rdquo; stop &ldquo;MySQL&rdquo;&rsquo;</p>

<pre><code>;hapus service MySQL
DetailPrint "Sedang menghapus service MySQL ..."
ExecWait '"$MySQLDir\bin\mysqld.exe" remove "MySQL"'

;driver MySQL Connector ODBC 5.1
DetailPrint "Tunggu sedang menghapus driver MySQL Connector ODBC 5.1"
ExecWait '"$SYSDIR\myodbc-installer.exe" -d -r -n "MySQL ODBC 5.1 Driver"'

; Remove registry keys
DeleteRegKey HKLM "Software\Microsoft\Windows\CurrentVersion\Uninstall\SPBB"

; Remove files and uninstaller
Delete $MainDir\*.*
RMDir $MainDir

; Remove shortcuts
Delete "$SMPROGRAMS\PT. ALBASI\*.*"
RMDir "$SMPROGRAMS\PT. ALBASI"

Delete "$DESKTOP\${APP_NAME}.lnk"
Delete "$QUICKLAUNCH\${APP_NAME}.lnk"
</code></pre>

<p>SectionEnd</p>

<p>;fungsi untuk menampilkan gambar/banner pada saat instalasi
;untuk contoh disini posisi gambar di sebelah kiri
Function BrandingImage
    SetOutPath &ldquo;$TEMP&rdquo;</p>

<pre><code>SetFileAttributes SetupModern21.bmp temporary
File SetupModern21.bmp
SetBrandingImage "$TEMP\SetupModern21.bmp" /resizetofit
</code></pre>

<p>FunctionEnd</p>

<p>;fungsi untuk menampilkan gambar/banner pada saat uninstall
Function un.BrandingImage
    SetBrandingImage &ldquo;$TEMP\SetupModern21.bmp&rdquo; /resizetofit
FunctionEnd
{% endcodeblock %}</p>

<p>Di dalam skrip instalasi ada file exec.cmd, isinya adalah :</p>

<p>{% codeblock %}
mysql -uroot -pmasterkey albasi &lt; albasi.sql
{% endcodeblock %}</p>

<p>Isi file exec.cmd sebenarnya untuk proses undump dan ternyata Inno Setup dan NSIS gagal menjalankan perintah tersebut, padahal perintah-perintah yang lainnya sukses.</p>

<p>Contoh hasil instalasi :</p>

<p><a href="http://coding4ever.files.wordpress.com/2010/01/16012010-1.jpg"><img src="http://coding4ever.files.wordpress.com/2010/01/16012010-1.jpg?w=299" alt="" /></a></p>

<p>Gambar 1</p>

<p><a href="http://coding4ever.files.wordpress.com/2010/01/16012010-22.jpg"><img src="http://coding4ever.files.wordpress.com/2010/01/16012010-22.jpg?w=299" alt="" /></a></p>

<p>Gambar 2</p>

<p><a href="http://coding4ever.files.wordpress.com/2010/01/16012010-3.jpg"><img src="http://coding4ever.files.wordpress.com/2010/01/16012010-3.jpg?w=299" alt="" /></a></p>

<p>Gambar 3</p>

<p><a href="http://coding4ever.files.wordpress.com/2010/01/16012010-4.jpg"><img src="http://coding4ever.files.wordpress.com/2010/01/16012010-4.jpg?w=299" alt="" /></a></p>

<p>Gambar 4</p>

<p>Selamat mencoba :)</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Membuat Paket Instalasi Vb + Firebird Dengan Inno Setup]]></title>
    <link href="http://coding4ever.net/blog/2010/01/05/membuat-paket-instalasi-vb-firebird-dengan-inno-setup/"/>
    <updated>2010-01-05T13:16:54+07:00</updated>
    <id>http://coding4ever.net/blog/2010/01/05/membuat-paket-instalasi-vb-firebird-dengan-inno-setup</id>
    <content type="html"><![CDATA[<p>Menyambung postingan saya sebelumnya <a href="{{%20site.url%20}}/blog/2009/12/31/membuat-paket-instalasi-vb-mysql-dengan-inno-setup/">Membuat paket instalasi vb + mysql dengan inno setup</a> kali ini database yang kita paketkan adalah <a href="http://firebirdsql.org/">Firebird</a>. Adapun hal-hal yang perlu dipersiapkan :</p>

<ol>
<li><p> File <a href="http://sourceforge.net/projects/firebird/files/firebird-win32/2.1.3-Release/Firebird-2.1.3.18185_0_Win32.exe/download?use_mirror=autoselect">Setup Firebird</a> (saat postingan ini dibuat versi Firebird-2.1.3.18185_0_Win32)</p></li>
<li><p> File OdbcFb32.dll hasil dari instalasi <a href="http://firebirdsql.org/download/prerelease/odbc/Firebird_ODBC_2.0.0.148_win32.exe">Firebird ODBC</a> yang ada di c:\windows\system32</p></li>
<li><p> <a href="http://jrsoftware.org/">Inno Setup</a></p></li>
</ol>


<!-- more -->


<p>Karena semua persiapan sudah oke, berikut skrip instalasinya :</p>

<p>{% codeblock %}
;Skrip instalasi by k4m4r82
;<a href="http://coding4ever.wordpress.com">http://coding4ever.wordpress.com</a></p>

<p>[Setup]
AppName=Retail Manager Pro
AppVerName=Retail Manager Pro Versi 1.0.0.50
AppPublisher=K4m4r82&rsquo;s Laboratory
AllowCancelDuringInstall = yes
DefaultDirName={pf}\RetailManagerPro
DefaultGroupName=Retail Manager Pro
Compression = lzma
SolidCompression = yes
OutputBaseFilename=SetupRetailManagerPro
AllowNoIcons = yes
AlwaysRestart = no
AlwaysShowComponentsList = no
DisableProgramGroupPage = yes
AppendDefaultDirName = yes
CreateUninstallRegKey = yes
DisableStartupPrompt = yes
LanguageDetectionMethod=none
ShowLanguageDialog=no
Uninstallable = yes
UninstallFilesDir={app}\uninst
UninstallDisplayIcon={app}\RetailManager.exe,0
UninstallDisplayName=Retail Manager Pro
WindowVisible = no
AppCopyright=Copyright © 2009 K4m4r82&rsquo;s Laboratory
FlatComponentsList = yes
PrivilegesRequired = admin
VersionInfoVersion=1.0.0.50
SetupIconFile=Setup.ico
WizardImageFile=SetupModern21.bmp
WizardSmallImageFile=SetupModernSmall21.bmp</p>

<p>[Languages]
Name: ina; MessagesFile: compiler:Indonesia.isl
Name: en; MessagesFile: compiler:Default.isl</p>

<p>[Tasks]
Name: desktopicon; Description: {cm:CreateDesktopIcon}; GroupDescription: {cm:AdditionalIcons}; Flags: unchecked
Name: quicklaunchicon; Description: {cm:CreateQuickLaunchIcon}; GroupDescription: {cm:AdditionalIcons}; Flags: unchecked</p>

<p>[Files]
;Visual Basic Runtime
Source: dll&amp;ocx\VB6STKIT.DLL; DestDir: {sys}; Flags: uninsneveruninstall onlyifdoesntexist
Source: dll&amp;ocx\COMCAT.DLL; DestDir: {sys}; Flags: uninsneveruninstall sharedfile regserver onlyifdoesntexist
Source: dll&amp;ocx\stdole2.tlb; DestDir: {sys}; Flags: uninsneveruninstall sharedfile regtypelib
Source: dll&amp;ocx\asycfilt.dll; DestDir: {sys}; Flags: uninsneveruninstall onlyifdoesntexist
Source: dll&amp;ocx\olepro32.dll; DestDir: {sys}; Flags: uninsneveruninstall sharedfile regserver onlyifdoesntexist
Source: dll&amp;ocx\oleaut32.dll; DestDir: {sys}; Flags: uninsneveruninstall sharedfile regserver onlyifdoesntexist
Source: dll&amp;ocx\msvbvm60.dll; DestDir: {sys}; Flags: uninsneveruninstall sharedfile regserver onlyifdoesntexist</p>

<p>;file hasil instalasi firebird odbc
Source: C:\WINDOWS\system32\OdbcFb32.dll; DestDir: {sys}; Flags: restartreplace sharedfile regserver onlyifdoesntexist</p>

<p>;file installer database firebird sesuaikan dengan versi yang Anda download
Source: main\Firebird-2.1.3.18185_0_Win32.exe; DestDir: &ldquo;{tmp}&rdquo;; Flags: deleteafterinstall</p>

<p>;My Application Runtime
Source: main\RetailManager.exe; DestDir: {app}; Flags: ignoreversion
Source: main\RetailManager.pdf; DestDir: {app}; Flags: ignoreversion
Source: main\RETAIL_MANAGER.FDB; DestDir: {app}\Db; Flags: onlyifdoesntexist
Source: main\RetailManager.exe.manifest; DestDir: {app}; Flags: ignoreversion</p>

<p>Source: dll&amp;ocx\cTreeOpt6.ocx; DestDir: {sys}; Flags: uninsneveruninstall sharedfile regserver onlyifdoesntexist
Source: dll&amp;ocx\vbalDTab6.ocx; DestDir: {sys}; Flags: uninsneveruninstall sharedfile regserver onlyifdoesntexist
Source: dll&amp;ocx\vbalExpBar6.ocx; DestDir: {sys}; Flags: uninsneveruninstall sharedfile regserver onlyifdoesntexist
Source: dll&amp;ocx\mscomctl.ocx; DestDir: {sys}; Flags: uninsneveruninstall sharedfile regserver onlyifdoesntexist
Source: dll&amp;ocx\vbalIml6.ocx; DestDir: {sys}; Flags: uninsneveruninstall sharedfile regserver onlyifdoesntexist
Source: dll&amp;ocx\cPopMenu6.ocx; DestDir: {sys}; Flags: uninsneveruninstall sharedfile regserver onlyifdoesntexist
Source: dll&amp;ocx\LVbuttons.ocx; DestDir: {sys}; Flags: uninsneveruninstall sharedfile regserver onlyifdoesntexist
Source: dll&amp;ocx\MyTextBox.ocx; DestDir: {sys}; Flags: uninsneveruninstall sharedfile regserver onlyifdoesntexist
Source: dll&amp;ocx\MSCOMCT2.OCX; DestDir: {sys}; Flags: uninsneveruninstall sharedfile regserver onlyifdoesntexist
Source: dll&amp;ocx\vbalMDITabs6.dll; DestDir: {sys}; Flags: uninsneveruninstall sharedfile regserver onlyifdoesntexist
Source: dll&amp;ocx\SSubTmr6.dll; DestDir: {sys}; Flags: uninsneveruninstall sharedfile regserver onlyifdoesntexist
Source: dll&amp;ocx\scrrun.dll; DestDir: {sys}; Flags: uninsneveruninstall sharedfile regserver onlyifdoesntexist
Source: dll&amp;ocx\cNewMenu6.dll; DestDir: {sys}; Flags: uninsneveruninstall sharedfile regserver onlyifdoesntexist
Source: dll&amp;ocx\msado21.tlb; DestDir: {sys}; Flags: uninsneveruninstall sharedfile regtypelib</p>

<p>[Icons]
Name: {group}\Retail Manager Pro; Filename: {app}\RetailManager.exe; WorkingDir: {app}
Name: {group}\Retail Manager Pro User Manual; Filename: {app}\RetailManager.pdf; WorkingDir: {app}</p>

<p>Name: {userdesktop}\Retail Manager Pro; Filename: {app}\RetailManager.exe; WorkingDir: {app}; Tasks: desktopicon
Name: {userappdata}\Microsoft\Internet Explorer\Quick Launch\Retail Manager Pro; Filename: {app}\RetailManager.exe; WorkingDir: {app}; Tasks: quicklaunchicon</p>

<p>[Registry]
;mencatat lokasi instalasi program, ini dibutuhkan jika kita ingin membuat paket instalasi update
Root: HKCU; Subkey: &ldquo;Software\K4m4r82`s Laboratory\RetailManager&rdquo;; ValueName: &ldquo;installDir&rdquo;; ValueType: String; ValueData: {app}; Flags: uninsdeletevalue</p>

<p>[INI]
Filename: &ldquo;{app}\infoProgram.ini&rdquo;; Section: &ldquo;Sistem&rdquo;; Key: &ldquo;serverName&rdquo;; String: &ldquo;127.0.0.1&rdquo;
Filename: &ldquo;{app}\infoProgram.ini&rdquo;; Section: &ldquo;Sistem&rdquo;; Key: &ldquo;dbPath&rdquo;; String: &ldquo;{app}\Db&rdquo;</p>

<p>[Run]
;install firebird
Filename: &ldquo;{tmp}\Firebird-2.1.3.18185_0_Win32.exe&rdquo;; Parameters: &ldquo;/SP- /NORESTART /NOCPL /NOICONS /SILENT /FORCE /COMPONENTS=&rdquo;&ldquo;servercomponent\superservercomponent, SuperServerComponent, ServerComponent, ClientComponent, DevAdminComponent&rdquo;&ldquo;&rdquo;; StatusMsg: &ldquo;Instalasi Firebird 2.0 Server&hellip;&rdquo;</p>

<p>;daftarkan port firebird (3050) ke windows firewall
Filename: &ldquo;{sys}\netsh.exe&rdquo;; Parameters: &ldquo;firewall add portopening TCP 3050 &rdquo;&ldquo;Service Firebird Server&rdquo;&ldquo;&rdquo;; StatusMsg: &ldquo;Mendaftarkan port Service Firebird &hellip;&rdquo;; Flags: runhidden; MinVersion: 0,5.01.2600sp2
Filename: &ldquo;{sys}\netsh.exe&rdquo;; Parameters: &ldquo;firewall add allowedprogram &rdquo;&ldquo;{pf}\Firebird\Firebird_2_0\bin\fbserver.exe&rdquo;&ldquo; &rdquo;&ldquo;Firebird Server&rdquo;&ldquo; ENABLE ALL&rdquo;; StatusMsg: &ldquo;Mendaftarkan Firebird Server &hellip;&rdquo;; Flags: runhidden; MinVersion: 0,5.01.2600sp2</p>

<p>;menjalankan service firebird
Filename: &ldquo;{pf}\Firebird\Firebird_2_0\bin\fbserver.exe&rdquo;; Parameters: &ldquo;-a&rdquo;; StatusMsg: &ldquo;Menjalankan service firebird&rdquo;; Flags: waituntilidle</p>

<p>[UninstallRun]
Filename: &ldquo;{sys}\netsh.exe&rdquo;; Parameters: &ldquo;firewall delete portopening protocol = TCP port = 3050&rdquo;; Flags: runhidden; MinVersion: 0,5.01.2600sp2
Filename: &ldquo;{sys}\netsh.exe&rdquo;; Parameters: &ldquo;firewall delete allowedprogram &rdquo;&ldquo;{pf}\Firebird\Firebird_2_0\bin\fbserver.exe&rdquo;&ldquo;&rdquo;; Flags: runhidden; MinVersion: 0,5.01.2600sp2
{% endcodeblock %}</p>

<p>Selamat mencoba :)</p>
]]></content>
  </entry>
  
</feed>
